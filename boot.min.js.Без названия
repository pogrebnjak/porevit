(()=>{var __webpack_modules__={499:()=>{window.WsDialCodesPhoneInput=function(e){var t;return{COUNTRY_NAME_INDEX:0,COUNTRY_KEY_INDEX:1,COUNTRY_CODE_INDEX:2,selectedCountryKeys:{},formattedCountriesData:{},commonCountriesArray:[],pinnedCountriesArray:[],settings:{defaultCountry:"ru",pinnedCountries:["ru","ua","kz","tr"],initCommonCallback:null,setFlagsImageCss:!0,disableEvents:!1},initCommon:function(e){return t=this,this.setSettings(e),this.initData(),this.settings.initCommonCallback&&"function"==typeof this.settings.initCommonCallback&&this.settings.initCommonCallback(),this},renderOnInput:function(t,i,n,a){var s=n?n.querySelector(t):document.querySelector(t);this.selectedCountryKeys.hasOwnProperty(i)&&e(s).closest(".ws-dcpi_dropdown").length||(this.setSelectedCountryByInputKey(this.settings.defaultCountry,i),this.renderDropdownElements(t,i,n,a))},initData:function(){this.setFormattedCountriesData(this.settings.pinnedCountries)},setSettings:function(t){return e.extend(this.settings,t),this.settings},setFormattedCountriesData:function(e){this.allCountries.forEach((function(i){t.formattedCountriesData[i[t.COUNTRY_KEY_INDEX]]={name:i[t.COUNTRY_NAME_INDEX],code:i[t.COUNTRY_CODE_INDEX],key:i[t.COUNTRY_KEY_INDEX]},e.includes(i[t.COUNTRY_KEY_INDEX])?t.pinnedCountriesArray.push(t.formattedCountriesData[i[t.COUNTRY_KEY_INDEX]]):t.commonCountriesArray.push(t.formattedCountriesData[i[t.COUNTRY_KEY_INDEX]])}))},setSelectedCountryByInputKey:function(e,t){if(!t||!e)return null;this.selectedCountryKeys[t]=e},getSelectedCountryByInputKey:function(e){return this.formattedCountriesData[this.selectedCountryKeys[e]]},toggleClickEvent:function(e){e.classList.contains("ws-dcpi_dropdown--closed")?e.classList.remove("ws-dcpi_dropdown--closed"):e.classList.add("ws-dcpi_dropdown--closed")},countryClickEvent:function(e,t,i,n,a){this.renderNewSelectedCountry(i,e,a),this.setSelectedCountryByInputKey(e,a),t.classList.add("ws-dcpi_dropdown--closed"),n.focus()},inputFocus:function(e){e.classList.add("ws-dcpi_dropdown--focused"),e.classList.add("ws-dcpi_dropdown--closed")},inputBlur:function(e){e.classList.remove("ws-dcpi_dropdown--focused")},onInput:function(e){e.target.value=e.target.value.replace(/\D/g,"")},setEvents:function(i,n,a,s){e(a).on("input.ws-phone-codes-target-input",t.onInput),e(a).on("focus.ws-phone-codes-target-input",(function(e){t.inputFocus(i,e)})),e(a).on("blur.ws-phone-codes-target-input",(function(e){t.inputBlur(i,e)})),e(n).on("click.ws-dcpi_dropdown-toggle",(function(){t.toggleClickEvent(i,a)})),i.querySelectorAll(".ws-dcpi_country").forEach((function(o){e(o).on("click.ws-dcpi_country",(function(){t.countryClickEvent(o.id,i,n,a,s)}))}))},clearEvents:function(i,n,a,s){e(a).off("input.ws-phone-codes-target-input",t.onInput),e(a).off("focus.ws-phone-codes-target-input",(function(e){t.inputFocus(i,e)})),e(a).off("blur.ws-phone-codes-target-input",(function(e){t.inputBlur(i,e)})),e(n).off("click.ws-dcpi_dropdown-toggle",(function(){t.toggleClickEvent(i,a)})),i.querySelectorAll(".ws-dcpi_country").forEach((function(o){e(o).off("click.ws-dcpi_country",(function(){t.countryClickEvent(o.id,i,n,a,s)}))}))},parseCountry:function(e,t){var i=this.selectedCountryKeys[t].key;if((e=e.replace(/[^\d]/g,"")).substring(0,this.formattedCountriesData[this.settings.defaultCountry].code.length)===this.formattedCountriesData[this.settings.defaultCountry].code)return{value:e.substring(this.formattedCountriesData[this.settings.defaultCountry].code.length,e.length),country:this.formattedCountriesData[this.settings.defaultCountry].key};for(key in this.formattedCountriesData){var n=this.formattedCountriesData.hasOwnProperty(key)?this.formattedCountriesData[key]:null;if(n&&e.substring(0,n.code.length)===n.code){e=e.substring(n.code.length,e.length),i=n.key;break}}return{value:e,country:i}},renderNewSelectedCountry:function(e,t,i){if(e){var n=e.querySelector(".ws-dcpi_dropdown-toggle-selected_flag"),a=e.querySelector(".ws-dcpi_dropdown-toggle-selected_code");n&&(n.classList.remove("ws-dcpi_flag-"+this.selectedCountryKeys[i]),n.classList.add("ws-dcpi_flag-"+t)),a&&(a.textContent="+"+this.formattedCountriesData[t].code)}},renderDropdownElements:function(e,t,i,n){var a=i?i.querySelector(e):document.querySelector(e);if(n){var s=this.parseCountry(a.value,t);a.value=s.value,this.setSelectedCountryByInputKey(s.country,t)}var o=this.сreateDropdownRootElement(),r=this.createListToggle(t);a.classList.add("ws-phone-codes-target-input"),a.parentElement.insertBefore(o,a),o.append(r),o.append(a),o.append(this.createCountriesList()),this.settings.setFlagsImageCss&&this.setFlagsImageCssWithStaticHost(this.settings.flagsStaticHost,this.settings.stylesTagId),this.settings.disableEvents||this.setEvents(o,r,a,t)},createListToggle:function(e){var t=document.createElement("span"),i='<span class="ws-dcpi_dropdown-toggle-selected_flag ws-dcpi_flag ws-dcpi_flag-'+this.getSelectedCountryByInputKey(e).key+'"></span><span class="ws-dcpi_dropdown-toggle-arrow"></span><span class="ws-dcpi_country-code ws-dcpi_dropdown-toggle-selected_code">+'+this.getSelectedCountryByInputKey(e).code+"</span>";return t.classList.add("ws-dcpi_dropdown-toggle"),t.innerHTML=i,t},сreateCountryListItem:function(e){var t='<span class="ws-dcpi_flag ws-dcpi_flag-'+e.key+'"></span><span class="ws-dcpi_country-name" title="'+e.name+'">'+e.name+'</span><span class="ws-dcpi_country-code">+'+e.code+"</span>",i=document.createElement("li");return i.classList.add("ws-dcpi_country"),i.id=e.key,i.innerHTML=t,i},createCountriesList:function(){var e=document.createElement("ul");if(e.classList.add("ws-dcpi_country-list"),this.pinnedCountriesArray.length){var i=document.createElement("hr");i.classList.add("ws-dcpi_divider"),this.pinnedCountriesArray.forEach((function(i){e.append(t.сreateCountryListItem(i))})),e.append(i)}return this.commonCountriesArray.forEach((function(i){e.append(t.сreateCountryListItem(i))})),e},сreateDropdownRootElement:function(){var e=document.createElement("div");return e.classList.add("ws-dcpi_dropdown"),e.classList.add("ws-dcpi_dropdown--closed"),e.id=this.settings.rootId?this.settings.rootId:e.id,e.style=this.settings.rootStyle?e.style+this.settings.rootStyle:e.style,e.className=this.settings.rootClassName?this.settings.rootClassName+" "+e.className:e.className,e},setFlagsImageCssWithStaticHost:function(e,t){e=e||"";var i=document.getElementById(t);t&&i||((i=document.createElement("style")).id="phoneCodeSelectFlags"),e=e?e+"/":"",i.append(".ws-dcpi_flag{background-image:url("+e+"img/flags.png);}"),document.body.append(i)},allCountries:[["Afghanistan (‫افغانستان‬‎)","af","93"],["Albania (Shqipëri)","al","355"],["Algeria (‫الجزائر‬‎)","dz","213"],["American Samoa","as","1",5,["684"]],["Andorra","ad","376"],["Angola","ao","244"],["Anguilla","ai","1",6,["264"]],["Antigua and Barbuda","ag","1",7,["268"]],["Argentina","ar","54"],["Armenia (Հայաստան)","am","374"],["Aruba","aw","297"],["Ascension Island","ac","247"],["Australia","au","61",0],["Austria (Österreich)","at","43"],["Azerbaijan (Azərbaycan)","az","994"],["Bahamas","bs","1",8,["242"]],["Bahrain (‫البحرين‬‎)","bh","973"],["Bangladesh (বাংলাদেশ)","bd","880"],["Barbados","bb","1",9,["246"]],["Belarus (Беларусь)","by","375"],["Belgium (België)","be","32"],["Belize","bz","501"],["Benin (Bénin)","bj","229"],["Bermuda","bm","1",10,["441"]],["Bhutan (འབྲུག)","bt","975"],["Bolivia","bo","591"],["Bosnia and Herzegovina (Босна и Херцеговина)","ba","387"],["Botswana","bw","267"],["Brazil (Brasil)","br","55"],["British Indian Ocean Territory","io","246"],["British Virgin Islands","vg","1",11,["284"]],["Brunei","bn","673"],["Bulgaria (България)","bg","359"],["Burkina Faso","bf","226"],["Burundi (Uburundi)","bi","257"],["Cambodia (កម្ពុជា)","kh","855"],["Cameroon (Cameroun)","cm","237"],["Canada","ca","1",1,["204","226","236","249","250","263","289","306","343","354","365","367","368","382","387","403","416","418","428","431","437","438","450","584","468","474","506","514","519","548","579","581","584","587","604","613","639","647","672","683","705","709","742","753","778","780","782","807","819","825","867","873","902","905"]],["Cape Verde (Kabu Verdi)","cv","238"],["Caribbean Netherlands","bq","599",1,["3","4","7"]],["Cayman Islands","ky","1",12,["345"]],["Central African Republic (République centrafricaine)","cf","236"],["Chad (Tchad)","td","235"],["Chile","cl","56"],["China (中国)","cn","86"],["Christmas Island","cx","61",2,["89164"]],["Cocos (Keeling) Islands","cc","61",1,["89162"]],["Colombia","co","57"],["Comoros (‫جزر القمر‬‎)","km","269"],["Congo (DRC) (Jamhuri ya Kidemokrasia ya Kongo)","cd","243"],["Congo (Republic) (Congo-Brazzaville)","cg","242"],["Cook Islands","ck","682"],["Costa Rica","cr","506"],["Côte d’Ivoire","ci","225"],["Croatia (Hrvatska)","hr","385"],["Cuba","cu","53"],["Curaçao","cw","599",0],["Cyprus (Κύπρος)","cy","357"],["Czech Republic (Česká republika)","cz","420"],["Denmark (Danmark)","dk","45"],["Djibouti","dj","253"],["Dominica","dm","1",13,["767"]],["Dominican Republic (República Dominicana)","do","1",2,["809","829","849"]],["Ecuador","ec","593"],["Egypt (‫مصر‬‎)","eg","20"],["El Salvador","sv","503"],["Equatorial Guinea (Guinea Ecuatorial)","gq","240"],["Eritrea","er","291"],["Estonia (Eesti)","ee","372"],["Eswatini","sz","268"],["Ethiopia","et","251"],["Falkland Islands (Islas Malvinas)","fk","500"],["Faroe Islands (Føroyar)","fo","298"],["Fiji","fj","679"],["Finland (Suomi)","fi","358",0],["France","fr","33"],["French Guiana (Guyane française)","gf","594"],["French Polynesia (Polynésie française)","pf","689"],["Gabon","ga","241"],["Gambia","gm","220"],["Georgia (საქართველო)","ge","995"],["Germany (Deutschland)","de","49"],["Ghana (Gaana)","gh","233"],["Gibraltar","gi","350"],["Greece (Ελλάδα)","gr","30"],["Greenland (Kalaallit Nunaat)","gl","299"],["Grenada","gd","1",14,["473"]],["Guadeloupe","gp","590",0],["Guam","gu","1",15,["671"]],["Guatemala","gt","502"],["Guernsey","gg","44",1,["1481","7781","7839","7911"]],["Guinea (Guinée)","gn","224"],["Guinea-Bissau (Guiné Bissau)","gw","245"],["Guyana","gy","592"],["Haiti","ht","509"],["Honduras","hn","504"],["Hong Kong (香港)","hk","852"],["Hungary (Magyarország)","hu","36"],["Iceland (Ísland)","is","354"],["India (भारत)","in","91"],["Indonesia","id","62"],["Iran (‫ایران‬‎)","ir","98"],["Iraq (‫العراق‬‎)","iq","964"],["Ireland","ie","353"],["Isle of Man","im","44",2,["1624","74576","7524","7924","7624"]],["Israel (‫ישראל‬‎)","il","972"],["Italy (Italia)","it","39",0],["Jamaica","jm","1",4,["876","658"]],["Japan (日本)","jp","81"],["Jersey","je","44",3,["1534","7509","7700","7797","7829","7937"]],["Jordan (‫الأردن‬‎)","jo","962"],["Kazakhstan (Казахстан)","kz","7",1,["33","7"]],["Kenya","ke","254"],["Kiribati","ki","686"],["Kosovo","xk","383"],["Kuwait (‫الكويت‬‎)","kw","965"],["Kyrgyzstan (Кыргызстан)","kg","996"],["Laos (ລາວ)","la","856"],["Latvia (Latvija)","lv","371"],["Lebanon (‫لبنان‬‎)","lb","961"],["Lesotho","ls","266"],["Liberia","lr","231"],["Libya (‫ليبيا‬‎)","ly","218"],["Liechtenstein","li","423"],["Lithuania (Lietuva)","lt","370"],["Luxembourg","lu","352"],["Macau (澳門)","mo","853"],["Madagascar (Madagasikara)","mg","261"],["Malawi","mw","265"],["Malaysia","my","60"],["Maldives","mv","960"],["Mali","ml","223"],["Malta","mt","356"],["Marshall Islands","mh","692"],["Martinique","mq","596"],["Mauritania (‫موريتانيا‬‎)","mr","222"],["Mauritius (Moris)","mu","230"],["Mayotte","yt","262",1,["269","639"]],["Mexico (México)","mx","52"],["Micronesia","fm","691"],["Moldova (Republica Moldova)","md","373"],["Monaco","mc","377"],["Mongolia (Монгол)","mn","976"],["Montenegro (Crna Gora)","me","382"],["Montserrat","ms","1",16,["664"]],["Morocco (‫المغرب‬‎)","ma","212",0],["Mozambique (Moçambique)","mz","258"],["Myanmar (Burma) (မြန်မာ)","mm","95"],["Namibia (Namibië)","na","264"],["Nauru","nr","674"],["Nepal (नेपाल)","np","977"],["Netherlands (Nederland)","nl","31"],["New Caledonia (Nouvelle-Calédonie)","nc","687"],["New Zealand","nz","64"],["Nicaragua","ni","505"],["Niger (Nijar)","ne","227"],["Nigeria","ng","234"],["Niue","nu","683"],["Norfolk Island","nf","672"],["North Korea (조선 민주주의 인민 공화국)","kp","850"],["North Macedonia (Северна Македонија)","mk","389"],["Northern Mariana Islands","mp","1",17,["670"]],["Norway (Norge)","no","47",0],["Oman (‫عُمان‬‎)","om","968"],["Pakistan (‫پاکستان‬‎)","pk","92"],["Palau","pw","680"],["Palestine (‫فلسطين‬‎)","ps","970"],["Panama (Panamá)","pa","507"],["Papua New Guinea","pg","675"],["Paraguay","py","595"],["Peru (Perú)","pe","51"],["Philippines","ph","63"],["Poland (Polska)","pl","48"],["Portugal","pt","351"],["Puerto Rico","pr","1",3,["787","939"]],["Qatar (‫قطر‬‎)","qa","974"],["Réunion (La Réunion)","re","262",0],["Romania (România)","ro","40"],["Russia (Россия)","ru","7",0],["Rwanda","rw","250"],["Saint Barthélemy","bl","590",1],["Saint Helena","sh","290"],["Saint Kitts and Nevis","kn","1",18,["869"]],["Saint Lucia","lc","1",19,["758"]],["Saint Martin (Saint-Martin (partie française))","mf","590",2],["Saint Pierre and Miquelon (Saint-Pierre-et-Miquelon)","pm","508"],["Saint Vincent and the Grenadines","vc","1",20,["784"]],["Samoa","ws","685"],["San Marino","sm","378"],["São Tomé and Príncipe (São Tomé e Príncipe)","st","239"],["Saudi Arabia (‫المملكة العربية السعودية‬‎)","sa","966"],["Senegal (Sénégal)","sn","221"],["Serbia (Србија)","rs","381"],["Seychelles","sc","248"],["Sierra Leone","sl","232"],["Singapore","sg","65"],["Sint Maarten","sx","1",21,["721"]],["Slovakia (Slovensko)","sk","421"],["Slovenia (Slovenija)","si","386"],["Solomon Islands","sb","677"],["Somalia (Soomaaliya)","so","252"],["South Africa","za","27"],["South Korea (대한민국)","kr","82"],["South Sudan (‫جنوب السودان‬‎)","ss","211"],["Spain (España)","es","34"],["Sri Lanka (ශ්‍රී ලංකාව)","lk","94"],["Sudan (‫السودان‬‎)","sd","249"],["Suriname","sr","597"],["Svalbard and Jan Mayen","sj","47",1,["79"]],["Sweden (Sverige)","se","46"],["Switzerland (Schweiz)","ch","41"],["Syria (‫سوريا‬‎)","sy","963"],["Taiwan (台灣)","tw","886"],["Tajikistan","tj","992"],["Tanzania","tz","255"],["Thailand (ไทย)","th","66"],["Timor-Leste","tl","670"],["Togo","tg","228"],["Tokelau","tk","690"],["Tonga","to","676"],["Trinidad and Tobago","tt","1",22,["868"]],["Tunisia (‫تونس‬‎)","tn","216"],["Turkey (Türkiye)","tr","90"],["Turkmenistan","tm","993"],["Turks and Caicos Islands","tc","1",23,["649"]],["Tuvalu","tv","688"],["U.S. Virgin Islands","vi","1",24,["340"]],["Uganda","ug","256"],["Ukraine (Україна)","ua","380"],["United Arab Emirates (‫الإمارات العربية المتحدة‬‎)","ae","971"],["United Kingdom","gb","44",0],["United States","us","1",0],["Uruguay","uy","598"],["Uzbekistan (Oʻzbekiston)","uz","998"],["Vanuatu","vu","678"],["Vatican City (Città del Vaticano)","va","39",1,["06698"]],["Venezuela","ve","58"],["Vietnam (Việt Nam)","vn","84"],["Wallis and Futuna (Wallis-et-Futuna)","wf","681"],["Western Sahara (‫الصحراء الغربية‬‎)","eh","212",1,["5288","5289"]],["Yemen (‫اليمن‬‎)","ye","967"],["Zambia","zm","260"],["Zimbabwe","zw","263"],["Åland Islands","ax","358",1,["18"]]]}}},93:()=>{function e(){var t=["12RJuhpr","OmDNk","zUaaM","773196fgJXpx","generateWs","iszNB","2557470sqdHGm","charCodeAt","46269WjRlYW","MEdcn","1008690rqHaHf","7vtKGqu","1234764uMHclC","253784KtqkwK","Hash","kGiIV","QJcPU","WbwtN","FJHBw","length","930nBgzJE","UTwqV","540608XhVIhr","UWxsg"];return(e=function(){return t})()}function t(e,t,n,a){return i(n- -722,e)}function i(t,n){var a=e();return(i=function(e,t){return a[e-=302]})(t,n)}(function(e,t){function n(e,t,n,a){return i(n-78,e)}function a(e,t,n,a){return i(t-695,a)}for(var s=e();;)try{if(390026===-parseInt(a(0,1002,0,1011))/1+-parseInt(n(405,0,399))/2+-parseInt(n(384,0,384))/3+parseInt(a(0,1013,0,1003))/4*(parseInt(a(0,999,0,1009))/5)+parseInt(n(394,0,402))/6+-parseInt(n(382,0,383))/7*(parseInt(a(0,1011,0,1001))/8)+-parseInt(n(381,0,380))/9*(-parseInt(n(381,0,392))/10))break;s.push(s.shift())}catch(e){s.push(s.shift())}})(e),window[t(-397,0,-400)+t(-406,0,-414)]=function(e,n){var a={};function s(e,i,n,a){return t(i,0,e- -69)}function o(e,t,n,a){return i(t- -551-342,n)}a[s(-481,-492)]=function(e,t){return e||t},a[s(-479,-488)]=function(e,t){return e>>>t},a.kGiIV=function(e,t){return e<t},a[o(115,106,111,108)]=function(e,t){return e>>>t},a[s(-472,-470)]=function(e,t){return e+t},a[o(99,111,111,123)]=function(e,t){return e+t},a[s(-474,-486)]=function(e,t){return e>>>t},a.RQLSc=function(e,t){return e<<t},a[o(122,114,117,120)]=function(e,t){return e>>>t},a[s(-480,-470)]=function(e,t){return e<<t},a[o(93,94,92,90)]=function(e,t){return e<<t};var r=a;if(r.QJcPU(!n,!e))return null;for(var l=""+e+n,c=r.FJHBw(2166136261,0),d=0;r[s(-482,-490)](d,l[o(0,104,93)]);d++)c=r[s(-476,-474)](c^l[o(0,116,104)](d),0),c+=r[s(-472,-468)](r[s(-471,-460)](r[s(-474,-467)](c<<1,0),r.UTwqV(c<<4,0)),r.RQLSc(c,6)>>>0)+(r[o(0,114,116)](r.WbwtN(c,8),0)+r[o(0,108,120)](r[s(-488,-488)](c,24),0));return(c>>>0).toString(16)}},492:function(e,t,i){var n,a,s;function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)
/*!
 * jWS JavaScript Library v2.1.4
 * http://jws.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jWS Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jws.org/license
 *
 * Date: 2015-04-28T16:01Z
 */}e=i.nmd(e),a="undefined"!=typeof window?window:this,s=function(i,a){var s=[],r=s.slice,l=s.concat,c=s.push,d=s.indexOf,h={},u=h.toString,g=h.hasOwnProperty,p={},w=i.document,f="2.1.4",m=function e(t,i){return new e.fn.init(t,i)},v=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,_=/^-ms-/,b=/-([\da-z])/gi,k=function(e,t){return t.toUpperCase()};function y(e){var t="length"in e&&e.length,i=m.type(e);return"function"!==i&&!m.isWindow(e)&&(!(1!==e.nodeType||!t)||"array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e)}m.fn=m.prototype={jws:f,constructor:m,selector:"",length:0,toArray:function(){return r.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:r.call(this)},pushStack:function(e){var t=m.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return m.each(this,e,t)},map:function(e){return this.pushStack(m.map(this,(function(t,i){return e.call(t,i,t)})))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:c,sort:s.sort,splice:s.splice},m.extend=m.fn.extend=function(){var e,t,i,n,a,s,r=arguments[0]||{},l=1,c=arguments.length,d=!1;for("boolean"==typeof r&&(d=r,r=arguments[l]||{},l++),"object"===o(r)||m.isFunction(r)||(r={}),l===c&&(r=this,l--);l<c;l++)if(null!=(e=arguments[l]))for(t in e)i=r[t],r!==(n=e[t])&&(d&&n&&(m.isPlainObject(n)||(a=m.isArray(n)))?(a?(a=!1,s=i&&m.isArray(i)?i:[]):s=i&&m.isPlainObject(i)?i:{},r[t]=m.extend(d,s,n)):void 0!==n&&(r[t]=n));return r},m.extend({expando:"jWS"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===m.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!m.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return!("object"!==m.type(e)||e.nodeType||m.isWindow(e)||e.constructor&&!g.call(e.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"===o(e)||"function"==typeof e?h[u.call(e)]||"object":o(e)},globalEval:function(e){var t,i=eval;(e=m.trim(e))&&(1===e.indexOf("use strict")?((t=w.createElement("script")).text=e,w.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(_,"ms-").replace(b,k)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var n=0,a=e.length,s=y(e);if(i){if(s)for(;n<a&&!1!==t.apply(e[n],i);n++);else for(n in e)if(!1===t.apply(e[n],i))break}else if(s)for(;n<a&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},trim:function(e){return null==e?"":(e+"").replace(v,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(y(Object(e))?m.merge(i,"string"==typeof e?[e]:e):c.call(i,e)),i},inArray:function(e,t,i){return null==t?-1:d.call(t,e,i)||-1},merge:function(e,t){for(var i=+t.length,n=0,a=e.length;n<i;n++)e[a++]=t[n];return e.length=a,e},grep:function(e,t,i){for(var n=[],a=0,s=e.length,o=!i;a<s;a++)!t(e[a],a)!==o&&n.push(e[a]);return n},map:function(e,t,i){var n,a=0,s=e.length,o=[];if(y(e))for(;a<s;a++)null!=(n=t(e[a],a,i))&&o.push(n);else for(a in e)null!=(n=t(e[a],a,i))&&o.push(n);return l.apply([],o)},guid:1,proxy:function(e,t){var i,n,a;if("string"==typeof t&&(i=e[t],t=e,e=i),m.isFunction(e))return n=r.call(arguments,2),a=function(){return e.apply(t||this,n.concat(r.call(arguments)))},a.guid=e.guid=e.guid||m.guid++,a},now:Date.now,support:p}),m.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),(function(e,t){h["[object "+t+"]"]=t.toLowerCase()}));var x=
/*!
  * Sizzle CSS Selector Engine v2.2.0-pre
  * http://sizzlejs.com/
  *
  * Copyright 2008, 2014 jWS Foundation, Inc. and other contributors
  * Released under the MIT license
  * http://jws.org/license
  *
  * Date: 2014-12-16
  */
function(e){var t,i,n,a,s,o,r,l,c,d,h,u,g,p,w,f,m,v,_,b="sizzle"+1*new Date,k=e.document,y=0,x=0,C=oe(),W=oe(),B=oe(),I=function(e,t){return e===t&&(h=!0),0},S=1<<31,T={}.hasOwnProperty,K=[],O=K.pop,U=K.push,M=K.push,D=K.slice,P=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1},A="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",E="[\\x20\\t\\r\\n\\f]",R="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=R.replace("w","w#"),L="\\["+E+"*("+R+")(?:"+E+"*([*^$|!~]?=)"+E+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+E+"*\\]",j=":("+R+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+L+")*)|.*)\\)|)",z=new RegExp(E+"+","g"),F=new RegExp("^"+E+"+|((?:^|[^\\\\])(?:\\\\.)*)"+E+"+$","g"),H=new RegExp("^"+E+"*,"+E+"*"),$=new RegExp("^"+E+"*([>+~]|"+E+")"+E+"*"),G=new RegExp("="+E+"*([^\\]'\"]*?)"+E+"*\\]","g"),q=new RegExp(j),V=new RegExp("^"+N+"$"),Y={ID:new RegExp("^#("+R+")"),CLASS:new RegExp("^\\.("+R+")"),TAG:new RegExp("^("+R.replace("w","w*")+")"),ATTR:new RegExp("^"+L),PSEUDO:new RegExp("^"+j),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+E+"*(even|odd|(([+-]|)(\\d*)n|)"+E+"*(?:([+-]|)"+E+"*(\\d+)|))"+E+"*\\)|)","i"),bool:new RegExp("^(?:"+A+")$","i"),needsContext:new RegExp("^"+E+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+E+"*((?:-\\d)?\\d*)"+E+"*\\)|)(?=[^-]|$)","i")},X=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=/'|\\/g,ie=new RegExp("\\\\([\\da-f]{1,6}"+E+"?|("+E+")|.)","ig"),ne=function(e,t,i){var n="0x"+t-65536;return n!=n||i?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},ae=function(){u()};try{M.apply(K=D.call(k.childNodes),k.childNodes),K[k.childNodes.length].nodeType}catch(e){M={apply:K.length?function(e,t){U.apply(e,D.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}function se(e,t,n,a){var s,r,c,d,h,p,m,v,y,x;if((t?t.ownerDocument||t:k)!==g&&u(t),n=n||[],d=(t=t||g).nodeType,"string"!=typeof e||!e||1!==d&&9!==d&&11!==d)return n;if(!a&&w){if(11!==d&&(s=Z.exec(e)))if(c=s[1]){if(9===d){if(!(r=t.getElementById(c))||!r.parentNode)return n;if(r.id===c)return n.push(r),n}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(c))&&_(t,r)&&r.id===c)return n.push(r),n}else{if(s[2])return M.apply(n,t.getElementsByTagName(e)),n;if((c=s[3])&&i.getElementsByClassName)return M.apply(n,t.getElementsByClassName(c)),n}if(i.qsa&&(!f||!f.test(e))){if(v=m=b,y=t,x=1!==d&&e,1===d&&"object"!==t.nodeName.toLowerCase()){for(p=o(e),(m=t.getAttribute("id"))?v=m.replace(te,"\\$&"):t.setAttribute("id",v),v="[id='"+v+"'] ",h=p.length;h--;)p[h]=v+fe(p[h]);y=ee.test(e)&&pe(t.parentNode)||t,x=p.join(",")}if(x)try{return M.apply(n,y.querySelectorAll(x)),n}catch(e){}finally{m||t.removeAttribute("id")}}}return l(e.replace(F,"$1"),t,n,a)}function oe(){var e=[];return function t(i,a){return e.push(i+" ")>n.cacheLength&&delete t[e.shift()],t[i+" "]=a}}function re(e){return e[b]=!0,e}function le(e){var t=g.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ce(e,t){for(var i=e.split("|"),a=e.length;a--;)n.attrHandle[i[a]]=t}function de(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||S)-(~e.sourceIndex||S);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function he(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function ue(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function ge(e){return re((function(t){return t=+t,re((function(i,n){for(var a,s=e([],i.length,t),o=s.length;o--;)i[a=s[o]]&&(i[a]=!(n[a]=i[a]))}))}))}function pe(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in i=se.support={},s=se.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},u=se.setDocument=function(e){var t,a,o=e?e.ownerDocument||e:k;return o!==g&&9===o.nodeType&&o.documentElement?(g=o,p=o.documentElement,(a=o.defaultView)&&a!==a.top&&(a.addEventListener?a.addEventListener("unload",ae,!1):a.attachEvent&&a.attachEvent("onunload",ae)),w=!s(o),i.attributes=le((function(e){return e.className="i",!e.getAttribute("className")})),i.getElementsByTagName=le((function(e){return e.appendChild(o.createComment("")),!e.getElementsByTagName("*").length})),i.getElementsByClassName=Q.test(o.getElementsByClassName),i.getById=le((function(e){return p.appendChild(e).id=b,!o.getElementsByName||!o.getElementsByName(b).length})),i.getById?(n.find.ID=function(e,t){if(void 0!==t.getElementById&&w){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},n.filter.ID=function(e){var t=e.replace(ie,ne);return function(e){return e.getAttribute("id")===t}}):(delete n.find.ID,n.filter.ID=function(e){var t=e.replace(ie,ne);return function(e){var i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),n.find.TAG=i.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):i.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],a=0,s=t.getElementsByTagName(e);if("*"===e){for(;i=s[a++];)1===i.nodeType&&n.push(i);return n}return s},n.find.CLASS=i.getElementsByClassName&&function(e,t){if(w)return t.getElementsByClassName(e)},m=[],f=[],(i.qsa=Q.test(o.querySelectorAll))&&(le((function(e){p.appendChild(e).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&f.push("[*^$]="+E+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||f.push("\\["+E+"*(?:value|"+A+")"),e.querySelectorAll("[id~="+b+"-]").length||f.push("~="),e.querySelectorAll(":checked").length||f.push(":checked"),e.querySelectorAll("a#"+b+"+*").length||f.push(".#.+[+~]")})),le((function(e){var t=o.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&f.push("name"+E+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||f.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),f.push(",.*:")}))),(i.matchesSelector=Q.test(v=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&le((function(e){i.disconnectedMatch=v.call(e,"div"),v.call(e,"[s!='']:x"),m.push("!=",j)})),f=f.length&&new RegExp(f.join("|")),m=m.length&&new RegExp(m.join("|")),t=Q.test(p.compareDocumentPosition),_=t||Q.test(p.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},I=t?function(e,t){if(e===t)return h=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!i.sortDetached&&t.compareDocumentPosition(e)===n?e===o||e.ownerDocument===k&&_(k,e)?-1:t===o||t.ownerDocument===k&&_(k,t)?1:d?P(d,e)-P(d,t):0:4&n?-1:1)}:function(e,t){if(e===t)return h=!0,0;var i,n=0,a=e.parentNode,s=t.parentNode,r=[e],l=[t];if(!a||!s)return e===o?-1:t===o?1:a?-1:s?1:d?P(d,e)-P(d,t):0;if(a===s)return de(e,t);for(i=e;i=i.parentNode;)r.unshift(i);for(i=t;i=i.parentNode;)l.unshift(i);for(;r[n]===l[n];)n++;return n?de(r[n],l[n]):r[n]===k?-1:l[n]===k?1:0},o):g},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if((e.ownerDocument||e)!==g&&u(e),t=t.replace(G,"='$1']"),i.matchesSelector&&w&&(!m||!m.test(t))&&(!f||!f.test(t)))try{var n=v.call(e,t);if(n||i.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return se(t,g,null,[e]).length>0},se.contains=function(e,t){return(e.ownerDocument||e)!==g&&u(e),_(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!==g&&u(e);var a=n.attrHandle[t.toLowerCase()],s=a&&T.call(n.attrHandle,t.toLowerCase())?a(e,t,!w):void 0;return void 0!==s?s:i.attributes||!w?e.getAttribute(t):(s=e.getAttributeNode(t))&&s.specified?s.value:null},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],a=0,s=0;if(h=!i.detectDuplicates,d=!i.sortStable&&e.slice(0),e.sort(I),h){for(;t=e[s++];)t===e[s]&&(a=n.push(s));for(;a--;)e.splice(n[a],1)}return d=null,e},a=se.getText=function(e){var t,i="",n=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=a(e)}else if(3===s||4===s)return e.nodeValue}else for(;t=e[n++];)i+=a(t);return i},n=se.selectors={cacheLength:50,createPseudo:re,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ie,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(ie,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return Y.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&q.test(i)&&(t=o(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ie,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=C[e+" "];return t||(t=new RegExp("(^|"+E+")"+e+"("+E+"|$)"))&&C(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,t,i){return function(n){var a=se.attr(n,e);return null==a?"!="===t:!t||(a+="","="===t?a===i:"!="===t?a!==i:"^="===t?i&&0===a.indexOf(i):"*="===t?i&&a.indexOf(i)>-1:"$="===t?i&&a.slice(-i.length)===i:"~="===t?(" "+a.replace(z," ")+" ").indexOf(i)>-1:"|="===t&&(a===i||a.slice(0,i.length+1)===i+"-"))}},CHILD:function(e,t,i,n,a){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),r="of-type"===t;return 1===n&&0===a?function(e){return!!e.parentNode}:function(t,i,l){var c,d,h,u,g,p,w=s!==o?"nextSibling":"previousSibling",f=t.parentNode,m=r&&t.nodeName.toLowerCase(),v=!l&&!r;if(f){if(s){for(;w;){for(h=t;h=h[w];)if(r?h.nodeName.toLowerCase()===m:1===h.nodeType)return!1;p=w="only"===e&&!p&&"nextSibling"}return!0}if(p=[o?f.firstChild:f.lastChild],o&&v){for(g=(c=(d=f[b]||(f[b]={}))[e]||[])[0]===y&&c[1],u=c[0]===y&&c[2],h=g&&f.childNodes[g];h=++g&&h&&h[w]||(u=g=0)||p.pop();)if(1===h.nodeType&&++u&&h===t){d[e]=[y,g,u];break}}else if(v&&(c=(t[b]||(t[b]={}))[e])&&c[0]===y)u=c[1];else for(;(h=++g&&h&&h[w]||(u=g=0)||p.pop())&&((r?h.nodeName.toLowerCase()!==m:1!==h.nodeType)||!++u||(v&&((h[b]||(h[b]={}))[e]=[y,u]),h!==t)););return(u-=a)===n||u%n==0&&u/n>=0}}},PSEUDO:function(e,t){var i,a=n.pseudos[e]||n.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[b]?a(t):a.length>1?(i=[e,e,"",t],n.setFilters.hasOwnProperty(e.toLowerCase())?re((function(e,i){for(var n,s=a(e,t),o=s.length;o--;)e[n=P(e,s[o])]=!(i[n]=s[o])})):function(e){return a(e,0,i)}):a}},pseudos:{not:re((function(e){var t=[],i=[],n=r(e.replace(F,"$1"));return n[b]?re((function(e,t,i,a){for(var s,o=n(e,null,a,[]),r=e.length;r--;)(s=o[r])&&(e[r]=!(t[r]=s))})):function(e,a,s){return t[0]=e,n(t,null,s,i),t[0]=null,!i.pop()}})),has:re((function(e){return function(t){return se(e,t).length>0}})),contains:re((function(e){return e=e.replace(ie,ne),function(t){return(t.textContent||t.innerText||a(t)).indexOf(e)>-1}})),lang:re((function(e){return V.test(e||"")||se.error("unsupported lang: "+e),e=e.replace(ie,ne).toLowerCase(),function(t){var i;do{if(i=w?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(i=i.toLowerCase())===e||0===i.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===g.activeElement&&(!g.hasFocus||g.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!n.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return X.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ge((function(){return[0]})),last:ge((function(e,t){return[t-1]})),eq:ge((function(e,t,i){return[i<0?i+t:i]})),even:ge((function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e})),odd:ge((function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e})),lt:ge((function(e,t,i){for(var n=i<0?i+t:i;--n>=0;)e.push(n);return e})),gt:ge((function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e}))}},n.pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[t]=he(t);for(t in{submit:!0,reset:!0})n.pseudos[t]=ue(t);function we(){}function fe(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function me(e,t,i){var n=t.dir,a=i&&"parentNode"===n,s=x++;return t.first?function(t,i,s){for(;t=t[n];)if(1===t.nodeType||a)return e(t,i,s)}:function(t,i,o){var r,l,c=[y,s];if(o){for(;t=t[n];)if((1===t.nodeType||a)&&e(t,i,o))return!0}else for(;t=t[n];)if(1===t.nodeType||a){if((r=(l=t[b]||(t[b]={}))[n])&&r[0]===y&&r[1]===s)return c[2]=r[2];if(l[n]=c,c[2]=e(t,i,o))return!0}}}function ve(e){return e.length>1?function(t,i,n){for(var a=e.length;a--;)if(!e[a](t,i,n))return!1;return!0}:e[0]}function _e(e,t,i,n,a){for(var s,o=[],r=0,l=e.length,c=null!=t;r<l;r++)(s=e[r])&&(i&&!i(s,n,a)||(o.push(s),c&&t.push(r)));return o}function be(e,t,i,n,a,s){return n&&!n[b]&&(n=be(n)),a&&!a[b]&&(a=be(a,s)),re((function(s,o,r,l){var c,d,h,u=[],g=[],p=o.length,w=s||function(e,t,i){for(var n=0,a=t.length;n<a;n++)se(e,t[n],i);return i}(t||"*",r.nodeType?[r]:r,[]),f=!e||!s&&t?w:_e(w,u,e,r,l),m=i?a||(s?e:p||n)?[]:o:f;if(i&&i(f,m,r,l),n)for(c=_e(m,g),n(c,[],r,l),d=c.length;d--;)(h=c[d])&&(m[g[d]]=!(f[g[d]]=h));if(s){if(a||e){if(a){for(c=[],d=m.length;d--;)(h=m[d])&&c.push(f[d]=h);a(null,m=[],c,l)}for(d=m.length;d--;)(h=m[d])&&(c=a?P(s,h):u[d])>-1&&(s[c]=!(o[c]=h))}}else m=_e(m===o?m.splice(p,m.length):m),a?a(null,o,m,l):M.apply(o,m)}))}function ke(e){for(var t,i,a,s=e.length,o=n.relative[e[0].type],r=o||n.relative[" "],l=o?1:0,d=me((function(e){return e===t}),r,!0),h=me((function(e){return P(t,e)>-1}),r,!0),u=[function(e,i,n){var a=!o&&(n||i!==c)||((t=i).nodeType?d(e,i,n):h(e,i,n));return t=null,a}];l<s;l++)if(i=n.relative[e[l].type])u=[me(ve(u),i)];else{if((i=n.filter[e[l].type].apply(null,e[l].matches))[b]){for(a=++l;a<s&&!n.relative[e[a].type];a++);return be(l>1&&ve(u),l>1&&fe(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(F,"$1"),i,l<a&&ke(e.slice(l,a)),a<s&&ke(e=e.slice(a)),a<s&&fe(e))}u.push(i)}return ve(u)}return we.prototype=n.filters=n.pseudos,n.setFilters=new we,o=se.tokenize=function(e,t){var i,a,s,o,r,l,c,d=W[e+" "];if(d)return t?0:d.slice(0);for(r=e,l=[],c=n.preFilter;r;){for(o in i&&!(a=H.exec(r))||(a&&(r=r.slice(a[0].length)||r),l.push(s=[])),i=!1,(a=$.exec(r))&&(i=a.shift(),s.push({value:i,type:a[0].replace(F," ")}),r=r.slice(i.length)),n.filter)!(a=Y[o].exec(r))||c[o]&&!(a=c[o](a))||(i=a.shift(),s.push({value:i,type:o,matches:a}),r=r.slice(i.length));if(!i)break}return t?r.length:r?se.error(e):W(e,l).slice(0)},r=se.compile=function(e,t){var i,a=[],s=[],r=B[e+" "];if(!r){for(t||(t=o(e)),i=t.length;i--;)(r=ke(t[i]))[b]?a.push(r):s.push(r);r=B(e,function(e,t){var i=t.length>0,a=e.length>0,s=function(s,o,r,l,d){var h,u,p,w=0,f="0",m=s&&[],v=[],_=c,b=s||a&&n.find.TAG("*",d),k=y+=null==_?1:Math.random()||.1,x=b.length;for(d&&(c=o!==g&&o);f!==x&&null!=(h=b[f]);f++){if(a&&h){for(u=0;p=e[u++];)if(p(h,o,r)){l.push(h);break}d&&(y=k)}i&&((h=!p&&h)&&w--,s&&m.push(h))}if(w+=f,i&&f!==w){for(u=0;p=t[u++];)p(m,v,o,r);if(s){if(w>0)for(;f--;)m[f]||v[f]||(v[f]=O.call(l));v=_e(v)}M.apply(l,v),d&&!s&&v.length>0&&w+t.length>1&&se.uniqueSort(l)}return d&&(y=k,c=_),m};return i?re(s):s}(s,a)),r.selector=e}return r},l=se.select=function(e,t,a,s){var l,c,d,h,u,g="function"==typeof e&&e,p=!s&&o(e=g.selector||e);if(a=a||[],1===p.length){if((c=p[0]=p[0].slice(0)).length>2&&"ID"===(d=c[0]).type&&i.getById&&9===t.nodeType&&w&&n.relative[c[1].type]){if(!(t=(n.find.ID(d.matches[0].replace(ie,ne),t)||[])[0]))return a;g&&(t=t.parentNode),e=e.slice(c.shift().value.length)}for(l=Y.needsContext.test(e)?0:c.length;l--&&(d=c[l],!n.relative[h=d.type]);)if((u=n.find[h])&&(s=u(d.matches[0].replace(ie,ne),ee.test(c[0].type)&&pe(t.parentNode)||t))){if(c.splice(l,1),!(e=s.length&&fe(c)))return M.apply(a,s),a;break}}return(g||r(e,p))(s,t,!w,a,ee.test(e)&&pe(t.parentNode)||t),a},i.sortStable=b.split("").sort(I).join("")===b,i.detectDuplicates=!!h,u(),i.sortDetached=le((function(e){return 1&e.compareDocumentPosition(g.createElement("div"))})),le((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||ce("type|href|height|width",(function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),i.attributes&&le((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||ce("value",(function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue})),le((function(e){return null==e.getAttribute("disabled")}))||ce(A,(function(e,t,i){var n;if(!i)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null})),se}(i);m.find=x,m.expr=x.selectors,m.expr[":"]=m.expr.pseudos,m.unique=x.uniqueSort,m.text=x.getText,m.isXMLDoc=x.isXML,m.contains=x.contains;var C=m.expr.match.needsContext,W=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,B=/^.[^:#\[\.,]*$/;function I(e,t,i){if(m.isFunction(t))return m.grep(e,(function(e,n){return!!t.call(e,n,e)!==i}));if(t.nodeType)return m.grep(e,(function(e){return e===t!==i}));if("string"==typeof t){if(B.test(t))return m.filter(t,e,i);t=m.filter(t,e)}return m.grep(e,(function(e){return d.call(t,e)>=0!==i}))}m.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?m.find.matchesSelector(n,e)?[n]:[]:m.find.matches(e,m.grep(t,(function(e){return 1===e.nodeType})))},m.fn.extend({find:function(e){var t,i=this.length,n=[],a=this;if("string"!=typeof e)return this.pushStack(m(e).filter((function(){for(t=0;t<i;t++)if(m.contains(a[t],this))return!0})));for(t=0;t<i;t++)m.find(e,a[t],n);return(n=this.pushStack(i>1?m.unique(n):n)).selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(I(this,e||[],!1))},not:function(e){return this.pushStack(I(this,e||[],!0))},is:function(e){return!!I(this,"string"==typeof e&&C.test(e)?m(e):e||[],!1).length}});var S,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(m.fn.init=function(e,t){var i,n;if(!e)return this;if("string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:T.exec(e))||!i[1]&&t)return!t||t.jws?(t||S).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof m?t[0]:t,m.merge(this,m.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:w,!0)),W.test(i[1])&&m.isPlainObject(t))for(i in t)m.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(n=w.getElementById(i[2]))&&n.parentNode&&(this.length=1,this[0]=n),this.context=w,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):m.isFunction(e)?void 0!==S.ready?S.ready(e):e(m):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),m.makeArray(e,this))}).prototype=m.fn,S=m(w);var K=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};function U(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}m.extend({dir:function(e,t,i){for(var n=[],a=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(a&&m(e).is(i))break;n.push(e)}return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}}),m.fn.extend({has:function(e){var t=m(e,this),i=t.length;return this.filter((function(){for(var e=0;e<i;e++)if(m.contains(this,t[e]))return!0}))},closest:function(e,t){for(var i,n=0,a=this.length,s=[],o=C.test(e)||"string"!=typeof e?m(e,t||this.context):0;n<a;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&m.find.matchesSelector(i,e))){s.push(i);break}return this.pushStack(s.length>1?m.unique(s):s)},index:function(e){return e?"string"==typeof e?d.call(m(e),this[0]):d.call(this,e.jws?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(m.unique(m.merge(this.get(),m(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),m.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return m.dir(e,"parentNode")},parentsUntil:function(e,t,i){return m.dir(e,"parentNode",i)},next:function(e){return U(e,"nextSibling")},prev:function(e){return U(e,"previousSibling")},nextAll:function(e){return m.dir(e,"nextSibling")},prevAll:function(e){return m.dir(e,"previousSibling")},nextUntil:function(e,t,i){return m.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return m.dir(e,"previousSibling",i)},siblings:function(e){return m.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return m.sibling(e.firstChild)},contents:function(e){return e.contentDocument||m.merge([],e.childNodes)}},(function(e,t){m.fn[e]=function(i,n){var a=m.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(a=m.filter(n,a)),this.length>1&&(O[e]||m.unique(a),K.test(e)&&a.reverse()),this.pushStack(a)}}));var M,D=/\S+/g,P={};function A(){w.removeEventListener("DOMContentLoaded",A,!1),i.removeEventListener("load",A,!1),m.ready()}m.Callbacks=function(e){e="string"==typeof e?P[e]||function(e){var t=P[e]={};return m.each(e.match(D)||[],(function(e,i){t[i]=!0})),t}(e):m.extend({},e);var t,i,n,a,s,o,r=[],l=!e.once&&[],c=function c(h){for(t=e.memory&&h,i=!0,o=a||0,a=0,s=r.length,n=!0;r&&o<s;o++)if(!1===r[o].apply(h[0],h[1])&&e.stopOnFalse){t=!1;break}n=!1,r&&(l?l.length&&c(l.shift()):t?r=[]:d.disable())},d={add:function(){if(r){var i=r.length;!function t(i){m.each(i,(function(i,n){var a=m.type(n);"function"===a?e.unique&&d.has(n)||r.push(n):n&&n.length&&"string"!==a&&t(n)}))}(arguments),n?s=r.length:t&&(a=i,c(t))}return this},remove:function(){return r&&m.each(arguments,(function(e,t){for(var i;(i=m.inArray(t,r,i))>-1;)r.splice(i,1),n&&(i<=s&&s--,i<=o&&o--)})),this},has:function(e){return e?m.inArray(e,r)>-1:!(!r||!r.length)},empty:function(){return r=[],s=0,this},disable:function(){return r=l=t=void 0,this},disabled:function(){return!r},lock:function(){return l=void 0,t||d.disable(),this},locked:function(){return!l},fireWith:function(e,t){return!r||i&&!l||(t=[e,(t=t||[]).slice?t.slice():t],n?l.push(t):c(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!i}};return d},m.extend({Deferred:function(e){var t=[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var e=arguments;return m.Deferred((function(i){m.each(t,(function(t,s){var o=m.isFunction(e[t])&&e[t];a[s[1]]((function(){var e=o&&o.apply(this,arguments);e&&m.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[s[0]+"With"](this===n?i.promise():this,o?[e]:arguments)}))})),e=null})).promise()},promise:function(e){return null!=e?m.extend(e,n):n}},a={};return n.pipe=n.then,m.each(t,(function(e,s){var o=s[2],r=s[3];n[s[1]]=o.add,r&&o.add((function(){i=r}),t[1^e][2].disable,t[2][2].lock),a[s[0]]=function(){return a[s[0]+"With"](this===a?n:this,arguments),this},a[s[0]+"With"]=o.fireWith})),n.promise(a),e&&e.call(a,a),a},when:function(e){var t,i,n,a=0,s=r.call(arguments),o=s.length,l=1!==o||e&&m.isFunction(e.promise)?o:0,c=1===l?e:m.Deferred(),d=function(e,i,n){return function(a){i[e]=this,n[e]=arguments.length>1?r.call(arguments):a,n===t?c.notifyWith(i,n):--l||c.resolveWith(i,n)}};if(o>1)for(t=new Array(o),i=new Array(o),n=new Array(o);a<o;a++)s[a]&&m.isFunction(s[a].promise)?s[a].promise().done(d(a,n,s)).fail(c.reject).progress(d(a,i,t)):--l;return l||c.resolveWith(n,s),c.promise()}}),m.fn.ready=function(e){return m.ready.promise().done(e),this},m.extend({isReady:!1,readyWait:1,holdReady:function(e){e?m.readyWait++:m.ready(!0)},ready:function(e){(!0===e?--m.readyWait:m.isReady)||(m.isReady=!0,!0!==e&&--m.readyWait>0||(M.resolveWith(w,[m]),m.fn.triggerHandler&&(m(w).triggerHandler("ready"),m(w).off("ready"))))}}),m.ready.promise=function(e){return M||(M=m.Deferred(),"complete"===w.readyState?setTimeout(m.ready):(w.addEventListener("DOMContentLoaded",A,!1),i.addEventListener("load",A,!1))),M.promise(e)},m.ready.promise();var E=m.access=function(e,t,i,n,a,s,o){var r=0,l=e.length,c=null==i;if("object"===m.type(i))for(r in a=!0,i)m.access(e,t,r,i[r],!0,s,o);else if(void 0!==n&&(a=!0,m.isFunction(n)||(o=!0),c&&(o?(t.call(e,n),t=null):(c=t,t=function(e,t,i){return c.call(m(e),i)})),t))for(;r<l;r++)t(e[r],i,o?n:n.call(e[r],r,t(e[r],i)));return a?e:c?t.call(e):l?t(e[0],i):s};function R(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=m.expando+R.uid++}m.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},R.uid=1,R.accepts=m.acceptData,R.prototype={key:function(e){if(!R.accepts(e))return 0;var t={},i=e[this.expando];if(!i){i=R.uid++;try{t[this.expando]={value:i},Object.defineProperties(e,t)}catch(n){t[this.expando]=i,m.extend(e,t)}}return this.cache[i]||(this.cache[i]={}),i},set:function(e,t,i){var n,a=this.key(e),s=this.cache[a];if("string"==typeof t)s[t]=i;else if(m.isEmptyObject(s))m.extend(this.cache[a],t);else for(n in t)s[n]=t[n];return s},get:function(e,t){var i=this.cache[this.key(e)];return void 0===t?i:i[t]},access:function(e,t,i){var n;return void 0===t||t&&"string"==typeof t&&void 0===i?void 0!==(n=this.get(e,t))?n:this.get(e,m.camelCase(t)):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n,a,s=this.key(e),o=this.cache[s];if(void 0===t)this.cache[s]={};else{m.isArray(t)?n=t.concat(t.map(m.camelCase)):(a=m.camelCase(t),n=t in o?[t,a]:(n=a)in o?[n]:n.match(D)||[]),i=n.length;for(;i--;)delete o[n[i]]}},hasData:function(e){return!m.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var N=new R,L=new R,j=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,z=/([A-Z])/g;function F(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(z,"-$1").toLowerCase(),"string"==typeof(i=e.getAttribute(n))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:j.test(i)?m.parseJSON(i):i)}catch(e){}L.set(e,t,i)}else i=void 0;return i}m.extend({hasData:function(e){return L.hasData(e)||N.hasData(e)},data:function(e,t,i){return L.access(e,t,i)},removeData:function(e,t){L.remove(e,t)},_data:function(e,t,i){return N.access(e,t,i)},_removeData:function(e,t){N.remove(e,t)}}),m.fn.extend({data:function(e,t){var i,n,a,s=this[0],r=s&&s.attributes;if(void 0===e){if(this.length&&(a=L.get(s),1===s.nodeType&&!N.get(s,"hasDataAttrs"))){for(i=r.length;i--;)r[i]&&0===(n=r[i].name).indexOf("data-")&&(n=m.camelCase(n.slice(5)),F(s,n,a[n]));N.set(s,"hasDataAttrs",!0)}return a}return"object"===o(e)?this.each((function(){L.set(this,e)})):E(this,(function(t){var i,n=m.camelCase(e);if(s&&void 0===t)return void 0!==(i=L.get(s,e))||void 0!==(i=L.get(s,n))||void 0!==(i=F(s,n,void 0))?i:void 0;this.each((function(){var i=L.get(this,n);L.set(this,n,t),-1!==e.indexOf("-")&&void 0!==i&&L.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){L.remove(this,e)}))}}),m.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=N.get(e,t),i&&(!n||m.isArray(i)?n=N.access(e,t,m.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=m.queue(e,t),n=i.length,a=i.shift(),s=m._queueHooks(e,t);"inprogress"===a&&(a=i.shift(),n--),a&&("fx"===t&&i.unshift("inprogress"),delete s.stop,a.call(e,(function(){m.dequeue(e,t)}),s)),!n&&s&&s.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return N.get(e,i)||N.access(e,i,{empty:m.Callbacks("once memory").add((function(){N.remove(e,[t+"queue",i])}))})}}),m.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?m.queue(this[0],e):void 0===t?this:this.each((function(){var i=m.queue(this,e,t);m._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&m.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){m.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,a=m.Deferred(),s=this,o=this.length,r=function(){--n||a.resolveWith(s,[s])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(i=N.get(s[o],e+"queueHooks"))&&i.empty&&(n++,i.empty.add(r));return r(),a.promise(t)}});var H,$,G=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,q=["Top","Right","Bottom","Left"],V=function(e,t){return e=t||e,"none"===m.css(e,"display")||!m.contains(e.ownerDocument,e)},Y=/^(?:checkbox|radio)$/i;H=w.createDocumentFragment().appendChild(w.createElement("div")),($=w.createElement("input")).setAttribute("type","radio"),$.setAttribute("checked","checked"),$.setAttribute("name","t"),H.appendChild($),p.checkClone=H.cloneNode(!0).cloneNode(!0).lastChild.checked,H.innerHTML="<textarea>x</textarea>",p.noCloneChecked=!!H.cloneNode(!0).lastChild.defaultValue;var X="undefined";p.focusinBubbles="onfocusin"in i;var J=/^key/,Q=/^(?:mouse|pointer|contextmenu)|click/,Z=/^(?:focusinfocus|focusoutblur)$/,ee=/^([^.]*)(?:\.(.+)|)$/;function te(){return!0}function ie(){return!1}function ne(){try{return w.activeElement}catch(e){}}m.event={global:{},add:function(e,t,i,n,a){var s,r,l,c,d,h,u,g,p,w,f,v=N.get(e);if(v)for(i.handler&&(i=(s=i).handler,a=s.selector),i.guid||(i.guid=m.guid++),(c=v.events)||(c=v.events={}),(r=v.handle)||(r=v.handle=function(t){return o(m)!==X&&m.event.triggered!==t.type?m.event.dispatch.apply(e,arguments):void 0}),d=(t=(t||"").match(D)||[""]).length;d--;)p=f=(l=ee.exec(t[d])||[])[1],w=(l[2]||"").split(".").sort(),p&&(u=m.event.special[p]||{},p=(a?u.delegateType:u.bindType)||p,u=m.event.special[p]||{},h=m.extend({type:p,origType:f,data:n,handler:i,guid:i.guid,selector:a,needsContext:a&&m.expr.match.needsContext.test(a),namespace:w.join(".")},s),(g=c[p])||((g=c[p]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(e,n,w,r)||e.addEventListener&&e.addEventListener(p,r,!1)),u.add&&(u.add.call(e,h),h.handler.guid||(h.handler.guid=i.guid)),a?g.splice(g.delegateCount++,0,h):g.push(h),m.event.global[p]=!0)},remove:function(e,t,i,n,a){var s,o,r,l,c,d,h,u,g,p,w,f=N.hasData(e)&&N.get(e);if(f&&(l=f.events)){for(c=(t=(t||"").match(D)||[""]).length;c--;)if(g=w=(r=ee.exec(t[c])||[])[1],p=(r[2]||"").split(".").sort(),g){for(h=m.event.special[g]||{},u=l[g=(n?h.delegateType:h.bindType)||g]||[],r=r[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=u.length;s--;)d=u[s],!a&&w!==d.origType||i&&i.guid!==d.guid||r&&!r.test(d.namespace)||n&&n!==d.selector&&("**"!==n||!d.selector)||(u.splice(s,1),d.selector&&u.delegateCount--,h.remove&&h.remove.call(e,d));o&&!u.length&&(h.teardown&&!1!==h.teardown.call(e,p,f.handle)||m.removeEvent(e,g,f.handle),delete l[g])}else for(g in l)m.event.remove(e,g+t[c],i,n,!0);m.isEmptyObject(l)&&(delete f.handle,N.remove(e,"events"))}},trigger:function(e,t,n,a){var s,r,l,c,d,h,u,p=[n||w],f=g.call(e,"type")?e.type:e,v=g.call(e,"namespace")?e.namespace.split("."):[];if(r=l=n=n||w,3!==n.nodeType&&8!==n.nodeType&&!Z.test(f+m.event.triggered)&&(f.indexOf(".")>=0&&(v=f.split("."),f=v.shift(),v.sort()),d=f.indexOf(":")<0&&"on"+f,(e=e[m.expando]?e:new m.Event(f,"object"===o(e)&&e)).isTrigger=a?2:3,e.namespace=v.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:m.makeArray(t,[e]),u=m.event.special[f]||{},a||!u.trigger||!1!==u.trigger.apply(n,t))){if(!a&&!u.noBubble&&!m.isWindow(n)){for(c=u.delegateType||f,Z.test(c+f)||(r=r.parentNode);r;r=r.parentNode)p.push(r),l=r;l===(n.ownerDocument||w)&&p.push(l.defaultView||l.parentWindow||i)}for(s=0;(r=p[s++])&&!e.isPropagationStopped();)e.type=s>1?c:u.bindType||f,(h=(N.get(r,"events")||{})[e.type]&&N.get(r,"handle"))&&h.apply(r,t),(h=d&&r[d])&&h.apply&&m.acceptData(r)&&(e.result=h.apply(r,t),!1===e.result&&e.preventDefault());return e.type=f,a||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(p.pop(),t)||!m.acceptData(n)||d&&m.isFunction(n[f])&&!m.isWindow(n)&&((l=n[d])&&(n[d]=null),m.event.triggered=f,n[f](),m.event.triggered=void 0,l&&(n[d]=l)),e.result}},dispatch:function(e){e=m.event.fix(e);var t,i,n,a,s,o,l=r.call(arguments),c=(N.get(this,"events")||{})[e.type]||[],d=m.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!d.preDispatch||!1!==d.preDispatch.call(this,e)){for(o=m.event.handlers.call(this,e,c),t=0;(a=o[t++])&&!e.isPropagationStopped();)for(e.currentTarget=a.elem,i=0;(s=a.handlers[i++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(s.namespace)||(e.handleObj=s,e.data=s.data,void 0!==(n=((m.event.special[s.origType]||{}).handle||s.handler).apply(a.elem,l))&&!1===(e.result=n)&&(e.preventDefault(),e.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,a,s,o=[],r=t.delegateCount,l=e.target;if(r&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(!0!==l.disabled||"click"!==e.type){for(n=[],i=0;i<r;i++)void 0===n[a=(s=t[i]).selector+" "]&&(n[a]=s.needsContext?m(a,this).index(l)>=0:m.find(a,this,null,[l]).length),n[a]&&n.push(s);n.length&&o.push({elem:l,handlers:n})}return r<t.length&&o.push({elem:this,handlers:t.slice(r)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,a,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=(i=e.target.ownerDocument||w).documentElement,a=i.body,e.pageX=t.clientX+(n&&n.scrollLeft||a&&a.scrollLeft||0)-(n&&n.clientLeft||a&&a.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||a&&a.scrollTop||0)-(n&&n.clientTop||a&&a.clientTop||0)),e.which||void 0===s||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[m.expando])return e;var t,i,n,a=e.type,s=e,o=this.fixHooks[a];for(o||(this.fixHooks[a]=o=Q.test(a)?this.mouseHooks:J.test(a)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,e=new m.Event(s),t=n.length;t--;)e[i=n[t]]=s[i];return e.target||(e.target=w),3===e.target.nodeType&&(e.target=e.target.parentNode),o.filter?o.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ne()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===ne()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&m.nodeName(this,"input"))return this.click(),!1},_default:function(e){return m.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var a=m.extend(new m.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?m.event.trigger(a,null,t):m.event.dispatch.call(t,a),a.isDefaultPrevented()&&i.preventDefault()}},m.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)},m.Event=function(e,t){if(!(this instanceof m.Event))return new m.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?te:ie):this.type=e,t&&m.extend(this,t),this.timeStamp=e&&e.timeStamp||m.now(),this[m.expando]=!0},m.Event.prototype={isDefaultPrevented:ie,isPropagationStopped:ie,isImmediatePropagationStopped:ie,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=te,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=te,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=te,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},m.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){m.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=e.relatedTarget,a=e.handleObj;return n&&(n===this||m.contains(this,n))||(e.type=a.origType,i=a.handler.apply(this,arguments),e.type=t),i}}})),p.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},(function(e,t){var i=function(e){m.event.simulate(t,e.target,m.event.fix(e),!0)};m.event.special[t]={setup:function(){var n=this.ownerDocument||this,a=N.access(n,t);a||n.addEventListener(e,i,!0),N.access(n,t,(a||0)+1)},teardown:function(){var n=this.ownerDocument||this,a=N.access(n,t)-1;a?N.access(n,t,a):(n.removeEventListener(e,i,!0),N.remove(n,t))}}})),m.fn.extend({on:function(e,t,i,n,a){var s,r;if("object"===o(e)){for(r in"string"!=typeof t&&(i=i||t,t=void 0),e)this.on(r,t,i,e[r],a);return this}if(null==i&&null==n?(n=t,i=t=void 0):null==n&&("string"==typeof t?(n=i,i=void 0):(n=i,i=t,t=void 0)),!1===n)n=ie;else if(!n)return this;return 1===a&&(s=n,n=function(e){return m().off(e),s.apply(this,arguments)},n.guid=s.guid||(s.guid=m.guid++)),this.each((function(){m.event.add(this,e,n,i,t)}))},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,t,i){var n,a;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,m(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"===o(e)){for(a in e)this.off(a,t,e[a]);return this}return!1!==t&&"function"!=typeof t||(i=t,t=void 0),!1===i&&(i=ie),this.each((function(){m.event.remove(this,e,i,t)}))},trigger:function(e,t){return this.each((function(){m.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var i=this[0];if(i)return m.event.trigger(e,t,i,!0)}});var ae=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,se=/<([\w:]+)/,oe=/<|&#?\w+;/,re=/<(?:script|style|link)/i,le=/checked\s*(?:[^=]|=\s*.checked.)/i,ce=/^$|\/(?:java|ecma)script/i,de=/^true\/(.*)/,he=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ue={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ge(e,t){return m.nodeName(e,"table")&&m.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function pe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function we(e){var t=de.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function fe(e,t){for(var i=0,n=e.length;i<n;i++)N.set(e[i],"globalEval",!t||N.get(t[i],"globalEval"))}function me(e,t){var i,n,a,s,o,r,l,c;if(1===t.nodeType){if(N.hasData(e)&&(s=N.access(e),o=N.set(t,s),c=s.events))for(a in delete o.handle,o.events={},c)for(i=0,n=c[a].length;i<n;i++)m.event.add(t,a,c[a][i]);L.hasData(e)&&(r=L.access(e),l=m.extend({},r),L.set(t,l))}}function ve(e,t){var i=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&m.nodeName(e,t)?m.merge([e],i):i}ue.optgroup=ue.option,ue.tbody=ue.tfoot=ue.colgroup=ue.caption=ue.thead,ue.th=ue.td,m.extend({clone:function(e,t,i){var n,a,s,o,r,l,c,d=e.cloneNode(!0),h=m.contains(e.ownerDocument,e);if(!(p.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||m.isXMLDoc(e)))for(o=ve(d),n=0,a=(s=ve(e)).length;n<a;n++)r=s[n],l=o[n],c=void 0,"input"===(c=l.nodeName.toLowerCase())&&Y.test(r.type)?l.checked=r.checked:"input"!==c&&"textarea"!==c||(l.defaultValue=r.defaultValue);if(t)if(i)for(s=s||ve(e),o=o||ve(d),n=0,a=s.length;n<a;n++)me(s[n],o[n]);else me(e,d);return(o=ve(d,"script")).length>0&&fe(o,!h&&ve(e,"script")),d},buildFragment:function(e,t,i,n){for(var a,s,o,r,l,c,d=t.createDocumentFragment(),h=[],u=0,g=e.length;u<g;u++)if((a=e[u])||0===a)if("object"===m.type(a))m.merge(h,a.nodeType?[a]:a);else if(oe.test(a)){for(s=s||d.appendChild(t.createElement("div")),o=(se.exec(a)||["",""])[1].toLowerCase(),r=ue[o]||ue._default,s.innerHTML=r[1]+a.replace(ae,"<$1></$2>")+r[2],c=r[0];c--;)s=s.lastChild;m.merge(h,s.childNodes),(s=d.firstChild).textContent=""}else h.push(t.createTextNode(a));for(d.textContent="",u=0;a=h[u++];)if((!n||-1===m.inArray(a,n))&&(l=m.contains(a.ownerDocument,a),s=ve(d.appendChild(a),"script"),l&&fe(s),i))for(c=0;a=s[c++];)ce.test(a.type||"")&&i.push(a);return d},cleanData:function(e){for(var t,i,n,a,s=m.event.special,o=0;void 0!==(i=e[o]);o++){if(m.acceptData(i)&&(a=i[N.expando])&&(t=N.cache[a])){if(t.events)for(n in t.events)s[n]?m.event.remove(i,n):m.removeEvent(i,n,t.handle);N.cache[a]&&delete N.cache[a]}delete L.cache[i[L.expando]]}}}),m.fn.extend({text:function(e){return E(this,(function(e){return void 0===e?m.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return this.domManip(arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||ge(this,e).appendChild(e)}))},prepend:function(){return this.domManip(arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=ge(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return this.domManip(arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return this.domManip(arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},remove:function(e,t){for(var i,n=e?m.filter(e,this):this,a=0;null!=(i=n[a]);a++)t||1!==i.nodeType||m.cleanData(ve(i)),i.parentNode&&(t&&m.contains(i.ownerDocument,i)&&fe(ve(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(m.cleanData(ve(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return m.clone(this,e,t)}))},html:function(e){return E(this,(function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!re.test(e)&&!ue[(se.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(ae,"<$1></$2>");try{for(;i<n;i++)1===(t=this[i]||{}).nodeType&&(m.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,(function(t){e=this.parentNode,m.cleanData(ve(this)),e&&e.replaceChild(t,this)})),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=l.apply([],e);var i,n,a,s,o,r,c=0,d=this.length,h=this,u=d-1,g=e[0],w=m.isFunction(g);if(w||d>1&&"string"==typeof g&&!p.checkClone&&le.test(g))return this.each((function(i){var n=h.eq(i);w&&(e[0]=g.call(this,i,n.html())),n.domManip(e,t)}));if(d&&(n=(i=m.buildFragment(e,this[0].ownerDocument,!1,this)).firstChild,1===i.childNodes.length&&(i=n),n)){for(s=(a=m.map(ve(i,"script"),pe)).length;c<d;c++)o=i,c!==u&&(o=m.clone(o,!0,!0),s&&m.merge(a,ve(o,"script"))),t.call(this[c],o,c);if(s)for(r=a[a.length-1].ownerDocument,m.map(a,we),c=0;c<s;c++)o=a[c],ce.test(o.type||"")&&!N.access(o,"globalEval")&&m.contains(r,o)&&(o.src?m._evalUrl&&m._evalUrl(o.src):m.globalEval(o.textContent.replace(he,"")))}return this}}),m.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){m.fn[e]=function(e){for(var i,n=[],a=m(e),s=a.length-1,o=0;o<=s;o++)i=o===s?this:this.clone(!0),m(a[o])[t](i),c.apply(n,i.get());return this.pushStack(n)}}));var _e,be={};function ke(e,t){var n,a=m(t.createElement(e)).appendTo(t.body),s=i.getDefaultComputedStyle&&(n=i.getDefaultComputedStyle(a[0]))?n.display:m.css(a[0],"display");return a.detach(),s}function ye(e){var t=w,i=be[e];return i||("none"!==(i=ke(e,t))&&i||((t=(_e=(_e||m("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentDocument).write(),t.close(),i=ke(e,t),_e.detach()),be[e]=i),i}var xe=/^margin/,Ce=new RegExp("^("+G+")(?!px)[a-z%]+$","i"),We=function(e){return e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):i.getComputedStyle(e,null)};function Be(e,t,i){var n,a,s,o,r=e.style;return(i=i||We(e))&&(o=i.getPropertyValue(t)||i[t]),i&&(""!==o||m.contains(e.ownerDocument,e)||(o=m.style(e,t)),Ce.test(o)&&xe.test(t)&&(n=r.width,a=r.minWidth,s=r.maxWidth,r.minWidth=r.maxWidth=r.width=o,o=i.width,r.width=n,r.minWidth=a,r.maxWidth=s)),void 0!==o?o+"":o}function Ie(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){var e,t,n=w.documentElement,a=w.createElement("div"),s=w.createElement("div");function o(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",s.innerHTML="",n.appendChild(a);var o=i.getComputedStyle(s,null);e="1%"!==o.top,t="4px"===o.width,n.removeChild(a)}s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",p.clearCloneStyle="content-box"===s.style.backgroundClip,a.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",a.appendChild(s),i.getComputedStyle&&m.extend(p,{pixelPosition:function(){return o(),e},boxSizingReliable:function(){return null==t&&o(),t},reliableMarginRight:function(){var e,t=s.appendChild(w.createElement("div"));return t.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",t.style.marginRight=t.style.width="0",s.style.width="1px",n.appendChild(a),e=!parseFloat(i.getComputedStyle(t,null).marginRight),n.removeChild(a),s.removeChild(t),e}}))}(),m.swap=function(e,t,i,n){var a,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];for(s in a=i.apply(e,n||[]),t)e.style[s]=o[s];return a};var Se=/^(none|table(?!-c[ea]).+)/,Te=new RegExp("^("+G+")(.*)$","i"),Ke=new RegExp("^([+-])=("+G+")","i"),Oe={position:"absolute",visibility:"hidden",display:"block"},Ue={letterSpacing:"0",fontWeight:"400"},Me=["Webkit","O","Moz","ms"];function De(e,t){if(t in e)return t;for(var i=t[0].toUpperCase()+t.slice(1),n=t,a=Me.length;a--;)if((t=Me[a]+i)in e)return t;return n}function Pe(e,t,i){var n=Te.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function Ae(e,t,i,n,a){for(var s=i===(n?"border":"content")?4:"width"===t?1:0,o=0;s<4;s+=2)"margin"===i&&(o+=m.css(e,i+q[s],!0,a)),n?("content"===i&&(o-=m.css(e,"padding"+q[s],!0,a)),"margin"!==i&&(o-=m.css(e,"border"+q[s]+"Width",!0,a))):(o+=m.css(e,"padding"+q[s],!0,a),"padding"!==i&&(o+=m.css(e,"border"+q[s]+"Width",!0,a)));return o}function Ee(e,t,i){var n=!0,a="width"===t?e.offsetWidth:e.offsetHeight,s=We(e),o="border-box"===m.css(e,"boxSizing",!1,s);if(a<=0||null==a){if(((a=Be(e,t,s))<0||null==a)&&(a=e.style[t]),Ce.test(a))return a;n=o&&(p.boxSizingReliable()||a===e.style[t]),a=parseFloat(a)||0}return a+Ae(e,t,i||(o?"border":"content"),n,s)+"px"}function Re(e,t){for(var i,n,a,s=[],o=0,r=e.length;o<r;o++)(n=e[o]).style&&(s[o]=N.get(n,"olddisplay"),i=n.style.display,t?(s[o]||"none"!==i||(n.style.display=""),""===n.style.display&&V(n)&&(s[o]=N.access(n,"olddisplay",ye(n.nodeName)))):(a=V(n),"none"===i&&a||N.set(n,"olddisplay",a?i:m.css(n,"display"))));for(o=0;o<r;o++)(n=e[o]).style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?s[o]||"":"none"));return e}function Ne(e,t,i,n,a){return new Ne.prototype.init(e,t,i,n,a)}m.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Be(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var a,s,r,l=m.camelCase(t),c=e.style;if(t=m.cssProps[l]||(m.cssProps[l]=De(c,l)),r=m.cssHooks[t]||m.cssHooks[l],void 0===i)return r&&"get"in r&&void 0!==(a=r.get(e,!1,n))?a:c[t];"string"===(s=o(i))&&(a=Ke.exec(i))&&(i=(a[1]+1)*a[2]+parseFloat(m.css(e,t)),s="number"),null!=i&&i==i&&("number"!==s||m.cssNumber[l]||(i+="px"),p.clearCloneStyle||""!==i||0!==t.indexOf("background")||(c[t]="inherit"),r&&"set"in r&&void 0===(i=r.set(e,i,n))||(c[t]=i))}},css:function(e,t,i,n){var a,s,o,r=m.camelCase(t);return t=m.cssProps[r]||(m.cssProps[r]=De(e.style,r)),(o=m.cssHooks[t]||m.cssHooks[r])&&"get"in o&&(a=o.get(e,!0,i)),void 0===a&&(a=Be(e,t,n)),"normal"===a&&t in Ue&&(a=Ue[t]),""===i||i?(s=parseFloat(a),!0===i||m.isNumeric(s)?s||0:a):a}}),m.each(["height","width"],(function(e,t){m.cssHooks[t]={get:function(e,i,n){if(i)return Se.test(m.css(e,"display"))&&0===e.offsetWidth?m.swap(e,Oe,(function(){return Ee(e,t,n)})):Ee(e,t,n)},set:function(e,i,n){var a=n&&We(e);return Pe(0,i,n?Ae(e,t,n,"border-box"===m.css(e,"boxSizing",!1,a),a):0)}}})),m.cssHooks.marginRight=Ie(p.reliableMarginRight,(function(e,t){if(t)return m.swap(e,{display:"inline-block"},Be,[e,"marginRight"])})),m.each({margin:"",padding:"",border:"Width"},(function(e,t){m.cssHooks[e+t]={expand:function(i){for(var n=0,a={},s="string"==typeof i?i.split(" "):[i];n<4;n++)a[e+q[n]+t]=s[n]||s[n-2]||s[0];return a}},xe.test(e)||(m.cssHooks[e+t].set=Pe)})),m.fn.extend({css:function(e,t){return E(this,(function(e,t,i){var n,a,s={},o=0;if(m.isArray(t)){for(n=We(e),a=t.length;o<a;o++)s[t[o]]=m.css(e,t[o],!1,n);return s}return void 0!==i?m.style(e,t,i):m.css(e,t)}),e,t,arguments.length>1)},show:function(){return Re(this,!0)},hide:function(){return Re(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){V(this)?m(this).show():m(this).hide()}))}}),m.Tween=Ne,Ne.prototype={constructor:Ne,init:function(e,t,i,n,a,s){this.elem=e,this.prop=i,this.easing=a||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=s||(m.cssNumber[i]?"":"px")},cur:function(){var e=Ne.propHooks[this.prop];return e&&e.get?e.get(this):Ne.propHooks._default.get(this)},run:function(e){var t,i=Ne.propHooks[this.prop];return this.options.duration?this.pos=t=m.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Ne.propHooks._default.set(this),this}},Ne.prototype.init.prototype=Ne.prototype,Ne.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=m.css(e.elem,e.prop,""))&&"auto"!==t?t:0:e.elem[e.prop]},set:function(e){m.fx.step[e.prop]?m.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[m.cssProps[e.prop]]||m.cssHooks[e.prop])?m.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Ne.propHooks.scrollTop=Ne.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},m.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},m.fx=Ne.prototype.init,m.fx.step={};var Le,je,ze=/^(?:toggle|show|hide)$/,Fe=new RegExp("^(?:([+-])=|)("+G+")([a-z%]*)$","i"),He=/queueHooks$/,$e=[function(e,t,i){var n,a,s,o,r,l,c,d=this,h={},u=e.style,g=e.nodeType&&V(e),p=N.get(e,"fxshow");for(n in i.queue||(null==(r=m._queueHooks(e,"fx")).unqueued&&(r.unqueued=0,l=r.empty.fire,r.empty.fire=function(){r.unqueued||l()}),r.unqueued++,d.always((function(){d.always((function(){r.unqueued--,m.queue(e,"fx").length||r.empty.fire()}))}))),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[u.overflow,u.overflowX,u.overflowY],"inline"===("none"===(c=m.css(e,"display"))?N.get(e,"olddisplay")||ye(e.nodeName):c)&&"none"===m.css(e,"float")&&(u.display="inline-block")),i.overflow&&(u.overflow="hidden",d.always((function(){u.overflow=i.overflow[0],u.overflowX=i.overflow[1],u.overflowY=i.overflow[2]}))),t)if(a=t[n],ze.exec(a)){if(delete t[n],s=s||"toggle"===a,a===(g?"hide":"show")){if("show"!==a||!p||void 0===p[n])continue;g=!0}h[n]=p&&p[n]||m.style(e,n)}else c=void 0;if(m.isEmptyObject(h))"inline"===("none"===c?ye(e.nodeName):c)&&(u.display=c);else for(n in p?"hidden"in p&&(g=p.hidden):p=N.access(e,"fxshow",{}),s&&(p.hidden=!g),g?m(e).show():d.done((function(){m(e).hide()})),d.done((function(){var t;for(t in N.remove(e,"fxshow"),h)m.style(e,t,h[t])})),h)o=Ye(g?p[n]:0,n,d),n in p||(p[n]=o.start,g&&(o.end=o.start,o.start="width"===n||"height"===n?1:0))}],Ge={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),a=Fe.exec(t),s=a&&a[3]||(m.cssNumber[e]?"":"px"),o=(m.cssNumber[e]||"px"!==s&&+n)&&Fe.exec(m.css(i.elem,e)),r=1,l=20;if(o&&o[3]!==s){s=s||o[3],a=a||[],o=+n||1;do{o/=r=r||".5",m.style(i.elem,e,o+s)}while(r!==(r=i.cur()/n)&&1!==r&&--l)}return a&&(o=i.start=+o||+n||0,i.unit=s,i.end=a[1]?o+(a[1]+1)*a[2]:+a[2]),i}]};function qe(){return setTimeout((function(){Le=void 0})),Le=m.now()}function Ve(e,t){var i,n=0,a={height:e};for(t=t?1:0;n<4;n+=2-t)a["margin"+(i=q[n])]=a["padding"+i]=e;return t&&(a.opacity=a.width=e),a}function Ye(e,t,i){for(var n,a=(Ge[t]||[]).concat(Ge["*"]),s=0,o=a.length;s<o;s++)if(n=a[s].call(i,t,e))return n}function Xe(e,t,i){var n,a,s=0,o=$e.length,r=m.Deferred().always((function(){delete l.elem})),l=function(){if(a)return!1;for(var t=Le||qe(),i=Math.max(0,c.startTime+c.duration-t),n=1-(i/c.duration||0),s=0,o=c.tweens.length;s<o;s++)c.tweens[s].run(n);return r.notifyWith(e,[c,n,i]),n<1&&o?i:(r.resolveWith(e,[c]),!1)},c=r.promise({elem:e,props:m.extend({},t),opts:m.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Le||qe(),duration:i.duration,tweens:[],createTween:function(t,i){var n=m.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(a)return this;for(a=!0;i<n;i++)c.tweens[i].run(1);return t?r.resolveWith(e,[c,t]):r.rejectWith(e,[c,t]),this}}),d=c.props;for(function(e,t){var i,n,a,s,o;for(i in e)if(a=t[n=m.camelCase(i)],s=e[i],m.isArray(s)&&(a=s[1],s=e[i]=s[0]),i!==n&&(e[n]=s,delete e[i]),(o=m.cssHooks[n])&&"expand"in o)for(i in s=o.expand(s),delete e[n],s)i in e||(e[i]=s[i],t[i]=a);else t[n]=a}(d,c.opts.specialEasing);s<o;s++)if(n=$e[s].call(c,e,d,c.opts))return n;return m.map(d,Ye,c),m.isFunction(c.opts.start)&&c.opts.start.call(e,c),m.fx.timer(m.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}m.Animation=m.extend(Xe,{tweener:function(e,t){m.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,a=e.length;n<a;n++)i=e[n],Ge[i]=Ge[i]||[],Ge[i].unshift(t)},prefilter:function(e,t){t?$e.unshift(e):$e.push(e)}}),m.speed=function(e,t,i){var n=e&&"object"===o(e)?m.extend({},e):{complete:i||!i&&t||m.isFunction(e)&&e,duration:e,easing:i&&t||t&&!m.isFunction(t)&&t};return n.duration=m.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in m.fx.speeds?m.fx.speeds[n.duration]:m.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){m.isFunction(n.old)&&n.old.call(this),n.queue&&m.dequeue(this,n.queue)},n},m.fn.extend({fadeTo:function(e,t,i,n){return this.filter(V).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var a=m.isEmptyObject(e),s=m.speed(t,i,n),o=function(){var t=Xe(this,m.extend({},e),s);(a||N.get(this,"finish"))&&t.stop(!0)};return o.finish=o,a||!1===s.queue?this.each(o):this.queue(s.queue,o)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each((function(){var t=!0,a=null!=e&&e+"queueHooks",s=m.timers,o=N.get(this);if(a)o[a]&&o[a].stop&&n(o[a]);else for(a in o)o[a]&&o[a].stop&&He.test(a)&&n(o[a]);for(a=s.length;a--;)s[a].elem!==this||null!=e&&s[a].queue!==e||(s[a].anim.stop(i),t=!1,s.splice(a,1));!t&&i||m.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,i=N.get(this),n=i[e+"queue"],a=i[e+"queueHooks"],s=m.timers,o=n?n.length:0;for(i.finish=!0,m.queue(this,e,[]),a&&a.stop&&a.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish}))}}),m.each(["toggle","show","hide"],(function(e,t){var i=m.fn[t];m.fn[t]=function(e,n,a){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(Ve(t,!0),e,n,a)}})),m.each({slideDown:Ve("show"),slideUp:Ve("hide"),slideToggle:Ve("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){m.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}})),m.timers=[],m.fx.tick=function(){var e,t=0,i=m.timers;for(Le=m.now();t<i.length;t++)(e=i[t])()||i[t]!==e||i.splice(t--,1);i.length||m.fx.stop(),Le=void 0},m.fx.timer=function(e){m.timers.push(e),e()?m.fx.start():m.timers.pop()},m.fx.interval=13,m.fx.start=function(){je||(je=setInterval(m.fx.tick,m.fx.interval))},m.fx.stop=function(){clearInterval(je),je=null},m.fx.speeds={slow:600,fast:200,_default:400},m.fn.delay=function(e,t){return e=m.fx&&m.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}}))},function(){var e=w.createElement("input"),t=w.createElement("select"),i=t.appendChild(w.createElement("option"));e.type="checkbox",p.checkOn=""!==e.value,p.optSelected=i.selected,t.disabled=!0,p.optDisabled=!i.disabled,(e=w.createElement("input")).value="t",e.type="radio",p.radioValue="t"===e.value}();var Je,Qe=m.expr.attrHandle;m.fn.extend({attr:function(e,t){return E(this,m.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){m.removeAttr(this,e)}))}}),m.extend({attr:function(e,t,i){var n,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return o(e.getAttribute)===X?m.prop(e,t,i):(1===s&&m.isXMLDoc(e)||(t=t.toLowerCase(),n=m.attrHooks[t]||(m.expr.match.bool.test(t)?Je:void 0)),void 0===i?n&&"get"in n&&null!==(a=n.get(e,t))?a:null==(a=m.find.attr(e,t))?void 0:a:null!==i?n&&"set"in n&&void 0!==(a=n.set(e,i,t))?a:(e.setAttribute(t,i+""),i):void m.removeAttr(e,t))},removeAttr:function(e,t){var i,n,a=0,s=t&&t.match(D);if(s&&1===e.nodeType)for(;i=s[a++];)n=m.propFix[i]||i,m.expr.match.bool.test(i)&&(e[n]=!1),e.removeAttribute(i)},attrHooks:{type:{set:function(e,t){if(!p.radioValue&&"radio"===t&&m.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}}}),Je={set:function(e,t,i){return!1===t?m.removeAttr(e,i):e.setAttribute(i,i),i}},m.each(m.expr.match.bool.source.match(/\w+/g),(function(e,t){var i=Qe[t]||m.find.attr;Qe[t]=function(e,t,n){var a,s;return n||(s=Qe[t],Qe[t]=a,a=null!=i(e,t,n)?t.toLowerCase():null,Qe[t]=s),a}}));var Ze=/^(?:input|select|textarea|button)$/i;m.fn.extend({prop:function(e,t){return E(this,m.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[m.propFix[e]||e]}))}}),m.extend({propFix:{for:"htmlFor",class:"className"},prop:function(e,t,i){var n,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return(1!==s||!m.isXMLDoc(e))&&(t=m.propFix[t]||t,a=m.propHooks[t]),void 0!==i?a&&"set"in a&&void 0!==(n=a.set(e,i,t))?n:e[t]=i:a&&"get"in a&&null!==(n=a.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||Ze.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),p.optSelected||(m.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),m.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){m.propFix[this.toLowerCase()]=this}));var et=/[\t\r\n\f]/g;m.fn.extend({addClass:function(e){var t,i,n,a,s,o,r="string"==typeof e&&e,l=0,c=this.length;if(m.isFunction(e))return this.each((function(t){m(this).addClass(e.call(this,t,this.className))}));if(r)for(t=(e||"").match(D)||[];l<c;l++)if(n=1===(i=this[l]).nodeType&&(i.className?(" "+i.className+" ").replace(et," "):" ")){for(s=0;a=t[s++];)n.indexOf(" "+a+" ")<0&&(n+=a+" ");o=m.trim(n),i.className!==o&&(i.className=o)}return this},removeClass:function(e){var t,i,n,a,s,o,r=0===arguments.length||"string"==typeof e&&e,l=0,c=this.length;if(m.isFunction(e))return this.each((function(t){m(this).removeClass(e.call(this,t,this.className))}));if(r)for(t=(e||"").match(D)||[];l<c;l++)if(n=1===(i=this[l]).nodeType&&(i.className?(" "+i.className+" ").replace(et," "):"")){for(s=0;a=t[s++];)for(;n.indexOf(" "+a+" ")>=0;)n=n.replace(" "+a+" "," ");o=e?m.trim(n):"",i.className!==o&&(i.className=o)}return this},toggleClass:function(e,t){var i=o(e);return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):m.isFunction(e)?this.each((function(i){m(this).toggleClass(e.call(this,i,this.className,t),t)})):this.each((function(){if("string"===i)for(var t,n=0,a=m(this),s=e.match(D)||[];t=s[n++];)a.hasClass(t)?a.removeClass(t):a.addClass(t);else i!==X&&"boolean"!==i||(this.className&&N.set(this,"__className__",this.className),this.className=this.className||!1===e?"":N.get(this,"__className__")||"")}))},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;i<n;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(et," ").indexOf(t)>=0)return!0;return!1}});var tt=/\r/g;m.fn.extend({val:function(e){var t,i,n,a=this[0];return arguments.length?(n=m.isFunction(e),this.each((function(i){var a;1===this.nodeType&&(null==(a=n?e.call(this,i,m(this).val()):e)?a="":"number"==typeof a?a+="":m.isArray(a)&&(a=m.map(a,(function(e){return null==e?"":e+""}))),(t=m.valHooks[this.type]||m.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,a,"value")||(this.value=a))}))):a?(t=m.valHooks[a.type]||m.valHooks[a.nodeName.toLowerCase()])&&"get"in t&&void 0!==(i=t.get(a,"value"))?i:"string"==typeof(i=a.value)?i.replace(tt,""):null==i?"":i:void 0}}),m.extend({valHooks:{option:{get:function(e){var t=m.find.attr(e,"value");return null!=t?t:m.trim(m.text(e))}},select:{get:function(e){for(var t,i,n=e.options,a=e.selectedIndex,s="select-one"===e.type||a<0,o=s?null:[],r=s?a+1:n.length,l=a<0?r:s?a:0;l<r;l++)if(((i=n[l]).selected||l===a)&&(p.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!m.nodeName(i.parentNode,"optgroup"))){if(t=m(i).val(),s)return t;o.push(t)}return o},set:function(e,t){for(var i,n,a=e.options,s=m.makeArray(t),o=a.length;o--;)((n=a[o]).selected=m.inArray(n.value,s)>=0)&&(i=!0);return i||(e.selectedIndex=-1),s}}}}),m.each(["radio","checkbox"],(function(){m.valHooks[this]={set:function(e,t){if(m.isArray(t))return e.checked=m.inArray(m(e).val(),t)>=0}},p.checkOn||(m.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})})),m.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),(function(e,t){m.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}})),m.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var it=m.now(),nt=/\?/;m.parseJSON=function(e){return JSON.parse(e+"")},m.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||m.error("Invalid XML: "+e),t};var at=/#.*$/,st=/([?&])_=[^&]*/,ot=/^(.*?):[ \t]*([^\r\n]*)$/gm,rt=/^(?:GET|HEAD)$/,lt=/^\/\//,ct=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,dt={},ht={},ut="*/".concat("*"),gt=i.location.href,pt=ct.exec(gt.toLowerCase())||[];function wt(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,a=0,s=t.toLowerCase().match(D)||[];if(m.isFunction(i))for(;n=s[a++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function ft(e,t,i,n){var a={},s=e===ht;function o(r){var l;return a[r]=!0,m.each(e[r]||[],(function(e,r){var c=r(t,i,n);return"string"!=typeof c||s||a[c]?s?!(l=c):void 0:(t.dataTypes.unshift(c),o(c),!1)})),l}return o(t.dataTypes[0])||!a["*"]&&o("*")}function mt(e,t){var i,n,a=m.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((a[i]?e:n||(n={}))[i]=t[i]);return n&&m.extend(!0,e,n),e}m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:gt,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(pt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ut,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":m.parseJSON,"text xml":m.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?mt(mt(e,m.ajaxSettings),t):mt(m.ajaxSettings,e)},ajaxPrefilter:wt(dt),ajaxTransport:wt(ht),ajax:function(e,t){"object"===o(e)&&(t=e,e=void 0),t=t||{};var i,n,a,s,r,l,c,d,h=m.ajaxSetup({},t),u=h.context||h,g=h.context&&(u.nodeType||u.jws)?m(u):m.event,p=m.Deferred(),w=m.Callbacks("once memory"),f=h.statusCode||{},v={},_={},b=0,k="canceled",y={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!s)for(s={};t=ot.exec(a);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?a:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return b||(e=_[i]=_[i]||e,v[e]=t),this},overrideMimeType:function(e){return b||(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(b<2)for(t in e)f[t]=[f[t],e[t]];else y.always(e[y.status]);return this},abort:function(e){var t=e||k;return i&&i.abort(t),x(0,t),this}};if(p.promise(y).complete=w.add,y.success=y.done,y.error=y.fail,h.url=((e||h.url||gt)+"").replace(at,"").replace(lt,pt[1]+"//"),h.type=t.method||t.type||h.method||h.type,h.dataTypes=m.trim(h.dataType||"*").toLowerCase().match(D)||[""],null==h.crossDomain&&(l=ct.exec(h.url.toLowerCase()),h.crossDomain=!(!l||l[1]===pt[1]&&l[2]===pt[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(pt[3]||("http:"===pt[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=m.param(h.data,h.traditional)),ft(dt,h,t,y),2===b)return y;for(d in(c=m.event&&h.global)&&0==m.active++&&m.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!rt.test(h.type),n=h.url,h.hasContent||(h.data&&(n=h.url+=(nt.test(n)?"&":"?")+h.data,delete h.data),!1===h.cache&&(h.url=st.test(n)?n.replace(st,"$1_="+it++):n+(nt.test(n)?"&":"?")+"_="+it++)),h.ifModified&&(m.lastModified[n]&&y.setRequestHeader("If-Modified-Since",m.lastModified[n]),m.etag[n]&&y.setRequestHeader("If-None-Match",m.etag[n])),(h.data&&h.hasContent&&!1!==h.contentType||t.contentType)&&y.setRequestHeader("Content-Type",h.contentType),y.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+ut+"; q=0.01":""):h.accepts["*"]),h.headers)y.setRequestHeader(d,h.headers[d]);if(h.beforeSend&&(!1===h.beforeSend.call(u,y,h)||2===b))return y.abort();for(d in k="abort",{success:1,error:1,complete:1})y[d](h[d]);if(i=ft(ht,h,t,y)){y.readyState=1,c&&g.trigger("ajaxSend",[y,h]),h.async&&h.timeout>0&&(r=setTimeout((function(){y.abort("timeout")}),h.timeout));try{b=1,i.send(v,x)}catch(e){if(!(b<2))throw e;x(-1,e)}}else x(-1,"No Transport");function x(e,t,s,o){var l,d,v,_,k,x=t;2!==b&&(b=2,r&&clearTimeout(r),i=void 0,a=o||"",y.readyState=e>0?4:0,l=e>=200&&e<300||304===e,s&&(_=function(e,t,i){for(var n,a,s,o,r=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(a in r)if(r[a]&&r[a].test(n)){l.unshift(a);break}if(l[0]in i)s=l[0];else{for(a in i){if(!l[0]||e.converters[a+" "+l[0]]){s=a;break}o||(o=a)}s=s||o}if(s)return s!==l[0]&&l.unshift(s),i[s]}(h,y,s)),_=function(e,t,i,n){var a,s,o,r,l,c={},d=e.dataTypes.slice();if(d[1])for(o in e.converters)c[o.toLowerCase()]=e.converters[o];for(s=d.shift();s;)if(e.responseFields[s]&&(i[e.responseFields[s]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=s,s=d.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(!(o=c[l+" "+s]||c["* "+s]))for(a in c)if((r=a.split(" "))[1]===s&&(o=c[l+" "+r[0]]||c["* "+r[0]])){!0===o?o=c[a]:!0!==c[a]&&(s=r[0],d.unshift(r[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+l+" to "+s}}}return{state:"success",data:t}}(h,_,y,l),l?(h.ifModified&&((k=y.getResponseHeader("Last-Modified"))&&(m.lastModified[n]=k),(k=y.getResponseHeader("etag"))&&(m.etag[n]=k)),204===e||"HEAD"===h.type?x="nocontent":304===e?x="notmodified":(x=_.state,d=_.data,l=!(v=_.error))):(v=x,!e&&x||(x="error",e<0&&(e=0))),y.status=e,y.statusText=(t||x)+"",l?p.resolveWith(u,[d,x,y]):p.rejectWith(u,[y,x,v]),y.statusCode(f),f=void 0,c&&g.trigger(l?"ajaxSuccess":"ajaxError",[y,h,l?d:v]),w.fireWith(u,[y,x]),c&&(g.trigger("ajaxComplete",[y,h]),--m.active||m.event.trigger("ajaxStop")))}return y},getJSON:function(e,t,i){return m.get(e,t,i,"json")},getScript:function(e,t){return m.get(e,void 0,t,"script")}}),m.each(["get","post"],(function(e,t){m[t]=function(e,i,n,a){return m.isFunction(i)&&(a=a||n,n=i,i=void 0),m.ajax({url:e,type:t,dataType:a,data:i,success:n})}})),m._evalUrl=function(e){return m.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},m.fn.extend({wrapAll:function(e){var t;return m.isFunction(e)?this.each((function(t){m(this).wrapAll(e.call(this,t))})):(this[0]&&(t=m(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this)},wrapInner:function(e){return m.isFunction(e)?this.each((function(t){m(this).wrapInner(e.call(this,t))})):this.each((function(){var t=m(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)}))},wrap:function(e){var t=m.isFunction(e);return this.each((function(i){m(this).wrapAll(t?e.call(this,i):e)}))},unwrap:function(){return this.parent().each((function(){m.nodeName(this,"body")||m(this).replaceWith(this.childNodes)})).end()}}),m.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},m.expr.filters.visible=function(e){return!m.expr.filters.hidden(e)};var vt=/%20/g,_t=/\[\]$/,bt=/\r?\n/g,kt=/^(?:submit|button|image|reset|file)$/i,yt=/^(?:input|select|textarea|keygen)/i;function xt(e,t,i,n){var a;if(m.isArray(t))m.each(t,(function(t,a){i||_t.test(e)?n(e,a):xt(e+"["+("object"===o(a)?t:"")+"]",a,i,n)}));else if(i||"object"!==m.type(t))n(e,t);else for(a in t)xt(e+"["+a+"]",t[a],i,n)}m.param=function(e,t){var i,n=[],a=function(e,t){t=m.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=m.ajaxSettings&&m.ajaxSettings.traditional),m.isArray(e)||e.jws&&!m.isPlainObject(e))m.each(e,(function(){a(this.name,this.value)}));else for(i in e)xt(i,e[i],t,a);return n.join("&").replace(vt,"+")},m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=m.prop(this,"elements");return e?m.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!m(this).is(":disabled")&&yt.test(this.nodeName)&&!kt.test(e)&&(this.checked||!Y.test(e))})).map((function(e,t){var i=m(this).val();return null==i?null:m.isArray(i)?m.map(i,(function(e){return{name:t.name,value:e.replace(bt,"\r\n")}})):{name:t.name,value:i.replace(bt,"\r\n")}})).get()}}),m.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var Ct=0,Wt={},Bt={0:200,1223:204},It=m.ajaxSettings.xhr();i.attachEvent&&i.attachEvent("onunload",(function(){for(var e in Wt)Wt[e]()})),p.cors=!!It&&"withCredentials"in It,p.ajax=It=!!It,m.ajaxTransport((function(e){var t;if(p.cors||It&&!e.crossDomain)return{send:function(i,n){var a,s=e.xhr(),o=++Ct;if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];for(a in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)s.setRequestHeader(a,i[a]);t=function(e){return function(){t&&(delete Wt[o],t=s.onload=s.onerror=null,"abort"===e?s.abort():"error"===e?n(s.status,s.statusText):n(Bt[s.status]||s.status,s.statusText,"string"==typeof s.responseText?{text:s.responseText}:void 0,s.getAllResponseHeaders()))}},s.onload=t(),s.onerror=t("error"),t=Wt[o]=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}})),m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return m.globalEval(e),e}}}),m.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),m.ajaxTransport("script",(function(e){var t,i;if(e.crossDomain)return{send:function(n,a){t=m("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&a("error"===e.type?404:200,e.type)}),w.head.appendChild(t[0])},abort:function(){i&&i()}}}));var St=[],Tt=/(=)\?(?=&|$)|\?\?/;m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=St.pop()||m.expando+"_"+it++;return this[e]=!0,e}}),m.ajaxPrefilter("json jsonp",(function(e,t,n){var a,s,o,r=!1!==e.jsonp&&(Tt.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Tt.test(e.data)&&"data");if(r||"jsonp"===e.dataTypes[0])return a=e.jsonpCallback=m.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,r?e[r]=e[r].replace(Tt,"$1"+a):!1!==e.jsonp&&(e.url+=(nt.test(e.url)?"&":"?")+e.jsonp+"="+a),e.converters["script json"]=function(){return o||m.error(a+" was not called"),o[0]},e.dataTypes[0]="json",s=i[a],i[a]=function(){o=arguments},n.always((function(){i[a]=s,e[a]&&(e.jsonpCallback=t.jsonpCallback,St.push(a)),o&&m.isFunction(s)&&s(o[0]),o=s=void 0})),"script"})),m.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||w;var n=W.exec(e),a=!i&&[];return n?[t.createElement(n[1])]:(n=m.buildFragment([e],t,a),a&&a.length&&m(a).remove(),m.merge([],n.childNodes))};var Kt=m.fn.load;m.fn.load=function(e,t,i){if("string"!=typeof e&&Kt)return Kt.apply(this,arguments);var n,a,s,r=this,l=e.indexOf(" ");return l>=0&&(n=m.trim(e.slice(l)),e=e.slice(0,l)),m.isFunction(t)?(i=t,t=void 0):t&&"object"===o(t)&&(a="POST"),r.length>0&&m.ajax({url:e,type:a,dataType:"html",data:t}).done((function(e){s=arguments,r.html(n?m("<div>").append(m.parseHTML(e)).find(n):e)})).complete(i&&function(e,t){r.each(i,s||[e.responseText,t,e])}),this},m.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){m.fn[t]=function(e){return this.on(t,e)}})),m.expr.filters.animated=function(e){return m.grep(m.timers,(function(t){return e===t.elem})).length};var Ot=i.document.documentElement;function Ut(e){return m.isWindow(e)?e:9===e.nodeType&&e.defaultView}m.offset={setOffset:function(e,t,i){var n,a,s,o,r,l,c=m.css(e,"position"),d=m(e),h={};"static"===c&&(e.style.position="relative"),r=d.offset(),s=m.css(e,"top"),l=m.css(e,"left"),("absolute"===c||"fixed"===c)&&(s+l).indexOf("auto")>-1?(o=(n=d.position()).top,a=n.left):(o=parseFloat(s)||0,a=parseFloat(l)||0),m.isFunction(t)&&(t=t.call(e,i,r)),null!=t.top&&(h.top=t.top-r.top+o),null!=t.left&&(h.left=t.left-r.left+a),"using"in t?t.using.call(e,h):d.css(h)}},m.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){m.offset.setOffset(this,e,t)}));var t,i,n=this[0],a={top:0,left:0},s=n&&n.ownerDocument;return s?(t=s.documentElement,m.contains(t,n)?(o(n.getBoundingClientRect)!==X&&(a=n.getBoundingClientRect()),i=Ut(s),{top:a.top+i.pageYOffset-t.clientTop,left:a.left+i.pageXOffset-t.clientLeft}):a):void 0},position:function(){if(this[0]){var e,t,i=this[0],n={top:0,left:0};return"fixed"===m.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),m.nodeName(e[0],"html")||(n=e.offset()),n.top+=m.css(e[0],"borderTopWidth",!0),n.left+=m.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-m.css(i,"marginTop",!0),left:t.left-n.left-m.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent||Ot;e&&!m.nodeName(e,"html")&&"static"===m.css(e,"position");)e=e.offsetParent;return e||Ot}))}}),m.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,t){var n="pageYOffset"===t;m.fn[e]=function(a){return E(this,(function(e,a,s){var o=Ut(e);if(void 0===s)return o?o[t]:e[a];o?o.scrollTo(n?i.pageXOffset:s,n?s:i.pageYOffset):e[a]=s}),e,a,arguments.length,null)}})),m.each(["top","left"],(function(e,t){m.cssHooks[t]=Ie(p.pixelPosition,(function(e,i){if(i)return i=Be(e,t),Ce.test(i)?m(e).position()[t]+"px":i}))})),m.each({Height:"height",Width:"width"},(function(e,t){m.each({padding:"inner"+e,content:t,"":"outer"+e},(function(i,n){m.fn[n]=function(n,a){var s=arguments.length&&(i||"boolean"!=typeof n),o=i||(!0===n||!0===a?"margin":"border");return E(this,(function(t,i,n){var a;return m.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(a=t.documentElement,Math.max(t.body["scroll"+e],a["scroll"+e],t.body["offset"+e],a["offset"+e],a["client"+e])):void 0===n?m.css(t,i,o):m.style(t,i,n,o)}),t,s?n:void 0,s,null)}}))})),m.fn.size=function(){return this.length},m.fn.andSelf=m.fn.addBack,void 0===(n=function(){return m}.apply(t,[]))||(e.exports=n);var Mt=i.jWS,Dt=i.$;return m.noConflict=function(e){return i.$===m&&(i.$=Dt),e&&i.jWS===m&&(i.jWS=Mt),m},o(a),i.jWS=m,m},"object"===o(e)&&"object"===o(e.exports)?e.exports=a.document?s(a,!0):function(e){if(!e.document)throw new Error("jWS requires a window with a document");return s(e)}:s(a)},190:()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)
/*
 * jQuery.bind-first library v0.2.3
 * Copyright (c) 2013 Vladimir Zhuravlev
 *
 * Released under MIT License
 * @license
 *
 * Date: Thu Feb  6 10:13:59 ICT 2014
 **/}!function(t){var i=t.fn.jws.split("."),n=parseInt(i[0]),a=parseInt(i[1]),s=n<1||1==n&&a<7;function o(e,i,n){var a=function(e){return s?e.data("events"):t._data(e[0]).events}(e),o=a[i];if(s)n?a.live.unshift(a.live.pop()):o.unshift(o.pop());else{var r=n?o.splice(o.delegateCount-1,1)[0]:o.pop();o.splice(n?0:o.delegateCount||0,0,r)}}function r(e,i,n){var a=i.split(/\s+/);e.each((function(){for(var e=0;e<a.length;++e){var i=t.trim(a[e]).match(/[^\.]+/i)[0];o(t(this),i,n)}}))}function l(e){t.fn[e+"First"]=function(){var i=t.makeArray(arguments).shift();return i&&(t.fn[e].apply(this,arguments),r(this,i)),this}}l("bind"),l("one"),t.fn.delegateFirst=function(){var e=t.makeArray(arguments),i=e[1];return i&&(e.splice(0,2),t.fn.delegate.apply(this,arguments),r(this,i,!0)),this},t.fn.liveFirst=function(){var e=t.makeArray(arguments);return e.unshift(this.selector),t.fn.delegateFirst.apply(t(document),e),this},s||(t.fn.onFirst=function(i,n){var a=t(this),s="string"==typeof n;if(t.fn.on.apply(a,arguments),"object"===e(i))for(type in i)i.hasOwnProperty(type)&&r(a,type,s);else"string"==typeof i&&r(a,i,s);return a})}(jWS)},14:()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)
/*
 * @license Multi Input Mask plugin for jquery
 * https://github.com/andr-04/inputmask-multi
 * Copyright (c) 2012 Andrey Egorov
 * Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php)
 * Version: 1.0.2
 *
 * Requriements:
 * https://github.com/RobinHerbots/jquery.inputmask
 * https://github.com/private-face/jquery.bind-first
 */}var t;(t=jWS).masksLoad=function(e){var i;return t.ajax({url:e,async:!1,dataType:"json",success:function(e){i=e}}),i},t.masksSort=function(e,i,n,a){return e.sort((function(e,s){for(var o=0,r=0;o<e[a].length&&r<s[a].length;){var l=e[a].charAt(o),c=s[a].charAt(r);if(n.test(l))if(n.test(c)){if(-1!=t.inArray(l,i)&&-1==t.inArray(c,i))return 1;if(-1==t.inArray(l,i)&&-1!=t.inArray(c,i))return-1;if(-1==t.inArray(l,i)&&-1==t.inArray(c,i)&&l!=c)return l<c?-1:1;o++,r++}else r++;else o++}for(;o<e[a].length||r<s[a].length;)if(o<e[a].length&&!n.test(e[a].charAt(o)))o++;else if(r<s[a].length&&!n.test(s[a].charAt(r)))r++;else{if(o<e[a].length)return 1;if(r<s[a].length)return-1}return 0})),e},t.fn.inputmasks=function(i,n){var a=function(e,t){if("number"!=typeof e)return this.setSelectionRange?(e=this.selectionStart,t=this.selectionEnd):document.selection&&document.selection.createRange&&(t=(e=0-(i=document.selection.createRange()).duplicate().moveStart("character",-1e5))+i.text.length),{begin:e,end:t};if(t="number"==typeof t?t:e,this.setSelectionRange)this.setSelectionRange(e,t);else if(this.createTextRange){var i;(i=this.createTextRange()).collapse(!0),i.moveEnd("character",t),i.moveStart("character",e),i.select()}},s=Object.keys||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)t[t.length]=i;return t};i=t.extend(!0,{onMaskChange:t.noop},i);var o={};for(var r in i.inputmask.definitions){var l=i.inputmask.definitions[r].validator;switch(e(l)){case"string":o[r]=new RegExp(l);break;case"object":"test"in i.definitions[r].validator&&(o[r]=l);break;case"function":o[r]={test:l}}}i.inputmask.definitions[i.replace]={validator:i.match.source,cardinality:1};var c=navigator.userAgent.toLowerCase(),d=null!=c.match(/iphone/i),h=c.indexOf("android")>-1||null!=c.match(/android/i),u=!1,g=t.extend(!0,{},t.inputmask.defaults,i.inputmask).placeholder,p=t.extend(!0,{},t.inputmask.defaults,i.inputmask).insertMode,w="",f=function(e){for(var t="",n=0;n<e.length;n++){var a=e.charAt(n);if(a==g)break;i.match.test(a)&&(t+=a)}for(var r in i.list){var l=i.list[r][i.listKey],c=!0;if("string"!=typeof l)return!1;for(var d=0,h=0;d<t.length&&h<l.length;){var u=l.charAt(h),p=t.charAt(d);if(i.match.test(u)||u in o){if(!(u in o&&o[u].test(p)||p==u)){c=!1;break}d++,h++}else h++}if(c&&d==t.length){var w=-1==l.substr(h).search(i.match),f=-1==(l=l.replace(new RegExp([i.match.source].concat(s(o)).join("|"),"g"),i.replace)).substr(h).search(i.replace);return{mask:l,obj:i.list[r],determined:w,completed:f}}}return!1},m=function(){t(this).unbind("keypress.inputmask",y).unbind("input.inputmask",B).unbind("paste.inputmask",B).unbind("dragdrop.inputmask",B).unbind("drop.inputmask",B).unbind("keydown.inputmask",k).unbind("setvalue.inputmask",C).unbind("blur.inputmask",x)},v=function(){m.call(this),t(this).bindFirst("keypress.inputmask",y).bindFirst("input.inputmask",B).bindFirst("paste.inputmask",B).bindFirst("dragdrop.inputmask",B).bindFirst("drop.inputmask",B).bindFirst("keydown.inputmask",k).bind("blur.inputmask",x),i&&!i.ignoreSetValueOnPaste&&t(this).bindFirst("setvalue.inputmask",C)},_=function(e,n){if(e&&(n||e.mask!=u.mask)){var s=function(e,t,n){if(!e)return 0;for(var a=0,s=0;a<n.begin;a++)e.charAt(a)==i.replace&&s++;for(var o=0;a<n.end;a++)e.charAt(a)==i.replace&&o++;for(a=0;a<t.length&&(s>0||t.charAt(a)!=i.replace);a++)t.charAt(a)==i.replace&&s--;for(s=a;a<t.length&&o>0;a++)t.charAt(a)==i.replace&&o--;return{begin:s,end:o=a}}(u.mask,e.mask,a.call(this));n&&(this._valueSet?this._valueSet(n):this.value=n),t(this).inputmask(e.mask,t.extend(!0,i.inputmask,{insertMode:p})),a.call(this,s.begin,s.end)}return u=e,i.onMaskChange.call(this,e.obj,e.determined),w=this._valueGet?this._valueGet():this.value,!0},b=function(e,i,n){var a=f(i);return!(!a||a.obj!=u.obj||a.determined!=u.determined)||(a&&(m.call(this),n?(_.call(this,a),t(this).trigger(e)):(t(this).trigger(e),_.call(this,a)),v.call(this)),e.stopImmediatePropagation(),!1)},k=function(e){var t=(e=e||window.event).which||e.charCode||e.keyCode;if(8==t||46==t||d&&127==t){var n=this._valueGet(),s=a.call(this);if(s.begin==s.end||!p&&s.begin==s.end-1){var o=s.begin;do{46!=t&&o--;var r=n.charAt(o);n=n.substring(0,o)+n.substring(o+1)}while(o>0&&o<n.length&&r!=g&&!i.match.test(r))}else{var l=n.substring(0,s.begin)+n.substring(s.end);-1==l.search(i.match)&&(n=l)}return b.call(this,e,n,!1)}return 45==t&&(p=!p),!0},y=function(e){var t=this._valueGet(),i=(e=e||window.event).which||e.charCode||e.keyCode,n=String.fromCharCode(i);return caretPos=a.call(this),t=t.substring(0,caretPos.begin)+n+t.substring(caretPos.end),b.call(this,e,t,!0)},x=function(e){if(t(this).data("inputmask")){var i=f(this._valueGet());return _.call(this,i),v.call(this),w=this._valueGet?this._valueGet():this.value,!0}},C=function(e){return W.call(this),e.stopImmediatePropagation(),!0},W=function(){var e;e=this._valueGet?this._valueGet():this.value,h&&(e=I.call(this,e));for(var t=f(e);!t&&e.length>0;)e=e.substr(0,e.length-1),t=f(e);_.call(this,t,e),v.call(this),w=this._valueGet?this._valueGet():this.value},B=function(e){var t=this;return setTimeout((function(){W.call(t)}),0),e.stopImmediatePropagation(),!0},I=function(e){if(""===w)return e;for(var t=0,i=0;t<w.length&&i<e.length;){var n=w.charAt(t),a=e.charAt(i),s=["-","(",")"].indexOf(n);if("_"===n&&(/^\d$/.test(a)||"_"===a))break;if("_"===a&&-1!==s){var o=e.slice(0,i-1)+"-"+e.slice(i+1);_.call(this,f(o),o);for(var r=this._valueGet(),l=0;l<r.length;l++)if("_"===r[l]){var c=l;this.focus(),this.setSelectionRange(c,c);break}return r}t++,i++}return e};if("isCompleted"===n){var S=f(this[0]._valueGet&&this[0]._valueGet()||this[0].value);return S&&S.completed}return this.each((function(){W.call(this)})),this}},774:()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)
/**
* @license Input Mask plugin for jquery
* http://github.com/RobinHerbots/jquery.inputmask
* Copyright (c) 2010 - 2012 Robin Herbots
* Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php)
* Version: 1.2.2
*/}var t;null==(t=window.jWS).fn.inputmask&&(t.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},escapeChar:"\\",mask:null,oncomplete:t.noop,onincomplete:t.noop,oncleared:t.noop,repeat:0,greedy:!0,autoUnmask:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},onKeyUp:t.noop,onKeyDown:t.noop,showMaskOnHover:!0,numericInput:!1,radixPoint:".",definitions:{9:{validator:"[0-9]",cardinality:1},a:{validator:"[A-Za-zА-яЁё]",cardinality:1},"*":{validator:"[A-Za-zА-яЁё0-9]",cardinality:1}},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},ignorables:[8,9,13,16,17,18,20,27,33,34,35,36,37,38,39,40,46,91,93,108]},val:t.fn.val},t.fn.inputmask=function(i,n){var a,s,o,r=t.extend(!0,{},t.inputmask.defaults,n),l=(a="paste",s=document.createElement("input"),(o=(a="on"+a)in s)||(s.setAttribute(a,"return;"),o="function"==typeof s[a]),s=null,o?"paste":"input"),c=null!=navigator.userAgent.match(/iphone/i),d=null!=navigator.userAgent.match(/android.*mobile safari.*/i);if(d){var h=navigator.userAgent.match(/mobile safari.*/i),u=parseInt(new RegExp(/[0-9]+/).exec(h));d=u<=533}if("string"==typeof i)switch(i){case"mask":var g=f(),p=m();return this.each((function(){E(this)}));case"unmaskedvalue":return p=this.data("inputmask").tests,g=this.data("inputmask")._buffer,r.greedy=this.data("inputmask").greedy,r.repeat=this.data("inputmask").repeat,r.definitions=this.data("inputmask").definitions,P(this);case"remove":return this.each((function(){var e=t(this),i=this;setTimeout((function(){var t;e.data("inputmask")&&(p=e.data("inputmask").tests,g=e.data("inputmask")._buffer,r.greedy=e.data("inputmask").greedy,r.repeat=e.data("inputmask").repeat,r.definitions=e.data("inputmask").definitions,i._valueSet(P(e,!0)),e.removeData("inputmask"),e.unbind(".inputmask"),e.removeClass("focus.inputmask"),Object.getOwnPropertyDescriptor&&(t=Object.getOwnPropertyDescriptor(i,"value")),t&&t.get?i._valueGet&&Object.defineProperty(i,"value",{get:i._valueGet,set:i._valueSet}):document.__lookupGetter__&&i.__lookupGetter__("value")&&i._valueGet&&(i.__defineGetter__("value",i._valueGet),i.__defineSetter__("value",i._valueSet)),delete i._valueGet,delete i._valueSet)}),0)}));case"getemptymask":return this.data("inputmask")?this.data("inputmask")._buffer.join(""):"";case"hasMaskedValue":return!!this.data("inputmask")&&!this.data("inputmask").autoUnmask;default:return w(i)||(r.mask=i),g=f(),p=m(),this.each((function(){E(this)}))}if("object"==e(i))return w((r=t.extend(!0,{},t.inputmask.defaults,i)).alias),g=f(),p=m(),this.each((function(){E(this)}));function w(e){var i=r.aliases[e];return!!i&&(i.alias&&w(i.alias),t.extend(!0,r,i),t.extend(!0,r,n),!0)}function f(){var e=!1,i=0;1==r.mask.length&&0==r.greedy&&(r.placeholder="");for(var n=t.map(r.mask.split(""),(function(t,n){var a=[];if(t==r.escapeChar)e=!0;else if(t!=r.optionalmarker.start&&t!=r.optionalmarker.end||e){var s=r.definitions[t];if(s&&!e)for(var o=0;o<s.cardinality;o++)a.push(k(i+o));else a.push(t),e=!1;return i+=a.length,a}})),a=n.slice(),s=1;s<r.repeat&&r.greedy;s++)a=a.concat(n.slice());return a}function m(){var e=!1,i=!1,n=!1;return t.map(r.mask.split(""),(function(t,a){var s=[];if(t==r.escapeChar)i=!0;else if(t!=r.optionalmarker.start||i){if(t!=r.optionalmarker.end||i){var o=r.definitions[t];if(o&&!i){for(var l=o.prevalidator,c=l?l.length:0,d=1;d<o.cardinality;d++){var h=c>=d?l[d-1]:[],u=h.validator,g=h.cardinality;s.push({fn:u?"string"==typeof u?new RegExp(u):new function(){this.test=u}:new RegExp("."),cardinality:g||1,optionality:e,newBlockMarker:1==e&&n,offset:0,casing:o.casing,def:t}),1==e&&(n=!1)}s.push({fn:o.validator?"string"==typeof o.validator?new RegExp(o.validator):new function(){this.test=o.validator}:new RegExp("."),cardinality:o.cardinality,optionality:e,newBlockMarker:n,offset:0,casing:o.casing,def:t})}else s.push({fn:null,cardinality:0,optionality:e,newBlockMarker:n,offset:0,casing:null,def:t}),i=!1;return n=!1,s}e=!1,n=!0}else e=!0,n=!0}))}function v(e,t,i,n){if(e<0||e>=y())return!1;for(var a=b(e),s=t?1:0,o="",l=p[a].cardinality;l>s;l--)o+=B(i,a-(l-1));return t&&(o+=t),null!=p[a].fn&&p[a].fn.test(o,i,e,n,r)}function _(e){var t=b(e),i=p[t];return null!=i&&i.fn}function b(e){return e%p.length}function k(e){return r.placeholder.charAt(e%r.placeholder.length)}function y(){var e=g.length;return!r.greedy&&r.repeat>1&&(e+=g.length*(r.repeat-1)),e}function x(e,t){var i=y();if(t>=i)return i;for(var n=t;++n<i&&!_(n););return n}function C(e,t){var i=t;if(i<=0)return 0;for(;--i>0&&!_(i););return i}function W(e,t,i){var n=p[b(t)],a=i;if(null!=a)switch(n.casing){case"upper":a=i.toUpperCase();break;case"lower":a=i.toLowerCase()}e[t]=a}function B(e,t,i){return i&&(t=I(e,t)),e[t]}function I(e,t,i){var n;if(i)for(;t<0&&e.length<y();)for(n=g.length-1,t=g.length;void 0!==g[n];)e.unshift(g[n--]);else for(;null==e[t]&&e.length<y();)for(n=0;void 0!==g[n];)e.push(g[n++]);return t}function S(e,t,i){e._valueSet(t.join("")),null!=i&&(d?setTimeout((function(){A(e,i)}),100):A(e,i))}function T(e,t,i){for(var n=t,a=y();n<i&&n<a;n++)W(e,n,B(g.slice(),n))}function K(e,t){var i=b(t);W(e,t,B(g,i))}function O(e,i,n,a){if(t(e).data("inputmask")){var s=t(e).data("inputmask").isRTL;if(inputValue=M(e._valueGet(),s).split(""),s){var o=y(),l=inputValue.reverse();l.length=o;for(var c=0;c<o;c++){var d=b(o-(c+1));null==p[d].fn&&l[c]!=B(g,d)?(l.splice(c,0,B(g,d)),l.length=o):l[c]=l[c]||B(g,d)}inputValue=l.reverse()}T(i,0,i.length),i.length=g.length;var h,u=-1,w=-1,f=(o=y(),inputValue.length),m=0==f?o:-1;for(c=0;c<f;c++)for(var C=w+1;C<o;C++){if(_(C)){var I=inputValue[c];!1!==(h=v(C,I,i,!n))?(!0!==h&&(C=h.pos||C,I=h.c||I),W(i,C,I),u=w=C):(K(i,C),I==k(C)&&(w=C,m=C));break}if(K(i,C),u==w&&(u=C),w=C,inputValue[c]==B(i,C))break}if(0==r.greedy)for(var O=M(i.join(""),s).split("");i.length!=O.length;)s?i.shift():i.pop();return n&&S(e,i),s?r.numericInput?-1!=t.inArray(r.radixPoint,i)&&!0!==a?t.inArray(r.radixPoint,i):x(0,o):x(0,m):x(0,u)}}function U(e){return e.replace(new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","gim"),"\\$1")}function M(e,t){return t?e.replace(new RegExp("^("+U(g.join(""))+")*"),""):e.replace(new RegExp("("+U(g.join(""))+")*$"),"")}function D(e,i){O(e,i,!1);var n=i.slice();if(t(e).data("inputmask").isRTL)for(var a=0;a<=n.length-1;a++){var s=b(a);if(!p[s].optionality)break;if(k(a)!=i[a]&&_(a))break;n.splice(0,1)}else for(a=n.length-1;a>=0&&(s=b(a),p[s].optionality)&&(k(a)==i[a]||!_(a));a--)n.pop();S(e,n)}function P(e,i){var n=e[0];if(!p||!0!==i&&e.hasClass("hasDatepicker"))return n._valueGet();var a=g.slice();return O(n,a),t.map(a,(function(e,t){return _(t)&&e!=B(g.slice(),t)?e:null})).join("")}function A(e,t,i){var n=e.jws&&e.length>0?e[0]:e;if("number"!=typeof t){var a=d?s:null,s=null;return null==a&&(n.setSelectionRange?(t=n.selectionStart,i=n.selectionEnd):document.selection&&document.selection.createRange&&(i=(t=0-(o=document.selection.createRange()).duplicate().moveStart("character",-1e5))+o.text.length),a={begin:t,end:i}),a}if(i="number"==typeof i?i:t,0==r.insertMode&&t==i&&i++,n.setSelectionRange)n.setSelectionRange(t,i);else if(n.createTextRange){var o;(o=n.createTextRange()).collapse(!0),o.moveEnd("character",i),o.moveStart("character",t),o.select()}n.focus(),d&&i!=n.selectionEnd&&(s={begin:t,end:i})}function E(e){var i=t(e);if(i.is(":input")){r.greedy=r.greedy?r.greedy:0==r.repeat;var n=i.prop("maxLength");y()>n&&n>-1&&(n<g.length&&(g.length=n),0==r.greedy&&(r.repeat=Math.round(n/g.length))),i.prop("maxLength",2*y()),i.data("inputmask",{tests:p,_buffer:g,greedy:r.greedy,repeat:r.repeat,autoUnmask:r.autoUnmask,definitions:r.definitions,isRTL:!1}),function(e){var i;Object.getOwnPropertyDescriptor&&(i=Object.getOwnPropertyDescriptor(e,"value")),i&&i.get?e._valueGet||(e._valueGet=i.get,e._valueSet=i.set,Object.defineProperty(e,"value",{get:function(){var e=t(this),i=t(this).data("inputmask");return i&&i.autoUnmask?e.inputmask("unmaskedvalue"):this._valueGet()!=i._buffer.join("")?this._valueGet():""},set:function(e){this._valueSet(e),t(this).triggerHandler("setvalue.inputmask")}})):document.__lookupGetter__&&e.__lookupGetter__("value")?e._valueGet||(e._valueGet=e.__lookupGetter__("value"),e._valueSet=e.__lookupSetter__("value"),e.__defineGetter__("value",(function(){var e=t(this),i=t(this).data("inputmask");return i&&i.autoUnmask?e.inputmask("unmaskedvalue"):this._valueGet()!=i._buffer.join("")?this._valueGet():""})),e.__defineSetter__("value",(function(e){this._valueSet(e),t(this).triggerHandler("setvalue.inputmask")}))):(e._valueGet||(e._valueGet=function(){return this.value},e._valueSet=function(e){this.value=e}),1!=t.fn.val.inputmaskpatch&&(t.fn.val=function(){if(0==arguments.length){var e=t(this);if(e.data("inputmask")){if(e.data("inputmask").autoUnmask)return e.inputmask("unmaskedvalue");var i=t.inputmask.val.apply(e);return i!=e.data("inputmask")._buffer.join("")?i:""}return t.inputmask.val.apply(e)}var n=arguments;return this.each((function(){var e=t(this),i=t.inputmask.val.apply(e,n);return e.data("inputmask")&&e.triggerHandler("setvalue.inputmask"),i}))},t.extend(t.fn.val,{inputmaskpatch:!0})))}(e);var a,s,o,h=g.slice(),u=e._valueGet(),w=!1,f=!1,m=-1,U=x(0,-1),P=(C(0,y()),!1);if("rtl"==e.dir||r.numericInput){e.dir="ltr",i.css("text-align","right"),i.removeAttr("dir");var E=i.data("inputmask");E.isRTL=!0,i.data("inputmask",E),P=!0}i.unbind(".inputmask"),i.removeClass("focus.inputmask"),i.bind("mouseenter.inputmask",(function(){if(!t(this).hasClass("focus.inputmask")&&r.showMaskOnHover){var e=this._valueGet().length;e<h.length&&(0==e&&(h=g.slice()),S(this,h))}})).bind("blur.inputmask",(function(){var e=t(this),i=this,n=i._valueGet();e.removeClass("focus.inputmask"),n!=u&&e.change(),r.clearMaskOnLostFocus&&(n==g.join("")?i._valueSet(""):D(i,h)),R(i)||(e.trigger("incomplete"),r.clearIncomplete&&(r.clearMaskOnLostFocus?i._valueSet(""):S(i,h=g.slice())))})).bind("focus.inputmask",(function(){var e=t(this),i=this;if(!e.hasClass("focus.inputmask")&&!r.showMaskOnHover){var n=i._valueGet().length;n<h.length&&(0==n&&(h=g.slice()),A(i,O(i,h,!0)))}e.addClass("focus.inputmask"),u=i._valueGet()})).bind("mouseleave.inputmask",(function(){var e=t(this),i=this;r.clearMaskOnLostFocus&&(e.hasClass("focus.inputmask")||(i._valueGet()==g.join("")||""==i._valueGet()?i._valueSet(""):D(i,h)))})).bind("click.inputmask",(function(){var e=this;setTimeout((function(){var t=A(e);if(t.begin==t.end){var i=t.begin;m=O(e,h,!1),A(e,P?i>m&&(!1!==v(i,h[i],h,!0)||!_(i))?i:m:i<m&&(!1!==v(i,h[i],h,!0)||!_(i))?i:m)}}),0)})).bind("dblclick.inputmask",(function(){var e=this;setTimeout((function(){A(e,0,m)}),0)})).bind("keydown.inputmask",(function(e){w=!1;var i=this,n=e.keyCode,a=A(i);if(r.numericInput){var s=i._valueGet().indexOf(r.radixPoint);-1!=s&&(P=a.begin<=s||a.end<=s)}if(n==r.keyCode.BACKSPACE||n==r.keyCode.DELETE||c&&127==n){var o=y();if(0==a.begin&&a.end==o)h=g.slice(),S(i,h),A(i,O(i,h,!1));else if(a.end-a.begin>1||a.end-a.begin==1&&r.insertMode)T(h,a.begin,a.end),S(i,h,P?O(i,h,!1):a.begin);else{var l=a.begin-(n==r.keyCode.DELETE?0:1);l<U&&n==r.keyCode.DELETE&&(l=U),l>=U&&(r.numericInput&&r.greedy&&n==r.keyCode.DELETE&&h[l]==r.radixPoint&&(l=x(0,l),P=!1),P?(l=L(U,l,k(l),!0),l=r.numericInput&&r.greedy&&n==r.keyCode.BACKSPACE&&h[l+1]==r.radixPoint?l+1:x(0,l)):l=N(l,o),S(i,h,l))}return i._valueGet()==g.join("")&&t(i).trigger("cleared"),!1}if(n==r.keyCode.END||n==r.keyCode.PAGE_DOWN)return setTimeout((function(){var t=O(i,h,!1,!0);r.insertMode||t!=y()||e.shiftKey||t--,A(i,e.shiftKey?a.begin:t,t)}),0),!1;if(n==r.keyCode.HOME||n==r.keyCode.PAGE_UP)return A(i,0,e.shiftKey?a.begin:0),!1;if(n==r.keyCode.ESCAPE)return i._valueSet(u),A(i,0,O(i,h)),!1;if(n==r.keyCode.INSERT)return r.insertMode=!r.insertMode,A(i,r.insertMode||a.begin!=y()?a.begin:a.begin-1),!1;if(e.ctrlKey&&88==n)setTimeout((function(){A(i,O(i,h,!0))}),0);else if(!r.insertMode){if(n==r.keyCode.RIGHT)return d=(d=a.begin==a.end?a.end+1:a.end)<y()?d:a.end,A(i,e.shiftKey?a.begin:d,e.shiftKey?d+1:d),!1;if(n==r.keyCode.LEFT){var d=a.begin-1;return A(i,d=d>0?d:0,e.shiftKey?a.end:d),!1}}r.onKeyDown.call(this,e,r),f=-1!=t.inArray(n,r.ignorables)})).bind("keypress.inputmask",(function(e){if(w)return!1;w=!0;var i=this,n=t(i),a=(e=e||window.event).which||e.charCode||e.keyCode;if(r.numericInput&&a==r.radixPoint.charCodeAt(r.radixPoint.length-1)){var s=i._valueGet().indexOf(r.radixPoint);A(i,x(0,-1!=s?s:y()))}if(e.ctrlKey||e.altKey||e.metaKey||f)return!0;if(a){n.trigger("input");var o=A(i),l=String.fromCharCode(a),c=y();if(T(h,o.begin,o.end),P)if(!1!==(m=v((_=r.numericInput?o.end:C(0,o.end))==c||B(h,_)==r.radixPoint?C(0,_):_,l,h,!1))){!0!==m&&(_=m.pos||o,l=m.c||l);var u=U;if(1==r.insertMode){if(1==r.greedy)for(var g=h.slice();B(g,u,!0)!=k(u)&&u<=_;)u=u==c?c+1:x(0,u);if(!(u<=_&&(r.greedy||h.length<c)))return!1;if(h[U]!=k(U)&&h.length<c){var p=I(h,-1,P);0!=o.end&&(_+=p),c=h.length}N(u,r.numericInput?C(0,_):_,l)}else W(h,r.numericInput?C(0,_):_,l);S(i,h,r.numericInput&&0==_?x(0,_):_),setTimeout((function(){R(i)&&n.trigger("complete")}),0)}else d&&S(i,h,o.begin);else{var m,_=x(0,o.begin-1);if(I(h,_,P),!1!==(m=v(_,l,h,!1))){if(!0!==m&&(_=m.pos||_,l=m.c||l),1==r.insertMode){var b=y();for(g=h.slice();B(g,b,!0)!=k(b)&&b>=_;)b=0==b?-1:C(0,b);if(!(b>=_))return!1;L(_,h.length,l)}else W(h,_,l);var K=x(0,_);S(i,h,K),setTimeout((function(){R(i)&&n.trigger("complete")}),0)}else d&&S(i,h,o.begin)}return!1}})).bind("keyup.inputmask",(function(e){var i=t(this),n=this,a=e.keyCode;r.onKeyUp.call(this,e,r),a==r.keyCode.TAB&&i.hasClass("focus.inputmask")&&0==n._valueGet().length&&(S(n,h=g.slice()),P||A(n,0),u=n._valueGet())})).bind(l+".inputmask, dragdrop.inputmask, drop.inputmask",(function(){var e=this;setTimeout((function(){A(e,O(e,h,!0))}),0)})).bind("setvalue.inputmask",(function(){var e=this;u=e._valueGet(),O(e,h,!0),e._valueGet()==g.join("")&&e._valueSet("")})).bind("complete.inputmask",r.oncomplete).bind("incomplete.inputmask",r.onincomplete).bind("cleared.inputmask",r.oncleared),m=O(e,h,!0);try{a=document.activeElement}catch(e){}a===e?(i.addClass("focus.inputmask"),A(e,m)):r.clearMaskOnLostFocus&&(e._valueGet()==g.join("")?e._valueSet(""):D(e,h)),s=e,o=t._data(s).events,t.each(o,(function(e,i){t(s).bind(e+".inputmask",(function(e){if(this.readOnly||this.disabled)return e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault(),!1}));for(
//!! the bound handlers are executed in the order they where bound
var n=i[i.length-1],a=i.length-1;a>0;a--)i[a]=i[a-1];i[0]=n}))}function R(e){for(var t=!0,i=e._valueGet(),n=i.length,a=0;a<n;a++)if(_(a)&&i.charAt(a)==k(a)){t=!1;break}return t}function N(e,t,i){for(;!_(e)&&e-1>=0;)e--;for(var n=e;n<t&&n<y();n++)if(_(n)){K(h,n);var a=x(0,n),s=B(h,a);if(s!=k(a)){if(a<y()&&!1!==v(n,s,h,!0)&&p[b(n)].def==p[b(a)].def)W(h,n,B(h,a)),K(h,a);else if(_(n))break}else if(null==i)break}else K(h,n);return null!=i&&W(h,P?t:C(0,t),i),0==(h=M(h.join(""),P).split("")).length&&(h=g.slice()),e}function L(e,t,i,n){for(var a=e;a<=t&&a<y();a++)if(_(a)){var s=B(h,a);if(W(h,a,i),s!=k(a)){var o=x(0,a);if(!(o<y()))break;if(!1!==v(o,s,h,!0)&&p[b(a)].def==p[b(o)].def)i=s;else{if(_(o))break;i=s}}else if(!0!==n)break}else K(h,a);var r=h.length;return 0==(h=M(h.join(""),P).split("")).length&&(h=g.slice()),t-(r-h.length)}}})},924:()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)
/*! nanoScrollerJS - v0.8.4 - 2014
* http://jamesflorentino.github.com/nanoScrollerJS/
* Copyright (c) 2014 James Florentino; Licensed MIT */}!function(t,i,n){"use strict";var a,s,o,r,l,c,d,h,u,g,p,w,f,m,v,_,b,k,y,x,C,W,B,I,S,T,K,O;x={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},v="scroll",d="mousedown",h="mouseenter",u="mousemove",p="mousewheel",g="mouseup",m="resize",l="drag",c="enter",b="up",f="panedown",o="DOMMouseScroll",r="down",k="wheel",_="touchmove",a="Microsoft Internet Explorer"===i.navigator.appName&&/msie 7./i.test(i.navigator.appVersion)&&i.ActiveXObject,s=null,I=i.requestAnimationFrame,y=i.cancelAnimationFrame,T=n.createElement("div").style,K=function(){var e,t,i,n;for(e=i=0,n=(t=["t","webkitT","MozT","msT","OT"]).length;i<n;e=++i)if(t[e],t[e]+"ransform"in T)return t[e].substr(0,t[e].length-1);return!1}(),O="transform",S=!1!==K&&(""===K?O:K+O.charAt(0).toUpperCase()+O.substr(1)),W=!1!==S,C=function(){var e,t,i;return(t=(e=n.createElement("div")).style).position="absolute",t.width="100px",t.height="100px",t.overflow=v,t.top="-9999px",n.body.appendChild(e),i=e.offsetWidth-e.clientWidth,n.body.removeChild(e),i},B=function(){var e,t,n;return t=i.navigator.userAgent,!!(e=/(?=.+Mac OS X)(?=.+Firefox)/.test(t))&&((n=/Firefox\/\d{2}\./.exec(t))&&(n=n[0].replace(/\D+/g,"")),e&&+n>23)},w=function(){function e(e,a){this.el=e,this.options=a,s||(s=C()),this.$el=t(this.el),this.doc=t(this.options.documentContext||n),this.win=t(this.options.windowContext||i),this.body=this.doc.find("body"),this.$content=this.$el.children("."+a.contentClass),this.$content.attr("tabindex",this.options.tabIndex||0),this.content=this.$content[0],this.previousPosition=0,this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return e.prototype.preventScrolling=function(e,t){if(this.isActive)if(e.type===o)(t===r&&e.originalEvent.detail>0||t===b&&e.originalEvent.detail<0)&&e.preventDefault();else if(e.type===p){if(!e.originalEvent||!e.originalEvent.wheelDelta)return;(t===r&&e.originalEvent.wheelDelta<0||t===b&&e.originalEvent.wheelDelta>0)&&e.preventDefault()}},e.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},e.prototype.updateScrollValues=function(){var e,t;e=this.content,this.maxScrollTop=e.scrollHeight-e.clientHeight,this.prevScrollTop=this.contentScrollTop||0,this.contentScrollTop=e.scrollTop,t=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same",this.previousPosition=this.contentScrollTop,"same"!==t&&this.$el.triggerHandler("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:t}),this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=0===this.maxScrollTop?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},e.prototype.setOnScrollStyles=function(){var e,t;W?(e={})[S]="translate(0, "+this.sliderTop+"px)":e={top:this.sliderTop},I?(y&&this.scrollRAF&&y(this.scrollRAF),this.scrollRAF=I((t=this,function(){return t.scrollRAF=null,t.slider.css(e)}))):this.slider.css(e)},e.prototype.createEvents=function(){var e;this.events={down:(e=this,function(t){return e.isBeingDragged=!0,e.offsetY=t.pageY-e.slider.offset().top,e.slider.is(t.target)||(e.offsetY=0),e.pane.addClass("active"),e.doc.bind(u,e.events[l]).bind(g,e.events[b]),e.body.bind(h,e.events[c]),!1}),drag:function(e){return function(t){return e.sliderY=t.pageY-e.$el.offset().top-e.paneTop-(e.offsetY||.5*e.sliderHeight),e.scroll(),e.contentScrollTop>=e.maxScrollTop&&e.prevScrollTop!==e.maxScrollTop?e.$el.triggerHandler("scrollend"):0===e.contentScrollTop&&0!==e.prevScrollTop&&e.$el.triggerHandler("scrolltop"),!1}}(this),up:function(e){return function(t){return e.isBeingDragged=!1,e.pane.removeClass("active"),e.doc.unbind(u,e.events[l]).unbind(g,e.events[b]),e.body.unbind(h,e.events[c]),!1}}(this),resize:function(e){return function(t){e.reset()}}(this),panedown:function(e){return function(t){return e.sliderY=(t.offsetY||t.originalEvent.layerY)-.5*e.sliderHeight,e.scroll(),e.events.down(t),!1}}(this),scroll:function(e){return function(i){if(e.updateScrollValues(),!e.isBeingDragged&&(e.iOSNativeScrolling||(e.sliderY=e.sliderTop,e.setOnScrollStyles()),null!=i)){t(e.$el).attr("max-slider-top",e.maxSliderTop),t(e.$el).attr("slider-top",e.sliderTop);var n=!1;e.options.parentNanoscrollContainer&&(t(e.$el).addClass("scroll-element"),n=t(e.options.parentNanoscrollContainer).attr("max-slider-top")===t(e.options.parentNanoscrollContainer).attr("slider-top"));var a=!1;e.options.childNanoscrollContainer&&t(e.options.childNanoscrollContainer).hasClass("scroll-element")&&(a=!0,t(e.options.childNanoscrollContainer).removeClass("scroll-element")),e.contentScrollTop>=e.maxScrollTop?(e.options.preventPageScrolling&&e.preventScrolling(i,r),e.prevScrollTop!==e.maxScrollTop?e.$el.triggerHandler("scrollend"):(e.options.parentNanoscrollContainer||e.options.childNanoscrollContainer)&&(a&&t(e.options.childNanoscrollContainer).attr("max-slider-top")===t(e.options.childNanoscrollContainer).attr("slider-top")||!a&&e.maxSliderTop===e.sliderTop&&(!e.options.parentNanoscrollContainer||e.options.parentNanoscrollContainer&&0===t(e.options.parentNanoscrollContainer).attr("slider-top")))&&e.preventScrolling(i,r)):0===e.contentScrollTop&&(e.options.preventPageScrolling&&e.preventScrolling(i,b),0!==e.prevScrollTop?e.$el.triggerHandler("scrolltop"):(e.options.parentNanoscrollContainer||e.options.childNanoscrollContainer)&&(a&&0==+t(e.options.childNanoscrollContainer).attr("slider-top")||!a&&0===e.sliderTop&&(!e.options.parentNanoscrollContainer||e.options.parentNanoscrollContainer&&!n))&&e.preventScrolling(i,b))}}}(this),wheel:function(e){return function(t){var i;if(null!=t)return(i=t.delta||t.wheelDelta||t.originalEvent&&t.originalEvent.wheelDelta||-t.detail||t.originalEvent&&-t.originalEvent.detail)&&(e.sliderY+=-i/3),e.scroll(),!1}}(this),enter:function(e){return function(t){var i;if(e.isBeingDragged)return 1!==(t.buttons||t.which)?(i=e.events)[b].apply(i,arguments):void 0}}(this)}},e.prototype.addEvents=function(){var e;this.removeEvents(),e=this.events,this.options.disableResize||this.win.bind(m,e[m]),this.iOSNativeScrolling||(this.slider.bind(d,e[r]),this.pane.bind(d,e[f]).bind(p+" "+o,e[k])),this.$content.bind(v+" "+p+" "+o+" "+_,e[v])},e.prototype.removeEvents=function(){var e;e=this.events,this.win.unbind(m,e[m]),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(v+" "+p+" "+o+" "+_,e[v])},e.prototype.generate=function(){var e,t,n,a,o;return a=(t=this.options).paneClass,o=t.sliderClass,t.contentClass,(n=this.$el.children("."+a)).length||n.children("."+o).length||this.$el.append('<div class="'+a+'"><div class="'+o+'" /></div>'),this.pane=this.$el.children("."+a),this.slider=this.pane.find("."+o),0===s&&B()?e={right:-14,paddingRight:+i.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/[^0-9.]+/g,"")+14}:s&&(e={right:-s},this.$el.addClass("has-scrollbar")),null!=e&&this.$content.css(e),this},e.prototype.restore=function(){this.stopped=!1,this.iOSNativeScrolling||this.pane.show(),this.addEvents()},e.prototype.reset=function(){var e,t,i,n,o,r,l,c,d,h,u;if(!this.iOSNativeScrolling)return this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),o=(n=(e=this.content).style).overflowY,a&&this.$content.css({height:this.$content.height()}),t=e.scrollHeight+s,(d=parseInt(this.$el.css("max-height"),10))>0&&(this.$el.height(""),this.$el.height(e.scrollHeight>d?d:e.scrollHeight)),l=(r=this.pane.outerHeight(!1))+(c=parseInt(this.pane.css("top"),10))+parseInt(this.pane.css("bottom"),10),(u=Math.round(l/t*l))<this.options.sliderMinHeight?u=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&u>this.options.sliderMaxHeight&&(u=this.options.sliderMaxHeight),o===v&&n.overflowX!==v&&(u+=s),this.maxSliderTop=l-u,this.contentHeight=t,this.paneHeight=r,this.paneOuterHeight=l,this.sliderHeight=u,this.paneTop=c,this.slider.height(u),this.events.scroll(),this.pane.show(),this.isActive=!0,e.scrollHeight===e.clientHeight||this.pane.outerHeight(!0)>=e.scrollHeight&&o!==v?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===e.scrollHeight&&o===v?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),"static"!==(i=this.$content.css("position"))&&"relative"!==i||(h=parseInt(this.$content.css("right"),10))&&this.$content.css({right:"",marginRight:h}),this;this.contentHeight=this.content.scrollHeight},e.prototype.scroll=function(){if(this.isActive)return this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop(this.maxScrollTop*this.sliderY/this.maxSliderTop),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this},e.prototype.scrollBottom=function(e){if(this.isActive)return this.$content.scrollTop(this.contentHeight-this.$content.height()-e).triggerHandler(p),this.stop().restore(),this},e.prototype.scrollTop=function(e){if(this.isActive)return this.$content.scrollTop(+e).triggerHandler(p),this.stop().restore(),this},e.prototype.scrollTo=function(e){if(this.isActive)return this.scrollTop(this.$el.find(e).get(0).offsetTop),this},e.prototype.stop=function(){return y&&this.scrollRAF&&(y(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},e.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),a&&this.$content.height(""),this.$content.removeAttr("tabindex"),this.$el.hasClass("has-scrollbar")&&(this.$el.removeClass("has-scrollbar"),this.$content.css({right:""})),this},e.prototype.flash=function(){var e;if(!this.iOSNativeScrolling&&this.isActive)return this.reset(),this.pane.addClass("flashed"),setTimeout((e=this,function(){e.pane.removeClass("flashed")}),this.options.flashDelay),this},e}(),t.fn.nanoScroller=function(i){return this.each((function(){var n,a;if((a=this.nanoscroller)||(n=t.extend({},x,i),this.nanoscroller=a=new w(this,n)),i&&"object"===e(i)){if(t.extend(a.options,i),null!=i.scrollBottom)return a.scrollBottom(i.scrollBottom);if(null!=i.scrollTop)return a.scrollTop(i.scrollTop);if(i.scrollTo)return a.scrollTo(i.scrollTo);if("bottom"===i.scroll)return a.scrollBottom(0);if("top"===i.scroll)return a.scrollTop(0);if(i.scroll&&i.scroll instanceof t)return a.scrollTo(i.scroll);if(i.stop)return a.stop();if(i.destroy)return a.destroy();if(i.flash)return a.flash()}return a.reset()}))},t.fn.nanoScroller.Constructor=w}(jWS,window,document)},910:(e,t,i)=>{"use strict";i(492),i(190),i(774),i(14),i(924),i(499),i(93),i(322),i(773),i(568),i(325),i(781),i(759),i(903),i(862)},903:()=>{"use strict";var e,t,i,n,a,s;window.wsCallTracking=(e=jWS,n=function(){var t=e('<div class="ws-call-tracking"></div>');if(i.logo){var n=e("<img>").attr("src",WBK.settings.staticServerUrl+"/uploaded/calltracking/"+WBK.settings.calltrackingId+"/logo/"+i.logo);switch(n.css("width","40px").css("height","40px"),i.corner_type){case"rect":break;case"round":n.css("border-radius","50%");break;default:n.css("border-radius","3px")}t.append(e("<div>").css("width","40px").css("height","40px").css("margin-right","4px").css("float","left").append(n))}var a=e("<span>").css("display","inline-block").css("height","100%").css("vertical-align","middle"),s=e("<span>").css("display","inline-block").css("vertical-align","middle").html(i.text);switch(t.append(e("<div>").css("height","40px").css("overflow","hidden").append(a).append(s)),t.css("padding","4px"),t.css("font-size","14px"),t.css("background-color",i.background_color).css("color",i.text_color),i.corner_type){case"rect":break;case"round":t.css("border-radius","24px");break;default:t.css("border-radius","6px")}this.show(t)},a=function(){this.show(i.phone)},s={itself:{x:function(t){var n=Math.round(e(window).width()/100*i.position_x);return n+t.outerWidth()>=e(window).width()&&(n=e(window).width()-t.outerWidth()),n},y:function(t){var n=Math.round(e(window).height()/100*i.position_y);return n+t.outerHeight()>=e(window).height()&&(n=e(window).height()-t.outerHeight()),n},show:function(e){e.css({position:"fixed","z-index":"999999","max-width":"350px",height:"48px"}),e.appendTo("body"),e.css({left:this.x(e)+"px",top:this.y(e)+"px"})}},phone:{_:e(".ws-integrate-calltracking-phone"),show:function(t){e(this._).html(e("<a>").attr("href","tel:"+t).html(t))}}},{settings:{},widget:{},log:function(e){t&&wsUtil.log("CALLTRACKING: "+e)},run:function(n){i=this.settings,this.widget,t=WBK.checkDebug(),e.fn._frameCheck()&&"undefined"==typeof WBK&&(WBK=document.WBK),WBK.settings.calltrackingId=n.Settings.calltrackingId,"function"==typeof window.ws_OnCallTrackingBeforeInit&&window.ws_OnCallTrackingBeforeInit();try{this.init(n.Data.calltracking),this.load(),WBK.initSocket(),"function"==typeof window.ws_OnCallTrackingLaunched&&window.ws_OnCallTrackingLaunched()}catch(e){this.log(e.message),"function"==typeof window.ws_OnCallTrackingFailedInit&&window.ws_OnCallTrackingFailedInit(e)}finally{"function"==typeof window.ws_OnCallTrackingAfterInit&&window.ws_OnCallTrackingAfterInit()}},init:function(e){if(!e.ispayed)throw new Error("Виджет не оплачен");i.logo=e.logo,i.phone=e.phone,i.text=e.text.replace("[телефон]",e.phone),i.text_color=e.text_color,i.background_color=e.background_color,i.corner_type=e.corner_type,i.type=e.type,i.position_x=e.position_x,i.position_y=e.position_y,i.country=e.country},load:function(){switch(i.type){case"itself":n.call(s.itself);break;case"phone":a.call(s.phone);break;default:this.log('"'+i.type+'" is not defined')}},onSocket:function(e){"call"===e.name&&wsUtil.sendGoal(e.ya_goal,e.ga_goal,e.ga_category,!1,!1)}})},568:()=>{var e,t,i,n,a,s;wsChat=(e=jWS,{settings:{},templates:{},widget:{},init:function(o){t=this,i=this.settings,n=this.templates,a=this.widget,e.fn._frameCheck()&&"undefined"==typeof WBK&&(WBK=document.WBK),s=WBK.checkDebug(),t.loader(o)},loader:function(n){var a=n.Data.chat;if(t.setSettings(a),WBK.settings.chatWidgetId=parseInt(n.Settings.chatWidgetId),WBK.settings.chatEnabled=!0,WBK.settings.chatId=!!a.chatId&&parseInt(a.chatId),i.all_operators=a.users?a.users:{},i.chat_operators=a.chatUsers?a.chatUsers:{},i.free_chat_widget=parseInt(i.free_chat_widget),a.auto_call&&(i.autoCall=parseInt(a.auto_call)),a.auto_call_text&&(i.autoCallText=a.auto_call_text),a.auto_call_deffered&&(i.autoCallDeffered=parseInt(a.auto_call_deffered)),a.auto_call_deffered_delay&&(i.autoCallDefferedDelay=parseInt(a.auto_call_deffered_delay)),i.free_chat_widget&&s&&t.log("Бесплатная версия чата"),parseInt(i.always_online)&&!i.free_chat_widget&&e.each(i.all_operators,(function(e,t){i.all_operators[e].status=1})),i.chat_is_online=t.operatorsIsOnline(),i.partnerLink||(i.partnerLink="http://"+WBK.settings.servicedomain+"?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=chat&utm_term="),i.widget_logo=parseInt(a.img_logo),i.img_robot_logo=parseInt(a.img_robot_logo),i.img_robot_logo_service=parseInt(a.img_robot_logo_service),i.chat_widget_logo=WBK.settings.staticServerUrl+"/widget/img/chat_robot.png",i.chat_widget_logo_robot=i.chat_widget_logo,i.img_robot_logo_service){var o=new Date;i.chat_widget_logo_robot=WBK.settings.staticServerUrl+"/uploaded/chat_widgets_service/"+WBK.settings.serviceid+"/logo_robot.png?"+o.getTime()}switch(i.img_robot_logo&&(o=new Date,i.chat_widget_logo_robot=WBK.settings.staticServerUrl+"/uploaded/chat_widgets/"+WBK.settings.chatWidgetId+"/logo_robot.png?"+o.getTime()),i.widget_logo&&(o=new Date,i.chat_widget_logo=WBK.settings.staticServerUrl+"/uploaded/chat_widgets/"+WBK.settings.chatWidgetId+"/logo.png?"+o.getTime()),i.btn_corner_class="",i.corner_type){case"smooth":i.btn_corner_class="ws-chat-btn-mini-round";break;case"flat":i.btn_corner_class="";break;case"round":i.btn_corner_class="ws-chat-btn-round"}i.auto_reply_not_connected_and_operators_offline_need_to_show=!1,i.disableMobileOpenHash=parseInt(a.disable_mobile_open_hash),t.updateUser(),t.setTemplate(),t.initWidget()},initWidget:function(){WBK.loadFont(),WBK.addStyles(".ws-chat-message-manager .ws-chat-message, .ws-chat-message-robot .ws-chat-message, .ws-chat-message-manager:before, .ws-chat-message-robot:before{background-color: "+i.color_background_message_operator+" !important;}.ws-chat-message-user .ws-chat-message, .ws-chat-message-user:before{background-color: "+i.color_background_message_user+" !important;}.ws-chat-message-manager .ws-chat-message-source, .ws-chat-message-manager .ws-chat-message-date, .ws-chat-message-robot .ws-chat-message-source, .ws-chat-message-robot .ws-chat-message-date{color: "+i.color_text_message_operator+" !important;}.ws-chat-message-user .ws-chat-message-source, .ws-chat-message-user .ws-chat-message-date{color: "+i.color_text_message_user+" !important;}.ws-chat .ws-chat-container .ws-chat-message-user .ws-chat-message-source .ws-chat-message-link, .ws-chat .ws-chat-container .ws-chat-message-user .ws-chat-message-source .ws-chat-message-link:visited, .ws-chat .ws-chat-container .ws-chat-message-user .ws-chat-message-source .ws-chat-message-link:active{color: "+i.color_text_message_user+" !important;}.ws-chat .ws-chat-container .ws-chat-message-user .ws-chat-message-source .ws-chat-message-link:hover{color: "+i.color_text_message_user+" !important;}.ws-chat .ws-chat-container {background-color: "+i.color_background_window+" !important;}.ws-chat .ws-chat-container:before {background-color: "+i.color_background_window+" !important;}.ws-chat .ws-chat-invitation-container{background-color: "+i.color_background_invitation+" !important;}.ws-chat .ws-chat-invitation-text{background-color: "+i.color_background_invitation_message+" !important;}.ws-chat .ws-chat-invitation-body-text:before{background-color: "+i.color_background_invitation_message+" !important;}.ws-chat .ws-chat-invitation-input{background-color: "+i.color_background_invitation_input+" !important;}.ws-chat .ws-chat-invitation-name{color: "+i.color_text_invitation+" !important;}.ws-chat .ws-chat-invitation-position{color: "+i.color_text_invitation+" !important;}.ws-chat .ws-chat-invitation-container .ws-icon-close{color: "+i.color_text_invitation+" !important;}.ws-chat .ws-chat-invitation-typing{color: "+i.color_text_invitation+" !important;}.ws-chat .ws-chat-invitation-container .ws-chat-invitation-body .ws-chat-invitation-body-el .ws-chat-invitation-text{color: "+i.color_text_invitation_message+" !important;}.ws-chat .ws-chat-invitation-container .ws-chat-invitation-body .ws-chat-invitation-body-el .ws-chat-invitation-text a{color: "+i.color_text_invitation_message+" !important; text-decoration: underline !important;}"),a.container=e(n),a.window=a.container.find(".ws-chat-container").hide(),a.btn=a.container.find(".ws-chat-btn-container").hide(),a.btn_el=a.container.find(".ws-chat-btn-el-container"),a.invitation=a.container.find(".ws-chat-invitation-container").hide(),a.container.appendTo("body"),wsUtil.fixFastClick();var o=i.text_button_online;"pc"!=WBK.settings.device?(a.container.addClass("ws-chat-mobile"),o=i.mobile_text_button_online,WBK.addStyles(".ws-chat .ws-chat-btn-container{background: "+i.mobile_color_background_button+"!important;}.ws-chat .ws-chat-btn-container .ws-btn-title{color: "+i.mobile_color_background_button_text+"!important;}")):(a.btn.addClass(i.btn_corner_class),WBK.addStyles(".ws-chat .ws-chat-btn-container{background: "+i.color_background_button+"!important;}.ws-chat .ws-chat-btn-container .ws-btn-title{color: "+i.color_background_button_text+"!important;}"),a.btn.find(".ws-btn-title").html(o)),i.widget_logo&&(a.window.addClass("ws-chat-logo-yes"),a.btn.addClass("ws-chat-btn-logo-yes")),(i.img_robot_logo||i.img_robot_logo_service)&&a.window.addClass("ws-chat-logo-robot-yes");var r,l=wsUtil.getCookie("WidgetChat_sound_"+WBK.settings.chatWidgetId);if(l?(i.sound=l,"off"==i.sound?(a.window.find(".ws-chat-sound").attr("title",i.lang_text.sound_on),a.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-on").addClass("ws-icon-sound-off")):(a.window.find(".ws-chat-sound").attr("title",i.lang_text.sound_off),a.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-off").addClass("ws-icon-sound-on"))):"off"==i.sound&&(a.window.find(".ws-chat-sound").attr("title",i.lang_text.sound_on),a.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-on").addClass("ws-icon-sound-off")),WBK.settings.hideCopyright?e(".ws-chat-copyright").hide():e("body").on("click",".ws-chat-copyright-url",(function(t){WBK.sendAdvertLinkStat(e(this).data("widget"),e(this).attr("href"),e(this).text(),WBK.settings.chatWidgetId)})),t.loadBtnEvents(),t.loadWindowEvents(),i.messages_quant_to_rate=0,i.chat_is_online)WBK.settings.chatId&&i.messages?(t.addOldMessages(),t.operatorsUpdate(),t.start()):(i.operators_array.length&&"robot"!==i.hello_message_author?t.showHelloMessageOperators():t.showHelloMessage(),i.is_first_message=!0,i.send_autoreply_first=!0),t.initRating(),t.checkRatingSettings();else{if("hide"==i.operator_offline_action)return s&&t.log("Операторы онлайн и отключена оффлайн форма"),void t.showOffline();t.showOffline()}if(t.initBtnPosition(),t.smilesInit(),WBK.settings.chatId||"hide"==i.button_location||"pc"!=WBK.settings.device&&parseInt(i.hide_mobile)||t.checkInvitation(),i.chat_invitation_has_scroll_rule&&e(window).on("scroll.callbackkillerchat",(function(){t.onScroll()})),i.agreementLink&&a.window.find(".ws-chat-agreement-link").attr("href",i.agreementLink),!e.fn._frameCheck()||"undefined"!=typeof WBK)try{r=window.top.location.hash}catch(e){}wsUtil.getCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId)&&wsUtil.getCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId)&&i.chat_is_online?t.showWidget():"#showchat"===r?(t.initWindowPosition(),t.showWidget(),t.sendGoal("open")):(a.btn.css("display","flex"),WBK.settings.chatBtnOpened=!0,wsUtil.getCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId)&&wsUtil.deleteCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId),t.initWindowPosition(),"hide"==i.button_location&&"pc"==WBK.settings.device&&(a.btn.hide(),WBK.settings.chatBtnOpened=!1)),"pc"==WBK.settings.device||i.disableMobileOpenHash||e(window).on("hashchange",(function(e){"-1"!=e.originalEvent.oldURL.search("#chatIsShown")&&(t.hideWidget(),window.location.hash="")}))},onScroll:function(){wsUtil.setTimeout("scrollTimerChat",(function(){t.checkInvitation()}),250)},showBtn:function(){a.btn.css("display","flex"),"horizontal"==i.button_location&&WBK.animateFastOnce(a.btn,"cbk-zoomIn"),WBK.settings.chatBtnOpened=!0},hideBtn:function(){a.btn.hide(),WBK.animateFastOnce(a.btn,"cbk-zoomOut"),WBK.settings.chatBtnOpened=!1},showWidget:function(){if(t.hideBtn(),WBK.settings.chatInvitationOpened&&t.hideInvitation(),WBK.settings.windowInvaderOpened&&(wsInvader.widget.window.find(".cbk-support-new-message-copyright").hide(),wsInvader.widget.window.hide()),(o=new Date).setMinutes(o.getMinutes()+1440),wsUtil.setCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId,!0,o),i.chat_is_online&&"pc"==WBK.settings.device&&wsUtil.getCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId)){var n=JSON.parse(wsUtil.getCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId));a.window.css({top:n.top,left:n.left,width:n.width,height:n.height})}if("pc"!=WBK.settings.device&&(i.scroll_left=e(window).scrollLeft(),i.scroll_top=e(window).scrollTop(),e("meta[name=viewport]").length?(a.window.data("oldViewport",e("meta[name=viewport]").last().attr("content")),e("meta[name=viewport]").remove()):a.window.data("noViewport",1),e("head").append(e("<meta>").attr("name","viewport").attr("content","width=device-width, user-scalable=0, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0")),e("body").addClass("cbk-body-mobile"),i.unread_messages_count&&t.setUnreadMessages(0),i.disableMobileOpenHash||(window.location.hash="chatIsShown")),(o=new Date).setMinutes(o.getMinutes()+144e3),wsUtil.setCookie("WidgetChat_shownOn",i.chat_is_online?"on_btn":"on_btn_offline",o),a.window.show(),"pc"==WBK.settings.device&&WBK.animateFastOnce(a.window,"cbk-zoomIn"),WBK.settings.chatWindowOpened=!0,i.chat_is_online&&"pc"==WBK.settings.device&&a.window.find(".ws-textarea").focus(),i.chatId&&i.chat_created){var s=(new Date).getTime();t.sendNode(JSON.stringify(""),s,"open_window")}else{var o,r=wsUtil.getStorage("WidgetChat_last_shown_invitation_id");if(WBK.settings.chatInvitationShown&&((o=new Date).setMinutes(o.getMinutes()+144e3),wsUtil.setCookie("WidgetChat_shownOn",i.chat_is_online?"on_inv":"on_inv_offline",o)),!WBK.settings.chatInvitationShown&&r&&i.invitations){WBK.settings.chatInvitationShown=!0;var l=!1;if(e.each(i.invitations,(function(e,t){i.invitations[e].id==r&&(l=e)})),!1!==l&&(i.invitation_operator_id=t.getOperatorIdForInvitation(l),i.invitations[l]=t.formatInvitation(i.invitations[l]),i.chat_is_online&&parseInt(i.invitations[l].invitation_always))){var c=i.invitation_operator_id.split("_");i.invitation_show_data={user_id:c[0],employee_id:c[1],invitation_id:i.invitations[l].id,hello_text:i.invitations[l].hello_text,text1:i.invitations[l].text1,text2:i.invitations[l].text2,ai_invitation_id:i.invitations[l].ai_invitation_id},n={hash:!1,message:"",date:"",user:i.invitation_operator_id,is_read:!0,message_type:"text",type:"manager",scroll:!1},a.window.find(".ws-chat-robot-hello, .ws-chat-manager-hello, .ws-chat-message-block").remove(),i.invitations[l].hello_text&&(n.message={text:i.invitations[l].hello_text},t.addMessage(n)),i.invitations[l].text1&&(n.message={text:i.invitations[l].text1},n.date="",t.addMessage(n)),i.invitations[l].text2&&(n.message={text:i.invitations[l].text2},n.date="",t.addMessage(n))}}}t.sendShowType(),a.window.find(".ws-chat-body").nanoScroller({scroll:"bottom",contentClass:"ws-chat-body-content",paneClass:"ws-chat-body-pane",sliderClass:"ws-chat-body-slider ",preventPageScrolling:!0}),a.window.find(".ws-textarea-group").nanoScroller({scroll:"bottom",contentClass:"ws-textarea",paneClass:"ws-textarea-pane",sliderClass:"ws-textarea-slider ",preventPageScrolling:!0}),wsUtil.fixBootstrap()},sendShowType:function(){var t=WBK.settings.serverUrl+"/api?action=chatNewShow&callback=?";e.getJSON(t,{type_show:wsUtil.getCookie("WidgetChat_shownOn"),status:i.chat_is_online?1:0,device:WBK.settings.device,code:WBK.settings.whiteSaasCode,googleClientId:wsUtil.getGoogleClientId(),chatId:WBK.settings.chatWidgetId,visitorId:WBK.settings.visitorId,advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId(),leadvertexId:wsUtil.getLeadvertexId(),externalParams:wsUtil.getExternalParams()})},hideWidget:function(){a.window.hide(),WBK.animateFastOnce(a.window,"cbk-zoomOut"),WBK.settings.chatWindowOpened=!1;var n=new Date;if(n.setMinutes(n.getMinutes()+144e3),wsUtil.deleteCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId),"pc"!=WBK.settings.device&&(a.window.data("noViewport")?(a.window.data("noViewport",0),e("meta[name=viewport]").attr("content","")):e("meta[name=viewport]").attr("content",a.window.data("oldViewport")),e("body").removeClass("cbk-body-mobile"),e(window).scrollTop(i.scroll_top),e(window).scrollLeft(i.scroll_left)),"hide"!=i.button_location&&t.showBtn(),i.chat_created){var s=(new Date).getTime();t.sendNode(JSON.stringify(""),s,"close_window")}if(!i.chat_is_online){var o=a.window.find(".ws-chat-body-offline");o.children().not(".ws-hide").show(),o.find(".ws-chat-offline-text-success").hide(),wsUtil.deleteTimeout("chatOfflineHide")}WBK.settings.multiButtonId&&wsMultiButton.reInitWidget(),WBK.settings.chatWindowOpened||WBK.settings.windowOpened||WBK.settings.windowQuizOpened||WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||jWS(window).trigger("envy:resize")},checkInvitation:function(n){if(i.invitations&&!parseInt(i.free_chat_widget)){s&&t.log("Проверяем автоприглашения");for(var a=0;a<i.invitations.length;a++)if(wsUtil.getCookie("WidgetChat_invitation_"+i.invitations[a].id))s&&t.log("автоприглашение № "+i.invitations[a].id+" уже было показано");else if(i.invitations[a].rules.length){var o=0,r=0,l=0,c=1,d=[],h=decodeURIComponent(window.location.toString());h||(h=window.location.toString()),e.each(i.invitations[a].rules,(function(n,a){switch(a.name){case"rule_url":switch(parseInt(a.type)){case 0:h.indexOf(a.value)+1?r++:o++;break;case 1:h.indexOf(a.value)+1==0?r++:o++;break;case 2:h==a.value?r++:o++;break;case 3:new RegExp(a.value,"gi").test(h)?r++:o++;break;case 4:h!=a.value?r++:o++}break;case"rule_time":d.push(parseInt(a.value)),l++;break;case"rule_time_site":var s=wsUtil.getCookie("WhiteCallback_timeAll")?parseInt(wsUtil.getCookie("WhiteCallback_timeAll")):1,c=parseInt(a.value)-s;d.push(c>1?c:1),l++;break;case"rule_time_close_chat":var u=t.getTimeClosedChat();u?(u=(new Date).setTime(u),u=parseInt(a.value)-((new Date).getTime()-u)/1e3,d.push(u>1?u:1)):d.push(1),l++;break;case"rule_operator":i.chat_is_online?"offline"==a.value?o++:r++:"online"==a.value?o++:r++;break;case"rule_visit_count":var g=WBK.getVisitCount();switch(parseInt(a.type)){case 0:parseInt(a.value)==g?r++:o++;break;case 1:parseInt(a.value)<g?r++:o++;break;case 2:parseInt(a.value)>g?r++:o++}break;case"rule_page_show_count":var p=WBK.getPageShowCount();switch(parseInt(a.type)){case 0:parseInt(a.value)==p?r++:o++;break;case 1:parseInt(a.value)<p?r++:o++;break;case 2:parseInt(a.value)>p?r++:o++}break;case"rule_scroll":var w=e(window).scrollTop()/(e(document).height()-e(window).height())*100;parseInt(a.value)<=w?r++:o++;break;case"rule_name":"known"===a.value?WBK.settings.visitorName?r++:o++:WBK.settings.visitorName?o++:r++;break;case"rule_device":parseInt(a.type)?WBK.settings.device==a.value?r++:o++:WBK.settings.device!=a.value?r++:o++}})),o&&s&&t.log("Не выполнены условия показа автоприглашения № "+i.invitations[a].id),"all"==i.invitations[a].check&&0==o&&(s&&t.log("Выполнены все правила показа автоприглашения № "+i.invitations[a].id),d.length>0&&(c=Math.max.apply(null,d)),s&&t.log("Показ автоприглашения через: "+c),t.checkNeedGenerateOrShowInvitation(a,c,n)),"one"==i.invitations[a].check&&(r>0||l>0)&&(s&&t.log("Выполнено 1 правило показа автоприглашения № "+i.invitations[a].id),r>0?c=1:d.length>0&&(c=Math.min.apply(null,d)),s&&t.log("Показ автоприглашения через: "+c),t.checkNeedGenerateOrShowInvitation(a,c,n))}else t.checkNeedGenerateOrShowInvitation(a,1,n)}else s&&t.log("Нет автоприглашении или бесплатная версия")},checkNeedGenerateOrShowInvitation:function(e,n,a){parseInt(i.invitations[e].ai_generated_text_enabled)?t.getGeneratedAiInvitation(e,n,a):t.showInvitation(e,n,a)},setGeneratedTextToParentInvitation:function(e,t){i.invitations[t].hello_text=e.hello_text,i.invitations[t].text1=e.main_text,i.invitations[t].text2=e.call_to_action_text,i.invitations[t].ai_invitation_id=e.id,i.invitations[t].generated=!0},getGeneratedAiInvitation:function(e,n,a){var s=document.querySelector('meta[name="keywords"]')?document.querySelector('meta[name="keywords"]').content:"";s||(s=document.querySelector("title")?document.querySelector("title").textContent:"");var o={invitation_id:i.invitations[e].id,generation_params:{keywords:s,description:document.querySelector('meta[name="description"]')?document.querySelector('meta[name="description"]').content:"",name:WBK.settings.visitorName?WBK.settings.visitorName:""}},r=WBK.settings.serverUrl+"/api?action=chatGetAiInvitation";jWS.post(r,{code:WBK.settings.whiteSaasCode,data:o,visitorId:WBK.settings.visitorId},(function(i){i&&i.Success&&i.Data&&(t.setGeneratedTextToParentInvitation(i.Data.ai_invitation,e),t.showInvitation(e,n,a))}),"json")},hideInvitation:function(){WBK.settings.chatInvitationOpened=!1,a.invitation.hide()},getOperatorIdForInvitation:function(e){var t=!1,n=wsUtil.getStorage("WidgetChat_invitation_operator_id"),a=i.operators_id;return i.chat_is_online&&(a=i.operators_online_id),n&&(i.all_operators.hasOwnProperty(n)||(n=!1)),"operator"==i.invitations[e].operator_type?(t=i.invitations[e].operator_id,i.all_operators.hasOwnProperty(t)||(t=n||a[wsUtil.getRandomArbitrary(0,a.length-1)])):t=n||a[wsUtil.getRandomArbitrary(0,a.length-1)],wsUtil.setStorage("WidgetChat_invitation_operator_id",t),t},showInvitationByName:function(e){for(var t,n=0;n<i.invitations.length;n++)i.invitations[n].name==e&&(t=n);this.hideInvitation(),WBK.settings.chatInvitationShown=!1,i.show_one_invitation=!1,a.invitation.find(".ws-chat-invitation-logo").text(""),a.invitation.find(".ws-chat-invitation-name, .ws-chat-invitation-position, .ws-chat-invitation-text, .ws-chat-invitation-typing").remove(),this.checkNeedGenerateOrShowInvitation(t,1)},showInvitation:function(n,s,o){if(!(WBK.settings.chatId||WBK.settings.chatWindowOpened||i.show_one_invitation||wsUtil.getCookie("WidgetChat_invitation_planed_"+i.invitations[n].id)&&i.chat_invitation_has_scroll_rule)){if(i.chat_invitation_has_scroll_rule){var r=new Date;r.setSeconds(r.getSeconds()+s+2),wsUtil.setCookie("WidgetChat_invitation_planed_"+i.invitations[n].id,"true",r)}wsUtil.setInterval("invitationShow_"+n,(function(){if(!(WBK.settings.chatInvitationOpened||WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||WBK.settings.windowQuizOpened||WBK.settings.windowLoanerOpened||WBK.settings.windowInvaderOpened||WBK.settings.windowOpened||WBK.settings.chatId||WBK.settings.chatWindowOpened||i.show_one_invitation||WBK.settings.multiButtonVariantsOpened)){wsUtil.setStorage("WidgetChat_last_shown_invitation_id",i.invitations[n].id),WBK.settings.chatInvitationOpened=!0,WBK.settings.chatInvitationShown=!0,i.show_one_invitation=!0;for(var s=0;s<i.invitations.length;s++)wsUtil.deleteInterval("invitationShow_"+s);var r=new Date;"minutes"==i.invitations[n].repeat_type?r.setMinutes(r.getMinutes()+parseInt(i.invitations[n].repeat_time)):"days"==i.invitations[n].repeat_type&&r.setDate(r.getDate()+parseInt(i.invitations[n].repeat_time)),wsUtil.setCookie("WidgetChat_invitation_"+i.invitations[n].id,"true",r),wsUtil.deleteCookie("WidgetChat_invitation_planed_"+i.invitations[n].id),i.invitation_operator_id=t.getOperatorIdForInvitation(n);var l=i.invitation_operator_id;if(i.invitations[n]=t.formatInvitation(i.invitations[n]),i.chat_is_online){var c=l.split("_");i.invitation_show_data={user_id:c[0],employee_id:c[1],invitation_id:i.invitations[n].id,hello_text:i.invitations[n].hello_text,text1:i.invitations[n].text1,text2:i.invitations[n].text2,ai_invitation_id:i.invitations[n].ai_invitation_id};var d={hash:!1,message:"",date:"",user:l,is_read:!0,message_type:"text",type:"manager",scroll:!1};a.window.find(".ws-chat-robot-hello, .ws-chat-manager-hello, .ws-chat-message-block").remove(),i.invitations[n].hello_text&&(d.message={text:i.invitations[n].hello_text},t.addMessage(d)),i.invitations[n].text1&&(d.message={text:i.invitations[n].text1},d.date="",t.addMessage(d)),i.invitations[n].text2&&(d.message={text:i.invitations[n].text2},d.date="",t.addMessage(d))}if("open_chat"==i.invitations[n].action)return void t.showWidget();a.invitation.find(".ws-chat-invitation-logo").append('<img class="ws-chat-invitation-img" src="'+WBK.settings.staticServerUrl+i.users[l].img+'">');var h=i.users[l].name+(i.users[l].surname?" "+i.users[l].surname:""),u=i.users[l].profession?i.users[l].profession:"";if(a.invitation.hasClass("from-multi-button")&&(u||a.invitation.find(".ws-chat-invitation-body-el").addClass("multi-button-no-profession")),a.invitation.find(".ws-chat-invitation-body-text").before('<div class="ws-chat-invitation-name">'+h+'</div><div class="ws-chat-invitation-position">'+u+"</div>"),a.invitation.find(".ws-chat-invitation-body-text").append('<div class="ws-chat-invitation-text-box"><div class="ws-chat-invitation-text">'+i.invitations[n].hello_text+"</div></div>"),void 0!==o&&"multi_button"==o&&(wsMultiButton.stopTimer(),e.each(wsMultiButton.settings.checked_variants,(function(e,t){if(t.show_autoreply_icon)return wsMultiButton.showIconVariant(e),!1})),wsMultiButton.settings.animation_type&&e(".multi_button").removeClass("bouncing"),wsMultiButton.settings.text_tip&&e(".multi_button-main-div-text .multi_button-text").hide()),a.invitation.show(),parseInt(i.invitations[n].autoinvite_play_sound)&&t.playSound("message"),WBK.animateFastOnce(a.invitation,"cbk-zoomIn"),i.invitations[n].text1){var g=e('<div class="ws-chat-invitation-typing"><span class="ws-chat-typing-action"><i class="ws-icon-typing"></i></span><span class="ws-chat-invitation-typing-name">'+h+"</span> "+i.lang_text.typing+"...</div>");a.invitation.find(".ws-chat-invitation-body-text").append(g.fadeIn()),wsUtil.setTimeout("invitationMessageTimer",(function(){a.invitation.find(".ws-chat-invitation-typing").fadeOut((function(){e(this).remove()})),i.invitations[n].text1&&(e(this).remove(),a.invitation.find(".ws-chat-invitation-body-text").append('<div class="ws-chat-invitation-text-box"><div class="ws-chat-invitation-text">'+i.invitations[n].text1+"</div></div>")),i.invitations[n].text2&&wsUtil.setTimeout("invitationMessageTimer",(function(){a.invitation.find(".ws-chat-invitation-body-text").append(g.fadeIn()),wsUtil.setTimeout("invitationMessageTimer",(function(){a.invitation.find(".ws-chat-invitation-typing").fadeOut((function(){e(this).remove()})),wsUtil.setTimeout("invitationMessageTimer",(function(){a.invitation.find(".ws-chat-invitation-body-text").append(g.fadeIn()),wsUtil.setTimeout("invitationMessageTimer",(function(){a.invitation.find(".ws-chat-invitation-typing").fadeOut((function(){e(this).remove(),i.invitations[n].text2&&a.invitation.find(".ws-chat-invitation-body-text").append('<div class="ws-chat-invitation-text-box"><div class="ws-chat-invitation-text">'+i.invitations[n].text2+"</div></div>"),void 0!==o&&"multi_button"===o&&wsUtil.setTimeout("invitationAutoHideMultibutton",(function(){t.hideInvitation(),wsMultiButton.reInitWidget(),wsMultiButton.settings.text_tip&&e(".multi_button-main-div-text .multi_button-text").show()}),15e3)}))}),wsUtil.specialChars(i.invitations[n].text2).length/2*110)}),2500),a.invitation.find(".ws-chat-invitation-typing").fadeOut((function(){e(this).remove(),i.invitations[n].text2&&a.invitation.find(".ws-chat-invitation-body-text").append('<div class="ws-chat-invitation-text-box"><div class="ws-chat-invitation-text">'+i.invitations[n].text2+"</div></div>")}))}),wsUtil.specialChars(i.invitations[n].text2).length/2*110)}),2500)}),110*wsUtil.specialChars(i.invitations[n].text1).length)}}}),1e3*s)}},formatInvitation:function(e){if(e.hello_text=WBK.formatText(e.hello_text),e.text1=WBK.formatText(e.text1),e.text2=WBK.formatText(e.text2),WBK.settings.geoCity){WBK.settings.geoCity.name||(WBK.settings.geoCity.name=WBK.settings.geoCity.ip_city);var t="";WBK.settings.visitorName&&(t=WBK.settings.visitorName),e.hello_text=e.hello_text.replace(/\[geocity1\]/g,WBK.settings.geoCity.name),e.hello_text=e.hello_text.replace(/\[geocity2\]/g,WBK.settings.geoCity.name_rod),e.hello_text=e.hello_text.replace(/\[geocity3\]/g,WBK.settings.geoCity.name_mes),e.hello_text=e.hello_text.replace(/\[geocity4\]/g,WBK.settings.geoCity.name_vin),e.hello_text=e.hello_text.replace(/\[name\]/g,t),e.hello_text=e.hello_text.replace(/\[(.+?)\|(.+?)\]/gi,"<a href='$1' target='_blank'>$2</a>"),e.text1=e.text1.replace(/\[geocity1\]/g,WBK.settings.geoCity.name),e.text1=e.text1.replace(/\[geocity2\]/g,WBK.settings.geoCity.name_rod),e.text1=e.text1.replace(/\[geocity3\]/g,WBK.settings.geoCity.name_mes),e.text1=e.text1.replace(/\[geocity4\]/g,WBK.settings.geoCity.name_vin),e.text1=e.text1.replace(/\[name\]/g,t),e.text1=e.text1.replace(/\[(.+?)\|(.+?)\]/gi,"<a href='$1' target='_blank'>$2</a>"),e.text2=e.text2.replace(/\[geocity1\]/g,WBK.settings.geoCity.name),e.text2=e.text2.replace(/\[geocity2\]/g,WBK.settings.geoCity.name_rod),e.text2=e.text2.replace(/\[geocity3\]/g,WBK.settings.geoCity.name_mes),e.text2=e.text2.replace(/\[geocity4\]/g,WBK.settings.geoCity.name_vin),e.text2=e.text2.replace(/\[name\]/g,t),e.text2=e.text2.replace(/\[(.+?)\|(.+?)\]/gi,"<a href='$1' target='_blank'>$2</a>")}return e.hello_text=this.smileReplacer(e.hello_text,"to_img"),e.text1=this.smileReplacer(e.text1,"to_img"),e.text2=this.smileReplacer(e.text2,"to_img"),e},smileReplacer:function(t,n){return t?(e.each(i.smilesCodes,(function(e,i){if("to_img"==n){var a=new RegExp(i,"g");t=t.replace(a,'<img class="emoji-img" src="'+WBK.settings.staticServerUrl+"/widget/img/smiles/"+e+'.png">')}"to_code"==n&&(a=new RegExp('<img class="emoji-img" src="'+WBK.settings.staticServerUrl+"/widget/img/smiles/"+e+'.png">',"g"),t=t.replace(a,i))})),t):""},smilesInit:function(){var n=a.window.find(".ws-smile-container");e.each(i.smilesCodes,(function(e,t){n.append('<a class="ws-emoji-el" href="#"><img class="emoji-img" src="'+WBK.settings.staticServerUrl+"/widget/img/smiles/"+e+'.png"></a>')})),a.window.find(".ws-emoji-el").on("click",(function(n){n.preventDefault(),i.chat_is_online?(a.window.find(".ws-textarea").focus(),t.insertHTML(e(this).html())):a.window.find(".ws-offline-textarea").append(e(this).html()),a.window.find(".ws-textarea-send-btn").show()}))},showOffline:function(){a.window.addClass("ws-chat-offline"),a.btn.find(".ws-chat-status-online").removeClass("ws-chat-status-online"),"pc"!=WBK.settings.device?a.btn.find(".ws-btn-title").text(i.mobile_text_button_offline):a.btn.find(".ws-btn-title").text(i.text_button_offline),a.window.find(".ws-chat-title").text(i.text_button_offline),a.window.find(".ws-chat-body").hide(),a.window.find(".ws-chat-footer").hide(),a.window.find(".ws-chat-status-online").removeClass("ws-chat-status-online"),a.window.find(".ws-chat-body-offline").show(),WBK.setPhoneInputFocusForm(e(".ws-offline-phone"))},chatAutoCall:function(e,t){if(e&&i.autoCall&&WBK.settings.callbackEnabled){wsKiller.settings.callingWidget=!0;var n=new Date;n.setMinutes(n.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onchat",n),WBK.settings.phoneMask=t,wsKiller.newCall(e,!1,i.autoCallDeffered,i.autoCallDefferedDelay)}},sendOfflineMessage:function(){if(!i.offline_message_sending){i.offline_message_sending=!0,(r=a.window.find(".ws-chat-body-offline")).find(".ws-offline-textarea").removeClass("ws-input-error"),r.find(".ws-offline-input").removeClass("ws-input-error");var n=r.find(".ws-offline-name").val(),s=r.find(".ws-offline-email").val(),o=r.find(".ws-offline-phone").val();o=(o=WBK.checkPhone(o))||"";var r,l=r.find(".ws-offline-phone").attr("placeholder"),c=e(".ws-offline-email-agreement").is(":checked")?1:0,d=t.smileReplacer(t.cleanMessage(r.find(".ws-offline-textarea")),"to_code"),h="";if("yes"==i.get_contact_offline_name&&""==n.trim()&&(h=".ws-offline-name"),"yes"==i.get_contact_offline_phone&&""==o.trim()&&(h?h+=", .ws-offline-phone":h=".ws-offline-phone"),"yes"!=i.get_contact_offline_email||""!=s.trim()&&wsUtil.validateEmail(s.trim())||(h?h+=", .ws-offline-email":h=".ws-offline-email"),"yes"==i.get_contact_offline_message&&""==d.trim()&&(h?h+=", .ws-offline-textarea":h=".ws-offline-textarea"),h)return a.window.find(h).addClass("ws-input-error"),void(i.offline_message_sending=!1);(r=a.window.find(".ws-chat-body-offline")).children().not(".ws-hide").hide(),r.find(".ws-offline-textarea").text(""),r.find(".ws-chat-offline-text-success").show(),wsUtil.setTimeout("chatOfflineHide",(function(){t.hideWidget()}),3e3),i.offline_message_sending=!1;var u=(new Date).getTime(),g=wsUtil.generateHash(u,WBK.settings.visitorId),p={code:WBK.settings.whiteSaasCode,name:n.trim(),email:s.trim(),phone:o.trim(),message:d.trim(),emailAgreement:c,visitId:WBK.settings.visitId,type_show:wsUtil.getCookie("WidgetChat_shownOn"),chatWidgetId:WBK.settings.chatWidgetId,chatId:WBK.settings.chatId,url:"string"==typeof document.URL?document.URL:"",visitorId:WBK.settings.visitorId,phoneMask:l,googleClientId:wsUtil.getGoogleClientId(),roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId(),leadvertexId:wsUtil.getLeadvertexId(),externalParams:wsUtil.getExternalParams(),hashTime:u,hash:g},w=WBK.settings.serverUrl+"/api?action=chatOfflineMessage&callback=?";jWS.getJSON(w,p),"function"==typeof window.ws_OnChatOfflineMessage&&window.ws_OnChatOfflineMessage(p),t.chatAutoCall(o.trim(),l),t.sendGoal("offline_message")}},showHelloMessage:function(){var e='<div class="ws-chat-manager-join ws-chat-robot-hello"><img src="'+i.chat_widget_logo_robot+'" alt="" class="ws-manager-img"><div class="ws-manager-event" style="color:'+i.color_hello_message+'">'+i.hello_message+"</div></div>";a.window.find(".ws-chat-typing").before(e)},showHelloMessageOperators:function(){i.operators_array.sort((function(e,i){return(e=t.formatTextToDate(e.connected_at))<(i=t.formatTextToDate(i.connected_at))?1:e>i?-1:0}));var e="";if("last3"===i.hello_message_author)for(var n=0;n<i.operators_array.length;n++){var s=i.operators_array[n].user_id+"_"+i.operators_array[n].employee_id,o=i.all_operators[s].name+(i.all_operators[s].surname?"<br>"+i.all_operators[s].surname:"");if(e+='<div class="ws-chat-manager-hello-el"><img src="'+WBK.settings.staticServerUrl+i.all_operators[s].img+'" class="ws-manager-hello-img"><div class="ws-manager-name">'+o+"</div></div>",2==n)break}else if("operator"===i.hello_message_author){var r,l={};if("rand"===i.hello_message_operator){var c=[];for(r in i.all_operators)i.all_operators.hasOwnProperty(r)&&1===i.all_operators[r].status&&c.push(i.all_operators[r]);l=c[Math.floor(Math.random()*c.length)]}else{var d=[];for(r in i.all_operators)i.all_operators.hasOwnProperty(r)&&(d[i.all_operators[r].employee_id]=i.all_operators[r]);l=d[i.hello_message_operator]}e+='<div class="ws-chat-manager-hello-el"><img src="'+WBK.settings.staticServerUrl+l.img+'" class="ws-manager-hello-img"><div class="ws-manager-name">'+l.name+" "+(l.surname?l.surname:"")+"</div></div>"}var h='<div class="ws-chat-manager-join ws-chat-manager-hello"><div class="ws-chat-manager-hello-body">'+e+'</div><div class="ws-manager-event" style="color:'+i.color_hello_message+'">'+i.hello_message+"</div></div>";a.window.find(".ws-chat-typing").before(h)},operatorsUpdate:function(e){var n="";if(e){var s=e.user_id+"_"+e.employee_id;i.all_operators.hasOwnProperty(s)&&(i.all_operators[s].status=e.status)}if(a.window.removeClass("ws-chat-ico-bottom"),a.window.find(".ws-chat-ico-container").empty(),i.chat_operators)for(var o in i.chat_operators)if(i.chat_operators.hasOwnProperty(o)&&void 0!==i.all_operators[o]){var r=i.all_operators[o].name+(i.all_operators[o].surname?" "+i.all_operators[o].surname:"");parseInt(i.all_operators[o].status)&&(n+=n?", "+r:r),t.addIco(i.all_operators[o].user_id+"_"+i.all_operators[o].employee_id,i.all_operators[o].img,r,parseInt(i.all_operators[o].status))}n?a.window.find(".ws-chat-title").text(n):a.window.find(".ws-chat-title").text(i.text_button_online)},addIco:function(e,t,n,s){a.window.hasClass(".ws-chat-ico-bottom")||(a.window.addClass("ws-chat-ico-bottom"),a.window.offset().left<100?a.window.addClass("ws-chat-ico-bottom-right"):a.window.removeClass("ws-chat-ico-bottom-right"));var o="";s&&(o="ws-chat-status-online");var r='<div class="ws-chat-ico" id="ico_'+e+'" style="background-color: '+i.color_background_chat_header+';"><div class="ws-chat-logo" data-name="'+n+'"><i class="ws-icon-chat"></i><img src="'+WBK.settings.staticServerUrl+t+'" class="ws-chat-logo-img" title="'+n+'"><div class="ws-chat-status-round '+o+'"></div></div></div>';a.window.find(".ws-chat-ico-container").append(r)},updateIcoBottom:function(e){var t=a.window.find(".ws-chat-ico-container");t.find("#ico_"+e).appendTo(t)},addOldMessages:function(){for(var e=0;e<i.messages.length;e++)if(i.messages[e].message=JSON.parse(i.messages[e].message),"auto_reply"!=i.messages[e].type||i.messages[e].user_id)if("rating"!=i.messages[e].type){var n=i.messages[e].user_id?"manager":"user",a="manager"==n&&i.messages[e].user_id+"_"+i.messages[e].employee_id;t.addMessage({id:i.messages[e].id,hash:i.messages[e].hash,type:n,message:i.messages[e].message,date:i.messages[e].created_at,user:a,is_read:!!parseInt(i.messages[e].is_read),message_type:i.messages[e].type,scroll:!1}),parseInt(i.messages[e].is_read)||(i.unread_messages[i.messages[e].hash]={id:i.messages[e].id,hash:i.messages[e].hash}),"manager"==n&&(i.last_operator_data={user_id:i.messages[e].user_id,employee_id:i.messages[e].employee_id},i.send_autoreply=!0)}else t.addMessageRobot(i.messages[e]);else{var s={message:i.messages[e].message.text,type:"auto_reply"};t.addMessageRobot(s)}},addMessageRobot:function(n){if(n){var s="";switch(n.type){case"text":case"auto_reply":if(n.message=wsUtil.specialChars(n.message),n.auto_reply_get_contact){if(!parseInt(i.show_contact_form_inside_chat)){var o=i.autoreplies[n.auto_reply_index].text_btn?i.autoreplies[n.auto_reply_index].text_btn:i.lang_text.autoreply_link;n.message=n.message+'<br><div class="ws-chat-autoreply-link"><a data-index="'+n.auto_reply_index+'" class="ws-chat-autoreply-btn" href="#">'+o+"</a></div>"}var r=new Date;r.setMinutes(r.getMinutes()+43200),wsUtil.setCookie("WidgetChat_autoreply_getcontact_"+WBK.settings.chatId,!0,r)}s='<div class="ws-chat-message-source">'+n.message+"</div>";break;case"lead":case"preform":s=parseInt(i.show_contact_form_inside_chat)?'<div class="ws-chat-body-preform ws-chat-body-preform-clear"><div class="ws-chat-preform-text"></div><div class="ws-chat-preform-social"><a href="javascript:void(0)" class="ws-chat-social-el ws-chat-social-vk"><img class="ws-chat-social-img" src="'+WBK.settings.staticServerUrl+'/widget/img/vk.png"></a><a href="javascript:void(0)" class="ws-chat-social-el ws-chat-social-fb"><img class="ws-chat-social-img" src="'+WBK.settings.staticServerUrl+'/widget/img/fb.png"></a></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="text" class="ws-preform-input ws-preform-name" placeholder="'+i.lang_text.form_name_placeholder+'" value="'+i.user_name+'"></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="tel" class="ws-preform-input ws-preform-phone" placeholder="'+i.lang_text.form_phone_placeholder+'" value="'+i.user_phone+'"><input type="text" class="cbk-phone-checker white-saas-generator-input-hidden"/></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="email" class="ws-preform-input ws-preform-email" placeholder="'+i.lang_text.form_email_placeholder+'" value="'+i.user_email+'"></div><div class="ws-preform-input-group ws-preform-input-group-text"><div class="ws-preform-input-label ws-preform-email-text">'+i.lang_text.email_exit+'</div></div><div class="ws-preform-input-group ws-preform-input-group-text"><label class="ws-preform-label-agreement"><span class="ws-preform-email-agreement-text">'+i.email_agreement_text+i.lang_text.email_agreement_text_agreement+'</span></label></div><div class="ws-preform-input-group ws-preform-input-group-btn"><a href="javascript:void(0)" class="ws-preform-btn ws-preform-btn-save">'+i.lang_text.preform_btn+"</a></div></div>":'<div class="ws-chat-message-source">'+i.lang_text.preform_text+'</div><input class="ws-chat-message-input" placeholder="'+i.lang_text.form_name+'">';break;case"load":s='<div class="ws-chat-message-source">'+i.lang_text.loading+' ...</div><div class="ws-chat-progress"><div class="ws-chat-progress-bar"></div></div>';break;case"rating":t.hideRating();var l='<img class="ws-chat-message-rating-el ws-chat-message-rating-el-1" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""><img class="ws-chat-message-rating-el ws-chat-message-rating-el-2" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""><img class="ws-chat-message-rating-el ws-chat-message-rating-el-3" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""><img class="ws-chat-message-rating-el ws-chat-message-rating-el-4" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""><img class="ws-chat-message-rating-el ws-chat-message-rating-el-5" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt="">';"smiles"==i.rate_chat_view&&(l='<img class="ws-chat-message-rating-el" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt="">');var c="";switch(parseInt(n.message.rate)){case 1:c=i.lang_text.rate_text_1;break;case 2:c=i.lang_text.rate_text_2;break;case 3:c=i.lang_text.rate_text_3;break;case 4:c=i.lang_text.rate_text_4;break;case 5:c=i.lang_text.rate_text_5}s='<div class="ws-chat-message-source">'+i.lang_text.rate_result+'</div></div><div class="ws-chat-message"><div class="ws-chat-message-source"><div class="ws-chat-message-rating ws-chat-message-rating-'+i.rate_chat_view+" ws-chat-message-rating-rate-"+n.message.rate+'">'+l+"</div>"+c+"</div>"}var d='<div class="ws-chat-message-block ws-chat-message-robot"><div class="ws-chat-message-logo"><img class="ws-chat-message-logo-img" src="'+i.chat_widget_logo_robot+'"></div><div class="ws-chat-message-name"><span class="ws-chat-message-name-text" data-name="">'+i.robot_name+'</span></div><div class="ws-chat-message">'+s+"</div></div>";!parseInt(i.show_contact_form_inside_chat)||"lead"!=n.type&&"preform"!=n.type||e(".ws-chat-body-preform")&&e(".ws-chat-body-preform").closest(".ws-chat-message-robot").remove(),a.window.find(".ws-chat-typing").before(d),"load"==n.type&&a.window.find(".ws-chat-body-content .ws-chat-message-robot").last().find(".ws-chat-progress-bar").animate({width:"70%"},4e3),WBK.settings.chatWindowOpened&&t.scroll()}},sendGoal:function(e){if(!i.free_chat_widget){var t,n,a=!1,s=!1;switch(e){case"invitation_click":t="CHAT_SHOW_ON_INVITATION",n="ChatShowOnInvitation";break;case"invitation_close":t="CHAT_INVITATION_CLOSE",n="ChatInvitationClose";break;case"open":t="CHAT_SHOW_ON_BTN",n="ChatShowOnBtn";break;case"first_message":t="CHAT_FIRST_MESSAGE",n="ChatFirstMessage",a="chat";break;case"offline_message":t="CHAT_OFFLINE_MESSAGE",n=s="ChatOfflineMessage",a="chat",wsUtil.sendUniversalGoal();break;case"visitor_introduced":t="CHAT_VISITOR_INTRODUCED",n=s="ChatVisitorIntroduced",a="chat",wsUtil.sendUniversalGoal();break;case"operator_connect":t="CHAT_OPERATOR_CONNECT",n="ChatOperatorConnect"}wsUtil.sendGoal(t,n,"ChatService",a,s)}},checkAutoReply:function(e,n){for(var a=0;a<i.autoreplies.length;a++)e==i.autoreplies[a].action&&t.startAutoReply(a,n)},stopAutoReply:function(e){wsUtil.deleteTimeout("chatTypingAutoreply");for(var t=0;t<i.autoreplies.length;t++)("all"==e||e==i.autoreplies[t].action)&&wsUtil.deleteTimeout("auto_reply_"+i.autoreplies[t].id)},startAutoReply:function(n,a){if("1"==i.autoreplies[n].info_introduced&&!i.chat_introduced||"2"==i.autoreplies[n].info_introduced&&i.chat_introduced)return!1;wsUtil.setTimeout("auto_reply_"+i.autoreplies[n].id,(function(){var s=parseInt(i.autoreplies[n].get_contact)&&!wsUtil.getCookie("WidgetChat_autoreply_getcontact_"+WBK.settings.chatId)?1:0;if("not_connected"==i.autoreplies[n].action&&!i.send_autoreply_first)return!1;var o,r,l,c,d={text:i.autoreplies[n].message};"not_connected"==i.autoreplies[n].action&&(o=!1,i.invitation_operator_id&&(r=i.invitation_operator_id.split("_"),t.typing({user_id:r[0],employee_id:r[1]},20*i.autoreplies[n].message.length),o=!0),l={message:i.autoreplies[n].message,type:"auto_reply",auto_reply_get_contact:s,auto_reply_index:n},o?(l={hash:!1,message:{text:i.autoreplies[n].message},date:"",user:i.invitation_operator_id,is_read:!0,message_type:"auto_reply",type:"manager",scroll:!0,auto_reply_get_contact:s,auto_reply_index:n},wsUtil.setTimeout("auto_reply_not_connected_start",(function(){t.addMessage(l)}),21*i.autoreplies[n].message.length)):t.addMessageRobot(l),parseInt(i.show_contact_form_inside_chat)&&s&&(t.typing(i.last_operator_data,55*i.autoreplies[n].message.length),wsUtil.setTimeout("auto_reply_get_inline_contact",(function(){t.addMessageRobot({type:"lead"}),e(".ws-preform-phone").inputmasks(t.optsRU),t.showPreform("lead",n,e(this))}),55*i.autoreplies[n].message.length)),c=(new Date).getTime(),d&&t.sendNode(JSON.stringify(d),c,"auto_reply"),i.auto_reply_not_connected_and_operators_offline_showed=!0),"not_answer_operator"==i.autoreplies[n].action&&(t.typing(a,50*i.autoreplies[n].message.length,2500),wsUtil.setTimeout("chatTypingAutoreply",(function(){l={hash:!1,message:{text:i.autoreplies[n].message},date:"",user:a.user_id+"_"+a.employee_id,is_read:!0,message_type:"auto_reply",type:"manager",scroll:!0,auto_reply_get_contact:s,auto_reply_index:n},t.addMessage(l),parseInt(i.show_contact_form_inside_chat)&&s&&(t.typing(i.last_operator_data,55*i.autoreplies[n].message.length),wsUtil.setTimeout("auto_reply_get_inline_contact",(function(){t.addMessageRobot({type:"lead"}),e(".ws-preform-phone").inputmasks(t.optsRU),t.showPreform("lead",n,e(this))}),55*i.autoreplies[n].message.length)),d.user_id=a.user_id,d.employee_id=a.employee_id,c=(new Date).getTime(),d&&t.sendNode(JSON.stringify(d),c,"auto_reply")}),50*i.autoreplies[n].message.length)),"not_connected_and_operators_offline"==i.autoreplies[n].action&&(o=!1,i.invitation_operator_id&&(r=i.invitation_operator_id.split("_"),t.typing({user_id:r[0],employee_id:r[1]},20*i.autoreplies[n].message.length),o=!0),l={message:i.autoreplies[n].message,type:"auto_reply",auto_reply_get_contact:s,auto_reply_index:n},o?(l={hash:!1,message:{text:i.autoreplies[n].message},date:"",user:i.invitation_operator_id,is_read:!0,message_type:"auto_reply",type:"manager",scroll:!0,auto_reply_get_contact:s,auto_reply_index:n},wsUtil.setTimeout("auto_reply_not_connected_and_operators_offline_start",(function(){t.addMessage(l)}),21*i.autoreplies[n].message.length)):t.addMessageRobot(l),parseInt(i.show_contact_form_inside_chat)&&s&&(t.typing(i.last_operator_data,55*i.autoreplies[n].message.length),wsUtil.setTimeout("auto_reply_get_inline_contact",(function(){t.addMessageRobot({type:"lead"}),e(".ws-preform-phone").inputmasks(t.optsRU),t.showPreform("lead",n,e(this))}),55*i.autoreplies[n].message.length)),c=(new Date).getTime(),d&&t.sendNode(JSON.stringify(d),c,"auto_reply"))}),1e3*parseInt(i.autoreplies[n].time))},initRating:function(){a.container.find(".ws-chat-rating-btns a").on("mouseenter.wbk_chat",(function(){if("stars"==i.rate_chat_view)for(var t=e(this).data("value"),n=1;n<=t;n++)a.container.find("a.ws-chat-rating-el-"+n).addClass("ws-chat-rating-el-marked");else e(this).addClass("ws-chat-rating-el-marked")})).on("mouseleave.wbk_chat",(function(){a.container.find("a.ws-chat-rating-el").removeClass("ws-chat-rating-el-marked")}))},checkRatingSettings:function(){if(WBK.settings.chatId&&parseInt(i.rate_chat)&&!parseInt(i.chatRate)&&!this.ratingIsVisible()&&i.messages_quant_to_rate>=parseInt(i.rate_chat_messages_quant)){for(var n=1;n<=5;n++)e(new Image).attr("src",WBK.settings.staticServerUrl+"/widget/img/rating/24/smile_"+n+".png").load((function(){})),e(new Image).attr("src",WBK.settings.staticServerUrl+"/widget/img/rating/32/smile_"+n+".png").load((function(){}));wsUtil.setTimeout("showRating",(function(){t.showRating()}),500),a.container.find(".ws-chat-rating-btns a").unbind("click").on("click",(function(){i.chatRate=e(this).data("value"),t.hideRating(),t.send({message:{rate:e(this).data("value")},type:"rating",scroll:!0})}))}},ratingIsVisible:function(){return a.container.hasClass("ws-chat-has-rating")},showRating:function(){a.container.addClass("ws-chat-has-rating"),WBK.animateFastOnce(a.container.find(".ws-chat-rating"),"cbk-fadeIn")},hideRating:function(){a.container.removeClass("ws-chat-has-rating")},sendNode:function(e,n,a,s){googleRegistrationIds=[];var o=0;if(i.chat_created){if(jWS.isEmptyObject(i.chat_operators))for(o in i.all_operators)i.all_operators[o].gcm_registration_id&&googleRegistrationIds.push(i.all_operators[o].gcm_registration_id);else for(o in i.chat_operators)i.chat_operators[o].gcm_registration_id&&googleRegistrationIds.push(i.chat_operators[o].gcm_registration_id);t.message(e,n,a,googleRegistrationIds)}else{for(o in i.all_operators)i.all_operators[o].gcm_registration_id&&googleRegistrationIds.push(i.all_operators[o].gcm_registration_id);i.invitation_show_data&&((e=JSON.parse(e)).invitation=!0,e.invitation_data=i.invitation_show_data,i.invitation_show_data=!1,e=JSON.stringify(e)),"function"!=typeof s&&(s=function(){}),t.create(e,n,a,googleRegistrationIds,s)}"auto_reply"!=a&&"open_window"!=a&&"close_window"!=a&&t.getAutoReply(),i.is_first_message=!1},getAutoReply:function(){if(!i.free_chat_widget&&i.autoreplies)if(jWS.isEmptyObject(i.chat_operators)){if(operators=wsChat.settings.all_operators,operators)for(var e in operators){if(!(null==operators[e].connected_at&&null==operators[e].disconnected_at||operators[e].connected_at&&operators[e].disconnected_at)){operators_offline=!1;break}operators_offline=!0}i.is_first_message&&(operators_offline?t.checkAutoReply("not_connected_and_operators_offline"):t.checkAutoReply("not_connected"))}else i.last_operator_data&&i.send_autoreply&&(t.checkAutoReply("not_answer_operator",i.last_operator_data),i.send_autoreply=!1)},send:function(e){var n,s=(new Date).getTime();if(n=JSON.stringify(e.message),"rating"==e.type?t.addMessageRobot(e):t.addMessage({hash:s,type:"user",message:e.message,date:!1,user:!1,is_read:!1,message_type:e.type,scroll:e.scroll}),i.is_first_message&&t.sendGoal("first_message"),i.is_first_message&&parseInt(i.get_contact))if(i.user_name||i.user_email||i.user_phone){var o=!1;"yes"==i.get_contact_name&&""==i.user_name&&(o=!0),"yes"==i.get_contact_email&&""==i.user_email&&(o=!0),"yes"==i.get_contact_phone&&""==i.user_phone&&(o=!0),o?(i.first_message={message:n,hash:s,type:e.type},t.getContactRobot()):(a.window.find(".ws-textarea").html(""),t.sendNode(n,s,e.type))}else i.first_message={message:n,hash:s,type:e.type},t.getContactRobot();else"rating"!=e.type&&a.window.find(".ws-textarea").html(""),t.sendNode(n,s,e.type);t.inputScroll()},getContactRobot:function(){t.addMessageRobot({type:"preform"}),parseInt(i.show_contact_form_inside_chat)&&(e(".ws-preform-phone").inputmasks(t.optsRU),t.showPreform("preform")),"no"==i.get_contact_can_refuse?(a.window.find(".ws-textarea").html(i.lang_text.block_input).attr("contenteditable",!1),a.window.find(".ws-textarea-group").addClass("ws-textarea-group-hide")):i.first_message&&(t.sendNode(i.first_message.message,i.first_message.hash,i.first_message.type),i.first_message=!1),parseInt(i.show_contact_form_inside_chat)&&t.stopAutoReply("not_connected")},sendMessage:function(){var n;if(n=t.formatMessage(e(".ws-textarea"))){for(var s=0;s<n.length;s++)""!=n[s].message.text&&t.send({message:n[s].message,type:n[s].type,data:n[s].data,scroll:!0});i.is_first_message||a.window.find(".ws-textarea").html(""),this.checkRatingSettings()}},inputScroll:function(){a.window.find(".ws-textarea")[0].scrollHeight>92&&!i.input_scroll?i.input_scroll=!0:a.window.find(".ws-textarea")[0].scrollHeight<=92&&i.input_scroll&&(i.input_scroll=!1);var e=a.window.find(".ws-textarea").outerHeight();if(i.height_input!=e){var n=62;56==e?n=76:74==e?n=94:e>=92&&(n=112),a.window.find(".ws-chat-body").css("bottom",n),i.height_input=e,t.scroll()}a.window.find(".ws-textarea-group").nanoScroller(),a.window.find(".ws-textarea-group").nanoScroller({scrollBottom:0})},insertHTML:function(e){if(-1!=navigator.appName.indexOf("Internet Explorer"))if(document.selection)(t=document.selection.createRange()).pasteHTML&&t.pasteHTML(e);else{var t=document.getSelection().getRangeAt(0),i=document.createElement("span");t.surroundContents(i),i.innerHTML=e,t.collapse(!1)}else e&&document.execCommand("insertHtml",!1,e)},uploadFile:function(n){if(i.fileUploadedCount<5){var a,s=new FormData;switch(n){case"doc":a=e(".ws-file-doc-upload")[0].files[0];break;case"img":a=e(".ws-file-img-upload")[0].files[0],s.append("image_type","image")}if(!a)return;s.append(n,a),s.append("type",n),s.append("chat_id",WBK.settings.chatId),t.uploadFileServer(s,n)}},uploadFileServer:function(i,n){t.addMessageRobot({type:"load"}),e.ajax({type:"POST",url:WBK.settings.serverUrl+"/chat/api/?action=uploadFile",processData:!1,contentType:!1,crossDomain:!0,data:i,dataType:"json",success:function(i){switch(n){case"doc":e(".ws-file-doc-upload").val("");break;case"img":e(".ws-file-img-upload").val("")}a.window.find(".ws-chat-body-content .ws-chat-message-robot").last().find(".ws-chat-progress-bar").stop().animate({width:"100%"},500,(function(){if(a.window.find(".ws-chat-body-content .ws-chat-message-robot").last().remove(),"success"===i.status)switch(n){case"doc":var e={message:{file_ico_url:"widget/img/"+i.ico+".png",file_name:i.original_name,file_name_upload:i.save_name,file_size:i.size,file_size_type:i.size_type},type:"attach_file",scroll:!0};t.addFileUploaded(e);break;case"img":e={message:{img_url:WBK.settings.staticServerUrl+"/"+i.path,file_name:i.original_name,file_name_upload:i.save_name,img_type:"uploaded"},type:"attach_image",scroll:!0},t.addFileUploaded(e)}else t.addMessageRobot({type:"text",message:i.message})}))}})},addFileUploaded:function(e){e&&(i.fileUploaded[(new Date).getTime()]=e,t.updateFilesUploaded())},updateFilesUploaded:function(){e(".ws-chat-uploaded-files").empty();var t=0;e.isEmptyObject(i.fileUploaded)||e.each(i.fileUploaded,(function(i,n){var a,s,o="";switch(n.type){case"attach_image":o="img",a=n.message.img_url,s=WBK.settings.serverUrl+"/chat/download/?type=image&file="+n.message.file_name_upload+"&filename="+n.message.file_name+"&chat="+WBK.settings.chatId;break;case"attach_file":o="file",a=WBK.settings.staticServerUrl+"/"+n.message.file_ico_url,s=WBK.settings.serverUrl+"/chat/download/?type=doc&file="+n.message.file_name_upload+"&filename="+n.message.file_name+"&chat="+WBK.settings.chatId}var r='<div class="ws-chat-uploaded-el" data-index="'+i+'"><div class="ws-chat-uploaded-el-close"><i class="ws-icon-close"></i></div><a class="ws-chat-uploaded-url" href="'+s+'" target="_blank"><img class="ws-chat-uploaded-'+o+'" src="'+a+'"></a></div>';e(".ws-chat-uploaded-files").append(r),t++})),t>0?a.window.find(".ws-textarea-send-btn").show():""==e(".ws-textarea").html()&&a.window.find(".ws-textarea-send-btn").hide(),this.typingPositionUpdate(),i.fileUploadedCount=t},showPreform:function(t,n){null==n&&(n=!1),parseInt(i.show_contact_form_inside_chat)||(a.window.find(".ws-chat-body").hide(),a.window.find(".ws-chat-footer").hide()),a.window.find(".ws-preform-name").closest(".ws-preform-input-group").removeClass("ws-hide"),a.window.find(".ws-preform-email").closest(".ws-preform-input-group").removeClass("ws-hide"),a.window.find(".ws-preform-phone").closest(".ws-preform-input-group").removeClass("ws-hide"),parseInt(i.show_introduce_social_button)||a.window.find(".ws-chat-preform-social").hide();var s="hide",o="hide",r="hide";switch(t){case"preform":s=i.get_contact_name,r=i.get_contact_phone,o=i.get_contact_email;break;case"lead":s=i.autoreplies[n].get_name,r=i.autoreplies[n].get_phone,o=i.autoreplies[n].get_email}a.window.find(".ws-chat-preform-text").text(i.lang_text.preform_text),"hide"==s?a.window.find(".ws-preform-name").closest(".ws-preform-input-group").addClass("ws-hide"):a.window.find(".ws-preform-name").closest(".ws-preform-input-group").find(".ws-preform-input-label").html(i.lang_text.form_name+'<span class="ws-input-required">'+("yes"==s?" *":"</span>")),"hide"==r?a.window.find(".ws-preform-phone").closest(".ws-preform-input-group").addClass("ws-hide"):a.window.find(".ws-preform-phone").closest(".ws-preform-input-group").find(".ws-preform-input-label").html(i.lang_text.form_phone+'<span class="ws-input-required">'+("yes"==r?" *":"</span>")),"hide"==o?(a.window.find(".ws-preform-email").closest(".ws-preform-input-group").addClass("ws-hide"),a.window.find(".ws-preform-email-text").closest(".ws-preform-input-group").addClass("ws-hide")):(a.window.find(".ws-preform-email").closest(".ws-preform-input-group").find(".ws-preform-input-label").html(i.lang_text.form_email+'<span class="ws-input-required">'+("yes"==o?" *":"</span>")),"lead"==t&&a.window.find(".ws-preform-email-text").closest(".ws-preform-input-group").addClass("ws-hide")),parseInt(i.email_agreement)||a.window.find(".ws-preform-label-agreement").closest(".ws-preform-input-group").addClass("ws-hide"),a.window.find(".ws-preform-btn-save").data("type",t).data("index",n),parseInt(i.show_contact_form_inside_chat)||a.window.find(".ws-chat-body-preform").show(),WBK.setPhoneInputFocusForm(e(".ws-preform-phone")),"yes"==s&&""==e(".ws-preform-name").val().trim()?e(".ws-preform-name").focus():"yes"!=r||""!=e(".ws-preform-phone").val().trim()&&e(".ws-preform-phone").val().trim()!=WBK.settings.phoneBase?"yes"!=o||""!=e(".ws-preform-email").val().trim()&&wsUtil.validateEmail(e(".ws-preform-email").val().trim())?wsUtil.setCaretPosition(e(".ws-preform-name"),e(".ws-preform-name").val().length):e(".ws-preform-email").focus():e(".ws-preform-phone").focus(),"lead"==t&&parseInt(i.show_contact_form_inside_chat)&&(a.window.find(".ws-preform-input-group:not(.ws-hide):first").css("margin-top","0px"),a.window.find(".ws-chat-preform-text").hide()),i.agreementLink&&a.window.find(".ws-chat-agreement-link").attr("href",i.agreementLink)},hidePreform:function(){i.is_first_message&&i.first_message&&"no"!=i.get_contact_can_refuse&&t.addMessageRobot({type:"preform"}),a.window.find(".ws-chat-body").show(),a.window.find(".ws-chat-footer").show(),a.window.find(".ws-chat-body-preform").hide(),t.scroll()},savePreform:function(n,s,o){null==n&&(n="preform"),null==s&&(s=!1);var r="hide",l="hide",c="hide";switch(n){case"preform":r=i.get_contact_name,c=i.get_contact_phone,l=i.get_contact_email;break;case"lead":t.stopAutoReply("all"),r=i.autoreplies[s].get_name,c=i.autoreplies[s].get_phone,l=i.autoreplies[s].get_email}a.window.find(".ws-preform-name, .ws-preform-phone, .ws-preform-email").removeClass("ws-input-error");var d=a.window.find(".ws-preform-name").val(),h=a.window.find(".ws-preform-phone").val();h=(h=WBK.checkPhone(h))||"";var u=a.window.find(".ws-preform-email").val(),g=e(".ws-preform-email-agreement").is(":checked")?1:0,p=a.window.find(".ws-preform-phone").attr("placeholder"),w="";if("yes"==r&&""==d.trim()&&(w=".ws-preform-name"),"yes"==c&&""==h.trim()&&(w?w+=", .ws-preform-phone":w=".ws-preform-phone"),"yes"!=l||""!=u.trim()&&wsUtil.validateEmail(u.trim())||(w?w+=", .ws-preform-email":w=".ws-preform-email"),w)a.window.find(w).addClass("ws-input-error");else{"lead"==n&&(e(".ws-chat-autoreply-link").closest(".ws-chat-message-robot").remove(),e(".ws-chat-autoreply-link").remove()),d&&(WBK.settings.visitorName=d.charAt(0).toUpperCase()+d.substr(1,d.length-1)),u&&(WBK.settings.visitorEmail=u),h&&(WBK.settings.visitorPhone=h),t.updateUser();var f="";"preform"==n&&d?f=i.user_name+", "+i.lang_text.preform_text_success:"preform"==n?f=(f=i.lang_text.preform_text_success).charAt(0).toUpperCase()+f.substr(1):"lead"==n&&d?f=i.user_name+", "+i.lang_text.preform_lead_text_success:"lead"==n&&(f=(f=i.lang_text.preform_lead_text_success).charAt(0).toUpperCase()+f.substr(1)),t.addMessageRobot({type:"text",message:f}),a.window.find(".ws-chat-message-input").closest(".ws-chat-message-robot").remove(),t.hidePreform();var m="";document.URL&&(m=encodeURIComponent(document.URL));var v=(new Date).getTime(),_=wsUtil.generateHash(v,WBK.settings.visitorId),b=WBK.settings.serverUrl+"/api?action=chatSavePreform&callback=?",k={code:WBK.settings.whiteSaasCode,url:m,name:d,email:u,phone:h,emailAgreement:g,type_preform:n,type:i.auth_type,image_url:i.logo_visitor,vk_id:i.visitor_vk_id,fb_id:i.visitor_fb_id,fb_token:i.visitor_fb_token,visitId:WBK.settings.visitId,visitorId:WBK.settings.visitorId,chatWidgetId:WBK.settings.chatWidgetId,chatId:WBK.settings.chatId,phoneMask:p,googleClientId:wsUtil.getGoogleClientId(),roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId(),leadvertexId:wsUtil.getLeadvertexId(),externalParams:wsUtil.getExternalParams(),hashTime:v,hash:_};i.is_first_message&&i.first_message?(t.sendNode(i.first_message.message,i.first_message.hash,i.first_message.type,(function(){k.chatId=WBK.settings.chatId,e.getJSON(b,k)})),i.first_message=!1,a.window.find(".ws-textarea").attr("contenteditable",!0).html(""),a.window.find(".ws-textarea-group").removeClass("ws-textarea-group-hide")):(a.window.find(".ws-textarea").attr("contenteditable",!0).html(""),a.window.find(".ws-textarea-group").removeClass("ws-textarea-group-hide"),e.getJSON(b,k)),"function"==typeof window.ws_OnChatVisitorIntroduced&&window.ws_OnChatVisitorIntroduced(k),t.chatAutoCall(h.trim(),p),t.sendGoal("visitor_introduced"),null!=o&&o.closest(".ws-chat-message-robot").remove()}},formatTextToDate:function(e){var t=new Date;if(e){var n=e.split(/[- :]/),a=(t=new Date(n[0],n[1]-1,n[2],n[3],n[4],n[5])).getTimezoneOffset();a=(a<0?"+":"-")+Math.abs(a),t.setTime(t.getTime()+60*a*1e3-60*i.chat_timezone*60*1e3)}return t},dateFormat:function(e){var n={new_block:!1,date_line:!1},a=t.formatTextToDate(e),s=new Date,o=function(e){return(e+"").length<2?"0"+e:e},r=!1;return i.chat_old_time?(r=i.chat_old_time<a&&Math.ceil((a-i.chat_old_time)/6e4),i.chat_old_time.getFullYear()==a.getFullYear()&&i.chat_old_time.getMonth()==a.getMonth()&&i.chat_old_time.getDate()==a.getDate()||(i.chat_old_time.getFullYear()!=a.getFullYear()?n.date_line=i.lang_text.dayNames[a.getDay()]+", "+a.getDate()+" "+i.lang_text.monthNames[a.getMonth()]+" "+a.getFullYear():n.date_line=i.lang_text.dayNames[a.getDay()]+", "+a.getDate()+" "+i.lang_text.monthNames[a.getMonth()])):(r=s>a&&Math.ceil((s-a)/6e4),s.getFullYear()==a.getFullYear()&&s.getMonth()==a.getMonth()&&s.getDate()==a.getDate()||(s.getFullYear()!=a.getFullYear()?n.date_line=i.lang_text.dayNames[a.getDay()]+", "+a.getDate()+" "+i.lang_text.monthNames[a.getMonth()]+" "+a.getFullYear():n.date_line=i.lang_text.dayNames[a.getDay()]+", "+a.getDate()+" "+i.lang_text.monthNames[a.getMonth()])),i.chat_old_time=a,r&&r>5&&(n.new_block=!0),a.getDay()==s.getDay()?(n.time=o(a.getHours())+":"+o(a.getMinutes()),n):(n.time=o(a.getDate())+"."+o(a.getMonth()+1)+"."+(a.getFullYear()+"").substr(2),n)},formatMessage:function(n){if(!n)return"";var a=t.cleanMessage(n),s=[];e.isEmptyObject(i.fileUploaded)||(e.each(i.fileUploaded,(function(e,t){s.push(t)})),i.fileUploaded={},t.updateFilesUploaded());var o=a.match(/(?!((.+)\/widget\/img\/smiles\/(\w+).png))(https?:\/\/[\w\-\.]+\.[a-zA-Z]{2,6}(?:\/\S*)?(?:[\w])+\.(?:jpg|png|gif|jpeg|bmp))/gi);if(o){for(var r=0;r<o.length;r++){var l=a.indexOf(o[r]);s.push({message:{text:t.textUrlFormat(a.slice(0,l))},type:"text"}),s.push({message:{img_url:o[r],file_name:"",file_name_upload:"",img_type:"link"},type:"attach_image"}),a=a.slice(l,a.length).replace(o[r],"")}a&&s.push({message:{text:t.textUrlFormat(a)},type:"text"})}else s.push({message:{text:t.textUrlFormat(a)},type:"text"});return s},textUrlFormat:function(e){var t=!1,i=!1;return e=(e||"").replace(/(^|[^A-Za-z0-9А-Яа-яёЁ\-\_])(https?:\/\/)?((?:[A-Za-z\$0-9А-Яа-яёЁ](?:[A-Za-z\$0-9\-\_А-Яа-яёЁ]*[A-Za-z\$0-9А-Яа-яёЁ])?\.){1,5}[A-Za-z\$рфуконлайнстРФУКОНЛАЙНСТ\-\d]{2,22}(?::\d{2,5})?)((?:\/(?:(?:\&amp;|\&#33;|,[_%]|[A-Za-z0-9А-Яа-яёЁ\-\_#%?+\/\$.~=;:]+|\[[A-Za-z0-9А-Яа-яёЁ\-\_#%?+\/\$.,~=;:]*\]|\([A-Za-z0-9А-Яа-яёЁ\-\_#%?+\/\$.,~=;:]*\))*(?:,[_%]|[A-Za-z0-9А-Яа-яёЁ\-\_#%?+\/\$.~=;:]*[A-Za-z0-9А-Яа-яёЁ\_#%?+\/\$~=]|\[[A-Za-z0-9А-Яа-яёЁ\-\_#%?+\/\$.,~=;:]*\]|\([A-Za-z0-9А-Яа-яёЁ\-\_#%?+\/\$.,~=;:]*\)))?)?)/gi,(function(){var e=Array.prototype.slice.apply(arguments),i=e[1]||"",n=e[2]||"http://",a=e[3]||"",s=a+(e[4]||""),o=(e[2]||"")+e[3]+e[4];if(-1==a.indexOf(".")||-1!=a.indexOf(".."))return e[0];var r=a.split(".").pop();if(s.indexOf("widget/img/smiles/")+1>0||-1!=e[0].indexOf("@"))return e[0];if((r.length>12||-1=="info,name,academy,aero,arpa,coop,media,museum,mobi,travel,xxx,asia,biz,com,net,org,gov,mil,edu,int,tel,ac,ad,ae,af,ag,ai,al,am,an,ao,aq,ar,as,at,au,aw,ax,az,ba,bb,bd,be,bf,bg,bh,bi,bj,bm,bn,bo,br,bs,bt,bv,bw,by,bz,ca,cc,cd,cf,cg,ch,ci,ck,cl,cm,cn,co,cr,cu,cv,cx,cy,cz,de,dj,dk,dm,do,dz,ec,ee,eg,eh,er,es,et,eu,fi,fj,fk,fm,fo,fr,ga,gd,ge,gf,gg,gh,gi,gl,gm,gn,gp,gq,gr,gs,gt,gu,gw,gy,hk,hm,hn,hr,ht,hu,id,ie,il,im,in,io,iq,ir,is,it,je,jm,jo,jp,ke,kg,kh,ki,km,kn,kp,kr,kw,ky,kz,la,lb,lc,li,lk,lr,ls,lt,lu,lv,ly,ma,mc,md,me,mg,mh,mk,ml,mm,mn,mo,mp,mq,mr,ms,mt,mu,mv,mw,mx,my,mz,na,nc,ne,nf,ng,ni,nl,no,np,nr,nu,nz,om,pa,pe,pf,pg,ph,pk,pl,pm,pn,pr,ps,pt,pw,py,qa,re,ro,ru,rs,rw,sa,sb,sc,sd,se,sg,sh,si,sj,sk,sl,sm,sn,so,sr,ss,st,su,sv,sx,sy,sz,tc,td,tf,tg,th,tj,tk,tl,tm,tn,to,tp,tr,tt,tv,tw,tz,ua,ug,uk,um,us,uy,uz,va,vc,ve,vg,vi,vn,vu,wf,ws,ye,yt,yu,za,zm,zw,рф,укр,сайт,онлайн,срб,cat,pro,local,xn--p1ai,xn--80aswg,xn--80asehdb".split(",").indexOf(r))&&(!/^[a-zA-Z]+$/.test(r)||!e[2]))return e[0];try{o=decodeURIComponent(o)}catch(e){}return t=!0,i+'<a class="ws-chat-message-link" href="'+n+s+'" target="_blank">'+o+"</a>"})),e=e.replace(/([a-zA-ZА-Яа-яёЁ\-_\.0-9]+@[a-zA-ZА-Яа-яёЁ\-_0-9]+\.[a-zA-ZА-Яа-яёЁ\-_\.0-9]+[a-zA-ZА-Яа-яёЁ\-_0-9]+)/g,(function(e){return i=!0,'<a class="ws-chat-message-link ws-chat-message-email ws-chat-message-email-from-user" href="mailto:'+e+'" target="_blank">'+e+"</a>"})),i||t||(e=e.replace(/\+?\d+((\d+|-+| +|\(+|\)+){6,})\d+/g,(function(e){return'<a class="ws-chat-message-link ws-chat-message-phone ws-chat-message-phone-from-user" href="javascript:void(0)" target="_blank">'+e+"</a>"}))),e},cleanTextToApp:function(e){return e=(e=e.replace(/^\n|\n$/g," ").replace(/[\n\xa0]/g," ").replace(/[ ]+/g," "))?e.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">").replace(/"/g,'"').replace(/'/g,"'"):""},cleanMessage:function(i){if(!i)return"";i=i instanceof e?i[0].firstChild:i.firstChild;for(var n="",a=new RegExp("^(DIV|P|LI|OL|TR|TD|BLOCKQUOTE|SCRIPT)$");i;){switch(i.nodeType){case 3:n+=s=this.cleanTextToApp(i.data);break;case 1:var s=t.cleanMessage(i);if(i.tagName&&i.tagName.match(a)&&s){"\n"!=s.substr(-1)&&(s+="\n");for(var o=i.previousSibling;o&&3==o.nodeType&&""==e.trim(o.nodeValue);)o=o.previousSibling;!o||o.tagName&&o.tagName.match(a)||(s="\n"+s)}else"IMG"==i.tagName?s+=i.outerHTML:"BR"==i.tagName&&(s+="\n");n+=s}i=i.nextSibling}return e.trim(n)},create:function(e,n,a,s,o){var r=this;if(i.chatCreating)wsUtil.setInterval("chatCreating_"+n,(function(o){i.chatCreating||(wsUtil.deleteInterval("chatCreating_"+n),t.message(e,n,a,s))}),1e3);else{i.chatCreating=!0;var l=WBK.settings.serverUrl+"/api?action=chatCreate&callback=?";jWS.getJSON(l,{code:WBK.settings.whiteSaasCode,visitorName:WBK.settings.visitorName?WBK.settings.visitorName:"",message:e,type:a,hash:n,type_show:wsUtil.getCookie("WidgetChat_shownOn"),visitorId:WBK.settings.visitorId,chatWidgetId:WBK.settings.chatWidgetId,googleClientId:wsUtil.getGoogleClientId(),roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId(),leadvertexId:wsUtil.getLeadvertexId(),externalParams:wsUtil.getExternalParams()},(function(t){if(t.Success&&t.Data&&t.Data.chat){for(var l=0;l<i.invitations.length;l++)wsUtil.deleteInterval("invitationShow_"+l);WBK.settings.chatId=t.Data.chat.id,i.chat_visitor_color=t.Data.chat.color,i.chat_visitor_name=t.Data.chat.visitor_name,i.chat_visitor_img=t.Data.chat.img,i.chat_introduced=t.Data.chat.introduced;var c={chat_id:WBK.settings.chatId,chat_widget_id:t.Data.chat.chat_widget_id,visitor_name:WBK.settings.visitorName?WBK.settings.visitorName:t.Data.chat.visitor_name,color:t.Data.chat.color,img:t.Data.chat.img,created_at:t.Data.chat.created_at,message_id:t.Data.messageId,hash:n,message:e,type:a,site:t.Data.chat.site,googleRegistrationIds:s,fcmData:r.getFcmData(e,!0),introduced:t.Data.chat.introduced,introduce_type:t.Data.chat.introduce_type,users_to_notification:t.Data.chat.users_to_notification};WBK.settings.socket?i.chat_created||(i.chatCreatedCrazyCycle=0,c.iteration=i.chatCreatedCrazyCycle,WBK.settings.socket.emit("chatCreated",c),wsUtil.setInterval("chatCreatedCrazyCycle",(function(e){i.chatCreatedCrazyCycle++,c.iteration=i.chatCreatedCrazyCycle,WBK.settings.socket&&WBK.settings.socket.emit("chatCreated",c),(i.chatCreatedCrazyCycle>10||!WBK.settings.socket)&&wsUtil.deleteInterval("chatCreatedCrazyCycle")}),5e3),i.chat_created=!0):WBK.initSocket((function(){i.chat_created||(i.chatCreatedCrazyCycle=0,c.iteration=i.chatCreatedCrazyCycle,WBK.settings.socket.emit("chatCreated",c),wsUtil.setInterval("chatCreatedCrazyCycle",(function(e){i.chatCreatedCrazyCycle++,c.iteration=i.chatCreatedCrazyCycle,WBK.settings.socket&&WBK.settings.socket.emit("chatCreated",c),(i.chatCreatedCrazyCycle>10||!WBK.settings.socket)&&wsUtil.deleteInterval("chatCreatedCrazyCycle")}),5e3),i.chat_created=!0)})),i.chatCreating=!1,"function"==typeof o&&o()}}))}},start:function(){if(WBK.settings.chatId){var e="";document.URL&&(e=encodeURIComponent(document.URL)),WBK.settings.socket?(WBK.settings.socket.emit("chatStarted",{chat_id:WBK.settings.chatId,visitor_name:WBK.settings.visitorName,url:e}),i.chat_created=!0):WBK.initSocket((function(){WBK.settings.socket.emit("chatStarted",{chat_id:WBK.settings.chatId,visitor_name:WBK.settings.visitorName,url:e}),i.chat_created=!0}))}},printing:function(e){WBK.settings.socket&&WBK.settings.chatId&&WBK.settings.socket.emit("printing",{chat_id:WBK.settings.chatId,message:e})},message:function(e,t,i,n){var a={message:JSON.parse(e)};a.message_type=i,WBK.settings.socket&&WBK.settings.chatId&&WBK.settings.socket.emit("message",{chat_id:WBK.settings.chatId,message:e,hash:t,type:i,googleRegistrationIds:n,fcmData:this.getFcmData(a,!1)})},getFcmData:function(e,t){var n=WBK.settings.visitorName?WBK.settings.visitorName:i.user_name?i.user_name:i.chat_visitor_name,a="Новое сообщение",s="";switch(s="default"!=i.auth_type?i.logo_visitor:i.chat_visitor_img?i.chat_visitor_img:WBK.settings.serverUrl+"/firstletter/?name="+encodeURI(n.substr(0,1))+"&color="+i.chat_visitor_color,e.message_type){case"show_invitation":case"text":a=e.message.text.replace(/(?:\r\n|\r|\n)/g,"<br />");break;case"attach_image":a="Посетитель отправил изображение";break;case"attach_file":a="Посетитель отправил документ";break;case"rating":a="Посетитель оценил работу оператора";break;case"introduced":a="Посетитель представился"}return{is_first:t,chat_id:WBK.settings.chatId,visitor_id:WBK.settings.visitorId,name:n,message:a,color:i.chat_visitor_color,introduced:i.chat_introduced,auth_type:i.auth_type,image:s,vk_id:i.visitor_vk_id,fb_id:i.visitor_fb_id}},messageReceived:function(e){WBK.settings.socket&&WBK.settings.socket.emit("messageReceived",e)},messageRead:function(e){WBK.settings.socket&&WBK.settings.socket.emit("messageRead",e)},messageReadVisitor:function(e){for(var n in i.unread_messages)e||t.messageRead(i.unread_messages[n]),delete i.unread_messages[n];t.setUnreadMessages(0)},messageReadOperator:function(t){var n=a.window.find(".ws-chat-body-content").find("#mess_"+t);n.data("read",!0);var s=n.closest(".ws-chat-message-block"),o=s.find(".ws-chat-message");if(o.length){var r=!0;o.each((function(t,i){0==e(i).data("read")&&(r=!1)})),r&&s.find(".ws-chat-message-status").text(i.lang_text.is_read)}},setUnreadMessages:function(n){var s=e('link[rel="shortcut icon"], link[rel="icon"]');if(n>99&&(n=99),wsUtil.deleteInterval("unreadMessages"),0==n)return a.btn.find(".ws-btn-badge").text("").hide(),i.unread_messages_count=0,document.title=i.document_title,i.new_favicon_href="",void(i.document_favicon_href&&s.attr("href",i.document_favicon_href));if(a.btn.find(".ws-btn-badge").text(n).show(),i.document_favicon_href){var o=e('<img crossOrigin="anonymous" src="'+i.document_favicon_href+'"/>');o.load((function(){i.new_favicon_href=t.generateFavicon(o,n),wsUtil.setInterval("unreadMessages",(function(){i.document_title==document.title?(document.title=wsUtil.doEnding(n,i.lang_text.one_new_mess,i.lang_text.two_new_mess,i.lang_text.five_new_mess),i.new_favicon_href&&s.attr("href",i.new_favicon_href)):(document.title=i.document_title,i.document_favicon_href&&s.attr("href",i.document_favicon_href))}),1e3)})).error((function(){wsUtil.setInterval("unreadMessages",(function(){i.document_title==document.title?document.title=n+" "+wsUtil.doEnding(n,i.lang_text.one_new_mess,i.lang_text.two_new_mess,i.lang_text.five_new_mess):document.title=i.document_title}),1e3)}))}else wsUtil.setInterval("unreadMessages",(function(){i.document_title==document.title?document.title=n+" "+wsUtil.doEnding(n,i.lang_text.one_new_mess,i.lang_text.two_new_mess,i.lang_text.five_new_mess):document.title=i.document_title}),1e3)},generateFavicon:function(t,n){if(i.document_favicon_href){var a,s=e("<canvas/>");if(e('link[rel="shortcut icon"], link[rel="icon"]'),s[0].getContext("2d")){s[0].height=s[0].width=t[0].width,a=s[0].getContext("2d"),n&&(a.globalAlpha=.4,n<10?n=" "+n:n>100&&(n=99));var o=t[0].width/16,r=11*o,l=o,c=11*o,d=o,h=2*o;return a.drawImage(t[0],0,0),a.globalAlpha=1,a.font="bold "+r+'px "helvetica", sans-serif',a.shadowColor="#FFF",a.shadowBlur=h,a.shadowOffsetX=0,a.shadowOffsetY=0,a.fillStyle="#FFF",a.fillText(n,l,c),a.fillText(n,l+d,c),a.fillText(n,l,c+d),a.fillText(n,l+d,c+d),a.fillStyle="#000",a.fillText(n,l+d/2,c+d/2),s[0].toDataURL("image/png")}}},scroll:function(){var e=a.window.find(".ws-chat-body");e[0].hasOwnProperty("nanoscroller")&&(e.nanoScroller(),e.nanoScroller({scrollBottom:0}))},initBtnPosition:function(){var e={},n={};if(a.btn.show(),"pc"!=WBK.settings.device)"hide"!=i.button_location&&t.updateBtnPositionMobile();else{switch(i.button_location){case"horizontal":switch(i.position_x){case"left":e.left=i.position_x_value+"%",e.right="auto",a.invitation.addClass("ws-chat-invitation-left");break;case"right":e.right=i.position_x_value+"%",e.left="auto"}switch(i.position_y){case"bottom":e.bottom=i.position_y_value+"%",e.top="auto",0==i.position_y_value&&a.btn.addClass("ws-chat-btn-attach"),WBK.addStyles(".ws-chat .ws-chat-invitation-container:after{border-top-color: "+i.color_background_invitation+" !important;}");break;case"top":e.top=i.position_y_value+"%",e.bottom="auto",0==i.position_y_value&&(a.btn.addClass("ws-chat-btn-attach-top"),a.btn.find(".ws-btn-badge").css("top","32px")),a.invitation.addClass("ws-chat-invitation-bottom"),WBK.addStyles(".ws-chat .ws-chat-invitation-container:after{border-bottom-color: "+i.color_background_invitation+" !important;}")}break;case"vertical_left":a.btn.addClass("ws-chat-btn-rotate").addClass("ws-chat-btn-attach-top"),a.btn.find(".ws-btn-badge").css("top","32px"),e.left=-(a.btn.outerWidth()-a.btn.outerHeight())/2+"px",e.right="auto",n.left=a.btn.outerWidth()/2+a.btn.outerHeight()+"px",n.right="auto",a.invitation.addClass("ws-chat-invitation-rotate-right"),WBK.addStyles(".ws-chat .ws-chat-invitation-container:after{border-right-color: "+i.color_background_invitation+" !important;}");break;case"vertical_right":a.btn.addClass("ws-chat-btn-rotate").addClass("ws-chat-btn-attach"),e.right=-(a.btn.outerWidth()-a.btn.outerHeight())/2+"px",e.left="auto",n.right=a.btn.outerWidth()/2+a.btn.outerHeight()+"px",n.left="auto",a.invitation.addClass("ws-chat-invitation-rotate-left"),WBK.addStyles(".ws-chat .ws-chat-invitation-container:after{border-left-color: "+i.color_background_invitation+" !important;}")}if("vertical_left"==i.button_location||"vertical_right"==i.button_location){switch(i.position_y){case"bottom":e.bottom=(a.btn.outerWidth()-a.btn.outerHeight())/2+window.innerHeight/100*i.position_y_value+"px",e.top="auto";break;case"top":e.top=(a.btn.outerWidth()-a.btn.outerHeight())/2+window.innerHeight/100*i.position_y_value+"px",e.bottom="auto"}a.invitation.css({top:-(a.btn.outerWidth()-a.btn.outerHeight())/2+"px",bottom:"auto",left:n.left,right:n.right})}a.btn_el.css(e)}a.btn.hide()},updateBtnPositionMobile:function(){if(!a.btn_el.hasClass("ws-chat-no-update-position")&&!parseInt(i.hide_mobile)){var e=wsUtil.getRatio();i.scallingMobile=1!=e;var t,n={ratio:e,positionX:i.mobile_position_x,positionY:i.mobile_position_y,positionXValue:i.mobile_position_x_value,positionYValue:i.mobile_position_y_value};i.scallingMobile?(a.btn_el.removeClass("envy-not-scalling"),n.el=a.btn_el,(t=wsUtil.getMobileScalePositionWidget(n))["z-index"]="inherit",a.btn_el.css(t),wsUtil.setTimeout("zIndex",(function(){a.btn_el.css("z-index",2147483645),parseInt(i.hide_zoom)&&wsUtil.setTimeout("btnElShow",(function(){a.btn_el.show()}),150)}),50)):(a.btn_el.addClass("envy-not-scalling"),t=wsUtil.getMobileNotScalePositionWidget(n),a.btn_el.css(t),a.btn_el.show()),a.container.addClass(i.mobile_position_x),a.container.addClass(i.mobile_position_y)}},updateOfflineBodySize:function(){i.containerSize=a.window.height();var e=a.window.find(".ws-chat-header").height(),t=a.window.find(".ws-chat-body-offline").height(),n=a.window.find(".ws-chat-copyright").height();i.containerSize<e+t+n?a.window.addClass("copyright-relative"):a.window.removeClass("copyright-relative")},initWindowPosition:function(){if("pc"==WBK.settings.device){var t=a.btn_el.position().top,i=a.btn_el.position().left,n=a.window.outerHeight(),s=a.window.width(),o=a.btn.outerHeight(),r=e(window).width(),l=window.innerHeight,c=0;a.window.hasClass("ws-chat-ico-bottom")&&(c=64),i+s>r&&(c=0,i=r-s),(t=t-n+o)<0&&(t=0),i<0&&(i=0),t+n>l&&(t=l-n),a.window.css({top:t/(l/100)+"%",left:(i+c)/(r/100)+"%"}),WBK.animateFastOnce(a.window,"cbk-zoomIn")}},updateWindowPosition:function(){if("pc"==WBK.settings.device){a.window.position().top;var e=a.window.position().left,t=(a.window.height(),a.window.width()),i=wsUtil.getVisualWidth(),n=(wsUtil.getVisualHeight(),0);a.window.hasClass("ws-chat-ico-bottom")&&(n=64),e+t+n>i-15&&(e=i-t-n-15),a.window.css({left:(e+n)/(i/100)+"%"}),WBK.animateFastOnce(a.window,"cbk-zoomIn")}},loadBtnEvents:function(){a.btn.on("click",(function(){1==WBK.settings.chatInvitationOpened&&t.hideInvitation(),t.showWidget(),t.sendGoal("open")})),a.invitation.on("click",(function(i){if(t.hideInvitation(),WBK.settings.multiButtonId&&wsMultiButton.hideWidget(),e(i.target).hasClass("ws-chat-invitation-close")||e(i.target).hasClass("ws-icon-close"))return WBK.settings.multiButtonId&&wsMultiButton.reInitWidget(),wsMultiButton.settings.text_tip&&e(".multi_button-main-div-text .multi_button-text").show(),void t.sendGoal("invitation_close");t.showWidget(),t.sendGoal("invitation_click")}))},loadWindowEvents:function(){if(!e.fn._frameCheck()||"undefined"!=typeof WBK)try{e("body").on("click",'a[href="#showchat"], a[href="'+window.top.location.origin+'#showchat"], a[href="'+window.top.location.origin+'/#showchat"]',(function(e){return t.showWidget(),t.sendGoal("open"),e.preventDefault(),!1}))}catch(e){}if(a.window.find(".ws-chat-close").on("click",(function(){"pc"!=WBK.settings.device&&(location.hash=""),t.hideWidget()})),e(document).on("click",".ws-chat-message-element-file",(function(){if(i.chat_created){var n=(new Date).getTime(),a={file_name:e(this).data("fileName"),file_name_upload:e(this).data("fileNameUpload")};t.sendNode(JSON.stringify(a),n,"start_download")}})),e(document).on("click",".ws-chat-uploaded-el-close",(function(){var n=e(this).parent().data("index");n&&(delete i.fileUploaded[n],t.updateFilesUploaded())})),a.window.find(".ws-chat-sound").on("click",(function(){"on"==i.sound?(i.sound="off",a.window.find(".ws-chat-sound").attr("title",i.lang_text.sound_on),a.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-on").addClass("ws-icon-sound-off")):(i.sound="on",a.window.find(".ws-chat-sound").attr("title",i.lang_text.sound_off),a.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-off").addClass("ws-icon-sound-on"));var e=new Date;e.setMinutes(e.getMinutes()+43200),wsUtil.setCookie("WidgetChat_sound_"+WBK.settings.chatWidgetId,i.sound,e)})),a.window.find(".ws-textarea").bind("keypress",(function(e){var i=e.keyCode||e.which;if(10==i||13==i&&e.ctrlKey){var n=window.getSelection().getRangeAt(0),s=document.createElement("br"),o=document.createElement("br");document.createTextNode(" "),n.deleteContents(),n.insertNode(s),3==n.startContainer.nodeType&&n.insertNode(o),n.collapse(!1)}13!=i||e.shiftKey||e.ctrlKey||(e.preventDefault(),t.sendMessage(),a.window.find(".ws-textarea-send-btn").hide())})),a.window.find(".ws-textarea").bind("keyup",(function(e){var i=e.keyCode||e.which;37!=i&&38!=i&&39!=i&&40!=i&&37!=i&&33!=i&&34!=i&&t.inputScroll()})),a.window.find(".ws-textarea").bind("keydown",(function(e){8==(e.keyCode||e.which)&&t.inputScroll()})),a.window.find(".ws-textarea").on("paste",(function(e){e.preventDefault();var i="";if((e.originalEvent||e.originalEvent.clipboardData.getData("text/plain"))&&(i=e.originalEvent.clipboardData.getData("text/plain")),i)try{i=i.replace(/^\n|\n$/g,"<br>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),t.insertHTML(i)}catch(e){}var n=e.clipboardData||e.originalEvent.clipboardData;if(n&&(n=n.items)){for(var a=!1,s=0;s<n.length;s++)0==n[s].type.indexOf("image")&&(a=n[s].getAsFile());if(a){a.name=a.filename="image_"+(new Date).getTime()+".png";var o=new File([a],a.filename),r=new FormData;r.append("img",o),r.append("type","img"),r.append("image_type","screen"),r.append("chat_id",WBK.settings.chatId),t.uploadFileServer(r,"img")}}})),a.window.find(".ws-textarea-send-btn").on("click",(function(e){t.sendMessage(),a.window.find(".ws-textarea-send-btn").hide(),wsUtil.setFocusContentEditable(form[0])})),e(document).on("click",".ws-chat-message-user .ws-chat-message-name-text",(function(){t.getContactRobot()})),e(document).on("click",".ws-chat-message-robot .ws-chat-message-input",(function(){t.showPreform("preform")})),e(document).on("click",".ws-chat-autoreply-btn",(function(){parseInt(i.show_contact_form_inside_chat)&&(t.addMessageRobot({type:"lead"}),e(".ws-preform-phone").inputmasks(t.optsRU)),t.showPreform("lead",e(this).data("index"),e(this))})),e(document).on("click",".ws-chat-message-manager .ws-chat-message-name-text, .ws-chat-ico .ws-chat-logo",(function(){var i=" "+e(this).data("name")+",&nbsp;";a.window.find(".ws-textarea").is(":focus")||a.window.find(".ws-textarea").focus(),t.insertHTML(i)})),a.window.find(".ws-textarea").bind("keyup",(function(n){if(13!=(n.keyCode||n.which))if(""!=e(".ws-textarea").html()){a.window.find(".ws-textarea-send-btn").show();var s=t.cleanMessage(e(".ws-textarea"));t.printing(s)}else 0==i.fileUploadedCount&&a.window.find(".ws-textarea-send-btn").hide()})),a.window.find(".ws-textarea").on("focus",(function(){t.messageReadVisitor(!1)})),a.window.find(".ws-btn-smile, .ws-smile-container").mouseenter((function(){wsUtil.deleteTimeout("hideSmileContainer"),a.window.find(".ws-file-container").hide(),a.window.find(".ws-smile-container").show()})).mouseleave((function(){wsUtil.setTimeout("hideSmileContainer",(function(){a.window.find(".ws-smile-container").hide()}),300)})),a.window.find(".ws-btn-file, .ws-file-container").mouseenter((function(){wsUtil.deleteTimeout("hideFileContainer"),a.window.find(".ws-smile-container").hide(),a.window.find(".ws-file-container").show()})).mouseleave((function(){wsUtil.setTimeout("hideFileContainer",(function(){a.window.find(".ws-file-container").hide()}),300)})),e(window).on("resize.ws-chat",(function(){if("pc"==WBK.settings.device)wsUtil.setTimeout("resizeChat",(function(){WBK.settings.chatWindowOpened?t.updateWindowPosition():t.initWindowPosition()}),500);else{var e=a.window.find(".ws-textarea").outerHeight();a.window.find(".ws-chat-body").css("bottom",e),t.scroll()}})),"pc"==WBK.settings.device?(a.window.find(".ws-chat-header").on("mousedown",(function(t){1!==t.which||e(t.target).hasClass("ws-chat-close")||e(t.target).hasClass("ws-icon-close")||e(t.target).hasClass("ws-chat-sound")||e(t.target).hasClass("ws-icon-sound-on")||e(t.target).hasClass("ws-icon-sound-off")||(a.window.addClass("ws-chat-drag"),i.dragChatObject.elem=a.window,i.dragChatObject.downX=t.pageX,i.dragChatObject.downY=t.pageY)})),e(document).on("mouseup.ws-chat-header",(function(e){if(i.dragChatObject.dragStarted){i.dragChatObject.dragStarted=!1;var t=new Date;t.setMinutes(t.getMinutes()+1440);var n=JSON.stringify({top:a.window.css("top"),left:a.window.css("left"),width:a.window.css("width"),height:a.window.css("height")});wsUtil.setCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId,n,t)}a.window.removeClass("ws-chat-drag"),i.dragChatObject={}})),e(document).on("mousemove.ws-chat-header",(function(t){if(i.dragChatObject.elem){var n=t.pageX-i.dragChatObject.downX,s=t.pageY-i.dragChatObject.downY;if(Math.abs(n)<3&&Math.abs(s)<3)return;i.dragChatObject.dragStarted||(i.dragChatObject.oldPosition={left:i.dragChatObject.elem.position().left||"",top:i.dragChatObject.elem.position().top||""},i.dragChatObject.shiftX=i.dragChatObject.downX-i.dragChatObject.elem.position().left,i.dragChatObject.shiftY=i.dragChatObject.downY-i.dragChatObject.elem.position().top,i.dragChatObject.dragStarted=!0);var o=t.pageX-i.dragChatObject.shiftX,r=t.pageY-i.dragChatObject.shiftY,l=e(window).width(),c=window.innerHeight;r=i.dragChatObject.elem.outerHeight()>c?0:r+i.dragChatObject.elem.outerHeight()>c-10?c-i.dragChatObject.elem.outerHeight():r<10?0:r,(o=i.dragChatObject.elem.outerWidth()+o>l?l-i.dragChatObject.elem.outerWidth():o<10?0:o)<100&&a.window.hasClass("ws-chat-ico-bottom")?a.window.addClass("ws-chat-ico-bottom-right"):a.window.removeClass("ws-chat-ico-bottom-right"),i.dragChatObject.elem.css({left:o+"px",top:r+"px",right:"auto",bottom:"auto"})}})),i.chat_is_online&&(a.window.find(".ws-chat-resize").on("mousedown",(function(e){1===e.which&&(i.resizeChatObject.elem=a.window,i.resizeChatObject.elemMinSizeHeight=375,i.resizeChatObject.elemMinSizeHeight=i.resizeChatObject.elemMinSizeHeight+i.resizeChatObject.elem.find(".ws-chat-footer").outerHeight(),i.resizeChatObject.downX=e.pageX,i.resizeChatObject.downY=e.pageY,a.window.addClass("ws-chat-no-select"))})),e(document).on("mouseup.ws-chat-resize",(function(e){if(i.resizeChatObject.dragStarted){i.resizeChatObject.dragStarted=!1;var n=new Date;n.setMinutes(n.getMinutes()+1440);var s=JSON.stringify({top:a.window.css("top"),left:a.window.css("left"),width:a.window.css("width"),height:a.window.css("height")});wsUtil.setCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId,s,n),t.inputScroll()}i.resizeChatObject={},a.window.removeClass("ws-chat-no-select"),t.typingPositionUpdate()})),e(document).on("mousemove.ws-chat-resize",(function(n){if(i.resizeChatObject.elem){var a=n.pageX-i.resizeChatObject.downX,s=n.pageY-i.resizeChatObject.downY;if(Math.abs(a)<3&&Math.abs(s)<3)return;i.resizeChatObject.dragStarted||(i.resizeChatObject.old={width:i.resizeChatObject.elem.outerWidth(),height:i.resizeChatObject.elem.outerHeight(),left:i.resizeChatObject.elem.position().left||"",top:i.resizeChatObject.elem.position().top||""},i.resizeChatObject.shiftX=i.resizeChatObject.downX-i.resizeChatObject.elem.position().left,i.resizeChatObject.shiftY=i.resizeChatObject.downY-i.resizeChatObject.elem.position().top,i.resizeChatObject.dragStarted=!0),i.resizeChatObject.dragStarted=!0;var o=n.pageX-i.resizeChatObject.downX,r=n.pageY-i.resizeChatObject.downY,l=e(window).width(),c=window.innerHeight,d=i.resizeChatObject.old.height+r,h=i.resizeChatObject.old.width+o;i.resizeChatObject.elem.position().top+d>c&&(d=c-i.resizeChatObject.elem.position().top),i.resizeChatObject.elem.position().left+h>l&&(h=l-i.resizeChatObject.elem.position().left),i.resizeChatObject.elem.css({width:h>338?h:338,height:d>=400?d:400}),t.scroll()}})))):(e(window).on("scroll.ws-chat",(function(){parseInt(i.hide_zoom)&&a.btn_el.hide(),wsUtil.setTimeout("scrollTimerChat",(function(){t.updateBtnPositionMobile()}),250)})),e(window).on("envy:resize",(function(){t.updateBtnPositionMobile(),i.containerSize!=a.window.height()&&t.updateOfflineBodySize()}))),a.window.find(".ws-file-upload").on("change",(function(i){i.preventDefault(),a.window.find(".ws-file-container").hide(),t.uploadFile(e(this).data("type"))})),a.window.find(".ws-offline-btn").on("click",(function(){t.sendOfflineMessage()})),a.window.find(".ws-preform-btn-cancel").on("click",(function(){t.hidePreform()})),e(document).on("click",".ws-preform-btn-save",(function(){t.savePreform(e(this).data("type"),e(this).data("index"),e(this))})),e(document).on("click",".ws-chat-social-vk",(function(){var e=(screen.width-675)/2,t=(screen.height-380)/4;open(WBK.settings.serverUrl+"/chat/auth_vk/?origin="+window.location.origin,"publish","width=675,height=380, top="+t+", left="+e+",resizable=yes,scrollbars=yes,status=yes")})),e(document).on("click",".ws-chat-social-fb",(function(){var e=(screen.width-675)/2,t=(screen.height-380)/4;open(WBK.settings.serverUrl+"/chat/auth_fb/?origin="+window.location.origin,"publish","width=675,height=380, top="+t+", left="+e+",resizable=yes,scrollbars=yes,status=yes")})),e(window).on("message",(function(e){if(e=e.originalEvent.data)switch(e.type){case"vk_auth":t.vkAuth(e);break;case"fb_auth":t.fbAuth(e)}})),a.window.find(".ws-preform-input").bind("keypress",(function(i){13==(i.keyCode||i.which)&&(i.preventDefault(),t.savePreform(e(".ws-preform-btn-save").data("type"),e(this).data("index")))})),e.fn._frameCheck()||Object.keys(i.invitations).length>0&&(_t=this,Object.keys(i.invitations).map((function(t,n){var a=i.invitations[t];try{e("body").on("click.invitations",'a[href="#autoinvitation-'+a.name.replace(/\s+/g,"-")+'"], a[href="'+window.top.location.origin+"#autoinvitation"+a.name.replace(/\s+/g,"-")+'"], a[href="'+window.top.location.origin+"/#autoinvitation"+a.name.replace(/\s+/g,"-")+'"]',(function(t){var i=e(t.currentTarget).attr("href").replace(new RegExp(window.top.location.origin+"|/|#autoinvitation|-+","g")," ").trim();return _t.showInvitationByName(i),t.preventDefault(),!1}))}catch(e){}}))),WBK.settings.phoneMasks){var n={inputmask:{definitions:{"#":{validator:"[0-9]",cardinality:1}},clearIncomplete:!1,showMaskOnHover:!1,autoUnmask:!0},match:/[0-9]/,replace:"#",list:e.masksSort(WBK.settings.phoneMasks,["#"],/[0-9]|#/,"mask"),listKey:"mask",onMaskChange:function(){e(this).attr("placeholder",e(this).inputmask("getemptymask"))}};t.optsRU=n,e(".ws-offline-phone").inputmasks(n),e(".ws-preform-phone").inputmasks(n),n.inputmask.definitions.clearIncomplete=!0,e(".cbk-phone-checker").inputmasks(n)}},vkAuth:function(n){i.visitor_vk_id=n.user_id,e.ajax({url:"https://api.vk.com/method/users.get?user_ids="+n.user_id+"&fields=photo_100&lang=ru&v=5.81",type:"GET",dataType:"jsonp",crossDomain:!0,success:function(s){a.window.find(".ws-preform-name").val(s.response[0].first_name+" "+s.response[0].last_name),n.email&&a.window.find(".ws-preform-email").val(n.email),s.response[0].photo_100&&(i.logo_visitor=s.response[0].photo_100),i.auth_type="vk",t.savePreform(e(".ws-preform-btn-save").data("type"),e(".ws-preform-btn-save").data("index"),e(".ws-preform-btn-save"))}})},fbAuth:function(n){i.visitor_fb_token=n.access_token,e.ajax({url:"https://graph.facebook.com/me?fields=id,email,first_name,last_name,picture.width(100).height(100)&access_token="+n.access_token,type:"GET",dataType:"jsonp",crossDomain:!0,success:function(n){i.visitor_fb_id=n.id,a.window.find(".ws-preform-name").val(n.first_name+" "+n.last_name),n.email&&a.window.find(".ws-preform-email").val(n.email),n.picture.data.url&&(i.logo_visitor=n.picture.data.url),i.auth_type="fb",t.savePreform(e(".ws-preform-btn-save").data("type"),e(".ws-preform-btn-save").data("index"),e(".ws-preform-btn-save"))}})},updateUser:function(){if(i.visitorData&&(i.auth_type=i.visitorData.type,i.logo_visitor=i.visitorData.img,i.visitorData=!1),i.user_name=WBK.settings.visitorName?WBK.settings.visitorName:"",i.user_email=WBK.settings.visitorEmail?WBK.settings.visitorEmail:"",i.user_phone=WBK.settings.visitorPhone?WBK.settings.visitorPhone:"",i.chat_created){a.window.find(".ws-chat-message-user").find(".ws-chat-message-name-text").text(i.user_name),t.logoVisitor(!0),a.window.find(".ws-chat-message-user").find(".ws-chat-message-name-text").text(i.user_name);var e=new Date;e=e.getTime();var n={visitor_name:i.user_name,visitor_email:i.user_email,visitor_phone:i.user_phone,auth_type:i.auth_type,image:i.logo_visitor,vk_id:i.visitor_vk_id,fb_id:i.visitor_fb_id};WBK.settings.socket?WBK.settings.socket.emit("introduced",{chat_id:WBK.settings.chatId,visitor_name:i.user_name,visitor_email:i.user_email,visitor_phone:i.user_phone,hash:e,message:JSON.stringify(n),type:"introduced"}):WBK.initSocket((function(){WBK.settings.socket.emit("introduced",{chat_id:WBK.settings.chatId,visitor_name:i.user_name,visitor_email:i.user_email,visitor_phone:i.user_phone,hash:e,message:JSON.stringify(n),type:"introduced"})}))}},operatorsIsOnline:function(){var t=!1;return i.operators_id=[],i.operators_online_id=[],i.operators_array=[],i.all_operators&&e.each(i.all_operators,(function(e,n){i.all_operators[e].user_logo&&i.all_operators[e].connected_at&&i.operators_array.push(i.all_operators[e]),i.operators_id.push(i.all_operators[e].user_id+"_"+i.all_operators[e].employee_id),parseInt(i.all_operators[e].status)&&(i.operators_online_id.push(i.all_operators[e].user_id+"_"+i.all_operators[e].employee_id),t=!0)})),t},addMessage:function(e){var n,s="",o=!0,r=i.lang_text.is_received,l=!1;switch(e.is_read&&(r=i.lang_text.is_read,l=!0),e.user=e.user?e.user:"",e.date=t.dateFormat(e.date),e.message_type){case"introduced":case"error":case"start_download":case"open_window":case"close_window":case"auto_ended":case"not_require_answer":case"close_chat":case"crm_integration_sended":case"invite_to_chat":case"":return!1;case"show_invitation":case"text":i.messages_quant_to_rate++,e.message=e.message.text.replace(/(?:\r\n|\r|\n)/g,"<br />");break;case"auto_reply":if(e.auto_reply_get_contact){if(parseInt(i.show_contact_form_inside_chat))e.message=wsUtil.specialChars(e.message.text);else{var c=i.autoreplies[e.auto_reply_index].text_btn?i.autoreplies[e.auto_reply_index].text_btn:i.lang_text.autoreply_link;e.message=wsUtil.specialChars(e.message.text)+'<br><div class="ws-chat-autoreply-link"><a data-index="'+e.auto_reply_index+'" class="ws-chat-autoreply-btn" href="#">'+c+"</a></div>"}var d=new Date;d.setMinutes(d.getMinutes()+43200),wsUtil.setCookie("WidgetChat_autoreply_getcontact_"+WBK.settings.chatId,!0,d)}else e.message=wsUtil.specialChars(e.message.text);break;case"attach_image":i.messages_quant_to_rate++;var h="";switch(e.message.img_type){case"link":h=e.message.img_url;break;case"uploaded":h=WBK.settings.serverUrl+"/chat/download/?type=image&file="+e.message.file_name_upload+"&filename="+e.message.file_name+"&chat="+WBK.settings.chatId}e.message='<a class="ws-chat-message-element"  data-file-name="'+e.message.file_name+'" data-file-name-upload="'+e.message.file_name_upload+'" href="'+h+'" target="_blank"><img class="ws-chat-message-img" src="'+e.message.img_url+'"><div class="ws-foto-hover"></div><div class="ws-foto-hover-img"></div></a>';break;case"attach_file":i.messages_quant_to_rate++;var u='<div class="ws-file-block"><div class="ws-file-el"><img class="ws-icon-file" src="'+WBK.settings.staticServerUrl+"/"+e.message.file_ico_url+'"> <div class="ws-file-size">'+e.message.file_size+" "+e.message.file_size_type+'</div></div><div class="ws-file-name">'+e.message.file_name+'</div></div><div class="ws-file-hover"></div>';e.message='<a class="ws-chat-message-element ws-chat-message-element-file" data-file-name="'+e.message.file_name+'" data-file-name-upload="'+e.message.file_name_upload+'" href="'+WBK.settings.serverUrl+"/chat/download/?type=doc&file="+e.message.file_name_upload+"&filename="+e.message.file_name+"&chat="+WBK.settings.chatId+'" target="_blank">'+u+"</a>";break;case"connect_to_chat":var g=e.message.user_name+(e.message.user_surname?" "+e.message.user_surname:"");e.date.date_line&&a.window.find(".ws-chat-typing").before('<div class="ws-chat-date-block">'+e.date.date_line+"</div>");var p=e.message.user_profession?e.message.user_profession:"",w='<div class="ws-chat-manager-join"><img src="'+WBK.settings.staticServerUrl+e.message.img_url+'" alt="" class="ws-manager-img"><div class="ws-manager-name">'+g+'</div><div class="ws-manager-position">'+p+'</div><div class="ws-manager-event">'+i.lang_text.join_chat+"</div></div>";return a.window.find(".ws-chat-typing").before(w),!1;case"disconnect_from_chat":return g=e.message.user_name+(e.message.user_surname?" "+e.message.user_surname:""),e.date.date_line&&a.window.find(".ws-chat-typing").before('<div class="ws-chat-date-block">'+e.date.date_line+"</div>"),p=e.message.user_profession?e.message.user_profession:"",w='<div class="ws-chat-manager-join"><img src="'+WBK.settings.staticServerUrl+e.message.img_url+'" alt="" class="ws-manager-img"><div class="ws-manager-name">'+g+'</div><div class="ws-manager-position">'+p+'</div><div class="ws-manager-event">'+i.lang_text.disconnect_from_chat+"</div></div>",a.window.find(".ws-chat-typing").before(w),!1}e.date.date_line&&a.window.find(".ws-chat-typing").before('<div class="ws-chat-date-block">'+e.date.date_line+"</div>");var f='<div id="mess_'+e.hash+'" data-read="'+l+'" class="ws-chat-message"><div class="ws-chat-message-source">'+e.message+'</div><div class="ws-chat-message-date">'+e.date.time+"</div></div>",m=a.window.find(".ws-chat-body-content").children(":not(.ws-chat-typing,.ws-chat-uploaded-files)").last();switch(e.type){case"manager":i.last_operator_message_id=e.id?e.id:i.last_operator_message_id,s="ws-chat-message-manager",o=m.data("user")==e.user,(k=this.getOperator(e.user))&&(n=k.name+(k.surname?" "+k.surname:""));break;case"user":n=i.user_name?i.user_name:i.lang_text.default_user,s="ws-chat-message-user"}if((m.hasClass("ws-chat-robot-hello")||m.hasClass("ws-chat-manager-hello"))&&m.css("padding-bottom","10px"),!e.date.new_block&&m.hasClass(s)&&o)m.find(".ws-chat-message-date").remove(),m.find(".ws-chat-message:last").after(f),e.is_read||"user"!=e.type||m.find(".ws-chat-message-status").text(r).addClass("ws-chat-message-status");else{var v="",_="",b="";if("manager"==e.type){var k=this.getOperator(e.user);v='<div class="ws-chat-message-logo"><img class="ws-chat-message-logo-img" src="'+WBK.settings.staticServerUrl+k.img+'"></div>'}else v='<div class="ws-chat-message-logo">'+t.logoVisitor(!1)+"</div>",_='<div class="ws-chat-message-status">'+r+"</div>",b=i.lang_text.change_name_title;var y='<div class="ws-chat-message-block '+s+'" data-user="'+e.user+'">'+v+'<div class="ws-chat-message-name"><span class="ws-chat-message-name-text" data-name="'+n+'" title="'+b+'">'+n+"</span></div>"+f+_+"</div>";a.window.find(".ws-chat-typing").before(y)}return e.user||e.is_read&&parseInt(e.is_read)||(a.window.find(".ws-chat-message-status:last").addClass("ws-chat-message-status-hidden"),wsUtil.setTimeout("show_message_status",(function(){var e=a.window.find(".ws-chat-message-status.ws-chat-message-status-hidden");e.removeClass("ws-chat-message-status-hidden"),WBK.animateOnce(e,"cbk-flipInY")}),1e3)),"manager"==e.type&&e.user&&t.updateIcoBottom(e.user),!WBK.settings.chatWindowOpened||"attach_image"!=e.message_type&&"attach_file"!=e.message_type||a.window.find(".ws-chat-body-content img:last").load((function(){t.scroll()})),t.typingPositionUpdate(),e.scroll&&t.scroll(),!0},getOperator:function(e){var t={img:"/img/avatars/nophoto.png",is_alias:0,name:i.lang_text.operator,surname:!1,profession:"",status:0,user_logo:"/img/avatars/nophoto.png"};return void 0!==i.all_operators[e]&&(t=i.all_operators[e]),t},logoVisitor:function(e){var t='<img class="ws-chat-message-logo-img" src="'+i.default_logo_visitor+'">';return"vk"!=i.auth_type&&"fb"!=i.auth_type||!i.logo_visitor?i.user_name&&(t='<div class="ws-chat-message-logo-letter">'+i.user_name.substr(0,1).toUpperCase()+"</div>",e&&a.window.find(".ws-chat-message-user").find(".ws-chat-message-logo-letter").html(t)):(t='<img class="ws-chat-message-logo-img" src="'+i.logo_visitor+'">',e&&a.window.find(".ws-chat-message-user").find(".ws-chat-message-logo").html(t)),t},playSound:function(e){if("off"!=i.sound){var t="";switch(e){case"message":case"operator_join":t="chat1"}WBK.Sound(t)}},typing:function(e,t,n){null==t&&(t=5e3);var s=e.user_id+"_"+e.employee_id,o=this.getOperator(s),r=o.name?o.name:i.lang_text.operator;a.window.find(".ws-chat-typing").find(".ws-manager-name").text(r),this.typingPositionUpdate(),a.window.find(".ws-chat-typing").removeClass("ws-chat-typing-removing"),wsUtil.setTimeout("chatTypingActivateTimeout",(function(){a.window.find(".ws-chat-typing").addClass("ws-chat-typing-active")}),300);var l=t;wsUtil.setTimeout("chatTypingTimeout",(function(){a.window.find(".ws-chat-typing").removeClass("ws-chat-typing-active").addClass("ws-chat-typing-removing")}),l)},typingPositionUpdate:function(){var t=a.window.find(".ws-chat-body-content").height(),i=0,n=a.window.find(".ws-chat-typing").outerHeight()+a.window.find(".ws-chat-uploaded-files").outerHeight();a.window.find(".ws-chat-body-content").children(":not(.ws-chat-typing,.ws-chat-uploaded-files)").each((function(n,a){if(i+=e(a).outerHeight(),t<i)return!1}));var s=t-i-6,o=0;s>n&&(o=s-n),a.window.find(".ws-chat-typing").css("marginTop",o)},operatorClosed:function(){a.window.removeClass("ws-chat-ico-bottom"),a.window.find(".ws-chat-ico-container").empty(),i.chat_created=!1},getTimeClosedChat:function(){return wsUtil.getStorage("ws_time_closed_chat")},updateTimeClosedChat:function(){wsUtil.setStorage("ws_time_closed_chat",(new Date).getTime())},operatorJoin:function(e){wsUtil.deleteInterval("chatCreatedCrazyCycle");var n=e.user_id+"_"+e.employee_id;if(!i.chat_operators.hasOwnProperty(n)){n!=i.invitation_operator_id?(t.addMessage({id:e.id,hash:e.hash,message:JSON.parse(e.message),date:e.created_at,user:n,is_read:!1,message_type:e.type,scroll:!0}),t.playSound("operator_join")):i.invitation_operator_id=!1;var a=this.getOperator(n);i.chat_operators[n]={employee_id:e.employee_id,name:a.name+(a.surname?" "+a.surname:""),user_id:e.user_id,gcm_registration_id:a.gcm_registration_id},t.operatorsUpdate(),i.send_autoreply=!0,i.send_autoreply_first=!1,t.getAutoReply(),t.scroll(),t.sendGoal("operator_connect")}},operatorExit:function(e){var n=e.user_id+"_"+e.employee_id;t.addMessage({id:e.id,hash:e.hash,message:JSON.parse(e.message),date:e.created_at,user:n,is_read:!1,message_type:e.type,scroll:!0}),a.window.find(".ws-chat-typing").removeClass("ws-chat-typing-active").addClass("ws-chat-typing-removing"),i.chat_operators.hasOwnProperty(n)&&delete i.chat_operators[n],t.operatorsUpdate(),t.scroll()},onVisitorMessage:function(e){if("show_invitation"!=e.data.type&&"auto_reply"!=e.data.type){if("rating"==e.data.type)return e.data.message=JSON.parse(e.data.message),i.chatRate=e.data.message.rate,void t.addMessageRobot(e.data);var n=!1;WBK.settings.chatWindowOpened&&(n=!0),t.addMessage({id:e.data.id,hash:e.data.hash,type:"user",message:JSON.parse(e.data.message),date:e.data.created_at,user:!1,is_read:!1,message_type:e.data.type,scroll:n}),t.playSound("message"),this.checkRatingSettings()}},onVisitorMessageRead:function(){t.messageReadVisitor(!0)},socketConnected:function(e,n){i.chat_created?t.reconnect():i.chat_created||void 0!==n&&n(e)},onOperatorStatus:function(e){1==e.status?(wsUtil.deleteTimeout("chatOperatorsUpdate"),t.operatorsUpdate(e)):wsUtil.setTimeout("chatOperatorsUpdate",(function(){t.operatorsUpdate(e)}),15e3)},onConnectToChat:function(e){i.last_operator_data={user_id:e.user_id,employee_id:e.employee_id},jWS.isEmptyObject(i.autoreplies)||t.stopAutoReply("not_connected"),t.operatorJoin(e)},onDisconnectFromChat:function(e){t.operatorExit(e),jWS.isEmptyObject(i.autoreplies)||t.stopAutoReply("all")},onCloseChat:function(e){t.operatorClosed(),t.stopAutoReply("all"),t.updateTimeClosedChat()},onOperatorPrinting:function(e){jWS.isEmptyObject(i.autoreplies)||t.stopAutoReply("all"),t.typing(e),jWS.isEmptyObject(i.autoreplies)||t.stopAutoReply("not_answer_operator")},onOperatorMessage:function(e){var n=e.user_id+"_"+e.employee_id;i.last_operator_data={user_id:e.user_id,employee_id:e.employee_id},wsUtil.deleteTimeout("chatTypingTimeout"),a.window.find(".ws-chat-typing").removeClass("ws-chat-typing-active").addClass("ws-chat-typing-removing");var s=!1;WBK.settings.chatWindowOpened&&(s=!0);var o=t.addMessage({id:e.id,hash:e.hash,type:"manager",message:JSON.parse(e.message),date:!1,user:n,is_read:!1,message_type:e.type,scroll:s});o&&(t.playSound("message"),t.messageReceived(e),i.unread_messages_count+=1),i.unread_messages[e.hash]={id:e.id,hash:e.hash},a.window.find(".ws-textarea").is(":focus")?t.messageReadVisitor(!1):o&&t.setUnreadMessages(i.unread_messages_count),WBK.settings.chatWindowOpened||WBK.settings.windowOpened||WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||WBK.settings.windowQuizOpened||"pc"!=WBK.settings.device||t.showWidget(),i.send_autoreply=!0,jWS.isEmptyObject(i.autoreplies)||t.stopAutoReply("not_answer_operator"),this.checkRatingSettings()},onOperatorUpdateMessage:function(t){t.user_id,t.employee_id,wsUtil.deleteTimeout("chatTypingTimeout"),a.window.find(".ws-chat-typing").removeClass("ws-chat-typing-active").addClass("ws-chat-typing-removing"),t.message=JSON.parse(t.message),e("#mess_"+t.hash+" .ws-chat-message-source").html(t.message.text)},onMessageRead:function(e){t.messageReadOperator(e.hash)},onUpdateRegistrationId:function(e){var t=e.user_id+"_"+e.employee_id;i.all_operators[t]&&(i.all_operators[t].gcm_registration_id=e.registration_id),i.chat_operators[t]&&(i.chat_operators[t].gcm_registration_id=e.registration_id)},reconnect:function(){e.getJSON(WBK.settings.serverUrl+"/chat/api/",{action:"getUnreadMessages",chatId:WBK.settings.chatId,chatWidgetId:WBK.settings.chatWidgetId,visitorId:WBK.settings.visitorId,lastOperatorMessageId:i.last_operator_message_id?i.last_operator_message_id:0},(function(e){if(e.success&&e.data.messages){var n=!1;WBK.settings.chatWindowOpened&&(n=!0);var s=e.data.messages,o=!1;for(var r in s)if(!i.unread_messages.hasOwnProperty(s[r].hash)){t.messageReceived(s[r]),"close_chat"==s[r].type&&(o=!0);var l=s[r].user_id+"_"+s[r].employee_id;t.addMessage({id:s[r].id,hash:s[r].hash,type:"manager",message:JSON.parse(s[r].message),date:!1,user:l,is_read:!1,message_type:s[r].type,scroll:n}),i.unread_messages[s[r].hash]={id:s[r].id,hash:s[r].hash},i.unread_messages_count+=1,a.window.find(".ws-textarea").is(":focus")?t.messageReadVisitor(!1):t.setUnreadMessages(i.unread_messages_count)}o&&(t.messageReadVisitor(!1),t.operatorClosed())}}))},setTemplate:function(){var e='<div class="ws-chat-btn-el-container envy-not-scalling"><div class="ws-chat-btn-container ws-chat-btn-mini-hover"><div class="ws-btn-badge"></div><div class="ws-btn-ico"><div class="ws-chat-logo"><i class="ws-icon-chat" style="color: '+i.color_background_button+'"></i><img src="'+i.chat_widget_logo+'" class="ws-chat-logo-img"><div class="ws-chat-status-round ws-chat-status-online"></div></div></div><div class="ws-btn-title"></div></div><div class="ws-chat-invitation-container"><div class="ws-chat-invitation-close"><i class="ws-icon-close"></i></div><div class="ws-chat-invitation-body"><div class="ws-chat-invitation-logo"></div><div class="ws-chat-invitation-body-el"><div class="ws-chat-invitation-body-text"></div></div></div><div class="ws-chat-invitation-form"><input type="text" class="ws-chat-invitation-input" placeholder="'+i.lang_text.form_message_placeholder+'"></div></div></div>';"pc"!=WBK.settings.device&&(e='<div class="ws-chat-btn-el-container envy-not-scalling"><div class="ws-chat-btn-container ws-chat-btn-mini-hover"><div class="ws-btn-badge"></div><div class="ws-btn-ico"><div class="ws-chat-logo"><i class="ws-icon-chat" style="color: '+i.mobile_color_background_button+'"></i><img src="'+i.chat_widget_logo+'" class="ws-chat-logo-img"><div class="ws-chat-status-round ws-chat-status-online"></div></div></div></div><div class="ws-chat-invitation-container"><div class="ws-chat-invitation-input">'+i.lang_text.form_message_placeholder+'</div><div class="ws-chat-invitation-close"><i class="ws-icon-close"></i></div><div class="ws-chat-invitation-body"><div class="ws-chat-invitation-logo"></div><div class="ws-chat-invitation-body-el"><div class="ws-chat-invitation-body-text"></div></div></div></div></div>'),i.text_button_online=this.safe_tags(i.text_button_online),n='<div class="ws-chat"><div class="ws-chat-container ws-chat-round" style="background: '+i.color_background_window+'"><div class="ws-chat-header" style="background: '+i.color_background_chat_header+'"><div class="ws-chat-logo"><i class="ws-icon-chat"></i><img src="'+i.chat_widget_logo+'" class="ws-chat-logo-img"><div class="ws-chat-status-round ws-chat-status-online"></div></div><div class="ws-chat-title" style="color: '+i.color_background_chat_header_text+'">'+i.text_button_online+'</div><a class="ws-chat-close" style="color: '+i.color_background_chat_header_text+'" href="javascript:void(0)" title="'+i.lang_text.close_title+'"><i class="ws-icon-close" style="color: '+i.color_background_chat_header_text+'"></i></a><a class="ws-chat-sound" style="color: '+i.color_background_chat_header_text+'" href="javascript:void(0)" title="'+i.lang_text.sound_off+'"><i class="ws-icon-sound-on" style="color: '+i.color_background_chat_header_text+'"></i></a></div><div class="ws-chat-body"><div class="ws-chat-rating">'+i.lang_text.rate_request+'<div class="ws-chat-rating-btns ws-chat-rating-btns-'+i.rate_chat_view+'"><a class="ws-chat-rating-el ws-chat-rating-el-1" href="javascript:void(0)" data-value="1" title="'+i.lang_text.rate_text_1+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a><a class="ws-chat-rating-el ws-chat-rating-el-2" href="javascript:void(0)" data-value="2" title="'+i.lang_text.rate_text_2+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a><a class="ws-chat-rating-el ws-chat-rating-el-3" href="javascript:void(0)" data-value="3" title="'+i.lang_text.rate_text_3+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a><a class="ws-chat-rating-el ws-chat-rating-el-4" href="javascript:void(0)" data-value="4" title="'+i.lang_text.rate_text_4+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a><a class="ws-chat-rating-el ws-chat-rating-el-5" href="javascript:void(0)" data-value="5" title="'+i.lang_text.rate_text_5+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a></div></div><div class="ws-chat-shadow" style="background: linear-gradient(to bottom, '+i.color_background_window+' 0%,rgba(255,255,255,0) 100%)"></div><div class="ws-chat-body-content"><div class="ws-chat-typing"><span class="ws-chat-typing-action"><i class="ws-icon-typing"></i></span><span class="ws-manager-name"></span> '+i.lang_text.typing+'...</div><div class="ws-chat-uploaded-files"></div></div></div><div class="ws-chat-body-offline" style="display: none"><div class="ws-chat-offline-text">'+i.offline_text+'</div><div class="ws-chat-offline-text-success">'+i.lang_text.offline_text_success+'</div><div class="ws-offline-input-group '+("hide"==i.get_contact_offline_name?"ws-hide":"")+'"><div class="ws-offline-input-label">'+i.lang_text.form_name+'<span class="ws-input-required">'+("yes"==i.get_contact_offline_name?" *":"")+'</span></div><input type="text" class="ws-offline-input ws-offline-name" placeholder="'+i.lang_text.form_name_placeholder+'" value="'+i.user_name+'"></div><div class="ws-offline-input-group '+("hide"==i.get_contact_offline_phone?"ws-hide":"")+'"><div class="ws-offline-input-label">'+i.lang_text.form_phone+'<span class="ws-input-required">'+("yes"==i.get_contact_offline_phone?" *":"")+'</span></div><input type="tel" class="ws-offline-input ws-offline-phone" placeholder="'+i.lang_text.form_phone_placeholder+'" value="'+i.user_phone+'"></div><div class="ws-offline-input-group '+("hide"==i.get_contact_offline_email?"ws-hide":"")+'"><div class="ws-offline-input-label">'+i.lang_text.form_email+'<span class="ws-input-required">'+("yes"==i.get_contact_offline_email?" *":"")+'</span></div><input type="email" class="ws-offline-input ws-offline-email" placeholder="'+i.lang_text.form_email_placeholder+'" value="'+i.user_email+'"></div><div class="ws-offline-input-group"><div class="ws-offline-input-label">'+i.lang_text.form_message_placeholder+'<span class="ws-input-required">'+("yes"==i.get_contact_offline_message?" *":"")+'</span></div><div contenteditable="true" class="ws-offline-textarea"></div><div class="ws-offline-textarea-element"><a class="ws-offline-textarea-btn ws-btn-smile" href="javascript:void(0)"><i class="ws-icon-smile"></i></a><div class="ws-smile-container ws-smile-container-offline"></div></div></div><div class="ws-offline-input-group'+(parseInt(i.email_agreement)?"":" ws-hide")+'"><label class="ws-offline-label-agreement"><input type="checkbox" class="ws-offline-email-agreement" checked><span class="ws-offline-email-agreement-text">'+i.email_agreement_text+i.lang_text.email_agreement_text_agreement+'</span></label></div><div class="ws-offline-input-group ws-offline-input-group-btn"><a href="javascript:void(0)" class="ws-offline-btn">'+i.lang_text.offline_btn+'</a></div></div><div class="ws-chat-body-preform" style="display: none"><div class="ws-chat-preform-text"></div><div class="ws-chat-preform-social"><a href="javascript:void(0)" class="ws-chat-social-el ws-chat-social-vk"><img class="ws-chat-social-img" src="'+WBK.settings.staticServerUrl+'/widget/img/vk.png"></a><a href="javascript:void(0)" class="ws-chat-social-el ws-chat-social-fb"><img class="ws-chat-social-img" src="'+WBK.settings.staticServerUrl+'/widget/img/fb.png"></a></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="text" class="ws-preform-input ws-preform-name" placeholder="'+i.lang_text.form_name_placeholder+'" value="'+i.user_name+'"></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="tel" class="ws-preform-input ws-preform-phone" placeholder="'+i.lang_text.form_phone_placeholder+'" value="'+i.user_phone+'"><input type="text" class="cbk-phone-checker white-saas-generator-input-hidden"/></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="email" class="ws-preform-input ws-preform-email" placeholder="'+i.lang_text.form_email_placeholder+'" value="'+i.user_email+'"></div><div class="ws-preform-input-group ws-preform-input-group-text"><div class="ws-preform-input-label ws-preform-email-text">'+i.lang_text.email_exit+'</div></div><div class="ws-preform-input-group ws-preform-input-group-text"><label class="ws-preform-label-agreement"><span class="ws-preform-email-agreement-text">'+i.email_agreement_text+i.lang_text.email_agreement_text_agreement+'</span></label></div><div class="ws-preform-input-group ws-preform-input-group-btn"><a href="javascript:void(0)" class="ws-preform-btn-cancel">'+i.lang_text.offline_btn_cancel+'</a><a href="javascript:void(0)" class="ws-preform-btn ws-preform-btn-save">'+i.lang_text.preform_btn+'</a></div></div><div class="ws-chat-footer"><div class="ws-textarea-element"><a class="ws-textarea-btn ws-btn-file" href="javascript:void(0)"><i class="ws-icon-file"></i></a><a class="ws-textarea-btn ws-btn-smile" href="javascript:void(0)"><i class="ws-icon-smile"></i></a><div class="ws-smile-container"></div><div class="ws-file-container"><div class="ws-file-element ws-file-doc"><i class="ws-icon-document"></i>'+i.lang_text.file+'<input type="file" class="ws-file-upload ws-file-doc-upload" name="ws-doc" data-type="doc" accept="'+i.allow_mime_file+'"></div><div class="ws-file-element ws-file-foto"><i class="ws-icon-image"></i>'+i.lang_text.image+'<input type="file" class="ws-file-upload ws-file-img-upload" name="ws-img" data-type="img" accept="'+i.allow_mime_img+'"></div></div></div><div class="ws-textarea-group"><div contenteditable="true" class="ws-textarea" placeholder="Введите сообщение"></div><div class="ws-textarea-send-btn" title="'+i.lang_text.send_btn_title+'"><i class="ws-icon-enter"></i></div></div></div><div class="ws-chat-copyright"><a href="'+i.partnerLink+'" class="ws-chat-copyright-url" target="_blank" data-widget="chat">'+i.lang_text.text_link+'</a></div><div class="ws-chat-resize" style="color: '+i.color_background_chat_header+'"><i class="ws-icon-resize"></i></div><div class="ws-chat-ico-container"></div></div>'+e+"</div>"},setSettings:function(t){var n={dragChatObject:{},resizeChatObject:{},chat_created:!1,chat_old_time:!1,chat_timezone:3,unread_messages:{},unread_messages_count:0,document_title:document.title,document_favicon_href:e('link[rel="shortcut icon"]').length?e('link[rel="shortcut icon"]').attr("href"):e('link[rel="icon"]').attr("href"),new_favicon_href:"",input_scroll:!1,auth_type:"default",default_logo_visitor:WBK.settings.staticServerUrl+"/widget/img/user.png",agreementLink:"https://whitesaas.com/agreement/",logo_visitor:!1,is_first_message:!1,first_message:!1,bottom_body:62,height_input:56,allow_mime_file:".pdf,.txt,.doc,.docx,.xls,.xlsm,.rar,.zip",allow_mime_img:"image/png,image/jpg,image/jpeg,image/gif",invitation_show_data:!1,invitation_operator_id:!1,last_operator_message_id:!1,last_operator_data:!1,send_autoreply:!1,send_autoreply_first:!1,show_one_invitation:!1,fileUploaded:{},fileUploadedCount:0,chatCreating:!1,scallingMobile:!1,offline_message_sending:!1,scroll_left:0,scroll_top:0,containerSize:0,show_contact_form_inside_chat:0,autoCall:0,autoCallText:"0",autoCallDeffered:0,autoCallDefferedDelay:0,disableMobileOpenHash:0,smilesCodes:{"1f601":"😁","1f602":"😂","1f603":"😃","1f604":"😄","1f605":"😅","1f606":"😆","1f609":"😉","1f60a":"😊","1f60b":"😋","1f60c":"😌","1f60d":"😍","1f60f":"😏","1f612":"😒","1f613":"😓","1f614":"😔","1f616":"😖","1f618":"😘","1f61a":"😚","1f61c":"😜","1f61d":"😝","1f61e":"😞","1f620":"😠","1f621":"😡","1f622":"😢","1f623":"😣","1f624":"😤","1f625":"😥","1f628":"😨","1f629":"😩","1f62a":"😪","1f62b":"😫","1f62d":"😭","1f630":"😰"}};e.extend(!0,i,n),e.extend(!0,i,t)},log:function(e){wsUtil.log("CHAT : "+e)},safe_tags:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}})},325:()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t,i,n,a,s,o;wsChatNew=(t=jWS,{settings:{},templates:{},widget:{},init:function(e){i=this,n=this.settings,a=this.templates,s=this.widget,t.fn._frameCheck()&&"undefined"==typeof WBK&&(WBK=document.WBK),o=WBK.checkDebug(),this.initSettings(e)},initSettings:function(e){i.setSettings(e.Data.chat),WBK.settings.chatWidgetId=parseInt(e.Settings.chatWidgetId),e=e.Data.chat,WBK.settings.chatEnabled=!0,WBK.settings.chatId=!!e.chatId&&parseInt(e.chatId),n.chatKey=e.chatKey,n.cachedUserKeys=e.cachedUserKeys,n.cachedUsers=e.cachedUsers;var t=wsUtil.getCookie("WidgetChat_first_message_"+WBK.settings.chatWidgetId);t&&(n.first_message=JSON.parse(t)),n.v2_local?i.initLocalBase().then((function(){i.loader(e)})):i.initFirebase().then((function(){i.loader(e)}))},loader:function(e){n.free_chat_widget=parseInt(n.free_chat_widget),n.online_visitor_enable=parseInt(n.online_visitor_enable),n.online_visitor_enable||o&&i.log("Посетители онлайн отключены"),e.auto_call&&(n.autoCall=parseInt(e.auto_call)),e.auto_call_text&&(n.autoCallText=e.auto_call_text),e.auto_call_deffered&&(n.autoCallDeffered=parseInt(e.auto_call_deffered)),e.auto_call_deffered_delay&&(n.autoCallDefferedDelay=parseInt(e.auto_call_deffered_delay)),e.use_telephony_mask&&(n.useTelephonyMask=parseInt(e.use_telephony_mask)),n.free_chat_widget&&o&&i.log("Бесплатная версия чата"),parseInt(n.always_online)&&!n.free_chat_widget&&t.each(n.all_operators,(function(e,t){n.all_operators[e].online=!0}));var a=i.checkWorkDays();if(o&&i.log("Рабочее время: "+a),n.chat_is_online=i.operatorsIsOnline()&&a||parseInt(n.always_online),n.partnerLink||(n.partnerLink="http://"+WBK.settings.servicedomain+"?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=chat&utm_term="),n.widget_logo=parseInt(e.img_logo),n.img_robot_logo=parseInt(e.img_robot_logo),n.img_robot_logo_service=parseInt(e.img_robot_logo_service),n.chat_widget_logo=WBK.settings.staticServerUrl+"/widget/img/chat_robot.png",n.chat_widget_logo_robot=n.chat_widget_logo,n.img_robot_logo_service){var s=new Date;n.chat_widget_logo_robot=WBK.settings.staticServerUrl+"/uploaded/chat_widgets_service/"+WBK.settings.serviceid+"/logo_robot.png?"+s.getTime()}switch(n.img_robot_logo&&(s=new Date,n.chat_widget_logo_robot=WBK.settings.staticServerUrl+"/uploaded/chat_widgets/"+WBK.settings.chatWidgetId+"/logo_robot.png?"+s.getTime()),n.widget_logo&&(s=new Date,n.chat_widget_logo=WBK.settings.staticServerUrl+"/uploaded/chat_widgets/"+WBK.settings.chatWidgetId+"/logo.png?"+s.getTime()),n.btn_corner_class="",n.corner_type){case"smooth":n.btn_corner_class="ws-chat-btn-mini-round";break;case"flat":n.btn_corner_class="";break;case"round":n.btn_corner_class="ws-chat-btn-round"}n.auto_reply_not_connected_and_operators_offline_need_to_show=!1,n.disableMobileOpenHash=parseInt(e.disable_mobile_open_hash),n.chat_introduced=e.chat_introduced?parseInt(e.chat_introduced):0,n.logo_visitor=!!parseInt(n.chat_introduced)&&n.chat_visitor_img,i.updateUser(),i.setTemplate(),i.initWidget()},initWidget:function(){WBK.loadFont(),WBK.addStyles(".ws-chat-message-manager .ws-chat-message, .ws-chat-message-robot .ws-chat-message, .ws-chat-message-manager:before, .ws-chat-message-robot:before{background-color: "+n.color_background_message_operator+" !important;}.ws-chat-message-user .ws-chat-message, .ws-chat-message-user:before{background-color: "+n.color_background_message_user+" !important;}.ws-chat-message-manager .ws-chat-message-source, .ws-chat-message-manager .ws-chat-message-date, .ws-chat-message-robot .ws-chat-message-source, .ws-chat-message-robot .ws-chat-message-date{color: "+n.color_text_message_operator+" !important;}.ws-chat .ws-chat-container .ws-chat-message-source .ws-chat-message-link, .ws-chat .ws-chat-container .ws-chat-message-source .ws-chat-message-link:visited, .ws-chat .ws-chat-container .ws-chat-message-source .ws-chat-message-link:active{color: "+n.color_text_message_operator+" !important;}.ws-chat .ws-chat-container .ws-chat-message-source .ws-chat-message-link:hover{color: "+n.color_text_message_operator+" !important;}.ws-chat-message-user .ws-chat-message-source, .ws-chat-message-user .ws-chat-message-date{color: "+n.color_text_message_user+" !important;}.ws-chat .ws-chat-container .ws-chat-message-user .ws-chat-message-source .ws-chat-message-link, .ws-chat .ws-chat-container .ws-chat-message-user .ws-chat-message-source .ws-chat-message-link:visited, .ws-chat .ws-chat-container .ws-chat-message-user .ws-chat-message-source .ws-chat-message-link:active{color: "+n.color_text_message_user+" !important;}.ws-chat .ws-chat-container {background-color: "+n.color_background_window+" !important;}.ws-chat .ws-chat-container:before {background-color: "+n.color_background_window+" !important;}.ws-chat .ws-chat-container .ws-chat-message-user .ws-chat-message-source .ws-chat-message-link:hover{color: "+n.color_text_message_user+" !important;}.ws-chat .ws-chat-invitation-container{background-color: "+n.color_background_invitation+" !important;}.ws-chat .ws-chat-invitation-text{background-color: "+n.color_background_invitation_message+" !important;}.ws-chat .ws-chat-invitation-body-text:before{background-color: "+n.color_background_invitation_message+" !important;}.ws-chat .ws-chat-invitation-input{background-color: "+n.color_background_invitation_input+" !important;}.ws-chat .ws-chat-invitation-name{color: "+n.color_text_invitation+" !important;}.ws-chat .ws-chat-invitation-position{color: "+n.color_text_invitation+" !important;}.ws-chat .ws-chat-invitation-container .ws-icon-close{color: "+n.color_text_invitation+" !important;}.ws-chat .ws-chat-invitation-typing{color: "+n.color_text_invitation+" !important;}.ws-chat .ws-chat-invitation-container .ws-chat-invitation-body .ws-chat-invitation-body-el .ws-chat-invitation-text{color: "+n.color_text_invitation_message+" !important;}.ws-chat .ws-chat-invitation-container .ws-chat-invitation-body .ws-chat-invitation-body-el .ws-chat-invitation-text a{color: "+n.color_text_invitation_message+" !important; text-decoration: underline !important;}.ws-chat .ws-chat-body-content .ws-chat-message-with-pick-department .ws-chat-message-option-pick-department:hover {background-color:"+i.makeOpacityColor(n.color_background_message_operator,2)+"}.ws-chat .ws-chat-body-content .ws-chat-message-robot-pick-department:before {background-color: #fff !important;}.ws-chat .ws-chat-shadow {background: linear-gradient(to bottom, "+n.color_background_window+" 0%,rgba(255,255,255,0) 100%);}"),s.container=t(a),s.window=s.container.find(".ws-chat-container").hide(),s.btn=s.container.find(".ws-chat-btn-container").hide(),s.btn_el=s.container.find(".ws-chat-btn-el-container"),s.invitation=s.container.find(".ws-chat-invitation-container").hide(),s.container.appendTo("body"),wsUtil.fixFastClick(),4==+n.chat_distribution&&n.chat_department_distribution.length&&!n.chat_created&&t.each(n.chat_department_distribution,(function(e,t){Object.keys(t.employees).length&&(n.chat_distribution_department_enabled=!0)}));var e=n.text_button_online;"pc"!=WBK.settings.device?(s.container.addClass("ws-chat-mobile"),e=n.mobile_text_button_online,WBK.addStyles(".ws-chat .ws-chat-btn-container{background: "+n.mobile_color_background_button+"!important;}.ws-chat .ws-chat-btn-container .ws-btn-title{color: "+n.mobile_color_background_button_text+"!important;}")):(s.btn.addClass(n.btn_corner_class),WBK.addStyles(".ws-chat .ws-chat-btn-container{background: "+n.color_background_button+"!important;}.ws-chat .ws-chat-btn-container .ws-btn-title{color: "+n.color_background_button_text+"!important;}"),s.btn.find(".ws-btn-title").html(e)),n.widget_logo&&(s.window.addClass("ws-chat-logo-yes"),s.btn.addClass("ws-chat-btn-logo-yes")),(n.img_robot_logo||n.img_robot_logo_service)&&s.window.addClass("ws-chat-logo-robot-yes");var r,l=wsUtil.getCookie("WidgetChat_sound_"+WBK.settings.chatWidgetId);if(l?(n.sound=l,"off"==n.sound?(s.window.find(".ws-chat-sound").attr("title",n.lang_text.sound_on),s.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-on").addClass("ws-icon-sound-off")):(s.window.find(".ws-chat-sound").attr("title",n.lang_text.sound_off),s.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-off").addClass("ws-icon-sound-on"))):"off"==n.sound&&(s.window.find(".ws-chat-sound").attr("title",n.lang_text.sound_on),s.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-on").addClass("ws-icon-sound-off")),WBK.settings.hideCopyright?t(".ws-chat-copyright").hide():t("body").on("click",".ws-chat-copyright-url",(function(e){WBK.sendAdvertLinkStat(t(this).data("widget"),t(this).attr("href"),t(this).text(),WBK.settings.chatWidgetId)})),i.loadBtnEvents(),i.loadWindowEvents(),n.messages_quant_to_rate=0,n.chat_is_online)WBK.settings.chatId?(i.addOldMessages(),i.operatorsUpdate()):(n.operators_online_keys.length&&"robot"!==n.hello_message_author?i.showHelloMessageOperators():i.showHelloMessage(),n.is_first_message=!0,n.send_autoreply_first=!0),i.initRating(),i.checkRatingSettings();else{if("hide"==n.operator_offline_action)return o&&i.log("Операторы офлайн и отключена оффлайн форма"),void i.showOffline();i.showOffline()}if(i.initBtnPosition(),WBK.settings.chatId||"hide"==n.button_location||"pc"!=WBK.settings.device&&parseInt(n.hide_mobile)||i.checkInvitation(),n.chat_invitation_has_scroll_rule&&t(window).on("scroll.callbackkillerchat",(function(){i.onScroll()})),n.agreementLink&&s.window.find(".ws-chat-agreement-link").attr("href",n.agreementLink),!t.fn._frameCheck()||"undefined"!=typeof WBK)try{r=window.top.location.hash}catch(e){}wsUtil.getCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId)&&wsUtil.getCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId)&&n.chat_is_online?i.showWidget():"#showchat"===r?(i.initWindowPosition(),i.showWidget(),i.sendGoal("open"),i.autoSendMessage()):(s.btn.css("display","flex"),WBK.settings.chatBtnOpened=!0,wsUtil.getCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId)&&wsUtil.deleteCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId),i.initWindowPosition(),("hide"==n.button_location||"pc"!=WBK.settings.device&&parseInt(n.hide_mobile))&&(s.btn.hide(),WBK.settings.chatBtnOpened=!1)),"pc"==WBK.settings.device||n.disableMobileOpenHash||t(window).on("hashchange",(function(e){"-1"!=e.originalEvent.oldURL.search("#chatIsShown")&&WBK.settings.chatWindowOpened&&(i.hideWidget(),window.location.hash="")})),i.recalculateWidthButton(),s.window.find(".ws-offline-textarea, .ws-textarea").on("selectstart",(function(e){return e.stopPropagation(),!0})),s.window.find(".ws-offline-textarea, .ws-textarea").css("user-select","text"),i.createVisitor()},loadFirebase:function(){var e=this,i=t.Deferred();return wsUtil.getScript(WBK.settings.staticServerUrl+"/widget/src/libs/firebase/firebase.js",(function(){var a={apiKey:n.FirebaseApiKey,authDomain:n.FirebaseAuthDomain,databaseURL:n.FirebaseDatabaseURL};n.FirebaseDatabaseURLMinProxy&&(wsUtil.setStorage("firebase:host:"+n.FirebaseDatabaseURLMin,'"'+n.FirebaseDatabaseURLMinProxy+'"'),wsUtil.deleteStorage("firebase:previous_websocket_failure")),n.firebase=firebase.initializeApp(a),n.FirebaseServiceRef="services/"+WBK.settings.serviceid+"/accounts/"+WBK.settings.accountid,n.fireDB=n.firebase.database().ref(n.FirebaseServiceRef);var s=["getFirebaseUsers"];n.chatKey&&s.push("loadFireChat"),s=s.map((function(t){return e[t]()})),t.when.apply(t,s).done((function(){e.setupConnectionObserver(),i.resolve()}))}),!0),i.promise()},loadFireChat:function(){var e=this,a=t.Deferred();return e.getChatRef().once("value").then((function(t){n.fireChat=t.val(),e.getChatRef().on("child_changed",(function(e){i.updateFireChat(e.key,e.val())})),e.getChatRef().on("child_added",(function(e){i.updateFireChat(e.key,e.val())})),e.getChatRef().on("child_removed",(function(e){i.updateFireChat(e.key,"")})),e.startUpdateVisitorStatus(),n.chat_created||i.loadFireChatData(t.val()).then((function(){n.chat_created=!0,a.resolve()}))})),a.promise()},setupConnectionObserver:function(){var e=this;n.firebase.database().ref(".info/connected").on("value",(function(t){if(t.val()){if(!n.chatKey)return;setTimeout((function(){e.loadChatMessages.call(e).then((function(){n.unread_messages_count=0,e.addOldMessages.call(e),e.scroll()}))}),1500)}}))},startUpdateVisitorStatus:function(){var e=this;n.fireChat&&n.fireChat.visitor&&(i.updateUserInBase(n.fireChat.visitor,{online:!0,lastActiveAt:{".sv":"timestamp"}}),e.updateVisitorStatus(),wsUtil.setInterval("updateVisitorStatus",(function(){n.fireChat&&n.fireChat.visitor&&e.updateVisitorStatus()}),2e4))},updateVisitorStatus:function(e){e={key:n.fireChat.visitor,chatKey:n.chatKey,serviceId:WBK.settings.serviceid,accountId:WBK.settings.accountid,useLocalBase:n.v2_local};var t=n.firebaseNodeUrl+"/visitor/setOnline";jWS.getJSON(t,e)},loadChatMessages:function(){var e=t.Deferred();return this.getChatMessageRef().once("value").then((function(t){n.fireOldMessages=t.val(),e.resolve()})),e.promise()},loadChatOtherUsers:function(e){var i=t.Deferred();return this.getChatUsersRef().child(e.visitor).once("value").then((function(e){var t=e.val();n.fireSender=e.key,n.fireUsers.hasOwnProperty("visitor")&&(t.name=n.fireUsers.visitor.name,t.photo=n.fireUsers.visitor.photo),n.fireUsers[e.key]=t,i.resolve()})),i.promise()},loadFireChatData:function(e){var i=this,a=t.Deferred();return t.when(this.loadChatMessages(),this.loadChatOtherUsers(e)).done((function(){i.getChatMessageRef().orderByChild("sentAt").limitToLast(1).on("child_added",(function(e){var t=e.val();if(t.sender!==n.fireSender){var a="operator"==n.fireUsers[t.sender].role&&"system"!=t.type,s="system"==t.type&&"pay_link"==t.subType,o="text"===t.type;(a||s||o)&&(t.key=e.key,i.onOperatorMessage(t))}})),i.getChatMessageRef().on("child_changed",(function(e){i.updateMessageDataById(e.key,e.val())})),a.resolve()})),a.promise()},initLocalBase:function(){var e=t.Deferred();return wsUtil.getScript(WBK.settings.staticServerUrl+"/build/lib/js/chat_local_server.min.js",(function(){ChatLocalServer.init(WBK.settings.serviceid,WBK.settings.accountid,WBK.settings.chatWidgetId,WBK.settings.visitorId,n.chat_server_url),parseInt(n.always_online)||parseInt(n.online_visitor_enable)&&!n.free_chat_widget?i.loadOnlineLocalServer().then((function(){return e.resolve()})):i.checkUserOnline().then((function(){return e.resolve()}))})),e.promise()},checkUserOnline:function(){var e=t.Deferred();return ChatLocalServer.checkOperatorsOnline().then((function(t){if(!(+t.online_count>0))return e.resolve();i.loadOnlineLocalServer().then((function(t){e.resolve()}))})),e.promise()},loadOnlineLocalServer:function(){var e=t.Deferred();return this.initLocalSocket().then((function(){var a=["getLocalUsers"];n.chatKey&&a.push("loadLocalChat"),a=a.map((function(e){return i[e]()})),t.when.apply(t,a).done((function(){e.resolve()}))})),e.promise()},getLocalChat:function(){var e=t.Deferred();return ChatLocalServer.getWidgetChat(n.chatKey).then((function(t){return ChatLocalServer.listenChatUpdated((function(e){i.updateChatDataListener(e)})),ChatLocalServer.listenChatDeleted(function(e){n.chat_created=!1,n.chatKey=null}.bind(i)),e.resolve(t)})),e.promise()},updateChatDataListener:function(e){var n=["status","noAnswerRequired","operators","rate","visitorBlocked"];t.each(e,(function(e,t){n.includes(e)&&i.updateFireChat(e,t)}))},loadLocalChatMessages:function(){var e=t.Deferred();return ChatLocalServer.getChatMessages(n.chatKey,n.last_message_id).then((function(t){return n.fireOldMessages=t,e.resolve(t)})),e.promise()},loadLocalChatVisitor:function(e){var i=t.Deferred();return ChatLocalServer.getChatVisitor(e.visitor,WBK.settings.visitorId).then((function(e){return n.fireSender=e.key,n.fireUsers.hasOwnProperty("visitor")&&(e.name=n.fireUsers.visitor.name,e.photo=n.fireUsers.visitor.photo),n.fireUsers[e.key]=e,i.resolve(e)})),i.promise()},getLocalUsers:function(){var e=t.Deferred();return this.loadLocalUsers().then((function(a){return n.fireUserKeys=Object.keys(a),n.fireUsers=a,n.all_operators=t.extend(!0,{},a),i.subscribeLocalUsers(),o&&i.log("Операторы: "+JSON.stringify(n.fireUsers)),e.resolve()})),e.promise()},subscribeLocalUsers:function(){ChatLocalServer.listenUserUpdated((function(e){var t=null;n.fireUsers.hasOwnProperty(e.key)&&(t=n.fireUsers[e.key]),n.fireUsers[e.key]=Object.assign(t||{},e),(null==t||null!==t&&e.online!==t.online)&&i.operatorsUpdate()}))},loadLocalUsers:function(){var e=t.Deferred();return ChatLocalServer.getWidgetUsers().then((function(i){var a={};t.each(i,(function(e,t){if(t){var i=t;if("operator"==i.role&&(a[t.key]=i,i.hasOwnProperty("aliases")&&i.aliases.hasOwnProperty(WBK.settings.chatWidgetId))){var s=i.aliases[WBK.settings.chatWidgetId];i.name=s.name?s.name:i.name,i.photo=s.photo?s.photo:i.photo,i.position=s.position?s.position:i.position}"robot"==i.role&&(i.key=t.key,a[t.key]=i,n.fireRobot=i)}})),e.resolve(a)})),e.promise()},initLocalSocket:function(){var e=t.Deferred();if(!this.socketStarted)return ChatLocalServer.initSocket(i.restoredConnection.bind(i)).then((function(){return e.resolve()})),e.promise();e.resolve()},restoredConnection:function(){this.loadLocalChatMessages().then(this.addOldMessages.bind(i)).then(this.scroll)},loadLocalChat:function(){var e=t.Deferred();return i.getLocalChat().then((function(t){n.fireChat=t,i.startUpdateVisitorStatus(),n.chat_created||i.loadLocalChatData(t).then((function(){i.joinChat().then((function(){n.chat_created=!0,e.resolve()}))}))})),e.promise()},loadLocalChatData:function(e){var a=t.Deferred();return t.when(this.loadLocalChatMessages(),this.loadLocalChatVisitor(e)).done((function(){ChatLocalServer.listenMessageCreated((function(e){if(n.last_message_id=e.id,e.sender!==n.fireSender){var t="operator"==n.fireUsers[e.sender].role&&"system"!=e.type,a="system"==e.type&&"pay_link"==e.subType,s="text"===e.type;(t||a||s)&&i.onOperatorMessage(e)}else i.onVisitorMessage(e)})),ChatLocalServer.listenMessageUpdated((function(e){i.updateMessageDataById(e.key,e)})),ChatLocalServer.listenPrinting((function(e){i.showPrinting(e)})),a.resolve()})),a.promise()},joinChat:function(){var e=t.Deferred();return ChatLocalServer.joinChat(n.chatKey).then((function(t){return console.log("join chat"),console.log(t),e.resolve()})),e.promise()},initFirebase:function(){var e=t.Deferred();return this.loadFirebase().then((function(){return e.resolve()})),e.promise()},getUserInFirebaseByKey:function(e){var i=t.Deferred();return this.getChatUsersRef().child(e).once("value").then((function(e){var t=e.val();t&&(t.key=e.key),i.resolve(t)})),i.promise()},getUserDataInFirebaseByKey:function(e,i){var n=t.Deferred();return this.getChatUsersRef().child(e+"/"+i).once("value").then((function(e){var t=e.val();n.resolve(t)})),n.promise()},loadUserDataFirebase:function(e){var i=this,n=t.Deferred(),a=["online","lastActiveAt"],s=a.map((function(t){return i.getUserDataInFirebaseByKey(e,t)})),o=[],r={};return t.when.apply(t,s).then((function(){var e=arguments;t.each(e,(function(e,t){o.push(t)})),t.each(a,(function(e,t){r[t]=o[e]})),n.resolve(r)})),n.promise()},doLoadFirebaseUsers:function(e){var i=this,a=t.Deferred(),s=e.map((function(e){return i.loadUserDataFirebase(e)}));return t.when.apply(t,s).then((function(){var i=arguments;t.each(e,(function(e,t){n.cachedUsers[t].online=i[e].online,n.cachedUsers[t].lastActiveAt=i[e].lastActiveAt})),a.resolve(n.cachedUsers)})),a.promise()},loadFirebaseUsers:function(e){var i=this,n=t.Deferred(),a=e.map((function(e){return i.getUserInFirebaseByKey(e)}));return t.when.apply(t,a).then((function(){var e=arguments,i={};t.each(e,(function(e,t){t&&(i[t.key]=t)})),n.resolve(i)})),n.promise()},getFirebaseUsers:function(){var e=this,a=t.Deferred();return e.getFireUserKeys().then((function(s){n.fireUserKeys=s,o&&i.log("Операторы в виджете: "+s),e.getFormatFireUsers().then((function(s){n.fireUsers=s,n.all_operators=t.extend(!0,{},s),e.subscribeUsers(),o&&i.log("Операторы: "+JSON.stringify(n.fireUsers)),a.resolve()}))})),a.promise()},getFormatFireUsers:function(){var e=t.Deferred();return this.getFireUsers().then((function(i){var a={};t.each(i,(function(e,t){if(t.key=e,a[e]=t,"operator"===t.role&&t.hasOwnProperty("aliases")&&t.aliases.hasOwnProperty(WBK.settings.chatWidgetId)){var i=t.aliases[WBK.settings.chatWidgetId];t.name=i.name?i.name:t.name,t.photo=i.photo?i.photo:t.photo,t.position=i.position?i.position:t.position}"robot"===t.role&&(n.fireRobot=t)})),e.resolve(a)})),e.promise()},getFireUsers:function(){var e=t.Deferred();return n.cachedUserKeys&&n.cachedUserKeys.length?this.doLoadFirebaseUsers(n.fireUserKeys).then((function(t){e.resolve(t)})):this.loadFirebaseUsers(n.fireUserKeys).then((function(t){e.resolve(t)})),e.promise()},getFireUserKeys:function(){var i=t.Deferred();return n.cachedUserKeys&&n.cachedUserKeys.length?i.resolve(n.cachedUserKeys):n.fireDB.child("user-keys/"+WBK.settings.chatWidgetId).once("value").then((function(t){var n="object"===e(t.val())?Object.keys(t.val()):[];i.resolve(n)})),i.promise()},subscribeUsers:function(){for(var e=this,t=0;t<n.fireUserKeys.length;t++){var i=n.fireUserKeys[t];e.getChatUsersRef().child(n.fireUserKeys[t]+"/online").on("value",function(t,i){n.fireUsersOnlineKeys.hasOwnProperty(t)?(n.fireUsers[t]=i.val(),e.operatorsUpdate()):n.fireUsersOnlineKeys[t]=!0}.bind(null,i))}},getChatUsersRef:function(){return n.fireDB.child("users")},getChatRef:function(){return n.fireDB.child("chats/"+n.chatKey)},getChatMessageRef:function(){return n.fireDB.child("chat-messages/"+n.chatKey)},getChatVisitorRef:function(){return n.fireDB.child("visitors/"+n.chatKeyVisitor)},onScroll:function(){wsUtil.setTimeout("scrollTimerChatInvitation",(function(){i.checkInvitation()}),250)},showBtn:function(){s.btn.css("display","flex"),"horizontal"==n.button_location&&WBK.animateFastOnce(s.btn,"cbk-zoomIn"),WBK.settings.chatBtnOpened=!0},hideBtn:function(){s.btn.hide(),WBK.animateFastOnce(s.btn,"cbk-zoomOut"),WBK.settings.chatBtnOpened=!1},showWidget:function(){if(this.smilesInit(),WBK.settings.multiButtonEnabled){var e=!1;t.each(wsMultiButton.settings.checked_variants,(function(t,i){"chat"===i.action&&i.action_value==WBK.settings.chatWidgetId&&(e=!0)})),e&&wsMultiButton.hideWidget()}if(i.hideBtn(),WBK.settings.chatInvitationOpened&&i.hideInvitation(),WBK.settings.windowInvaderOpened&&(wsInvader.widget.window.find(".cbk-support-new-message-copyright").hide(),wsInvader.widget.window.hide()),(o=new Date).setMinutes(o.getMinutes()+1440),wsUtil.setCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId,!0,o),n.chat_is_online&&"pc"==WBK.settings.device&&wsUtil.getCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId)){var a=JSON.parse(wsUtil.getCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId));s.window.css({top:a.top,left:a.left,width:a.width,height:a.height})}if("pc"!=WBK.settings.device&&(n.scroll_left=t(window).scrollLeft(),n.scroll_top=t(window).scrollTop(),t("meta[name=viewport]").length?(s.window.data("oldViewport",t("meta[name=viewport]").last().attr("content")),t("meta[name=viewport]").remove()):s.window.data("noViewport",1),t("head").append(t("<meta>").attr("name","viewport").attr("content","width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0")),s.window.data("oldBodyWidth",document.body.style.width),t("body").addClass("cbk-body-mobile").css("width",t(window).width()+"px"),n.unread_messages_count&&i.setUnreadMessages(0),n.disableMobileOpenHash||(window.location.hash="chatIsShown")),(o=new Date).setMinutes(o.getMinutes()+144e3),wsUtil.setCookie("WidgetChat_shownOn",n.chat_is_online?"on_btn":"on_btn_offline",o),s.window.show(),"pc"==WBK.settings.device&&WBK.animateFastOnce(s.window,"cbk-zoomIn"),WBK.settings.chatWindowOpened=!0,n.chat_is_online&&("pc"===WBK.settings.device?(s.window.find(".ws-textarea").focus(),s.window.find(".ws-chat-body-preform").is(":visible")&&this.reinitPreformPosition()):this.messageReadVisitor()),n.chatKey&&n.chat_created)i.sendRobot({text:n.lang_text.visitor_open_window,subType:"open_window"});else{var o,r=wsUtil.getStorage("WidgetChat_last_shown_invitation_id");if(WBK.settings.chatInvitationShown&&((o=new Date).setMinutes(o.getMinutes()+144e3),wsUtil.setCookie("WidgetChat_shownOn",n.chat_is_online?"on_inv":"on_inv_offline",o)),!WBK.settings.chatInvitationShown&&r&&n.invitations){WBK.settings.chatInvitationShown=!0;var l=!1;t.each(n.invitations,(function(e,t){n.invitations[e].id==r&&(l=e)})),!1!==l&&(n.invitation_operator_key=i.getOperatorKeyForInvitation(l),n.invitations[l]=i.formatInvitation(n.invitations[l]),n.chat_is_online&&parseInt(n.invitations[l].invitation_always)&&i.appendInvitation(l))}}if(i.sendShowType(),n.first_message&&i.send(n.first_message),s.window.find(".ws-chat-body").nanoScroller({scroll:"bottom",contentClass:"ws-chat-body-content",paneClass:"ws-chat-body-pane",sliderClass:"ws-chat-body-slider",childNanoscrollContainer:".ws-chat-quick-messages"}),s.window.find(".ws-textarea-group").nanoScroller({scroll:"bottom",contentClass:"ws-textarea",paneClass:"ws-textarea-pane",sliderClass:"ws-textarea-slider",preventPageScrolling:!0}),wsUtil.fixBootstrap(),n.quick_messages&&i.checkQuickMessage(),"function"==typeof window.ws_OnChatShowWidget&&window.ws_OnChatShowWidget(),i.typingPositionUpdate(),n.unread_messages.length>0&&i.scroll(),(o=new Date).setMinutes(o.getMinutes()+1440),a=JSON.stringify({top:s.window.css("top"),left:s.window.css("left"),width:s.window.css("width"),height:s.window.css("height")}),wsUtil.setCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId,a,o),wsUtil.getStorage("ws_chat_input_text_"+WBK.settings.chatWidgetId)){var c=wsUtil.getStorage("ws_chat_input_text_"+WBK.settings.chatWidgetId);c=wsUtil.isAppleOS()?c.replace(/\n/g,"<div><br></div>"):c.replace(/\n/g,"<br>"),t(".ws-textarea").html(c),s.window.find(".ws-textarea-group .ws-textarea-placeholder").hide(),s.window.find(".ws-textarea-send-btn").css("display","flex"),s.window.find(".ws-textarea").focus()}},checkQuickMessage:function(){if(n.quick_messages&&!parseInt(n.free_chat_widget))if(Object.keys(n.fireOldMessages).length)o&&i.log("Быстрые сообщения уже были показаны");else if(wsUtil.getCookie("WidgetChat_close_quick_messages_"+WBK.settings.chatWidgetId))o&&i.log("Быстрые сообщения ране были скрыты");else{o&&i.log("Проверяем быстрые сообщения"),n.quick_messages.sort((function(e,t){return e.rules.length>0&&t.rules.length>0||0===e.rules.length&&0===t.rules.length?e.position-t.position:e.rules.length>0&&0===t.rules.length||0===e.rules.length&&t.rules.length>0?t.rules.length-e.rules.length:void 0}));for(var e=0;e<n.quick_messages.length;e++)if(n.showed_quick_messages)o&&i.log("быстрое сообщение № "+n.quick_messages[e].id+" уже было показано");else if(n.quick_messages[e].rules.length){var a={contains:0,not_contains:1,equally:2,regular:3,not_equally:4},r=0,l=0,c=decodeURIComponent(window.location.toString());c||(c=window.location.toString()),t.each(n.quick_messages[e].rules,(function(e,t){switch(t.name){case"url":switch(parseInt(t.type)){case a.contains:c.indexOf(t.value)+1?l++:r++;break;case a.not_contains:c.indexOf(t.value)+1===0?l++:r++;break;case a.equally:c==t.value?l++:r++;break;case a.regular:new RegExp(t.value,"gi").test(c)?l++:r++;break;case a.not_equally:c!=t.value?l++:r++}break;case"device":1==parseInt(t.type)?t.value.trim()==WBK.settings.device?l++:r++:t.value.trim()!=WBK.settings.device?l++:r++}})),r&&o&&i.log("Не выполнены условия показа быстрого сообщения № "+n.quick_messages[e].id),"all"===n.quick_messages[e].check&&0==r&&(o&&i.log("Выполнены все правила показа быстрого сообщения № "+n.quick_messages[e].id),o&&i.log("Показ быстрого сообщения"),i.showQuickMessage(e)),"one"===n.quick_messages[e].check&&l>0&&(o&&i.log("Выполнено 1 правило показа быстрого сообщения № "+n.quick_messages[e].id),o&&i.log("Показ быстрого сообщения"),i.showQuickMessage(e))}else i.showQuickMessage(e);/iPad|iPhone|iPod/.test(navigator.userAgent)&&!s.window.MSStream||(t(".ws-chat-quick-messages").addClass("ws-chat-height-fixed"),s.window.find(".ws-chat-quick-messages").is(":visible")&&s.window.find(".ws-chat-quick-messages").nanoScroller({scroll:"top",contentClass:"ws-chat-quick-messages-group",paneClass:"ws-chat-quick-messages-pane",sliderClass:"ws-chat-quick-messages-slider",parentNanoscrollContainer:".ws-chat-body"}),s.window.find(".ws-chat-body").nanoScroller())}else o&&i.log("Нет быстрых сообщений или бесплатная версия")},startListenEventOnClickQuickMessages:function(){s.window.find(".ws-chat-quick-message").on("click",(function(){i.send({text:t(this).text(),type:"text"},{scroll:!0}),n.sent_quick_messages=!0,t(".ws-chat-quick-messages-group").html("");var e=s.window.find(".ws-textarea");wsUtil.setFocusContentEditable(e[0]),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!s.window.MSStream&&t(".ws-chat-body-pane").addClass("ws-hide"),setTimeout((function(){i.typingPositionUpdate()}),500)}))},showQuickMessage:function(e){if(!n.show_quick_message&&!n.showed_quick_messages){t(".ws-chat-manager-hello").css("padding","15px 0 15px 10px"),t(".ws-chat-quick-messages").removeClass("ws-hide");var i="";for(var a in n.quick_messages[e].messages)n.quick_messages[e].messages.hasOwnProperty(a)&&void 0!==n.quick_messages[e].messages[a].message&&(i+='<div class="ws-chat-quick-message">'+n.quick_messages[e].messages[a].message+"</div>");t(".ws-chat-quick-messages-group").html(i),this.startListenEventOnClickQuickMessages(),n.showed_quick_messages=!0,n.show_quick_message=!0}},sendShowType:function(){var e=WBK.settings.serverUrl+"/api?action=chatNewShow&callback=?";t.getJSON(e,{type_show:wsUtil.getCookie("WidgetChat_shownOn"),status:n.chat_is_online?1:0,device:WBK.settings.device,code:WBK.settings.whiteSaasCode,googleClientId:wsUtil.getGoogleClientId(),chatId:WBK.settings.chatWidgetId,visitorId:WBK.settings.visitorId,advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId(),leadvertexId:wsUtil.getLeadvertexId(),externalParams:wsUtil.getExternalParams()})},hideWidget:function(){s.window.hide(),WBK.animateFastOnce(s.window,"cbk-zoomOut"),WBK.settings.chatWindowOpened=!1;var e=new Date;if(e.setMinutes(e.getMinutes()+144e3),wsUtil.deleteCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId),"pc"!=WBK.settings.device&&(s.window.data("noViewport")?(s.window.data("noViewport",0),t("meta[name=viewport]").attr("content","")):t("meta[name=viewport]").attr("content",s.window.data("oldViewport")),t("body").removeClass("cbk-body-mobile").css("width",s.window.data("oldBodyWidth")),t(window).scrollTop(n.scroll_top),t(window).scrollLeft(n.scroll_left)),"hide"==n.button_location||"pc"!=WBK.settings.device&&parseInt(n.hide_mobile)||i.showBtn(),n.chatKey&&n.chat_created&&i.sendRobot({text:n.lang_text.visitor_close_window,subType:"close_window"}),!n.chat_is_online){var a=s.window.find(".ws-chat-body-offline");a.children().not(".ws-hide").show(),a.find(".ws-chat-offline-text-success").hide(),wsUtil.deleteTimeout("chatOfflineHide")}WBK.settings.multiButtonId&&wsMultiButton.reInitWidget(),WBK.settings.chatWindowOpened||WBK.settings.windowOpened||WBK.settings.windowQuizOpened||WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||jWS(window).trigger("envy:resize"),"function"==typeof window.ws_OnChatHideWidget&&window.ws_OnChatHideWidget()},checkInvitation:function(e){if(n.invitations&&!parseInt(n.free_chat_widget))if(o&&i.log("Проверяем автоприглашения"),"hide"!=n.button_location)for(var a=0;a<n.invitations.length;a++)if(wsUtil.getCookie("WidgetChat_invitation_"+n.invitations[a].id))o&&i.log("автоприглашение № "+n.invitations[a].id+" уже было показано");else if(n.invitations[a].rules.length){var s,r=0,l=0,c=0,d=1,h=[];try{s=decodeURIComponent(window.location.toString())}catch(e){s=window.location.toString()}t.each(n.invitations[a].rules,(function(e,a){switch(a.name){case"rule_url":switch(parseInt(a.type)){case 0:s.indexOf(a.value)+1?l++:r++;break;case 1:s.indexOf(a.value)+1==0?l++:r++;break;case 2:s==a.value?l++:r++;break;case 3:new RegExp(a.value,"gi").test(s)?l++:r++;break;case 4:s!=a.value?l++:r++}break;case"rule_time":h.push(parseInt(a.value)),c++;break;case"rule_time_site":var o=wsUtil.getCookie("WhiteCallback_timeAll")?parseInt(wsUtil.getCookie("WhiteCallback_timeAll")):1,d=parseInt(a.value)-o;h.push(d>1?d:1),c++;break;case"rule_time_close_chat":var u=i.getTimeClosedChat();u?(u=(new Date).setTime(u),u=parseInt(a.value)-((new Date).getTime()-u)/1e3,h.push(u>1?u:1)):h.push(1),c++;break;case"rule_operator":n.chat_is_online?"offline"==a.value?r++:l++:"online"==a.value?r++:l++;break;case"rule_visit_count":var g=WBK.getVisitCount();switch(parseInt(a.type)){case 0:parseInt(a.value)==g?l++:r++;break;case 1:parseInt(a.value)<g?l++:r++;break;case 2:parseInt(a.value)>g?l++:r++}break;case"rule_page_show_count":var p=WBK.getPageShowCount();switch(parseInt(a.type)){case 0:parseInt(a.value)==p?l++:r++;break;case 1:parseInt(a.value)<p?l++:r++;break;case 2:parseInt(a.value)>p?l++:r++}break;case"rule_scroll":var w=t(window).scrollTop()/(t(document).height()-t(window).height())*100;parseInt(a.value)<=w?l++:r++;break;case"rule_name":"known"===a.value?WBK.settings.visitorName?l++:r++:WBK.settings.visitorName?r++:l++;break;case"rule_device":1==parseInt(a.type)?a.value==WBK.settings.device?l++:r++:a.value!=WBK.settings.device?l++:r++}})),r&&o&&i.log("Не выполнены условия показа автоприглашения № "+n.invitations[a].id),"all"==n.invitations[a].check&&0==r&&(o&&i.log("Выполнены все правила показа автоприглашения № "+n.invitations[a].id),h.length>0&&(d=Math.max.apply(null,h)),o&&i.log("Показ автоприглашения через: "+d),i.checkNeedGenerateOrShowInvitation(a,d,e)),"one"==n.invitations[a].check&&(l>0||c>0)&&(o&&i.log("Выполнено 1 правило показа автоприглашения № "+n.invitations[a].id),l>0?d=1:h.length>0&&(d=Math.min.apply(null,h)),o&&i.log("Показ автоприглашения через: "+d),i.checkNeedGenerateOrShowInvitation(a,d,e))}else i.checkNeedGenerateOrShowInvitation(a,1,e);else o&&i.log("Чат скрыт, автоприглашение не нужно");else o&&i.log("Нет автоприглашении или бесплатная версия")},checkNeedGenerateOrShowInvitation:function(e,t,a){parseInt(n.invitations[e].ai_generated_text_enabled)?i.getGeneratedAiInvitation(e,t,a):i.showInvitation(e,t,a)},setGeneratedTextToParentInvitation:function(e,t){n.invitations[t].hello_text=e.hello_text,n.invitations[t].text1=e.main_text,n.invitations[t].text2=e.call_to_action_text,n.invitations[t].ai_invitation_id=e.id,n.invitations[t].generated=!0},getGeneratedAiInvitation:function(e,t,a){var s=document.querySelector('meta[name="keywords"]')?document.querySelector('meta[name="keywords"]').content:"";s||(s=document.querySelector("title")?document.querySelector("title").textContent:"");var o={invitation_id:n.invitations[e].id,generation_params:{keywords:s,description:document.querySelector('meta[name="description"]')?document.querySelector('meta[name="description"]').content:"",name:WBK.settings.visitorName?WBK.settings.visitorName:""}},r=WBK.settings.serverUrl+"/api?action=chatGetAiInvitation";jWS.post(r,{code:WBK.settings.whiteSaasCode,data:o,visitorId:WBK.settings.visitorId},(function(n){n&&n.Success&&n.Data&&(i.setGeneratedTextToParentInvitation(n.Data.ai_invitation,e),i.showInvitation(e,t,a))}),"json")},hideInvitation:function(){WBK.settings.chatInvitationOpened=!1,s.invitation.hide()},getOperatorKeyForInvitation:function(e){var t=!1,i=wsUtil.getStorage("WidgetChat_invitation_operator_id"),a=Object.keys(n.operators_connect);return n.chat_is_online&&(a=n.operators_connect_online_ids),i&&(n.operators_connect.hasOwnProperty(i)||(i=!1)),"operator"==n.invitations[e].operator_type?(t=n.invitations[e].operator_id,n.operators_connect.hasOwnProperty(t)||(t=i||a[wsUtil.getRandomArbitrary(0,a.length-1)])):t=i||a[wsUtil.getRandomArbitrary(0,a.length-1)],wsUtil.setStorage("WidgetChat_invitation_operator_id",t),n.operators_connect[t]},showInvitationByName:function(e){for(var t,i=0;i<n.invitations.length;i++)n.invitations[i].name==e&&(t=i);this.hideInvitation(),WBK.settings.chatInvitationShown=!1,n.show_one_invitation=!1,s.invitation.find(".ws-chat-invitation-logo").text(""),s.invitation.find(".ws-chat-invitation-name, .ws-chat-invitation-position, .ws-chat-invitation-text, .ws-chat-invitation-typing").remove(),this.checkNeedGenerateOrShowInvitation(t,1)},appendInvitation:function(e){var t=(new Date).getTime();n.invitation_show_data={sentAt:t,sender:n.invitation_operator_key,invitation_id:n.invitations[e].id,hello_text:n.invitations[e].hello_text,text1:n.invitations[e].text1,text2:n.invitations[e].text2,ai_invitation_id:n.invitations[e].ai_invitation_id};var a={sender:n.invitation_operator_key,type:"text",sentAt:t,key:"operator_"+t};n.first_message||s.window.find(".ws-chat-robot-hello, .ws-chat-manager-hello, .ws-chat-message-block").remove(),n.invitations[e].hello_text&&(a.text=n.invitations[e].hello_text,i.appendMessage(a)),n.invitations[e].text1&&(a.text=n.invitations[e].text1,a.sentAt=t+1,a.key="operator_"+a.sentAt,i.appendMessage(a)),n.invitations[e].text2&&(a.text=n.invitations[e].text2,a.sentAt=t+2,a.key="operator_"+a.sentAt,i.appendMessage(a)),i.updateVisitorAutoInvite()},showInvitation:function(e,a,o){if(!(WBK.settings.chatId||WBK.settings.chatWindowOpened||n.show_one_invitation||wsUtil.getCookie("WidgetChat_invitation_planed_"+n.invitations[e].id)&&n.chat_invitation_has_scroll_rule)){if(n.chat_invitation_has_scroll_rule){var r=new Date;r.setSeconds(r.getSeconds()+a+2),wsUtil.setCookie("WidgetChat_invitation_planed_"+n.invitations[e].id,"true",r)}wsUtil.setInterval("invitationShow_"+e,(function(){if(!(WBK.settings.chatInvitationOpened||WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||WBK.settings.windowQuizOpened||WBK.settings.windowLoanerOpened||WBK.settings.windowInvaderOpened||WBK.settings.windowOpened||WBK.settings.chatId||WBK.settings.chatWindowOpened||n.show_one_invitation||WBK.settings.multiButtonVariantsOpened)){i.updateVisitorAutoInvite(),wsUtil.setStorage("WidgetChat_last_shown_invitation_id",n.invitations[e].id),WBK.settings.chatInvitationOpened=!0,WBK.settings.chatInvitationShown=!0,n.show_one_invitation=!0;for(var a=0;a<n.invitations.length;a++)wsUtil.deleteInterval("invitationShow_"+a);var r=new Date;if("minutes"==n.invitations[e].repeat_type?r.setMinutes(r.getMinutes()+parseInt(n.invitations[e].repeat_time)):"days"==n.invitations[e].repeat_type&&r.setDate(r.getDate()+parseInt(n.invitations[e].repeat_time)),wsUtil.setCookie("WidgetChat_invitation_"+n.invitations[e].id,"true",r),wsUtil.deleteCookie("WidgetChat_invitation_planed_"+n.invitations[e].id),n.invitation_operator_key=i.getOperatorKeyForInvitation(e),n.invitations[e]=i.formatInvitation(n.invitations[e]),n.chat_is_online&&i.appendInvitation(e),"open_chat"==n.invitations[e].action)return void i.showWidget();s.invitation.find(".ws-chat-invitation-logo").append('<img class="ws-chat-invitation-img" src="'+n.fireUsers[n.invitation_operator_key].photo+'">');var l=n.fireUsers[n.invitation_operator_key].name,c=n.fireUsers[n.invitation_operator_key].position?n.fireUsers[n.invitation_operator_key].position:"";if(s.invitation.hasClass("from-multi-button")&&(c||s.invitation.find(".ws-chat-invitation-body-el").addClass("multi-button-no-profession")),s.invitation.find(".ws-chat-invitation-body-text").before('<div class="ws-chat-invitation-name">'+l+'</div><div class="ws-chat-invitation-position">'+c+"</div>"),n.invitations[e].hello_text?s.invitation.find(".ws-chat-invitation-body-text").append('<div class="ws-chat-invitation-text-box"><div class="ws-chat-invitation-text">'+n.invitations[e].hello_text+"</div></div>"):t(".ws-chat-invitation-body-text").addClass("hide_background_invitation_message"),void 0!==o&&"multi_button"==o&&(wsMultiButton.stopTimer(),t.each(wsMultiButton.settings.checked_variants,(function(e,t){if(t.show_autoreply_icon)return wsMultiButton.showIconVariant(e),!1}))),i.upInvitationIfNotFit(),s.invitation.show(),parseInt(n.invitations[e].autoinvite_play_sound)&&i.playSound("message"),WBK.animateFastOnce(s.invitation,"cbk-zoomIn"),n.invitations[e].text1||n.invitations[e].text2){var d=t('<div class="ws-chat-invitation-typing"><span class="ws-chat-typing-action"><i class="ws-icon-typing"></i></span><span class="ws-chat-invitation-typing-name">'+l+"</span> "+n.lang_text.typing+"...</div>");n.invitations[e].text1&&s.invitation.find(".ws-chat-invitation-body-text").append(d.fadeIn()),wsUtil.setTimeout("invitationMessageTimer",(function(){i.updateVisitorAutoInvite(),s.invitation.find(".ws-chat-invitation-typing").fadeOut((function(){n.invitations[e].text1&&(t(this).remove(),s.invitation.find(".ws-chat-invitation-body-text").append('<div class="ws-chat-invitation-text-box"><div class="ws-chat-invitation-text">'+n.invitations[e].text1+"</div></div>"),t(".ws-chat-invitation-body-text").removeClass("hide_background_invitation_message"))})),n.invitations[e].text2&&wsUtil.setTimeout("invitationMessageTimer",(function(){i.updateVisitorAutoInvite(),s.invitation.find(".ws-chat-invitation-body-text").append(d.fadeIn()),wsUtil.setTimeout("invitationMessageTimer",(function(){i.updateVisitorAutoInvite(),s.invitation.find(".ws-chat-invitation-typing").fadeOut((function(){t(this).remove()})),wsUtil.setTimeout("invitationMessageTimer",(function(){s.invitation.find(".ws-chat-invitation-body-text").append(d.fadeIn()),wsUtil.setTimeout("invitationMessageTimer",(function(){i.updateVisitorAutoInvite(),s.invitation.find(".ws-chat-invitation-typing").fadeOut((function(){t(this).remove(),n.invitations[e].text2&&(s.invitation.find(".ws-chat-invitation-body-text").append('<div class="ws-chat-invitation-text-box"><div class="ws-chat-invitation-text">'+n.invitations[e].text2+"</div></div>"),t(".ws-chat-invitation-body-text").removeClass("hide_background_invitation_message"))}))}),wsUtil.specialChars(n.invitations[e].text2).length/2*110)}),2500),s.invitation.find(".ws-chat-invitation-typing").fadeOut((function(){t(this).remove(),n.invitations[e].text2&&(s.invitation.find(".ws-chat-invitation-body-text").append('<div class="ws-chat-invitation-text-box"><div class="ws-chat-invitation-text">'+n.invitations[e].text2+"</div></div>"),t(".ws-chat-invitation-body-text").removeClass("hide_background_invitation_message"))}))}),wsUtil.specialChars(n.invitations[e].text2).length/2*110)}),2500)}),110*wsUtil.specialChars(n.invitations[e].text1).length)}}}),1e3*a)}},formatInvitation:function(e){if(e.hello_text=WBK.formatText(e.hello_text),e.text1=WBK.formatText(e.text1),e.text2=WBK.formatText(e.text2),WBK.settings.geoCity){WBK.settings.geoCity.name||(WBK.settings.geoCity.name=WBK.settings.geoCity.ip_city);var t="";WBK.settings.visitorName&&(t=WBK.settings.visitorName),e.hello_text=e.hello_text.replace(/\[geocity1\]/g,WBK.settings.geoCity.name),e.hello_text=e.hello_text.replace(/\[geocity2\]/g,WBK.settings.geoCity.name_rod),e.hello_text=e.hello_text.replace(/\[geocity3\]/g,WBK.settings.geoCity.name_mes),e.hello_text=e.hello_text.replace(/\[geocity4\]/g,WBK.settings.geoCity.name_vin),e.hello_text=e.hello_text.replace(/\[name\]/g,t),e.hello_text=e.hello_text.replace(/\[(.+?)\|(.+?)\]/gi,"<a class='ws-text-link' href='$1' target='_blank'>$2</a>"),e.text1=e.text1.replace(/\[geocity1\]/g,WBK.settings.geoCity.name),e.text1=e.text1.replace(/\[geocity2\]/g,WBK.settings.geoCity.name_rod),e.text1=e.text1.replace(/\[geocity3\]/g,WBK.settings.geoCity.name_mes),e.text1=e.text1.replace(/\[geocity4\]/g,WBK.settings.geoCity.name_vin),e.text1=e.text1.replace(/\[name\]/g,t),e.text1=e.text1.replace(/\[(.+?)\|(.+?)\]/gi,"<a class='ws-text-link' href='$1' target='_blank'>$2</a>"),e.text2=e.text2.replace(/\[geocity1\]/g,WBK.settings.geoCity.name),e.text2=e.text2.replace(/\[geocity2\]/g,WBK.settings.geoCity.name_rod),e.text2=e.text2.replace(/\[geocity3\]/g,WBK.settings.geoCity.name_mes),e.text2=e.text2.replace(/\[geocity4\]/g,WBK.settings.geoCity.name_vin),e.text2=e.text2.replace(/\[name\]/g,t),e.text2=e.text2.replace(/\[(.+?)\|(.+?)\]/gi,"<a class='ws-text-link' href='$1' target='_blank'>$2</a>")}return e.hello_text=this.smileReplacer(e.hello_text,"to_img"),e.text1=this.smileReplacer(e.text1,"to_img"),e.text2=this.smileReplacer(e.text2,"to_img"),e},urlInvitationLinkClear:function(e){return e=e.replace(/\<a\ class\=\'ws\-text\-link\'\ href\=\'(.+?)\' target\=\'\_blank\'\>(.+?)<\/a>/gi,"$2")},smileReplacer:function(e,i){return e?(t.each(n.smilesCodes,(function(t,n){"to_img"===i?(a=new RegExp(n,"g"),e=e.replace(a,'<img class="ws-sprite-emoji emoji-img ws-sprite-emoji-'+t+'" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif">')):"to_code"===i&&(a=new RegExp('<img class="ws-sprite-emoji emoji-img ws-sprite-emoji-'+t+'" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif">',"g"),e=e.replace(a,n))})),e):"";var a},smilesInit:function(){var e=s.window.find(".ws-smile-container");0===e.children(".ws-emoji-el").length&&t.each(n.smilesCodes,(function(t){e.append('<a class="ws-emoji-el" href="#"><img class="ws-sprite-emoji emoji-img ws-sprite-emoji-'+t+'" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif"></a>')})),n.on_event.emodji||(s.window.find(".ws-emoji-el").on("click",(function(e){e.preventDefault(),n.chat_is_online?(s.window.find(".ws-textarea").focus(),i.insertHTML(t(this).html())):s.window.find(".ws-offline-textarea").append(t(this).html()),wsUtil.setStorage("ws_chat_input_text_"+WBK.settings.chatWidgetId,t(".ws-textarea").html()),s.window.find(".ws-textarea-send-btn").css("display","flex"),s.window.find(".ws-textarea-group .ws-textarea-placeholder").hide()})),n.on_event.emodji=!0)},showOffline:function(){s.window.addClass("ws-chat-offline"),s.btn.find(".ws-chat-status-online").removeClass("ws-chat-status-online"),"pc"!=WBK.settings.device?s.btn.find(".ws-btn-title").text(n.mobile_text_button_offline):s.btn.find(".ws-btn-title").text(n.text_button_offline),s.window.find(".ws-chat-title").text(n.text_button_offline),s.window.find(".ws-chat-body").hide(),s.window.find(".ws-chat-footer").hide(),s.window.find(".ws-chat-status-online").removeClass("ws-chat-status-online"),s.window.find(".ws-chat-body-offline").show(),n.useTelephonyMask&&WBK.setPhoneInputFocusForm(t(".ws-offline-phone"))},chatAutoCall:function(e,t){if(e&&n.autoCall&&WBK.settings.callbackEnabled){wsKiller.settings.callingWidget=!0;var i=new Date;i.setMinutes(i.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onchat",i),WBK.settings.phoneMask=n.useTelephonyMask?t:WBK.numberMask(e).mask,wsKiller.newCall(e,!1,n.autoCallDeffered,n.autoCallDefferedDelay)}},sendOfflineMessage:function(){if(!n.offline_message_sending){n.offline_message_sending=!0,(l=s.window.find(".ws-chat-body-offline")).find(".ws-offline-textarea").removeClass("ws-input-error"),l.find(".ws-offline-input").removeClass("ws-input-error");var e,a=l.find(".ws-offline-name").val(),o=l.find(".ws-offline-email").val(),r=l.find(".ws-offline-phone").val();n.useTelephonyMask?(e=l.find(".ws-offline-phone").attr("placeholder"),r=WBK.checkPhone(r,!0)):(n.user_phone_without_dial_code=r,r=(r=this.getActualPhoneWithCountryCode(r,"offlinePhone")).replace(/[^\d]/g,"")),r=r||"";var l,c=t(".ws-offline-email-agreement").is(":checked")?1:0,d=t(".offline-email-distribution-agreement").is(":checked")?1:0,h=i.smileReplacer(i.cleanMessage(l.find(".ws-offline-textarea")),"to_code"),u="";if("yes"==n.get_contact_offline_name&&""==a.trim()&&(u=".ws-offline-name"),"yes"==n.get_contact_offline_phone&&""==r.trim()&&(u?u+=", .ws-offline-phone":u=".ws-offline-phone"),"yes"!=n.get_contact_offline_email||""!=o.trim()&&wsUtil.validateEmail(o.trim())||(u?u+=", .ws-offline-email":u=".ws-offline-email"),"yes"==n.get_contact_offline_message&&""==h.trim()&&(u?u+=", .ws-offline-textarea":u=".ws-offline-textarea"),u)return s.window.find(u).addClass("ws-input-error"),void(n.offline_message_sending=!1);(l=s.window.find(".ws-chat-body-offline")).children().not(".ws-hide").hide(),l.find(".ws-offline-textarea").text(""),l.find(".ws-chat-offline-text-success").show(),wsUtil.setTimeout("chatOfflineHide",(function(){i.hideWidget()}),3e3),n.offline_message_sending=!1;var g=(new Date).getTime(),p=wsUtil.generateHash(g,WBK.settings.visitorId),w={code:WBK.settings.whiteSaasCode,name:a.trim(),email:o.trim(),phone:r.trim(),message:h.trim(),emailAgreement:c,emailDistributionAgreement:d,visitId:WBK.settings.visitId,type_show:wsUtil.getCookie("WidgetChat_shownOn"),chatWidgetId:WBK.settings.chatWidgetId,chatId:WBK.settings.chatId,url:"string"==typeof document.URL?document.URL:"",visitorId:WBK.settings.visitorId,phoneMask:e,googleClientId:wsUtil.getGoogleClientId(),roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId(),leadvertexId:wsUtil.getLeadvertexId(),externalParams:wsUtil.getExternalParams(),hashTime:g,hash:p},f=WBK.settings.serverUrl+"/api?action=chatOfflineMessage";jWS.post(f,w,"json"),"function"==typeof window.ws_OnChatOfflineMessage&&window.ws_OnChatOfflineMessage(w),i.chatAutoCall(r.trim(),e),i.sendGoal("offline_message")}},showHelloMessage:function(){var e='<div class="ws-chat-manager-join ws-chat-robot-hello"><img src="'+n.chat_widget_logo_robot+'" alt="" class="ws-manager-img"><div class="ws-manager-event" style="color:'+n.color_hello_message+'">'+n.hello_message+"</div></div>";s.window.find(".ws-chat-typing").before(e)},showHelloMessageOperators:function(){n.operators_online_keys.sort((function(e,t){return(e=n.all_operators[e].lastActiveAt)<(t=n.all_operators[t].lastActiveAt)?1:e>t?-1:0}));var e="";if("last3"===n.hello_message_author)for(var i=0;i<n.operators_online_keys.length;i++){var a=n.all_operators[n.operators_online_keys[i]].name;if(e+='<div class="ws-chat-manager-hello-el"><img src="'+n.all_operators[n.operators_online_keys[i]].photo+'" class="ws-manager-hello-img"><div class="ws-manager-name">'+a+"</div></div>",2==i)break}else if("operator"===n.hello_message_author){var o,r={};if("rand"===n.hello_message_operator){var l=[];for(o in n.all_operators)n.all_operators.hasOwnProperty(o)&&"operator"===n.all_operators[o].role&&n.all_operators[o].online&&l.push(n.all_operators[o]);r=l[Math.floor(Math.random()*l.length)]}else{var c=[];for(o in n.all_operators)n.all_operators.hasOwnProperty(o)&&"operator"===n.all_operators[o].role&&(c[n.all_operators[o].apiId]=n.all_operators[o]);if(!c.hasOwnProperty(n.hello_message_operator))return void this.showHelloMessage();r=c[n.hello_message_operator]}e+='<div class="ws-chat-manager-hello-el"><img src="'+r.photo+'" class="ws-manager-hello-img"><div class="ws-manager-name">'+r.name+"</div></div>"}var d='<div class="ws-chat-manager-join ws-chat-manager-hello"><div class="ws-chat-manager-hello-body">'+e+'</div><div class="ws-manager-event" style="color:'+n.color_hello_message+'">'+n.hello_message+"</div></div>";s.window.find(".ws-chat-typing").before(d),n.chat_distribution_department_enabled||t(".ws-chat-manager-join.ws-chat-manager-hello").css("padding-bottom","60px;")},showHelloMessageOperatorsFromDepartments:function(){var e,i="",a=t(".ws-chat .ws-chat-manager-join");if(a.length&&(t.each(n.chat_department_distribution,(function(t,i){i.id===n.chat_distribution_department_picked&&(e=i)})),e)){var s=0;t.each(n.operators_online_keys,(function(t,a){var o=n.all_operators[a].apiId;if(e.employees[o]){var r=n.all_operators[a].name;i+='<div class="ws-chat-manager-hello-el"><img src="'+n.all_operators[a].photo+'" class="ws-manager-hello-img"><div class="ws-manager-name">'+r+"</div></div>",s+=1}if(3===s)return!1})),a.addClass("ws-chat-manager-hello");var o='<div class="ws-chat-manager-hello-body">'+i+'</div><div class="ws-manager-event" style="color:'+n.color_hello_message+'">'+n.hello_message+"</div>";s&&(a.empty(),a.append(o))}},operatorsUpdate:function(){if(s.window&&n.fireChat.hasOwnProperty("operators")){var e="";s.window.removeClass("ws-chat-ico-bottom"),s.window.find(".ws-chat-ico-container").empty();for(var t=0;t<n.fireChat.operators.length;t++)if(n.fireUsers.hasOwnProperty(n.fireChat.operators[t])){if(n.fireUsers[n.fireChat.operators[t]].online){var a=n.fireUsers[n.fireChat.operators[t]].name?n.fireUsers[n.fireChat.operators[t]].name:"";e+=e?", "+a:a}i.addIco(n.fireUsers[n.fireChat.operators[t]])}e?s.window.find(".ws-chat-title").text(e):s.window.find(".ws-chat-title").text(n.text_button_online)}},addIco:function(e){s.window.hasClass(".ws-chat-ico-bottom")||(s.window.addClass("ws-chat-ico-bottom"),s.window.offset().left<100?s.window.addClass("ws-chat-ico-bottom-right"):s.window.removeClass("ws-chat-ico-bottom-right"));var t="";e.online&&(t="ws-chat-status-online");var i='<div class="ws-chat-ico" id="ico_'+e.key+'" style="background-color: '+n.color_background_chat_header+';"><div class="ws-chat-logo" data-name="'+e.name+'"><i class="ws-icon-chat"></i><img src="'+e.photo+'" class="ws-chat-logo-img" title="'+e.name+'"><div class="ws-chat-status-round '+t+'"></div></div></div>';s.window.find(".ws-chat-ico-container").append(i)},updateIcoBottom:function(e){var t=s.window.find(".ws-chat-ico-container");t.find("#ico_"+e).appendTo(t)},addOldMessages:function(){if(n.fireOldMessages){var e=Object.keys(n.fireOldMessages);if(e.length){for(var a=0;a<e.length;a++)if(n.fireOldMessages.hasOwnProperty(e[a])){var o=n.fireOldMessages[e[a]];o.key=e[a];var r="operator"==n.fireUsers[o.sender].role,l="text"===o.type,c="system"===o.type&&"pay_link"===o.subType,d=!r&&o.sender===n.fireSender;"read"!=o.status&&(r||l&&!d||c)&&(n.unread_messages_count+=1,n.unread_messages.push(o.key));var h={scroll:!1};if("auto_reply"===o.subType&&o.autoReplyId)for(var u in n.autoreplies)+n.autoreplies[u].id==+o.autoReplyId&&(h.auto_reply_get_contact=n.autoreplies[u].get_contact,h.auto_reply_index=u);this.appendMessage(o,h),"auto_reply"===o.subType&&parseInt(n.show_contact_form_inside_chat)&&h.auto_reply_get_contact&&!(WBK.settings.visitorName||WBK.settings.visitorPhone||WBK.settings.visitorEmail||"none"!==s.window.find(".ws-chat-body-preform").css("display"))&&(this.addMessageRobot({subType:"lead"}),this.setPhoneMaskData(".ws-preform-phone"),this.showPreform("lead",u,t(this)))}n.unread_messages_count&&i.setUnreadMessages(n.unread_messages_count)}}},updateVisitor:function(e){n.online_visitor_enable&&(n.free_chat_widget||(n.chatKeyVisitor?this.getVisitor(n.chatKeyVisitor).then((function(t){if(t){var a={lastActiveAt:{".sv":"timestamp"}};n.chat_distribution_department_picked&&(a.departmentId=n.chat_distribution_department_picked),i.updateVisitorInBase(Object.assign(e,a))}else i.createVisitor()})):i.createVisitor()))},updateVisitorInBase:function(e){n.v2_local?ChatLocalServer.updateVisitor(e).then((function(){})):i.getChatVisitorRef().update(e)},updateUserInBase:function(e,t){n.v2_local?ChatLocalServer.updateUser(e,t).then((function(){})):i.getChatUsersRef().child(e).update(t)},getVisitor:function(e){var i=t.Deferred();return n.v2_local?ChatLocalServer.getVisitor(e).then((function(e){i.resolve(e)})):n.fireDB.child("visitors/"+e).once("value").then((function(e){i.resolve(e.val())})),i.promise()},createVisitor:function(){n.online_visitor_enable&&(n.free_chat_widget||(WBK.settings.visitorId?this.getVisitor(WBK.settings.visitorId).then((function(e){e?(n.chatKeyVisitor=WBK.settings.visitorId,i.listenVisitor()):(n.chatKeyVisitor=!1,i.sendVisitor())})):this.sendVisitor()))},sendVisitor:function(){this.processVisitor||(this.processVisitor=!0,jWS.getJSON(WBK.settings.serverUrl+"/api?action=chatVisitor&callback=?",{code:WBK.settings.whiteSaasCode,type_show:wsUtil.getCookie("WidgetChat_shownOn"),visitorId:WBK.settings.visitorId,visitId:WBK.settings.visitId,chatWidgetId:WBK.settings.chatWidgetId,googleClientId:wsUtil.getGoogleClientId(),roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId(),leadvertexId:wsUtil.getLeadvertexId(),invitation:!1,externalParams:wsUtil.getExternalParams()},(function(e){e.Success&&e.Data&&e.Data.chat&&(n.chatKeyVisitor=e.Data.chat.visitor_key,i.listenVisitor()),i.processVisitor=!1}),(function(){i.processVisitor=!1})))},listenVisitor:function(){i.updateVisitor({currentUrl:window.location.href}),n.v2_local?this.listenVisitorLocalBase():(i.getChatVisitorRef().on("child_changed",(function(e){"chatKey"==e.key&&(n.chatKey=e.val(),n.chatKey&&(i.loadFireChat().then((function(){i.addOldMessages(),n.chatCreating=!1,n.chat_created=!0})),i.updateVisitor({said:!0})))})),i.getChatVisitorRef().on("child_removed",(function(e){n.chatKeyVisitor=!1})))},listenVisitorLocalBase:function(){ChatLocalServer.listenVisitorUpdated((function(e){n.visitor_auto_invite=e.autoInvite,e.hasOwnProperty("chatKey")&&(n.chatKey=e.chatKey,n.chatKey&&!n.chatCreating&&(i.loadLocalChat().then((function(){i.addOldMessages(),n.chatCreating=!1,n.chat_created=!0})),i.updateVisitor({said:!0})))}))},sendSystem:function(e){e.status="read",e.type="system",e.sentAt=(new Date).getTime(),i.sendFire(e)},sendRobot:function(e,t){e.status="read",e.type="system",e.sender=n.fireRobot.key,e.sentAt=(new Date).getTime(),i.sendMessageRobot(e,t),"rating"!=e.subType&&"auto_reply"!=e.subType||i.addMessageRobot(e,t)},sendMessageRobot:function(e){i.sendFire(e)},addMessageRobot:function(e,a){if(e&&!("auto_reply"==(e=t.extend({},e)).subType&&e.hasOwnProperty("sender")&&e.sender&&"operator"==n.fireUsers[e.sender].role||"open_window"==e.subType||"close_window"==e.subType||"start_download"==e.subType||"introduction"==e.subType||"not_require_answer"===e.subType)){var o="",r="";switch(e.subType){case"text":case"auto_reply":if(e.hasOwnProperty("key")&&(WBK.settings.visitorName||WBK.settings.visitorPhone||WBK.settings.visitorEmail))return;if(e.text=wsUtil.specialChars(e.text),e.text=this.textUrlFormat(e.text),a&&a.auto_reply_get_contact){if(!parseInt(n.show_contact_form_inside_chat)){var l=n.autoreplies[a.auto_reply_index].text_btn?n.autoreplies[a.auto_reply_index].text_btn:n.lang_text.autoreply_link;e.text=e.text+'<br><div class="ws-chat-autoreply-link"><a data-index="'+a.auto_reply_index+'" class="ws-chat-autoreply-btn" href="javascript:void(0)">'+l+"</a></div>"}var c=new Date;c.setMinutes(c.getMinutes()+43200),wsUtil.setCookie("WidgetChat_autoreply_getcontact_"+WBK.settings.chatId,!0,c)}o='<div class="ws-chat-message-source">'+e.text+"</div>";break;case"lead":case"preform":if(r="ws-chat-message-robot-preform",parseInt(n.show_contact_form_inside_chat)){var d=WBK.formatToPhone(n.user_phone);!n.useTelephonyMask&&n.user_phone_without_dial_code&&(d=n.user_phone_without_dial_code),o='<div class="ws-chat-body-preform ws-chat-body-preform-clear"><div class="ws-chat-preform-text"></div><div class="ws-chat-preform-social"><a href="javascript:void(0)" class="ws-chat-social-el ws-chat-social-vk"><span class="ws-chat-social-img ws-sprite-social-vk"></span></a><a href="javascript:void(0)" class="ws-chat-social-el ws-chat-social-fb"><span class="ws-chat-social-img ws-sprite-social-fb"></span></a></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="text" class="ws-preform-input ws-preform-name" placeholder="'+n.lang_text.form_name_placeholder+'" value="'+n.user_name+'"></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="tel" class="ws-preform-input ws-preform-phone" placeholder="'+n.lang_text.form_phone_placeholder+'" value="'+d+'"><input type="text" class="cbk-phone-checker white-saas-generator-input-hidden"/></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="email" class="ws-preform-input ws-preform-email" placeholder="'+n.lang_text.form_email_placeholder+'" value="'+n.user_email+'"></div><div class="ws-preform-input-group ws-preform-input-group-text"><div class="ws-preform-input-label ws-preform-email-text">'+n.lang_text.email_exit+'</div></div><div class="ws-preform-input-group'+(parseInt(n.email_distribution_agreement)?"":" ws-hide")+'"><label class="ws-preform-label-agreement"><input type="checkbox" class="ws-preform-email-distribution-agreement preform-email-distribution-agreement"><span class="ws-preform-email-distribution-agreement-text">'+n.email_text_distribution_agreement+'</span></label></div><div class="ws-preform-input-group ws-preform-input-group-text"><label class="ws-preform-label-agreement"><span class="ws-preform-email-agreement-text">'+n.email_agreement_text+n.lang_text.email_agreement_text_agreement+'</span></label></div><div class="ws-preform-input-group ws-preform-input-group-btn"><a href="javascript:void(0)" class="ws-preform-btn ws-preform-btn-save">'+n.lang_text.preform_btn+"</a></div></div>"}else o='<div class="ws-chat-message-source">'+n.lang_text.preform_text+'</div><input class="ws-chat-message-input" placeholder="'+n.lang_text.form_name+'">';break;case"load":o='<div class="ws-chat-message-source">'+n.lang_text.loading+' ...</div><div class="ws-chat-progress"><div class="ws-chat-progress-bar"></div></div>';break;case"rating":i.hideRating();var h='<img class="ws-chat-message-rating-el ws-chat-message-rating-el-1" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""><img class="ws-chat-message-rating-el ws-chat-message-rating-el-2" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""><img class="ws-chat-message-rating-el ws-chat-message-rating-el-3" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""><img class="ws-chat-message-rating-el ws-chat-message-rating-el-4" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""><img class="ws-chat-message-rating-el ws-chat-message-rating-el-5" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt="">';"smiles"==n.rate_chat_view&&(h='<img class="ws-chat-message-rating-el" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt="">');var u="";switch(parseInt(e.attributes.rate)){case 1:u=n.lang_text.rate_text_1;break;case 2:u=n.lang_text.rate_text_2;break;case 3:u=n.lang_text.rate_text_3;break;case 4:u=n.lang_text.rate_text_4;break;case 5:u=n.lang_text.rate_text_5}o='<div class="ws-chat-message-source">'+n.lang_text.rate_result+'</div></div><div class="ws-chat-message"><div class="ws-chat-message-source"><div class="ws-chat-message-rating ws-chat-message-rating-'+n.rate_chat_view+" ws-chat-message-rating-rate-"+e.attributes.rate+'">'+h+"</div>"+u+"</div>";break;case"pay_link":o='<div class="ws-chat-message-source"><div class="ws-chat-message-pay-title">'+e.attributes.title+'</div><div class="ws-chat-message-pay-amount">'+wsUtil.humanizeNumber(e.attributes.amount)+" "+e.attributes.currencyText+'</div><div class="ws-chat-message-pay-link"><a href="'+e.attributes.link+'" target="_blank">'+n.lang_text.pay+'<i class="ws-icon-link"></i></a></div><div class="ws-chat-message-pay-system">'+n.lang_text.security_pay_in+" "+n.lang_text[e.attributes.paySystem]+"</div></div>";break;case"pick_department":if(n.chat_distribution_department_enabled){r="ws-chat-message-robot-pick-department",o='<div class="ws-chat-message-source ws-chat-message-pick-department" style="background:'+n.color_background_message_operator+'">',o+='<p class="ws-chat-message-header-pick-department">'+n.lang_text.pick_department_header+"</p>",o+='<div class="ws-chat-status-round ws-chat-status-online"></div>',o+='<p class="ws-chat-message-text-pick-department">'+n.lang_text.pick_department_text+"</p>",o+="</div>",o+='<div class="ws-chat-select-pick-department">';var g=i.makeOpacityColor(n.color_background_message_operator,3);t.each(n.chat_department_distribution,(function(e,t){Object.keys(t.employees).length&&(o+='<div class="ws-chat-message-option-pick-department" data-value="'+t.id+'">',o+='<div style="border-bottom: 1px solid '+g+'">'+i.escapeHtml(t.name)+"</div>",o+="</div>")})),o+="</div>"}}var p='<div class="ws-chat-message-block ws-chat-message-robot '+r+'"><div class="ws-chat-message-logo"><img class="ws-chat-message-logo-img" src="'+n.fireRobot.photo+'"></div><div class="ws-chat-message-name"><span class="ws-chat-message-name-text" data-name="">'+n.fireRobot.name+'</span></div><div class="ws-chat-message'+("pick_department"===e.subType?" ws-chat-message-with-pick-department":"")+'">'+o+"</div></div>";!parseInt(n.show_contact_form_inside_chat)||"lead"!=e.type&&"preform"!=e.type||t(".ws-chat-body-preform")&&t(".ws-chat-body-preform").closest(".ws-chat-message-robot").remove(),s.window.find(".ws-chat-typing").before(p),!n.useTelephonyMask&&s.window.find(".ws-chat-message-robot-preform .ws-preform-phone").length&&s.wsDCPI.renderOnInput(".ws-preform-phone","chatBodyPreformPhone"+(s.window.find(".ws-chat-message-robot-preform .ws-preform-phone").length-1),s.window.find(".ws-chat-message-robot-preform")[s.window.find(".ws-chat-message-robot-preform .ws-preform-phone").length-1],!n.user_phone_without_dial_code),"load"==e.type&&s.window.find(".ws-chat-body-content .ws-chat-message-robot").last().find(".ws-chat-progress-bar").animate({width:"70%"},4e3),WBK.settings.chatWindowOpened&&i.scroll()}},sendGoal:function(e){if(!n.free_chat_widget){var t,i,a=!1,s=!1;switch(e){case"invitation_click":t="CHAT_SHOW_ON_INVITATION",i="ChatShowOnInvitation";break;case"invitation_close":t="CHAT_INVITATION_CLOSE",i="ChatInvitationClose";break;case"open":t="CHAT_SHOW_ON_BTN",i="ChatShowOnBtn";break;case"first_message":t="CHAT_FIRST_MESSAGE",i="ChatFirstMessage",a="chat";break;case"offline_message":t="CHAT_OFFLINE_MESSAGE",i=s="ChatOfflineMessage",a="chat",wsUtil.sendUniversalGoal();break;case"visitor_introduced":t="CHAT_VISITOR_INTRODUCED",i=s="ChatVisitorIntroduced",a="chat",wsUtil.sendUniversalGoal();break;case"operator_connect":t="CHAT_OPERATOR_CONNECT",i="ChatOperatorConnect"}wsUtil.sendGoal(t,i,"ChatService",a,s)}},checkAutoReply:function(e,t){for(var a=0;a<n.autoreplies.length;a++)e==n.autoreplies[a].action&&i.startAutoReply(a,t)},stopAutoReply:function(e){wsUtil.deleteTimeout("chatTypingAutoreply");for(var t=0;t<n.autoreplies.length;t++)("all"==e||e==n.autoreplies[t].action)&&wsUtil.deleteTimeout("auto_reply_"+n.autoreplies[t].id)},startAutoReply:function(e,a){if("2"==n.autoreplies[e].info_introduced&&parseInt(n.chat_introduced))return!1;var s="auto_reply_"+n.autoreplies[e].id;if(wsUtil._timeouts.hasOwnProperty(s))return!1;wsUtil.setTimeout(s,(function(a){var s,o=parseInt(n.autoreplies[e].get_contact),r=i.hasVisitorData();if("not_connected"==n.autoreplies[e].action&&(!n.send_autoreply_first||"1"==n.autoreplies[e].info_introduced&&!r||"2"==n.autoreplies[e].info_introduced&&r))return!1;if("not_connected"==n.autoreplies[e].action){if(s=!1,n.invitation_operator_key&&(i.typing(n.invitation_operator_key,20*n.autoreplies[e].message.length),s=!0),a={text:n.autoreplies[e].message,type:"system",subType:"auto_reply",autoReplyId:n.autoreplies[e].id},s?(a.sender=n.invitation_operator_key,wsUtil.setTimeout("auto_reply_not_connected_start",(function(){i.appendMessage(a,{auto_reply_get_contact:o,auto_reply_index:e,scroll:!0}),i.sendSystem(a),i.playSound("message")}),21*n.autoreplies[e].message.length)):(i.sendRobot(a,{auto_reply_get_contact:o,auto_reply_index:e,scroll:!0}),i.playSound("message")),parseInt(n.show_contact_form_inside_chat)&&o){if(i.hasVisitorData())return;if(i.contactFormIsVisible())return;n.invitation_operator_key&&i.typing(n.invitation_operator_key,55*n.autoreplies[e].message.length),wsUtil.setTimeout("auto_reply_get_inline_contact",(function(){i.addMessageRobot({subType:"lead"}),i.setPhoneMaskData(".ws-preform-phone"),i.showPreform("lead",e,t(this))}),55*n.autoreplies[e].message.length)}n.auto_reply_not_connected_and_operators_offline_showed=!0}if("not_answer_operator"==n.autoreplies[e].action){if("1"==n.autoreplies[e].info_introduced&&!r)return!1;if("2"==n.autoreplies[e].info_introduced&&r)return!1;i.typing(n.last_operator_data.user_key,50*n.autoreplies[e].message.length,2500),wsUtil.setTimeout("chatTypingAutoreply",(function(){var a={text:n.autoreplies[e].message,type:"system",subType:"auto_reply",sender:n.last_operator_data.user_key,autoReplyId:n.autoreplies[e].id};if(i.appendMessage(a,{auto_reply_get_contact:o,auto_reply_index:e,scroll:!0}),i.sendSystem(a),i.playSound("message"),parseInt(n.show_contact_form_inside_chat)&&o){if(i.hasVisitorData())return;if(i.contactFormIsVisible())return;n.last_operator_data&&i.typing(n.last_operator_data.user_key,55*n.autoreplies[e].message.length),wsUtil.setTimeout("auto_reply_get_inline_contact",(function(){i.addMessageRobot({subType:"lead"}),i.setPhoneMaskData(".ws-preform-phone"),i.showPreform("lead",e,t(this))}),55*n.autoreplies[e].message.length)}}),50*n.autoreplies[e].message.length)}if("not_connected_and_operators_offline"==n.autoreplies[e].action&&(s=!1,n.invitation_operator_key&&(i.typing(n.invitation_operator_key,20*n.autoreplies[e].message.length),s=!0),a={text:n.autoreplies[e].message,type:"system",subType:"auto_reply",autoReplyId:n.autoreplies[e].id},s?(a.sender=n.invitation_operator_key,wsUtil.setTimeout("auto_reply_not_connected_and_operators_offline_start",(function(){i.appendMessage(a,{auto_reply_get_contact:o,auto_reply_index:e,scroll:!0}),i.sendSystem(a),i.playSound("message")}),21*n.autoreplies[e].message.length)):(i.sendRobot(a,{auto_reply_get_contact:o,auto_reply_index:e,scroll:!0}),i.playSound("message")),parseInt(n.show_contact_form_inside_chat)&&o)){if(i.hasVisitorData())return;if(i.contactFormIsVisible())return;n.invitation_operator_key&&i.typing(n.invitation_operator_key,55*n.autoreplies[e].message.length),wsUtil.setTimeout("auto_reply_get_inline_contact",(function(){i.addMessageRobot({subType:"lead"}),i.setPhoneMaskData(".ws-preform-phone"),i.showPreform("lead",e,t(this))}),55*n.autoreplies[e].message.length)}}),1e3*parseInt(n.autoreplies[e].time))},contactFormIsVisible:function(){return s.window.find(".ws-chat-body-preform").is(":visible")},initRating:function(){s.container.find(".ws-chat-rating-btns a").on("mouseenter.wbk_chat",(function(){if("stars"==n.rate_chat_view)for(var e=t(this).data("value"),i=1;i<=e;i++)s.container.find("a.ws-chat-rating-el-"+i).addClass("ws-chat-rating-el-marked");else t(this).addClass("ws-chat-rating-el-marked")})).on("mouseleave.wbk_chat",(function(){s.container.find("a.ws-chat-rating-el").removeClass("ws-chat-rating-el-marked")}))},checkRatingSettings:function(){if(WBK.settings.chatId&&parseInt(n.rate_chat)&&!parseInt(n.fireChat.rate)&&!this.ratingIsVisible()&&n.messages_quant_to_rate>=parseInt(n.rate_chat_messages_quant)){for(var e=1;e<=5;e++)t(new Image).attr("src",WBK.settings.staticServerUrl+"/widget/img/rating/24/smile_"+e+".png").load((function(){})),t(new Image).attr("src",WBK.settings.staticServerUrl+"/widget/img/rating/32/smile_"+e+".png").load((function(){}));wsUtil.setTimeout("showRating",(function(){i.showRating()}),500),s.container.find(".ws-chat-rating-btns a").unbind("click").on("click",(function(){var e=t(this).data("value");i.hideRating();var a=WBK.settings.staticServerUrl+"/widget/img/rating/64/smile_"+e+".png";"stars"===n.rate_chat_view&&(a=WBK.settings.staticServerUrl+"/widget/img/rating/64/star_"+e+".png"),i.sendRobot({text:"Посетитель оценил диалог",subType:"rating",attributes:{imageUrl:a,rate:e}})}))}},ratingIsVisible:function(){return s.container.hasClass("ws-chat-has-rating")},showRating:function(){s.container.addClass("ws-chat-has-rating"),WBK.animateFastOnce(s.container.find(".ws-chat-rating"),"cbk-fadeIn")},hideRating:function(){s.container.removeClass("ws-chat-has-rating")},sendFire:function(e,t){delete e.key,n.chat_created?i.messageFire(e):(e.hasOwnProperty("text")&&(e.text=this.smileReplacer(e.text,"to_code")),n.invitation_show_data&&(e.invitation=n.invitation_show_data,e.invitation.hello_text=this.urlInvitationLinkClear(this.smileReplacer(e.invitation.hello_text,"to_code")),e.invitation.text1=this.urlInvitationLinkClear(this.smileReplacer(e.invitation.text1,"to_code")),e.invitation.text2=this.urlInvitationLinkClear(this.smileReplacer(e.invitation.text2,"to_code")),n.invitation_show_data=!1),"function"!=typeof t&&(t=function(){}),i.create(e,t)),"system"!=e.type&&"auto_reply"!=e.subType&&"open_window"!=e.subType&&"close_window"!=e.subType&&i.getAutoReply(),n.is_first_message=!1},getAutoReply:function(){if(!n.free_chat_widget&&n.autoreplies)if(n.fireChat.hasOwnProperty("operators")&&n.fireChat.operators.length)n.last_operator_data&&n.send_autoreply&&(i.checkAutoReply("not_answer_operator",n.last_operator_data),n.send_autoreply=!1);else{if(!n.is_first_message)return;for(var e=!0,t=0;t<n.fireUserKeys.length;t++)n.fireUsers[n.fireUserKeys[t]].online&&(e=!1);e&&!parseInt(n.always_online)?i.checkAutoReply("not_connected_and_operators_offline"):i.checkAutoReply("not_connected")}},send:function(e,a){t(".ws-chat-quick-messages").html(""),n.show_quick_message=!1;var o=(new Date).getTime();e.sentAt=o,e.key="visitor_"+o,e.status="sent",e.sender=n.fireSender,i.appendMessage(e,a),n.is_first_message&&(i.sendGoal("first_message"),"function"==typeof window.ws_OnChatFirstMessage&&window.ws_OnChatFirstMessage());var r=!0,l=(n.is_first_message||"yes"===n.get_contact_can_refuse)&&n.chat_distribution_department_enabled&&!n.chat_distribution_department_picked;if(n.is_first_message&&parseInt(n.get_contact))if(r=!1,n.user_name||n.user_email||n.user_phone){var c=!1;"yes"==n.get_contact_name&&""==n.user_name&&(c=!0),"yes"==n.get_contact_email&&""==n.user_email&&(c=!0),"yes"==n.get_contact_phone&&""==n.user_phone&&(c=!0),c?(n.first_message=e,i.getContactRobot(!0)):(n.chat_introduced=1,s.window.find(".ws-textarea").html(""),i.sendFire(e))}else n.first_message=e,i.getContactRobot(!l);if(l){n.first_message=e;var d=new Date;d.setMinutes(d.getMinutes()+30),wsUtil.setCookie("WidgetChat_first_message_"+WBK.settings.chatWidgetId,JSON.stringify(e),d),r||"yes"===n.get_contact_can_refuse?(i.sendPickDepartmentMessage(),r=!1):n.need_send_pick_department=!0}r&&("rating"!=e.subType&&s.window.find(".ws-textarea").html(""),i.sendFire(e)),i.inputScroll(),i.typingPositionUpdate()},getContactRobot:function(e){i.addMessageRobot({subType:"preform"}),parseInt(n.show_contact_form_inside_chat)&&(i.setPhoneMaskData(".ws-preform-phone"),i.showPreform("preform")),"no"==n.get_contact_can_refuse?i.changeStateInput(!0,n.lang_text.block_input):n.first_message&&e&&(i.sendFire(n.first_message),n.first_message=!1)},sendMessage:function(){var e;if(!(e=i.formatMessage(t(".ws-textarea"))))return!1;for(var a=0;a<e.length;a++)i.send(e[a],{scroll:!0});return n.is_first_message||s.window.find(".ws-textarea").html(""),this.checkRatingSettings(),!0},inputScroll:function(){if("false"!==s.window.find(".ws-textarea").attr("contenteditable")){s.window.find(".ws-textarea")[0].scrollHeight>92&&!n.input_scroll?n.input_scroll=!0:s.window.find(".ws-textarea")[0].scrollHeight<=92&&n.input_scroll&&(n.input_scroll=!1);var e=s.window.find(".ws-textarea").outerHeight();if(n.height_input!=e){var t=62;56==e?t=76:74==e?t=94:e>=92&&(t=112),s.window.find(".ws-chat-body").css("bottom",t),n.height_input=e,i.scroll()}s.window.find(".ws-textarea-group").nanoScroller(),s.window.find(".ws-textarea-group").nanoScroller({scrollBottom:0})}},insertHTML:function(e){if(-1!=navigator.appName.indexOf("Internet Explorer"))if(document.selection)(t=document.selection.createRange()).pasteHTML&&t.pasteHTML(e);else{var t=document.getSelection().getRangeAt(0),i=document.createElement("span");t.surroundContents(i),i.innerHTML=e,t.collapse(!1)}else e&&document.execCommand("insertHtml",!1,e)},uploadFile:function(e){if(!n.chat_distribution_department_enabled||n.chat_distribution_department_picked){if(n.fileUploadedCount<5){var a,s=new FormData;switch(e){case"doc":a=t(".ws-file-doc-upload")[0].files[0];break;case"img":a=t(".ws-file-img-upload")[0].files[0],s.append("image_type","image")}if(!a)return;s.append(e,a),s.append("type",e),s.append("chat_id",WBK.settings.chatId),i.uploadFileServer(s,e)}}else o&&i.log("Необходимо выбрать отдел")},uploadFileServer:function(e,n){i.addMessageRobot({subType:"load"}),wsUtil.setInterval("uploading_files",(function(){switch(n){case"doc":i.printing("file","");break;case"img":i.printing("image","")}}),300),t.ajax({type:"POST",url:WBK.settings.serverUrl+"/chat/api/?action=uploadFile",processData:!1,contentType:!1,crossDomain:!0,data:e,dataType:"json",success:function(e){switch(n){case"doc":t(".ws-file-doc-upload").val("");break;case"img":t(".ws-file-img-upload").val("")}s.window.find(".ws-chat-body-content .ws-chat-message-robot").last().find(".ws-chat-progress-bar").stop().animate({width:"100%"},500,(function(){if(s.window.find(".ws-chat-body-content .ws-chat-message-robot").last().remove(),"success"===e.status)switch(n){case"doc":var t={icon:e.icon,filename:e.original_name,url:WBK.settings.staticServerUrl+"/"+e.path,size:e.size_full,type:"file"};i.addFileUploaded(t);break;case"img":t={preview:WBK.settings.staticServerUrl+"/"+e.path_mini,url:WBK.settings.staticServerUrl+"/"+e.path,size:e.size_full,type:"image",filename:e.original_name},i.addFileUploaded(t)}else i.addMessageRobot({type:"text",message:e.message});wsUtil.deleteInterval("uploading_files")}))}})},addFileUploaded:function(e){e&&(n.fileUploaded[(new Date).getTime()]=e,i.updateFilesUploaded())},updateFilesUploaded:function(){t(".ws-chat-uploaded-files").empty();var e=0;t.isEmptyObject(n.fileUploaded)||t.each(n.fileUploaded,(function(i,n){var a,s,o="";switch(n.type){case"image":o="img",a=n.preview,s=n.path;break;case"file":o="file",a=n.icon,s=n.path}var r='<div class="ws-chat-uploaded-el ws-chat-uploaded-type-'+o+'" data-index="'+i+'"><div class="ws-chat-uploaded-el-close"><i class="ws-icon-close"></i></div><a class="ws-chat-uploaded-url" href="'+s+'" target="_blank"><img class="ws-chat-uploaded-'+o+'" src="'+a+'"></a></div>';t(".ws-chat-uploaded-files").append(r),e++})),e>0?s.window.find(".ws-textarea-send-btn").css("display","flex"):""==t(".ws-textarea").html()&&s.window.find(".ws-textarea-send-btn").hide(),this.typingPositionUpdate(),n.fileUploadedCount=e},showPreform:function(e,i){void 0===i&&(i=0),parseInt(n.show_contact_form_inside_chat)||(s.window.find(".ws-chat-body").hide(),s.window.find(".ws-chat-footer").hide()),s.window.find(".ws-preform-name").closest(".ws-preform-input-group").removeClass("ws-hide"),s.window.find(".ws-preform-email").closest(".ws-preform-input-group").removeClass("ws-hide"),s.window.find(".ws-preform-phone").closest(".ws-preform-input-group").removeClass("ws-hide"),parseInt(n.show_introduce_social_button)||s.window.find(".ws-chat-preform-social").hide();var a="hide",o="hide",r="hide";switch(e){case"preform":a=n.get_contact_name,r=n.get_contact_phone,o=n.get_contact_email;break;case"lead":a=n.autoreplies[i].get_name,r=n.autoreplies[i].get_phone,o=n.autoreplies[i].get_email}s.window.find(".ws-chat-preform-text").text(n.lang_text.preform_text),"hide"==a?s.window.find(".ws-preform-name").closest(".ws-preform-input-group").addClass("ws-hide"):s.window.find(".ws-preform-name").closest(".ws-preform-input-group").find(".ws-preform-input-label").html(n.lang_text.form_name+'<span class="ws-input-required">'+("yes"==a?" *":"</span>")),"hide"==r?s.window.find(".ws-preform-phone").closest(".ws-preform-input-group").addClass("ws-hide"):s.window.find(".ws-preform-phone").closest(".ws-preform-input-group").find(".ws-preform-input-label").html(n.lang_text.form_phone+'<span class="ws-input-required">'+("yes"==r?" *":"</span>")),"hide"==o?(s.window.find(".ws-preform-email").closest(".ws-preform-input-group").addClass("ws-hide"),s.window.find(".ws-preform-email-text").closest(".ws-preform-input-group").addClass("ws-hide")):(s.window.find(".ws-preform-email").closest(".ws-preform-input-group").find(".ws-preform-input-label").html(n.lang_text.form_email+'<span class="ws-input-required">'+("yes"==o?" *":"</span>")),"lead"==e&&s.window.find(".ws-preform-email-text").closest(".ws-preform-input-group").addClass("ws-hide")),parseInt(n.email_agreement)||s.window.find(".ws-preform-label-agreement").closest(".ws-preform-input-group").addClass("ws-hide"),s.window.find(".ws-preform-btn-save").data("type",e).data("index",i),parseInt(n.show_contact_form_inside_chat)||(s.window.find(".ws-chat-body-preform").show(),"pc"==WBK.settings.device&&this.reinitPreformPosition()),n.useTelephonyMask&&WBK.setPhoneInputFocusForm(t(".ws-preform-phone")),"yes"==a&&""==t(".ws-preform-name").val().trim()?t(".ws-preform-name").focus():"yes"!=r||""!=t(".ws-preform-phone").val().trim()&&t(".ws-preform-phone").val().trim()!=WBK.settings.phoneBase?"yes"!=o||""!=t(".ws-preform-email").val().trim()&&wsUtil.validateEmail(t(".ws-preform-email").val().trim())?wsUtil.setCaretPosition(t(".ws-preform-name"),t(".ws-preform-name").val().length):t(".ws-preform-email").focus():t(".ws-preform-phone").focus(),"lead"==e&&parseInt(n.show_contact_form_inside_chat)&&(s.window.find(".ws-preform-input-group:not(.ws-hide):first").css("margin-top","0px"),s.window.find(".ws-chat-preform-text").hide()),n.agreementLink&&s.window.find(".ws-chat-agreement-link").attr("href",n.agreementLink)},reinitPreformPosition:function(){var e=s.window.position().top,t=s.window.find(".ws-chat-header").outerHeight()+s.window.find(".ws-chat-body-preform").outerHeight(),i=wsUtil.getVisualHeight();s.window.outerHeight()<t&&s.window.height(t);var n=i-t-e,a=0;n<0&&((a=(e+n)/(i/100))<0&&(a=0),s.window.css({top:a+"%",height:"auto"}))},hidePreform:function(){s.window.find(".ws-chat-body").show(),s.window.find(".ws-chat-footer").show(),""!==t(".ws-textarea").html()?s.window.find(".ws-textarea-group .ws-textarea-placeholder").hide():s.window.find(".ws-textarea-group .ws-textarea-placeholder").show(),s.window.find(".ws-chat-body-preform").hide(),i.scroll()},savePreform:function(e,a,o){null==e&&(e="preform"),null==a&&(a=!1);var r="hide",l="hide",c="hide";switch(e){case"preform":r=n.get_contact_name,c=n.get_contact_phone,l=n.get_contact_email;break;case"lead":i.stopAutoReply("all"),r=n.autoreplies[a].get_name,c=n.autoreplies[a].get_phone,l=n.autoreplies[a].get_email}s.window.find(".ws-preform-name, .ws-preform-phone, .ws-preform-email").removeClass("ws-input-error");var d,h=s.window.find(".ws-preform-name").val(),u=s.window.find(".ws-preform-email").val(),g=t(".ws-preform-email-agreement").is(":checked")?1:0,p=t(".preform-email-distribution-agreement").is(":checked")?1:0,w=s.window.find(".ws-preform-phone").val();n.useTelephonyMask?(d=s.window.find(".ws-preform-phone").attr("placeholder"),w=WBK.checkPhone(w,!0)):(n.user_phone_without_dial_code=w,w=(w=s.window.find(".ws-preform-phone").closest(".ws-chat-message-robot-preform").length?this.getActualPhoneWithCountryCode(w,"chatBodyPreformPhone"+(s.window.find(".ws-chat-message-robot-preform .ws-preform-phone").length-1)):this.getActualPhoneWithCountryCode(w,"preformPhone")).replace(/[^\d]/g,"")),w=w||"";var f="";if("yes"==r&&""==h.trim()&&(f=".ws-preform-name"),"yes"==c&&""==w.trim()&&(f?f+=", .ws-preform-phone":f=".ws-preform-phone"),"yes"!=l||""!=u.trim()&&wsUtil.validateEmail(u.trim())||(f?f+=", .ws-preform-email":f=".ws-preform-email"),f)s.window.find(f).addClass("ws-input-error");else{"lead"==e&&(t(".ws-chat-autoreply-link").closest(".ws-chat-message-robot").remove(),t(".ws-chat-autoreply-link").remove()),h&&(WBK.settings.visitorName=h.charAt(0).toUpperCase()+h.substr(1,h.length-1)),u&&(WBK.settings.visitorEmail=u),w&&(WBK.settings.visitorPhone=w),"default"==n.auth_type&&h&&(n.logo_visitor=WBK.settings.serverUrl+"/firstletter/?name="+encodeURI(h.substr(0,1))+"&color="+n.chat_visitor_color),i.updateUser(!0);var m="";"preform"==e&&h?m=n.user_name+", "+n.lang_text.preform_text_success:"preform"==e?m=(m=n.lang_text.preform_text_success).charAt(0).toUpperCase()+m.substr(1):"lead"==e&&h?m=n.user_name+", "+n.lang_text.preform_lead_text_success:"lead"==e&&(m=(m=n.lang_text.preform_lead_text_success).charAt(0).toUpperCase()+m.substr(1)),i.addMessageRobot({subType:"text",text:m}),s.window.find(".ws-chat-message-input").closest(".ws-chat-message-robot").remove();var v="";document.URL&&(v=encodeURIComponent(document.URL));var _={code:WBK.settings.whiteSaasCode,url:v,name:h,email:u,phone:w,emailAgreement:g,emailDistributionAgreement:p,type_preform:e,type:n.auth_type,image_url:n.logo_visitor,vk_id:n.visitor_vk_id,fb_id:n.visitor_fb_id,fb_token:n.visitor_fb_token,visitId:WBK.settings.visitId,visitorId:WBK.settings.visitorId,chatWidgetId:WBK.settings.chatWidgetId,chatId:WBK.settings.chatId,phoneMask:d,googleClientId:wsUtil.getGoogleClientId(),roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId(),leadvertexId:wsUtil.getLeadvertexId(),externalParams:wsUtil.getExternalParams()};if(WBK.setVisitorInfoIfNot({name:h,phone:w,email:u}),n.need_send_pick_department)n.need_send_pick_department=!1,i.sendPickDepartmentMessage(),n.preform_request_data={request:_,context:o},i.clearContextRobotMessage(o);else{var b=s.window.find(".ws-chat-message-robot-pick-department");if(b&&b.is(":visible"))return s.window.find(".ws-chat-message-robot-preform").remove(),void(n.preform_request_data={request:_,context:o});n.is_first_message&&n.first_message?(i.sendFire(n.first_message,(function(){"default"==n.auth_type&&h&&(n.logo_visitor=WBK.settings.serverUrl+"/firstletter/?name="+encodeURI(h.substr(0,1))+"&color="+n.chat_visitor_color,_.image_url=n.logo_visitor),_.chatId=WBK.settings.chatId,i.sendPreformRequest(_,o)})),n.first_message=!1,i.changeStateInput(!1,"")):(i.changeStateInput(!1,""),i.sendPreformRequest(_,o))}i.hidePreform()}},sendPreformRequest:function(e,n){var a=(new Date).getTime(),s=wsUtil.generateHash(a,WBK.settings.visitorId);e.hashTime=a,e.hash=s;var o=WBK.settings.serverUrl+"/api?action=chatSavePreform";t.post(o,e,"json"),"function"==typeof window.ws_OnChatVisitorIntroduced&&window.ws_OnChatVisitorIntroduced(e),i.chatAutoCall(e.phone.trim(),e.phoneMask),i.sendGoal("visitor_introduced"),i.clearContextRobotMessage(n)},clearContextRobotMessage:function(e){null!=e&&null!==e&&e.closest(".ws-chat-message-robot").remove()},dateFormat:function(e){var t={new_block:!1,date_line:!1},i="";i=e?new Date(e):new Date;var a=new Date,s=function(e){return(e+"").length<2?"0"+e:e},o=!1;return n.chat_old_time?(o=n.chat_old_time<i&&Math.ceil((i-n.chat_old_time)/6e4),n.chat_old_time.getFullYear()==i.getFullYear()&&n.chat_old_time.getMonth()==i.getMonth()&&n.chat_old_time.getDate()==i.getDate()||(n.chat_old_time.getFullYear()!=i.getFullYear()?t.date_line=n.lang_text.dayNames[i.getDay()]+", "+i.getDate()+" "+n.lang_text.monthNames[i.getMonth()]+" "+i.getFullYear():t.date_line=n.lang_text.dayNames[i.getDay()]+", "+i.getDate()+" "+n.lang_text.monthNames[i.getMonth()])):(o=a>i&&Math.ceil((a-i)/6e4),a.getFullYear()==i.getFullYear()&&a.getMonth()==i.getMonth()&&a.getDate()==i.getDate()||(a.getFullYear()!=i.getFullYear()?t.date_line=n.lang_text.dayNames[i.getDay()]+", "+i.getDate()+" "+n.lang_text.monthNames[i.getMonth()]+" "+i.getFullYear():t.date_line=n.lang_text.dayNames[i.getDay()]+", "+i.getDate()+" "+n.lang_text.monthNames[i.getMonth()])),n.chat_old_time=i,o&&o>5&&(t.new_block=!0),i.getDay()==a.getDay()?(t.time=s(i.getHours())+":"+s(i.getMinutes()),t):(t.time=s(i.getDate())+"."+s(i.getMonth()+1)+"."+(i.getFullYear()+"").substr(2),t)},formatMessage:function(e){if(!e)return"";var a=i.cleanMessage(e),s=[];t.isEmptyObject(n.fileUploaded)||(t.each(n.fileUploaded,(function(e,t){s.push(t)})),n.fileUploaded={},i.updateFilesUploaded());var o=a.match(/(?!((.+)\/widget\/img\/blank.gif))(https?:\/\/[\w\-\.]+\.[a-zA-Z]{2,6}(?:\/\S*)?(?:[\w])+\.(?:jpg|png|gif|jpeg|bmp))/gi);if(o){for(var r=0;r<o.length;r++){var l=a.indexOf(o[r]);s.push({text:a.slice(0,l),type:"text"}),s.push({type:"image",preview:o[r],url:o[r],size:0}),a=a.slice(l,a.length).replace(o[r],"")}a&&s.push({text:a,type:"text"})}else a&&s.push({text:a,type:"text"});return s},escapeHtml:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},textUrlFormat:function(e){return e=(e||"").replace(/(^|([^A-Za-z0-9А-Яа-яёЁ\-\_])|(ws\-text\-link)(.+?)href\=\')(https?:\/\/)?((?:[A-Za-z\$0-9А-Яа-яёЁ](?:[A-Za-z\$0-9\-\_А-Яа-яёЁ]*[A-Za-z\$0-9А-Яа-яёЁ])?\.){1,5}[A-Za-z\$рфуконлайнстРФУКОНЛАЙНСТ\-\d]{2,22}(?::\d{2,5})?)((?:\/?(?:(?:\&|\&amp;|\&#33;|,[_%]|[A-Za-z0-9А-Яа-яёЁ\-\_#%?!+\/\$\|.~=;:']+|\[[A-Za-z0-9А-Яа-яёЁ\-\_#%?!+\/\$.,~=;:]*\]|\([A-Za-z0-9А-Яа-яёЁ\-\_#%?!+\/\$.,~=;:]*\))*(?:,[_%]|[A-Za-z0-9А-Яа-яёЁ\-\_#%?!+\/\$.~=,;:]*[A-Za-z0-9А-Яа-яёЁ\_#%?!+\/\$~=]|\[[A-Za-z0-9А-Яа-яёЁ\-\_#%?!+\/\$.,~=;:]*\]|\([A-Za-z0-9А-Яа-яёЁ\-\_#%?!+\/\$.,~=;:]*\)))?)?)/gi,(function(){var e=Array.prototype.slice.apply(arguments),t=e[1]||"",n=e[5]||"http://",a=e[6]||"",s=a+(e[7]||""),o=(e[5]||"")+e[6]+e[7];if(-1==a.indexOf(".")||-1!=a.indexOf(".."))return e[0];var r=a.split(".").pop();if(s.indexOf("widget/img/blank")+1>0||-1!=e[0].indexOf("@"))return e[0];if((r.length>12||-1=="info,name,academy,aero,arpa,coop,media,museum,mobi,travel,xxx,asia,biz,com,net,org,gov,mil,edu,int,tel,ac,ad,ae,af,ag,ai,al,am,an,ao,aq,ar,as,at,au,aw,ax,az,ba,bb,bd,be,bf,bg,bh,bi,bj,bm,bn,bo,br,bs,bt,bv,bw,by,bz,ca,cc,cd,cf,cg,ch,ci,ck,cl,cm,cn,co,cr,cu,cv,cx,cy,cz,de,dj,dk,dm,do,dz,ec,ee,eg,eh,er,es,et,eu,fi,fj,fk,fm,fo,fr,ga,gd,ge,gf,gg,gh,gi,gl,gm,gn,gp,gq,gr,gs,gt,gu,gw,gy,hk,hm,hn,hr,ht,hu,id,ie,il,im,in,io,iq,ir,is,it,je,jm,jo,jp,ke,kg,kh,ki,km,kn,kp,kr,kw,ky,kz,la,lb,lc,li,lk,lr,ls,lt,lu,lv,ly,ma,mc,md,me,mg,mh,mk,ml,mm,mn,mo,mp,mq,mr,ms,mt,mu,mv,mw,mx,my,mz,na,nc,ne,nf,ng,ni,nl,no,np,nr,nu,nz,om,pa,pe,pf,pg,ph,pk,pl,pm,pn,pr,ps,pt,pw,py,qa,re,ro,ru,rs,rw,sa,sb,sc,sd,se,sg,sh,si,sj,sk,sl,sm,sn,so,sr,ss,st,su,sv,sx,sy,sz,tc,td,tf,tg,th,tj,tk,tl,tm,tn,to,tp,tr,tt,tv,tw,tz,ua,ug,uk,um,us,uy,uz,va,vc,ve,vg,vi,vn,vu,wf,ws,ye,yt,yu,za,zm,zw,рф,укр,сайт,онлайн,срб,cat,pro,local,plus,xn--p1ai,xn--80aswg,xn--80asehdb".split(",").indexOf(r))&&(!/^[a-zA-Z]+$/.test(r)||!e[5]))return e[0];try{o=decodeURIComponent(o),o=i.escapeHtml(o)}catch(e){}return t+'<a class="ws-chat-message-link" href="'+n+s+'" target="_blank">'+o+"</a>"})),e=e.replace(/([a-zA-ZА-Яа-яёЁ\-_\.0-9]+@[a-zA-ZА-Яа-яёЁ\-_0-9]+\.[a-zA-ZА-Яа-яёЁ\-_\.0-9]+[a-zA-ZА-Яа-яёЁ\-_0-9]+)/g,(function(e){return'<a class="ws-chat-message-link" href="mailto:'+e+'" target="_blank">'+e+"</a>"}))},cleanTextToApp:function(e){return e=(e=e.replace(/^\n|\n$/g," ").replace(/[\n\xa0]/g," ").replace(/[ ]+/g," "))?e.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">").replace(/"/g,'"').replace(/'/g,"'"):""},cleanTextToHtml:function(e){return e=e?e.replace(/(\<(?!(img class="ws-sprite-emoji emoji-img|a class\=\'ws\-text\-link|\/a)))/g,"&lt;"):"",e=this.textUrlFormat(e)},cleanMessage:function(e){if(!e)return"";e=e instanceof t?e[0].firstChild:e.firstChild;for(var n="",a=new RegExp("^(DIV|P|LI|OL|TR|TD|BLOCKQUOTE|SCRIPT)$");e;){switch(e.nodeType){case 3:n+=s=this.cleanTextToApp(e.data);break;case 1:var s=i.cleanMessage(e);if(e.tagName&&e.tagName.match(a)&&s){"\n"!=s.substr(-1)&&(s+="\n");for(var o=e.previousSibling;o&&3==o.nodeType&&""==t.trim(o.nodeValue);)o=o.previousSibling;!o||o.tagName&&o.tagName.match(a)||(s="\n"+s)}else"IMG"==e.tagName?s+=e.outerHTML:"BR"==e.tagName&&(s+="\n");n+=s}e=e.nextSibling}return t.trim(n)},getOperatorsKeys:function(){var e={all:[],online:[]};return t.each(n.fireUsers,(function(t,i){"operator"===i.role&&(e.all.push(t),i.online&&e.online.push(t))})),e},create:function(e,a){var s=this;if(n.chatCreating)n.messages_for_send_by_timer.push(e),wsUtil.getInterval("chatCreating")||wsUtil.setInterval("chatCreating",(function(e){if(!n.chatCreating&&(wsUtil.deleteInterval("chatCreating"),n.messages_for_send_by_timer&&n.messages_for_send_by_timer.length)){for(var t in n.messages_for_send_by_timer)i.messageFire(n.messages_for_send_by_timer[t]);n.messages_for_send_by_timer=[]}}),1e3);else{n.chatCreating=!0;var o=(new Date).getTime(),r=wsUtil.generateHash(o,WBK.settings.visitorId),l=WBK.settings.serverUrl+"/api?action=chatCreateNew",c=s.getOperatorsKeys();jWS.post(l,{code:WBK.settings.whiteSaasCode,visitorName:WBK.settings.visitorName?WBK.settings.visitorName:"",data:e,type_show:wsUtil.getCookie("WidgetChat_shownOn"),visitorId:WBK.settings.visitorId,url:"string"==typeof document.URL?document.URL:"",chatWidgetId:WBK.settings.chatWidgetId,googleClientId:wsUtil.getGoogleClientId(),roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId(),leadvertexId:wsUtil.getLeadvertexId(),operatorsOnline:c.online,operatorsAll:c.all,externalParams:wsUtil.getExternalParams(),departmentId:n.chat_distribution_department_picked,hashTime:o,hash:r},(function(o){if(o&&o.Success&&o.Data&&o.Data.chat){for(var r=0;r<n.invitations.length;r++)wsUtil.deleteInterval("invitationShow_"+r);WBK.settings.chatId=o.Data.chat.id,n.chat_visitor_color=o.Data.chat.color,n.chat_visitor_name=o.Data.chat.visitor_name,n.chat_visitor_img=o.Data.chat.img,n.chatKey=o.Data.data.chat_key,n.visitorKey=o.Data.data.visitor_key,o.Data.data.message_key;var l=o.Data.data.invitation_keys;l&&t.each(l,(function(e,t){s.updateMessageId(e,t)})),s.updateMessageId(e.sentAt,o.Data.data.message_key),n.v2_local?(n.fireChat=o.Data.data.chat,n.visitor=o.Data.data.visitor,s.loadLocalChat().then((function(){n.chatCreating=!1,n.chat_created=!0}))):s.loadFireChat().then((function(){s.addOldMessages(),n.chatCreating=!1,n.chat_created=!0})),i.updateVisitor({chatCreated:!0,chatKey:n.chatKey,said:!0}),"function"==typeof a&&a()}else n.chatCreating=!1}),"json")}},updateFireChat:function(e,t){"noAnswerRequired"===e&&!0===t&&(i.stopAutoReply("not_answer_operator"),i.stopAutoReply("not_connected")),"userText"==e&&t&&this.showPrinting(t),"operators"==e&&(n.fireChat.operators=t||[],this.operatorsUpdate()),"status"==e&&t&&(n.fireChat.status=t,"ended"!=t&&"auto_ended"!=t&&"lost"!=t||this.onCloseChat()),n.fireChat[e]=t},showPrinting:function(e){jWS.isEmptyObject(e)||t.each(e,(function(t,a){if(a&&n.all_operators.hasOwnProperty(t)&&n.fireOperatorPrinting[t]!=e[t])return n.fireOperatorPrinting[t]=e[t],void i.onOperatorPrinting(t)}))},printing:function(e,t){n.printingData.type=e,n.printingData.message=this.smileReplacer(t,"to_code"),this.updatePrintingTimeout(),wsUtil.getInterval("printingInterval")||(this.sendPrinting(),wsUtil.setInterval("printingInterval",(function(){i.sendPrinting()}),3e3))},sendPrinting:function(){var e={};n.chatKey&&!n.fireChat.visitorBlocked&&n.fireChat.visitor&&n.chat_created&&(n.v2_local?((e=n.printingData).userKey=n.fireChat.visitor,ChatLocalServer.printing(n.chatKey,e)):("text"==n.printingData.type&&n.printingData.message&&(e["userText/"+n.fireChat.visitor]=n.printingData.message),e["userActivity/"+n.fireChat.visitor]=n.printingData.type,this.getChatRef().update(e)))},updatePrintingTimeout:function(){wsUtil.deleteTimeout("printingTimeout"),wsUtil.setTimeout("printingTimeout",(function(){i.removePrinting()}),5e3)},removePrinting:function(){if(wsUtil.deleteInterval("printingInterval"),wsUtil.deleteTimeout("printingTimeout"),n.chatKey&&n.fireChat&&!n.fireChat.visitorBlocked&&n.chat_created){var e={};n.v2_local?(e={userKey:n.fireChat.visitor,type:null,message:null},ChatLocalServer.printing(n.chatKey,e)):(e["userActivity/"+n.fireChat.visitor]=null,e["userText/"+n.fireChat.visitor]=null,this.getChatRef().update(e))}},messageFire:function(e){n.chatKey&&!n.fireChat.visitorBlocked&&(e.hasOwnProperty("status")||(e.status="delivered"),e.hasOwnProperty("text")&&(e.text=this.smileReplacer(e.text,"to_code")),n.v2_local?i.messageLocalRun(e):i.messageFireRun(e))},messageFireRun:function(e){var t=e.sentAt;if(e.sentAt={".sv":"timestamp"},"system"==e.type&&(e.sender||(e.sender=n.fireRobot.key),a=i.getChatMessageRef().push(e),"rating"==e.subType&&i.getChatRef().child("rate").set(e.attributes.rate)),"system"!=e.type){e.sender=n.fireSender,i.removePrinting();var a=i.getChatMessageRef().push(e,(function(e){e||i.updateMessageId(t,a)})).key;i.updateVisitor({said:!0}),i.getChatRef().update({unreadCount:n.fireChat.unreadCount+1,lastMessage:e,noAnswerRequired:!1})}},messageLocalRun:function(e){var t=e.sentAt;e.localKey="visitor_"+t,"system"==e.type&&(e.sender||(e.sender=n.fireRobot.key),ChatLocalServer.sendMessage(n.chatKey,e).then((function(e){i.updateMessageId(t,e.key)}))),"system"!=e.type&&(e.sender=n.fireSender,ChatLocalServer.sendMessage(n.chatKey,e).then((function(e){i.updateMessageId(t,e.key)})),i.removePrinting(),i.updateVisitor({said:!0}))},updateMessageId:function(e,t){e="visitor_"+e;var i=n.fireMessages[e];n.fireMessages[t]=i,delete n.fireMessages[e];var a=s.window.find(".ws-chat-body-content").find("#"+e);a.attr("id",t),a.data("sender",n.visitorKey),this.updateMessageDataById(t,{status:"delivered"})},updateMessageDataById:function(e,t){var i;if((i=s.window.find(".ws-chat-body-content").find("#"+e)).length>0&&t.text&&t.text!==i.find(".ws-chat-message-source").text()){var n=this.cleanTextToHtml(t.text);n=this.smileReplacer(n,"to_img"),i.find(".ws-chat-message-source").html(n)}t.hasOwnProperty("status")&&(i=i.closest(".ws-chat-message-block")).find(".ws-chat-message-status").text(this.getStatusText(t.status))},getFcmData:function(e,t){var i=WBK.settings.visitorName?WBK.settings.visitorName:n.user_name?n.user_name:n.chat_visitor_name,a="Новое сообщение",s="";switch(s="default"!=n.auth_type?n.logo_visitor:n.chat_visitor_img?n.chat_visitor_img:WBK.settings.serverUrl+"/firstletter/?name="+i.substr(0,1)+"&color="+n.chat_visitor_color,e.message_type){case"show_invitation":case"text":a=e.message.text.replace(/(?:\r\n|\r|\n)/g,"<br />");break;case"attach_image":a="Посетитель отправил изображение";break;case"attach_file":a="Посетитель отправил документ";break;case"rating":a="Посетитель оценил работу оператора";break;case"introduced":a="Посетитель представился"}return{is_first:t,chat_id:WBK.settings.chatId,visitor_id:WBK.settings.visitorId,name:i,message:a,color:n.chat_visitor_color,introduced:n.chat_introduced,auth_type:n.auth_type,image:s,vk_id:n.visitor_vk_id,fb_id:n.visitor_fb_id}},messageRead:function(e){n.chatKey&&n.fireChat&&n.fireChat.visitor&&(n.v2_local?ChatLocalServer.updateMessage(n.chatKey,e,{status:"read"}):(this.getChatMessageRef().child(e).update({status:"read"}),n.fireChat.lastMessage.sender!=n.fireChat.visitor&&this.getChatRef().child("lastMessage").update({status:"read"})),i.updateVisitor({said:!0}))},messageReadVisitor:function(){for(var e=0;e<n.unread_messages.length;e++)i.messageRead(n.unread_messages[e]);n.unread_messages=[],i.setUnreadMessages(0)},setUnreadMessages:function(e){var a=t('link[rel="shortcut icon"], link[rel="icon"]');if(e>99&&(e=99),WBK.settings.multiButtonEnabled&&wsMultiButton.showBudgeMessage(e),wsUtil.deleteInterval("unreadMessages"),0==e)return s.btn.find(".ws-btn-badge").text("").hide(),n.unread_messages_count=0,document.title=n.document_title,n.new_favicon_href="",void(n.document_favicon_href&&a.attr("href",n.document_favicon_href));if(s.btn.find(".ws-btn-badge").text(e).show(),n.document_favicon_href){var o=t('<img crossOrigin="anonymous" src="'+n.document_favicon_href+'"/>');o.load((function(){n.new_favicon_href=i.generateFavicon(o,e),wsUtil.setInterval("unreadMessages",(function(){n.document_title==document.title?(document.title=wsUtil.doEnding(e,n.lang_text.one_new_mess,n.lang_text.two_new_mess,n.lang_text.five_new_mess),n.new_favicon_href&&a.attr("href",n.new_favicon_href)):(document.title=n.document_title,n.document_favicon_href&&a.attr("href",n.document_favicon_href))}),1e3)})).error((function(){wsUtil.setInterval("unreadMessages",(function(){n.document_title==document.title?document.title=e+" "+wsUtil.doEnding(e,n.lang_text.one_new_mess,n.lang_text.two_new_mess,n.lang_text.five_new_mess):document.title=n.document_title}),1e3)}))}else wsUtil.setInterval("unreadMessages",(function(){n.document_title==document.title?document.title=e+" "+wsUtil.doEnding(e,n.lang_text.one_new_mess,n.lang_text.two_new_mess,n.lang_text.five_new_mess):document.title=n.document_title}),1e3)},generateFavicon:function(e,i){if(n.document_favicon_href){var a,s=t("<canvas/>");if(t('link[rel="shortcut icon"], link[rel="icon"]'),s[0].getContext("2d")){s[0].height=s[0].width=e[0].width,a=s[0].getContext("2d"),i&&(a.globalAlpha=.4,i<10?i=" "+i:i>100&&(i=99));var o=e[0].width/16,r=11*o,l=o,c=11*o,d=o,h=2*o;return a.drawImage(e[0],0,0),a.globalAlpha=1,a.font="bold "+r+'px "helvetica", sans-serif',a.shadowColor="#FFF",a.shadowBlur=h,a.shadowOffsetX=0,a.shadowOffsetY=0,a.fillStyle="#FFF",a.fillText(i,l,c),a.fillText(i,l+d,c),a.fillText(i,l,c+d),a.fillText(i,l+d,c+d),a.fillStyle="#000",a.fillText(i,l+d/2,c+d/2),s[0].toDataURL("image/png")}}},scroll:function(){var e=s.window.find(".ws-chat-body");e[0].hasOwnProperty("nanoscroller")&&(e.nanoScroller(),e.nanoScroller({scrollBottom:0}))},initBtnPosition:function(){var e={},t={};if(s.btn.show(),"pc"!=WBK.settings.device)"hide"==n.button_location||"pc"!=WBK.settings.device&&parseInt(n.hide_mobile)||i.updateBtnPositionMobile();else{switch(n.button_location){case"horizontal":switch(n.position_x){case"left":e.left=n.position_x_value+"%",e.right="auto",s.invitation.addClass("ws-chat-invitation-left");break;case"right":e.right=n.position_x_value+"%",e.left="auto"}switch(n.position_y){case"bottom":e.bottom=n.position_y_value+"%",e.top="auto",0==n.position_y_value&&s.btn.addClass("ws-chat-btn-attach"),WBK.addStyles(".ws-chat .ws-chat-invitation-container:after{border-top-color: "+n.color_background_invitation+" !important;}");break;case"top":e.top=n.position_y_value+"%",e.bottom="auto",0==n.position_y_value&&(s.btn.addClass("ws-chat-btn-attach-top"),s.btn.find(".ws-btn-badge").css("top","32px")),s.invitation.addClass("ws-chat-invitation-bottom"),WBK.addStyles(".ws-chat .ws-chat-invitation-container:after{border-bottom-color: "+n.color_background_invitation+" !important;}")}break;case"vertical_left":s.btn.addClass("ws-chat-btn-rotate").addClass("ws-chat-btn-attach-top"),s.btn.find(".ws-btn-badge").css("top","32px"),e.left=-(s.btn.outerWidth()-s.btn.outerHeight())/2+"px",e.right="auto",t.left=s.btn.outerWidth()/2+s.btn.outerHeight()+"px",t.right="auto",s.invitation.addClass("ws-chat-invitation-rotate-right"),WBK.addStyles(".ws-chat .ws-chat-invitation-container:after{border-right-color: "+n.color_background_invitation+" !important;}");break;case"vertical_right":s.btn.addClass("ws-chat-btn-rotate").addClass("ws-chat-btn-attach"),e.right=-(s.btn.outerWidth()-s.btn.outerHeight())/2+"px",e.left="auto",t.right=s.btn.outerWidth()/2+s.btn.outerHeight()+"px",t.left="auto",s.invitation.addClass("ws-chat-invitation-rotate-left"),WBK.addStyles(".ws-chat .ws-chat-invitation-container:after{border-left-color: "+n.color_background_invitation+" !important;}")}if("vertical_left"==n.button_location||"vertical_right"==n.button_location){switch(n.position_y){case"bottom":e.bottom=(s.btn.outerWidth()-s.btn.outerHeight())/2+window.innerHeight/100*n.position_y_value+"px",e.top="auto";break;case"top":e.top=(s.btn.outerWidth()-s.btn.outerHeight())/2+window.innerHeight/100*n.position_y_value+"px",e.bottom="auto"}s.invitation.css({top:-(s.btn.outerWidth()-s.btn.outerHeight())/2+"px",bottom:"auto",left:t.left,right:t.right})}s.btn_el.css(e)}s.btn.hide()},upInvitationIfNotFit:function(){if("mobile"===WBK.settings.device){var e=s.btn_el,i=n.mobile_position_x,a=t(document).find(".multi_button"),o=0,r=0,l=this.checkMultibuttonForChatActivated();if(l)if(e=a.first(),i=wsMultiButton.settings.position_x,"bottom"!==wsMultiButton.settings.position_y)switch(wsMultiButton.settings.size){case"mb_big_size":o=20,r=20;break;case"mb_medium_size":o=10,r=10}else switch(wsMultiButton.settings.size){case"mb_big_size":o=-20,r=20;break;case"mb_medium_size":o=-10,r=10}var c=parseInt(window.outerWidth),d=parseInt(window.outerHeight),h=parseInt(e.offset().left),u=e.outerWidth(),g=e.outerHeight(),p=e.outerHeight(!0),w=c-(h+u),f=s.invitation.find(".ws-chat-invitation-input"),m=s.invitation.outerWidth()-50,v=c-s.invitation.outerWidth()-w-10,_=e.position().top,b=d-(_+g);s.invitation.css({top:"",bottom:""}),("none"!==e.css("display")||l)&&("left"===i&&w<m||"right"===i&&h<m&&v<0||v<0&&w<m)?(s.invitation.css({left:10-h}),f.addClass("invitation-input-full-size"),_>b?(this.changeChatVerticalOrientationOnMobile("top"),l?(this.setChatBtnElVerticalPositionLikeMultibutton(),s.invitation.css({bottom:g-o,top:"unset"}),"top"===wsMultiButton.settings.position_y&&(s.invitation.css({bottom:"unset",top:p}),this.changeChatVerticalOrientationOnMobile("bottom"))):"bottom"===n.mobile_position_y?s.invitation.css({bottom:g,top:"unset"}):(s.invitation.css({bottom:"unset",top:g+o}),this.changeChatVerticalOrientationOnMobile("bottom"))):b>=_&&(l?(this.setChatBtnElVerticalPositionLikeMultibutton(),s.invitation.css({bottom:"unset",top:p+o})):s.invitation.css({bottom:"unset",top:g+o}),this.changeChatVerticalOrientationOnMobile("bottom"))):(f.removeClass("invitation-input-full-size"),l&&(this.setChatBtnElVerticalPositionLikeMultibutton(),"top"===wsMultiButton.settings.position_y?(this.changeChatVerticalOrientationOnMobile("top"),s.invitation.css("top",p)):"bottom"===wsMultiButton.settings.position_y&&this.changeChatVerticalOrientationOnMobile("bottom")),"right"===i&&!0===l&&(s.btn_el.css({right:wsMultiButton.settings.position_x_value+"%"}),s.invitation.css({left:"",right:r})))}},setChatBtnElVerticalPositionLikeMultibutton:function(){var e=t(document).find(".multi_button");s.btn_el.css({top:"",bottom:""}),"top"===wsMultiButton.settings.position_y?s.btn_el.css({top:wsMultiButton.settings.position_y_value+"%"}):s.btn_el.css({bottom:wsMultiButton.settings.position_y_value+"%","margin-bottom":e.css("margin-bottom")})},setChatBtnElHorizontalPositionLikeMultibutton:function(){switch(s.btn_el.css({left:"auto",right:"auto"}),wsMultiButton.settings.position_x){case"left":s.btn_el.css("left",wsMultiButton.settings.position_x_value+"%");break;case"right":s.btn_el.css("right",wsMultiButton.settings.position_x_value+"%")}},changeChatVerticalOrientationOnMobile:function(e){var i=t(".ws-chat-mobile");switch(i.removeClass("top bottom"),e){case"top":i.addClass("top");break;case"bottom":i.addClass("bottom")}},changeChatHorizontalOrientationOnMobile:function(e){var i=t(".ws-chat-mobile");switch(i.removeClass("left right"),e){case"left":i.addClass("left");break;case"right":i.addClass("right")}},checkMultibuttonForChatActivated:function(){var e=!1;return WBK.settings.multiButtonEnabled&&t.each(wsMultiButton.settings.checked_variants,(function(t,i){"chat"===i.action&&i.action_value==WBK.settings.chatWidgetId&&(e=!0)})),e},updateBtnPositionMobile:function(){if(!s.btn_el.hasClass("ws-chat-no-update-position")&&!parseInt(n.hide_mobile)){var e=wsUtil.getRatio();n.scallingMobile=1!=e;var t,i={ratio:e,positionX:n.mobile_position_x,positionY:n.mobile_position_y,positionXValue:n.mobile_position_x_value,positionYValue:n.mobile_position_y_value};n.scallingMobile?(s.btn_el.removeClass("envy-not-scalling"),i.el=s.btn_el,(t=wsUtil.getMobileScalePositionWidget(i))["z-index"]="inherit",s.btn_el.css(t),wsUtil.setTimeout("zIndex",(function(){s.btn_el.css("z-index",2147483645),parseInt(n.hide_zoom)&&wsUtil.setTimeout("btnElShow",(function(){s.btn_el.show()}),150)}),50)):(s.btn_el.addClass("envy-not-scalling"),t=wsUtil.getMobileNotScalePositionWidget(i),s.btn_el.css(t),s.btn_el.show()),s.container.addClass(n.mobile_position_x),s.container.addClass(n.mobile_position_y),this.upInvitationIfNotFit()}},updateOfflineBodySize:function(){n.containerSize=s.window.height();var e=s.window.find(".ws-chat-header").height(),t=s.window.find(".ws-chat-body-offline").height(),i=s.window.find(".ws-chat-copyright").height();n.containerSize<e+t+i?s.window.addClass("copyright-relative"):s.window.removeClass("copyright-relative")},initWindowPosition:function(){if("pc"==WBK.settings.device){var e=s.btn_el.position().top,i=s.btn_el.position().left,n=s.window.outerHeight(),a=s.window.width(),o=s.btn.outerHeight(),r=t(window).width(),l=window.innerHeight,c=0;s.window.hasClass("ws-chat-ico-bottom")&&(c=64),i+a>r&&(c=0,i=r-a),(e=e-n+o)<0&&(e=0),i<0&&(i=0),e+n>l&&(e=l-n),e<0&&(e=0),s.window.css({top:e/(l/100)+"%",left:(i+c)/(r/100)+"%"}),WBK.animateFastOnce(s.window,"cbk-zoomIn")}},updateWindowPosition:function(){s.window.position().top;var e=s.window.position().left,t=(s.window.height(),s.window.width()),i=wsUtil.getVisualWidth(),n=(wsUtil.getVisualHeight(),0);s.window.hasClass("ws-chat-ico-bottom")&&(n=64),e+t+n>i-15&&(e=i-t-n-15),e<0&&(e=0),s.window.css({left:(e+n)/(i/100)+"%"}),WBK.animateFastOnce(s.window,"cbk-zoomIn")},loadBtnEvents:function(){s.btn.on("click",(function(){1==WBK.settings.chatInvitationOpened&&i.hideInvitation(),i.showWidget(),i.sendGoal("open")})),s.invitation.on("click",(function(e){if(i.hideInvitation(),t(e.target).hasClass("ws-chat-invitation-close")||t(e.target).hasClass("ws-icon-close"))return WBK.settings.multiButtonId&&(wsMultiButton.hideWidget(),wsMultiButton.reInitWidget()),wsMultiButton.settings.text_tip&&t(".multi_button-main-div-text .multi_button-text").show(),void i.sendGoal("invitation_close");i.showWidget(),i.sendGoal("invitation_click")}))},loadWindowEvents:function(){if(!t.fn._frameCheck()||"undefined"!=typeof WBK)try{t("body").on("click",'a[href="#showchat"], a[href="'+window.top.location.origin+'#showchat"], a[href="'+window.top.location.origin+'/#showchat"]',(function(e){return i.showWidget(),i.sendGoal("open"),i.autoSendMessage(this),e.preventDefault(),!1}))}catch(e){}if(s.window.find(".ws-chat-close").on("click",(function(){"pc"!=WBK.settings.device&&(location.hash=""),i.hideWidget()})),t(document).on("click",".ws-chat-message-element-file",(function(){if(n.chat_created){(new Date).getTime();var e={file_name:t(this).data("fileName"),file_name_upload:t(this).data("fileNameUpload"),file_link:t(this).attr("href")};i.sendRobot({text:"Посетитель скачал файл "+e.file_name+", "+e.file_link,subType:"start_download"})}})),t(document).on("click",".ws-chat-uploaded-el-close",(function(){var e=t(this).parent().data("index");e&&(delete n.fileUploaded[e],i.updateFilesUploaded())})),s.window.find(".ws-chat-sound").on("click",(function(){"on"==n.sound?(n.sound="off",s.window.find(".ws-chat-sound").attr("title",n.lang_text.sound_on),s.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-on").addClass("ws-icon-sound-off")):(n.sound="on",s.window.find(".ws-chat-sound").attr("title",n.lang_text.sound_off),s.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-off").addClass("ws-icon-sound-on"));var e=new Date;e.setMinutes(e.getMinutes()+43200),wsUtil.setCookie("WidgetChat_sound_"+WBK.settings.chatWidgetId,n.sound,e)})),s.window.find(".ws-textarea").bind("keypress",(function(e){var t=e.keyCode||e.which;if(10==t||13==t&&e.ctrlKey){var n=window.getSelection().getRangeAt(0),a=document.createElement("br"),o=document.createElement("br");document.createTextNode(" "),n.deleteContents(),n.insertNode(a),3==n.startContainer.nodeType&&n.insertNode(o),n.collapse(!1)}if(13==t&&!e.shiftKey&&!e.ctrlKey){if("false"===s.window.find(".ws-textarea").attr("contenteditable"))return;e.preventDefault(),i.sendMessage()&&s.window.find(".ws-textarea-send-btn").hide()}s.window.find(".ws-textarea-group .ws-textarea-placeholder").hide(),i.deleteInputTextInLocalStorage()})),s.window.find(".ws-textarea").bind("keyup",(function(e){var t=e.keyCode||e.which;37!=t&&38!=t&&39!=t&&40!=t&&37!=t&&33!=t&&34!=t&&i.inputScroll()})),s.window.find(".ws-textarea").bind("keydown",(function(e){8==(e.keyCode||e.which)&&i.inputScroll()})),s.window.find(".ws-textarea").on("paste",(function(e){e.preventDefault();var t="";if((e.originalEvent||e.originalEvent.clipboardData.getData("text/plain"))&&(t=e.originalEvent.clipboardData.getData("text/plain")),t)try{t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/\n/g,"<br>"),i.insertHTML(t)}catch(e){}var n=e.clipboardData||e.originalEvent.clipboardData;if(n&&(n=n.items)){for(var a=!1,s=0;s<n.length;s++)0==n[s].type.indexOf("image")&&(a=n[s].getAsFile());if(a){a.name=a.filename="image_"+(new Date).getTime()+".png";var o=new File([a],a.filename),r=new FormData;r.append("img",o),r.append("type","img"),r.append("image_type","screen"),r.append("chat_id",WBK.settings.chatId),i.uploadFileServer(r,"img")}}})),s.window.find(".ws-textarea-send-btn").on("click",(function(e){if(i.sendMessage()){s.window.find(".ws-textarea-send-btn").hide(),s.window.find(".ws-textarea-group:not(.ws-textarea-group-hide) .ws-textarea-placeholder").show();var t=s.window.find(".ws-textarea");wsUtil.setFocusContentEditable(t[0]),i.typingPositionUpdate(),i.deleteInputTextInLocalStorage()}})),t(document).on("click",".ws-chat-message-user .ws-chat-message-name-text",(function(){i.getContactRobot(!0)})),t(document).on("click",".ws-chat-message-robot .ws-chat-message-input",(function(){i.showPreform("preform")})),t(document).on("click",".ws-chat-autoreply-btn",(function(){parseInt(n.show_contact_form_inside_chat)&&(i.addMessageRobot({subType:"lead"}),i.setPhoneMaskData(".ws-preform-phone")),i.showPreform("lead",t(this).data("index"),t(this))})),t(document).on("click",".ws-chat-message-manager .ws-chat-message-name-text, .ws-chat-ico .ws-chat-logo",(function(){var e=" "+t(this).text()+", ";s.window.find(".ws-textarea").is(":focus")||s.window.find(".ws-textarea").focus(),i.insertHTML(e)})),s.window.find(".ws-textarea").bind("keyup paste",(function(e){var a=e.keyCode||e.which;if(13!=a)if(""!=t(".ws-textarea").html()||8==a){s.window.find(".ws-textarea-send-btn").css("display","flex");var o=i.cleanMessage(t(".ws-textarea"));i.printing("text",o),wsUtil.setStorage("ws_chat_input_text_"+WBK.settings.chatWidgetId,t(".ws-textarea").html())}else 0==n.fileUploadedCount&&s.window.find(".ws-textarea-send-btn").hide();""===t(".ws-textarea").html()||"<br>"===t(".ws-textarea").html()?(s.window.find(".ws-textarea-group .ws-textarea-placeholder").show(),i.deleteInputTextInLocalStorage()):s.window.find(".ws-textarea-group .ws-textarea-placeholder").hide()})),s.window.find(".ws-textarea").on("focus",(function(){i.messageReadVisitor()})),s.window.find(".ws-btn-smile, .ws-smile-container").mouseenter((function(){wsUtil.deleteTimeout("hideSmileContainer"),s.window.find(".ws-file-container").hide(),s.window.find(".ws-smile-container").show()})).mouseleave((function(){wsUtil.setTimeout("hideSmileContainer",(function(){s.window.find(".ws-smile-container").hide()}),300)})),s.window.find(".ws-btn-file, .ws-file-container").mouseenter((function(){wsUtil.deleteTimeout("hideFileContainer"),s.window.find(".ws-smile-container").hide(),s.window.find(".ws-file-container").show()})).mouseleave((function(){wsUtil.setTimeout("hideFileContainer",(function(){s.window.find(".ws-file-container").hide()}),300)})),t(window).on("resize.ws-chat",(function(){if("pc"==WBK.settings.device)wsUtil.setTimeout("resizeChat",(function(){WBK.settings.chatWindowOpened?i.updateWindowPosition():i.initWindowPosition()}),500);else{var e=s.window.find(".ws-textarea").outerHeight();e<62&&(e=62),s.window.find(".ws-chat-body").css("bottom",e),i.scroll()}})),t(document).on("click",".ws-chat .ws-chat-message-option-pick-department",(function(){var e=t(this).data("value");e&&i.setDepartment(e,t(this).text())})),"pc"==WBK.settings.device?(s.window.find(".ws-chat-header").on("mousedown",(function(e){1!==e.which||t(e.target).hasClass("ws-chat-close")||t(e.target).hasClass("ws-icon-close")||t(e.target).hasClass("ws-chat-sound")||t(e.target).hasClass("ws-icon-sound-on")||t(e.target).hasClass("ws-icon-sound-off")||(s.window.addClass("ws-chat-drag"),n.dragChatObject.elem=s.window,n.dragChatObject.downX=e.pageX,n.dragChatObject.downY=e.pageY)})),t(document).on("mouseup.ws-chat-header",(function(e){if(n.dragChatObject.dragStarted){n.dragChatObject.dragStarted=!1;var t=new Date;t.setMinutes(t.getMinutes()+1440);var i=JSON.stringify({top:s.window.css("top"),left:s.window.css("left"),width:s.window.css("width"),height:s.window.css("height")});wsUtil.setCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId,i,t)}s.window.removeClass("ws-chat-drag"),n.dragChatObject={}})),t(document).on("mousemove.ws-chat-header",(function(e){if(n.dragChatObject.elem){var i=e.pageX-n.dragChatObject.downX,a=e.pageY-n.dragChatObject.downY;if(Math.abs(i)<3&&Math.abs(a)<3)return;n.dragChatObject.dragStarted||(n.dragChatObject.oldPosition={left:n.dragChatObject.elem.position().left||"",top:n.dragChatObject.elem.position().top||""},n.dragChatObject.shiftX=n.dragChatObject.downX-n.dragChatObject.elem.position().left,n.dragChatObject.shiftY=n.dragChatObject.downY-n.dragChatObject.elem.position().top,n.dragChatObject.dragStarted=!0);var o=e.pageX-n.dragChatObject.shiftX,r=e.pageY-n.dragChatObject.shiftY,l=t(window).width(),c=window.innerHeight;r=n.dragChatObject.elem.outerHeight()>c?0:r+n.dragChatObject.elem.outerHeight()>c-10?c-n.dragChatObject.elem.outerHeight():r<10?0:r,(o=n.dragChatObject.elem.outerWidth()+o>l?l-n.dragChatObject.elem.outerWidth():o<10?0:o)<100&&s.window.hasClass("ws-chat-ico-bottom")?s.window.addClass("ws-chat-ico-bottom-right"):s.window.removeClass("ws-chat-ico-bottom-right"),n.dragChatObject.elem.css({left:o+"px",top:r+"px",right:"auto",bottom:"auto"})}})),n.chat_is_online&&(s.window.find(".ws-chat-resize").on("mousedown",(function(e){1===e.which&&(n.resizeChatObject.elem=s.window,n.resizeChatObject.elemMinSizeHeight=310+s.window.find(".ws-chat-header").outerHeight()+n.resizeChatObject.elem.find(".ws-chat-footer").outerHeight(),n.resizeChatObject.downX=e.pageX,n.resizeChatObject.downY=e.pageY,s.window.addClass("ws-chat-no-select"))})),t(document).on("mouseup.ws-chat-resize",(function(e){if(n.resizeChatObject.dragStarted){n.resizeChatObject.dragStarted=!1;var t=new Date;t.setMinutes(t.getMinutes()+1440);var a=JSON.stringify({top:s.window.css("top"),left:s.window.css("left"),width:s.window.css("width"),height:s.window.css("height")});wsUtil.setCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId,a,t),i.inputScroll()}n.resizeChatObject={},s.window.removeClass("ws-chat-no-select"),i.typingPositionUpdate()})),t(document).on("mousemove.ws-chat-resize",(function(e){if(n.resizeChatObject.elem){var a=e.pageX-n.resizeChatObject.downX,o=e.pageY-n.resizeChatObject.downY;if(Math.abs(a)<3&&Math.abs(o)<3)return;n.resizeChatObject.dragStarted||(n.resizeChatObject.old={width:n.resizeChatObject.elem.outerWidth(),height:n.resizeChatObject.elem.outerHeight(),left:n.resizeChatObject.elem.position().left||"",top:n.resizeChatObject.elem.position().top||""},n.resizeChatObject.shiftX=n.resizeChatObject.downX-n.resizeChatObject.elem.position().left,n.resizeChatObject.shiftY=n.resizeChatObject.downY-n.resizeChatObject.elem.position().top,n.resizeChatObject.dragStarted=!0),n.resizeChatObject.dragStarted=!0;var r=e.pageX-n.resizeChatObject.downX,l=e.pageY-n.resizeChatObject.downY,c=t(window).width(),d=window.innerHeight,h=n.resizeChatObject.old.height+l,u=n.resizeChatObject.old.width+r;n.resizeChatObject.elem.position().top+h>d&&(h=d-n.resizeChatObject.elem.position().top),n.resizeChatObject.elem.position().left+u>c&&(u=c-n.resizeChatObject.elem.position().left),i.contactFormIsVisible()&&(n.resizeChatObject.elemMinSizeHeight=s.window.find(".ws-chat-body-preform").outerHeight()+s.window.find(".ws-chat-header").outerHeight()),s.window.find(".ws-chat-body-offline").is(":visible")&&(n.resizeChatObject.elemMinSizeHeight=s.window.find(".ws-chat-body-offline").outerHeight()+s.window.find(".ws-chat-header").outerHeight()),n.resizeChatObject.elem.css({width:u>338?u:338,height:h>=n.resizeChatObject.elemMinSizeHeight?h:n.resizeChatObject.elemMinSizeHeight}),i.scroll()}})))):(t(window).on("scroll.ws-chat",(function(){parseInt(n.hide_zoom)&&(WBK.settings.chatInvitationOpened=!1,s.btn_el.hide()),wsUtil.setTimeout("scrollTimerChat",(function(){i.updateBtnPositionMobile()}),250)})),t(window).on("envy:resize",(function(){i.updateBtnPositionMobile(),n.containerSize!=s.window.height()&&i.updateOfflineBodySize()}))),s.window.find(".ws-file-upload").on("change",(function(e){e.preventDefault(),s.window.find(".ws-file-container").hide(),i.uploadFile(t(this).data("type"))})),s.window.find(".ws-offline-btn").on("click",(function(){i.sendOfflineMessage()})),s.window.find(".ws-preform-btn-cancel").on("click",(function(){i.hidePreform()})),t(document).on("click",".ws-preform-btn-save",(function(){n.auth_type="default",i.savePreform(t(this).data("type"),t(this).data("index"),t(this))})),t(document).on("click",".ws-chat-social-vk",(function(){var e=(screen.width-675)/2,t=(screen.height-380)/4;open(WBK.settings.serverUrl+"/chat/auth_vk/?origin="+window.location.origin,"publish","width=675,height=380, top="+t+", left="+e+",resizable=yes,scrollbars=yes,status=yes")})),t(document).on("click",".ws-chat-social-fb",(function(){var e=(screen.width-675)/2,t=(screen.height-380)/4;open(WBK.settings.serverUrl+"/chat/auth_fb/?origin="+window.location.origin,"publish","width=675,height=380, top="+t+", left="+e+",resizable=yes,scrollbars=yes,status=yes")})),t(window).on("message",(function(e){if(e=e.originalEvent.data)switch(e.type){case"vk_auth":i.vkAuth(e);break;case"fb_auth":i.fbAuth(e)}})),s.window.find(".ws-preform-input").bind("keypress",(function(e){13==(e.keyCode||e.which)&&(e.preventDefault(),i.savePreform(t(".ws-preform-btn-save").data("type"),t(this).data("index")))})),t.fn._frameCheck()||n.invitations&&Object.keys(n.invitations).length>0&&(_t=this,Object.keys(n.invitations).map((function(e,i){var a=n.invitations[e];try{t("body").on("click.invitations",'a[href="#autoinvitation-'+a.name.replace(/\s+/g,"-")+'"], a[href="'+window.top.location.origin+"#autoinvitation"+a.name.replace(/\s+/g,"-")+'"], a[href="'+window.top.location.origin+"/#autoinvitation"+a.name.replace(/\s+/g,"-")+'"]',(function(e){var i=t(e.currentTarget).attr("href").replace(new RegExp(window.top.location.origin+"|/|#autoinvitation|-+","g")," ").trim();return _t.showInvitationByName(i),e.preventDefault(),!1}))}catch(e){}}))),WBK.settings.phoneMasks){var e={inputmask:{definitions:{"#":{validator:"[0-9]",cardinality:1}},clearIncomplete:!1,showMaskOnHover:!1,autoUnmask:!0},match:/[0-9]/,replace:"#",list:t.masksSort(WBK.settings.phoneMasks,["#"],/[0-9]|#/,"mask"),listKey:"mask",onMaskChange:function(){t(this).attr("placeholder",t(this).inputmask("getemptymask"))}};i.optsRU=e,i.setPhoneMaskData(".ws-offline-phone"),i.setPhoneMaskData(".ws-preform-phone"),n.useTelephonyMask||i.initDialCodeSelectors(),e.inputmask.definitions.clearIncomplete=!0,t(".cbk-phone-checker").inputmasks(e)}},initDialCodeSelectors:function(){s.wsDCPI=wsUtil.getOrInitDialCodesPhoneInput(),s.wsDCPI.renderOnInput(".ws-offline-phone","offlinePhone",null,!0),s.wsDCPI.renderOnInput(".ws-preform-phone","preformPhone",null,!0)},getActualPhoneWithCountryCode:function(e,t){var i=s.wsDCPI.getSelectedCountryByInputKey(t);return i&&i.code&&(e="+"+i.code+e),e},setPhoneMaskData:function(e){n.useTelephonyMask?t(e).inputmasks(i.optsRU):t(e).attr("placeholder",n.lang_text.phone_input_placeholder_text)},deleteInputTextInLocalStorage:function(){wsUtil.deleteStorage("ws_chat_input_text_"+WBK.settings.chatWidgetId)},vkAuth:function(e){n.visitor_vk_id=e.user_id,e.access_token&&t.ajax({url:"https://api.vk.com/method/users.get?user_ids="+e.user_id+"&fields=photo_100&lang=ru&v=5.81&access_token="+e.access_token,type:"GET",dataType:"jsonp",crossDomain:!0,success:function(a){s.window.find(".ws-preform-name").val(a.response[0].first_name+" "+a.response[0].last_name),e.email&&s.window.find(".ws-preform-email").val(e.email),a.response[0].photo_100&&(n.logo_visitor=a.response[0].photo_100),n.auth_type="vk",i.savePreform(t(".ws-preform-btn-save").data("type"),t(".ws-preform-btn-save").data("index"),t(".ws-preform-btn-save"))}})},fbAuth:function(e){n.visitor_fb_token=e.access_token,t.ajax({url:"https://graph.facebook.com/me?fields=id,email,first_name,last_name,picture.width(100).height(100)&access_token="+e.access_token,type:"GET",dataType:"jsonp",crossDomain:!0,success:function(e){n.visitor_fb_id=e.id,s.window.find(".ws-preform-name").val(e.first_name+" "+e.last_name),e.email&&s.window.find(".ws-preform-email").val(e.email),e.picture.data.url&&(n.logo_visitor=e.picture.data.url),n.auth_type="fb",i.savePreform(t(".ws-preform-btn-save").data("type"),t(".ws-preform-btn-save").data("index"),t(".ws-preform-btn-save"))}})},updateUser:function(e){n.user_name=WBK.settings.visitorName?WBK.settings.visitorName:"",n.user_email=WBK.settings.visitorEmail?WBK.settings.visitorEmail:"",n.user_phone=WBK.settings.visitorPhone?WBK.settings.visitorPhone:"";var t="visitor";if(n.chatKey&&n.fireChat[t]){t=n.fireChat[t];var a={visitUrl:window.location.href};i.updateUserInBase(t,a)}else n.fireUsers[t]={};if(n.fireUsers[t].name=n.user_name,n.fireUsers[t].role="visitor",n.fireUsers[t].photo=n.logo_visitor||n.default_logo_visitor,e){var o=1e3;n.chat_created&&(o=0),wsUtil.setInterval("visitorIntroduction",(function(e){if(n.chat_created){wsUtil.deleteInterval("visitorIntroduction"),t=n.visitorKey||t,n.fireUsers[t].name=n.user_name,n.fireUsers[t].photo=n.logo_visitor||n.default_logo_visitor,s.window.find(".ws-chat-message-user").find(".ws-chat-message-name-text").text(n.user_name),s.window.find(".ws-chat-message-user").find(".ws-chat-message-logo-img").attr("src",n.fireUsers[t].photo);var a=n.visitor_vk_id?"vk":n.visitor_fb_id?"fb":"",o=n.visitor_vk_id||n.visitor_fb_id||"",r=i.getSocialParams(a,o);if(i.sendRobot({subType:"introduction",attributes:{email:n.user_email,name:n.user_name,phone:n.user_phone,url:r.url,icon:r.icon}}),n.user_name||n.fireUsers[t].photo){var l={};n.user_name&&(l.name=n.user_name),n.fireUsers[t].photo&&n.default_logo_visitor!=n.fireUsers[t].photo&&(l.photo=n.fireUsers[t].photo),n.user_email&&(l.hasEmail=!0),i.updateUserInBase(t,l),n.user_email&&(l.email=n.user_email),n.user_phone&&(l.phone=n.user_phone),i.updateVisitor(l)}}}),o)}},getSocialParams:function(e,t){var i={url:"",icon:""};switch(e){case"vk":i.url="http://vk.com/id"+t,i.icon="http://vk.com/images/safari_60.png";break;case"fb":i.url="http://facebook.com/"+t,i.icon="https://www.facebook.com/rsrc.php/yl/r/H3nktOa7ZMg.ico"}return i},operatorsIsOnline:function(){var e=!1;return n.operators_online_keys=[],n.operators_connect={},n.operators_connect_online_ids=[],n.all_operators&&t.each(n.all_operators,(function(t,i){i.apiId&&(n.operators_connect[WBK.settings.accountid+"_"+i.apiId]=t),n.all_operators[t].online&&"operator"===n.all_operators[t].role&&(n.operators_online_keys.push(t),n.operators_connect_online_ids.push(WBK.settings.accountid+"_"+i.apiId),e=!0)})),o&&i.log("Операторы онлайн: "+e),e},checkWorkDays:function(){var e=!1;if(!parseInt(n.workdays_active))return!0;var t=wsUtil.timezoneFormat(n.timezone),i=wsUtil.getTimeByServerTimezone(t),a=i.getDay();if(a=0==a?7:a,!parseInt(n["workdays_"+a]))return e;var s=n["workdays_"+a+"_time_start"].split(":"),o=n["workdays_"+a+"_time_end"].split(":"),r=new Date(i.getTime()).setHours(s[0],s[1]),l=new Date(i.getTime()).setHours(o[0],o[1]);return i>r&&i<l&&(e=!0),e},getStatusText:function(e){var t="";switch(e){case"sent":t=n.lang_text.is_send;break;case"delivered":t=n.lang_text.is_received;break;case"read":t=n.lang_text.is_read}return t},appendMessage:function(e,a){if(!n.fireMessages.hasOwnProperty(e.key)){e.key&&(n.fireMessages[e.key]=e),e=t.extend({},e);var o=n.fireUsers[e.sender];if("system"!=e.type||"robot"!=o.role){var r="",l=this.getStatusText(e.status),c="",d=i.dateFormat(e.sentAt);switch(e.type){case"crm":case"invitation":return!1;case"text":if(n.messages_quant_to_rate++,e.text=this.cleanTextToHtml(e.text),e.text=this.smileReplacer(e.text,"to_img"),"read"!==e.status&&e.buttons){var h="";for(btn in t(".ws-chat-quick-messages").removeClass("ws-hide"),e.buttons)h+='<div class="ws-chat-quick-message">'+e.buttons[btn].text+"</div>";h='<div class="ws-chat-quick-messages-group">'+h+"</div>",t(".ws-chat-quick-messages").html(h),this.startListenEventOnClickQuickMessages(),n.showed_quick_messages=!0,n.show_quick_message=!0}break;case"joined":case"left":var u=n.lang_text.join_chat;"left"==e.type&&(u=n.lang_text.disconnect_from_chat),d.date_line&&s.window.find(".ws-chat-typing").before('<div class="ws-chat-date-block">'+d.date_line+"</div>");var g='<div class="ws-chat-manager-join"><img src="'+o.photo+'" alt="" class="ws-manager-img"><div class="ws-manager-name">'+o.name+'</div><div class="ws-manager-position">'+(o.position||"")+'</div><div class="ws-manager-event">'+u+"</div></div>";return s.window.find(".ws-chat-typing").before(g),n.is_first_message&&(n.chat_distribution_department_enabled&&(n.chat_distribution_department_picked=i.getIdDepartmentByIdEmployee(n.fireUsers[o.key].apiId),s.container.find(".ws-chat-departments-block").addClass("ws-hide")),n.showed_quick_messages&&s.window.find(".ws-chat-quick-messages").hide(),n.invitation_show_data&&s.window.find(".ws-chat-message-manager").hide(),i.typingPositionUpdate()),!1;case"image":n.messages_quant_to_rate++,e.text='<a class="ws-chat-message-element"  href="'+e.url+'" target="_blank"><img class="ws-chat-message-img" src="'+e.preview+'"><div class="ws-foto-hover"></div><div class="ws-foto-hover-img"></div></a>';break;case"file":n.messages_quant_to_rate++;var p='<div class="ws-file-block"><div class="ws-file-el"><img class="ws-icon-file" src="'+e.icon+'"> </div><div class="ws-file-name">'+e.filename+'</div><div class="ws-file-size">'+this.getSize(e.size)+'</div></div><div class="ws-file-hover"></div>';e.text='<a class="ws-chat-message-element ws-chat-message-element-file" data-file-name="'+e.filename+'" data-file-name-upload="'+e.filename+'" href="'+e.url+'" target="_blank">'+p+"</a>";break;case"system":if("auto_reply"!=e.subType)return;if(e.hasOwnProperty("key")&&(WBK.settings.visitorName||WBK.settings.visitorPhone||WBK.settings.visitorEmail))return;if(e.text=wsUtil.specialChars(e.text),a&&a.auto_reply_get_contact){if(!parseInt(n.show_contact_form_inside_chat)){var w=n.autoreplies[a.auto_reply_index].text_btn?n.autoreplies[a.auto_reply_index].text_btn:n.lang_text.autoreply_link;e.text=e.text+'<br><div class="ws-chat-autoreply-link"><a data-index="'+a.auto_reply_index+'" class="ws-chat-autoreply-btn" href="javascript:void(0)">'+w+"</a></div>"}var f=new Date;f.setMinutes(f.getMinutes()+43200),wsUtil.setCookie("WidgetChat_autoreply_getcontact_"+WBK.settings.chatId,!0,f)}}var m=n.fireMessages.hasOwnProperty(e.key)&&n.fireMessages[e.key].hasOwnProperty("sentAt")?n.fireMessages[e.key].sentAt:Date.now(),v=(u='<div id="'+e.key+'" data-sent-at="'+m+'" class="ws-chat-message"><div class="ws-chat-message-source">'+e.text+'</div><div class="ws-chat-message-date">'+d.time+"</div></div>",s.window.find(".ws-chat-body-content").children(":not(.ws-chat-typing,.ws-chat-uploaded-files,.ws-chat-quick-messages)").last());(v.hasClass("ws-chat-robot-hello")||v.hasClass("ws-chat-manager-hello"))&&v.css("padding-bottom","10px");var _=v.data("role")==o.role;if("visitor"===o.role?(r="ws-chat-message-user",c='<div class="ws-chat-message-status">'+l+"</div>",o.name=o.name?o.name:n.lang_text.default_user):(r="ws-chat-message-manager",_=_&&v.data("user")==e.sender,n.last_operator_data={user_key:e.sender},n.send_autoreply=!0),!d.new_block&&v.hasClass(r)&&_){for(var b=v.find(".ws-chat-message").length;b>0;b--){var k=v.find(".ws-chat-message").eq(b-1),y=k.data();if(y.hasOwnProperty("sentAt")){if(!(e.key&&n.fireMessages[e.key]&&y.sentAt>n.fireMessages[e.key].sentAt)){k.after(u);break}if(1===b){k.before(u);break}}}v.find(".ws-chat-message-date").hide(),v.find(".ws-chat-message-date:last").show(),v.find(".ws-chat-message-status").text(l).addClass("ws-chat-message-status")}else{var x='<div class="ws-chat-message-block '+r+'" data-role="'+o.role+'" data-user="'+e.sender+'"><div class="ws-chat-message-logo"><img class="ws-chat-message-logo-img" src="'+o.photo+'"></div><div class="ws-chat-message-name"><span class="ws-chat-message-name-text">'+o.name+"</span></div>"+u+c+"</div>";s.window.find(".ws-chat-typing").before(x)}a&&a.hasOwnProperty("scroll")&&a.scroll&&i.scroll()}else this.addMessageRobot(e,a)}},getIdDepartmentByIdEmployee:function(e){var t=n.chat_department_distribution.filter((function(e){return-1!==Object.keys(e.employees).indexOf(this.toString())}),e);return t.length?t[0].id:null},getSize:function(e){return e<0?"":e/1024>1024?(e/1024/1024).toFixed(1)+" Mb":(e/1024).toFixed(1)+" Kb"},playSound:function(e){if("off"!=n.sound){var t="";switch(e){case"message":case"operator_join":t="chat1"}WBK.Sound(t)}},typing:function(e,t){null==t&&(t=5e3);var i=!!n.fireUsers.hasOwnProperty(e)&&n.fireUsers[e];if(i){var a=i.name?i.name:n.lang_text.operator;s.window.find(".ws-chat-typing").find(".ws-manager-name").text(a),this.typingPositionUpdate(),s.window.find(".ws-chat-typing").removeClass("ws-chat-typing-removing"),wsUtil.setTimeout("chatTypingActivateTimeout",(function(){s.window.find(".ws-chat-typing").addClass("ws-chat-typing-active")}),300);var o=t;wsUtil.setTimeout("chatTypingTimeout",(function(){s.window.find(".ws-chat-typing").removeClass("ws-chat-typing-active").addClass("ws-chat-typing-removing")}),o)}},calculationBodyHeight:function(e){return e?t(window).height()-t(".ws-chat-copyright").outerHeight()-t(".ws-chat-footer").outerHeight()-t(".ws-chat-header").outerHeight()-t(".ws-chat-quick-message").outerHeight():s.window.find(".ws-chat-body-content").height()},calculationMarginTop:function(e){var i=0,a=[];s.window.find(".ws-chat-quick-messages-group").children().each((function(e,n){var s=t(n).outerWidth(),o=parseInt(t(n).css("margin-right"));a.push({width:s,height:t(n).innerHeight(),margin_right:o}),i+=s>0?s+o:0})),a.length>0&&(i-=a[a.length-1].margin_right);var o=t(window).width()-parseInt(s.window.find(".ws-chat-body-content").css("padding-right"))+parseInt(s.window.find(".ws-chat-body-content").css("padding-left")),r=1;if(i>o&&(r+=1,a.length>2&&a[0].width+a[1].width>o&&a[1].width+a[2].width>o&&(r+=1)),n.invitation_show_data&&!n.chat_distribution_department_enabled||n.invitation_show_data&&n.chat_distribution_department_enabled&&!n.chat_distribution_department_picked)switch(r){case 1:return e;case 2:return n.invitation_show_data&&(e-=2*a[0].height),e;case 3:return e-3*a[0].height}else{if(n.invitation_show_data&&n.chat_distribution_department_picked||n.chat_distribution_department_enabled&&n.chat_distribution_department_picked)return a.length>0&&(e+=a[0].height),e;switch(r){case 1:return a.length>0&&n.invitation_show_data&&(e+=a[0].height),e;case 2:return e-a[0].height;case 3:return e-2*a[0].height}}},typingPositionUpdate:function(){var e=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!s.window.MSStream,a=i.calculationBodyHeight(e),o=0,r=s.window.find(".ws-chat-typing").outerHeight()+s.window.find(".ws-chat-uploaded-files").outerHeight();s.window.find(".ws-chat-body-content").children(":not(.ws-chat-typing,.ws-chat-uploaded-files)").each((function(e,i){if(o+=t(i).outerHeight(),a<o)return!1}));var l=a-o-6,c=0;l>r&&(c=l-r,n.quick_messages&&!n.sent_quick_messages&&e&&(c=i.calculationMarginTop(c))),s.window.find(".ws-chat-typing").css("marginTop",c)},operatorClosed:function(){s.window.removeClass("ws-chat-ico-bottom"),s.window.find(".ws-chat-ico-container").empty(),n.chat_created=!1},getTimeClosedChat:function(){return wsUtil.getStorage("ws_time_closed_chat")},updateTimeClosedChat:function(){wsUtil.setStorage("ws_time_closed_chat",(new Date).getTime())},onCloseChat:function(){i.operatorClosed(),i.stopAutoReply("all"),i.updateTimeClosedChat()},onOperatorPrinting:function(e){jWS.isEmptyObject(n.autoreplies)||i.stopAutoReply("all"),i.typing(e),jWS.isEmptyObject(n.autoreplies)||i.stopAutoReply("not_answer_operator")},onVisitorMessage:function(e){n.fireMessages.hasOwnProperty(e.key)||n.fireMessages.hasOwnProperty(e.localKey)||i.appendMessage(e,{scroll})},onOperatorMessage:function(e){if(!n.fireMessages.hasOwnProperty(e.key))if("joined"!=e.type)if("left"!=e.type){n.last_operator_data={user_key:e.sender},wsUtil.deleteTimeout("chatTypingTimeout"),s.window.find(".ws-chat-typing").removeClass("ws-chat-typing-active").addClass("ws-chat-typing-removing");var t=!1;WBK.settings.chatWindowOpened&&(t=!0),i.appendMessage(e,{scroll:t}),i.playSound("message"),n.unread_messages_count+=1,n.unread_messages.push(e.key),s.window.find(".ws-textarea").is(":focus")?i.messageReadVisitor():i.setUnreadMessages(n.unread_messages_count),WBK.settings.chatWindowOpened||WBK.settings.windowOpened||WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||WBK.settings.windowQuizOpened||"pc"!=WBK.settings.device||i.showWidget(),n.send_autoreply=!0,jWS.isEmptyObject(n.autoreplies)||i.stopAutoReply("not_answer_operator"),this.checkRatingSettings()}else this.operatorExit(e);else this.operatorJoin(e)},operatorJoin:function(e){n.last_operator_data={user_key:e.sender},jWS.isEmptyObject(n.autoreplies)||i.stopAutoReply("not_connected"),e.sender!=n.invitation_operator_key?(i.appendMessage(e),i.playSound("operator_join")):n.invitation_operator_key=!1,i.operatorsUpdate(),n.send_autoreply=!0,n.send_autoreply_first=!1,i.getAutoReply(),i.scroll(),i.sendGoal("operator_connect")},operatorExit:function(e){i.appendMessage(e),s.window.find(".ws-chat-typing").removeClass("ws-chat-typing-active").addClass("ws-chat-typing-removing"),i.operatorsUpdate(),i.scroll(),jWS.isEmptyObject(n.autoreplies)||i.stopAutoReply("all")},onUpdateRegistrationId:function(e){},setTemplate:function(){var e='<div class="ws-chat-btn-el-container envy-not-scalling"><div class="ws-chat-btn-container ws-chat-btn-mini-hover"><div class="ws-btn-badge"></div><div class="ws-btn-ico"><div class="ws-chat-logo"><i class="ws-icon-chat" style="color: '+n.color_background_button+'"></i><img src="'+n.chat_widget_logo+'" class="ws-chat-logo-img"><div class="ws-chat-status-round ws-chat-status-online"></div></div></div><div class="ws-btn-title"></div></div><div class="ws-chat-invitation-container"><div class="ws-chat-invitation-close"><i class="ws-icon-close"></i></div><div class="ws-chat-invitation-body"><div class="ws-chat-invitation-logo"></div><div class="ws-chat-invitation-body-el"><div class="ws-chat-invitation-body-text"></div></div></div><div class="ws-chat-invitation-form"><input type="text" class="ws-chat-invitation-input" placeholder="'+n.lang_text.form_message_placeholder+'"></div></div></div>';"pc"!=WBK.settings.device&&(e='<div class="ws-chat-btn-el-container envy-not-scalling"><div class="ws-chat-btn-container ws-chat-btn-mini-hover"><div class="ws-btn-badge"></div><div class="ws-btn-ico"><div class="ws-chat-logo"><i class="ws-icon-chat" style="color: '+n.mobile_color_background_button+'"></i><img src="'+n.chat_widget_logo+'" class="ws-chat-logo-img"><div class="ws-chat-status-round ws-chat-status-online"></div></div></div></div><div class="ws-chat-invitation-container"><div class="ws-chat-invitation-input">'+n.lang_text.form_message_placeholder+'</div><div class="ws-chat-invitation-close"><i class="ws-icon-close"></i></div><div class="ws-chat-invitation-body"><div class="ws-chat-invitation-logo"></div><div class="ws-chat-invitation-body-el"><div class="ws-chat-invitation-body-text"></div></div></div></div></div>'),n.text_button_online=this.safe_tags(n.text_button_online),a='<div class="ws-chat"><div class="ws-chat-container ws-chat-round"><div class="ws-chat-header" style="background: '+n.color_background_chat_header+'"><div class="ws-chat-logo"><i class="ws-icon-chat"></i><img src="'+n.chat_widget_logo+'" class="ws-chat-logo-img"><div class="ws-chat-status-round ws-chat-status-online"></div></div><div class="ws-chat-title" style="color: '+n.color_background_chat_header_text+'">'+n.text_button_online+'</div><a class="ws-chat-close" style="color: '+n.color_background_chat_header_text+'" href="javascript:void(0)" title="'+n.lang_text.close_title+'"><i class="ws-icon-close" style="color: '+n.color_background_chat_header_text+'"></i></a><a class="ws-chat-sound" style="color: '+n.color_background_chat_header_text+'" href="javascript:void(0)" title="'+n.lang_text.sound_off+'"><i class="ws-icon-sound-on" style="color: '+n.color_background_chat_header_text+'"></i></a></div><div class="ws-chat-body"><div class="ws-chat-rating">'+n.lang_text.rate_request+'<div class="ws-chat-rating-btns ws-chat-rating-btns-'+n.rate_chat_view+'"><a class="ws-chat-rating-el ws-chat-rating-el-1" href="javascript:void(0)" data-value="1" title="'+n.lang_text.rate_text_1+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a><a class="ws-chat-rating-el ws-chat-rating-el-2" href="javascript:void(0)" data-value="2" title="'+n.lang_text.rate_text_2+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a><a class="ws-chat-rating-el ws-chat-rating-el-3" href="javascript:void(0)" data-value="3" title="'+n.lang_text.rate_text_3+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a><a class="ws-chat-rating-el ws-chat-rating-el-4" href="javascript:void(0)" data-value="4" title="'+n.lang_text.rate_text_4+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a><a class="ws-chat-rating-el ws-chat-rating-el-5" href="javascript:void(0)" data-value="5" title="'+n.lang_text.rate_text_5+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a></div></div><div class="ws-chat-shadow"></div><div class="ws-chat-body-content"><div class="ws-chat-typing"><span class="ws-chat-typing-action"><i class="ws-icon-typing"></i></span><span class="ws-manager-name"></span> '+n.lang_text.typing+'...</div><div class="ws-chat-uploaded-files"></div><div class="ws-chat-quick-messages ws-hide"><div class="ws-chat-quick-messages-group"></div></div></div></div><div class="ws-chat-body-offline" style="display: none"><div class="ws-chat-offline-text">'+n.offline_text+'</div><div class="ws-chat-offline-text-success">'+n.lang_text.offline_text_success+'</div><div class="ws-offline-input-group '+("hide"==n.get_contact_offline_name?"ws-hide":"")+'"><div class="ws-offline-input-label">'+n.lang_text.form_name+'<span class="ws-input-required">'+("yes"==n.get_contact_offline_name?" *":"")+'</span></div><input type="text" class="ws-offline-input ws-offline-name" placeholder="'+n.lang_text.form_name_placeholder+'" value="'+n.user_name+'"></div><div class="ws-offline-input-group '+("hide"==n.get_contact_offline_phone?"ws-hide":"")+'"><div class="ws-offline-input-label">'+n.lang_text.form_phone+'<span class="ws-input-required">'+("yes"==n.get_contact_offline_phone?" *":"")+'</span></div><input type="tel" class="ws-offline-input ws-offline-phone" placeholder="'+n.lang_text.form_phone_placeholder+'" value="'+WBK.formatToPhone(n.user_phone)+'"></div><div class="ws-offline-input-group '+("hide"==n.get_contact_offline_email?"ws-hide":"")+'"><div class="ws-offline-input-label">'+n.lang_text.form_email+'<span class="ws-input-required">'+("yes"==n.get_contact_offline_email?" *":"")+'</span></div><input type="email" class="ws-offline-input ws-offline-email" placeholder="'+n.lang_text.form_email_placeholder+'" value="'+n.user_email+'"></div><div class="ws-offline-input-group'+(parseInt(n.email_distribution_agreement)?"":" ws-hide")+'"><label class="ws-offline-label-agreement"><input type="checkbox" class="ws-offline-email-agreement offline-email-distribution-agreement"><span class="ws-offline-email-agreement-text">'+n.email_text_distribution_agreement+'</span></label></div><div class="ws-offline-input-group"><div class="ws-offline-input-label">'+n.lang_text.form_message_placeholder+'<span class="ws-input-required">'+("yes"==n.get_contact_offline_message?" *":"")+'</span></div><div contenteditable="true" class="ws-offline-textarea"></div><div class="ws-offline-textarea-element"><a class="ws-offline-textarea-btn ws-btn-smile" href="javascript:void(0)"><i class="ws-icon-smile"></i></a><div class="ws-smile-container ws-smile-container-offline"></div></div></div><div class="ws-offline-input-group'+(parseInt(n.email_agreement)?"":" ws-hide")+'"><label class="ws-offline-label-agreement"><input type="checkbox" class="ws-offline-email-agreement" checked><span class="ws-offline-email-agreement-text">'+n.email_agreement_text+n.lang_text.email_agreement_text_agreement+'</span></label></div><div class="ws-offline-input-group ws-offline-input-group-btn"><a href="javascript:void(0)" class="ws-offline-btn">'+n.lang_text.offline_btn+'</a></div></div><div class="ws-chat-body-preform" style="display: none"><div class="ws-chat-preform-text"></div><div class="ws-chat-preform-social"><a href="javascript:void(0)" class="ws-chat-social-el ws-chat-social-vk"><span class="ws-chat-social-img ws-sprite-social-vk"></span></a></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="text" class="ws-preform-input ws-preform-name" placeholder="'+n.lang_text.form_name_placeholder+'" value="'+n.user_name+'"></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="tel" class="ws-preform-input ws-preform-phone" placeholder="'+n.lang_text.form_phone_placeholder+'" value="'+WBK.formatToPhone(n.user_phone)+'"><input type="text" class="cbk-phone-checker white-saas-generator-input-hidden"/></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="email" class="ws-preform-input ws-preform-email" placeholder="'+n.lang_text.form_email_placeholder+'" value="'+n.user_email+'"></div><div class="ws-preform-input-group ws-preform-input-group-text"><div class="ws-preform-input-label ws-preform-email-text">'+n.lang_text.email_exit+'</div></div><div class="ws-preform-input-group'+(parseInt(n.email_distribution_agreement)?"":" ws-hide")+'"><label class="ws-preform-label-agreement"><input type="checkbox" class="ws-preform-email-distribution-agreement preform-email-distribution-agreement"><span class="ws-preform-email-distribution-agreement-text">'+n.email_text_distribution_agreement+'</span></label></div><div class="ws-preform-input-group ws-preform-input-group-text"><label class="ws-preform-label-agreement"><span class="ws-preform-email-agreement-text">'+n.email_agreement_text+n.lang_text.email_agreement_text_agreement+'</span></label></div><div class="ws-preform-input-group ws-preform-input-group-btn"><a href="javascript:void(0)" class="ws-preform-btn-cancel">'+n.lang_text.offline_btn_cancel+'</a><a href="javascript:void(0)" class="ws-preform-btn ws-preform-btn-save">'+n.lang_text.preform_btn+'</a></div></div><div class="ws-chat-footer"><div class="ws-textarea-element"><a class="ws-textarea-btn ws-btn-file" href="javascript:void(0)"><i class="ws-icon-file"></i></a><a class="ws-textarea-btn ws-btn-smile" href="javascript:void(0)"><i class="ws-icon-smile"></i></a><div class="ws-smile-container"></div><div class="ws-file-container"><div class="ws-file-element ws-file-doc"><i class="ws-icon-document"></i>'+n.lang_text.file+'<input type="file" class="ws-file-upload ws-file-doc-upload" title="'+n.lang_text.not_selected_file_text+'" name="ws-doc" data-type="doc" accept="'+n.allow_mime_file+'"></div><div class="ws-file-element ws-file-foto"><i class="ws-icon-image"></i>'+n.lang_text.image+'<input type="file" class="ws-file-upload ws-file-img-upload" title="'+n.lang_text.not_selected_file_text+'" name="ws-img" data-type="img" accept="'+n.allow_mime_img+'"></div></div></div><div class="ws-textarea-group"><div contenteditable="true" class="ws-textarea"></div><div class="ws-textarea-send-btn"  title="'+n.lang_text.send_btn_title+'"><i class="ws-icon-enter"></i></div><div class="ws-textarea-placeholder">'+n.lang_text.textarea_placeholder+'</div></div></div><div class="ws-chat-copyright"><a href="'+n.partnerLink+'" class="ws-chat-copyright-url" target="_blank" data-widget="chat">'+n.lang_text.text_link+'</a></div><div class="ws-chat-resize" style="color: '+n.color_background_chat_header+'"><i class="ws-icon-resize"></i></div><div class="ws-chat-ico-container"></div></div>'+e+"</div>"},setSettings:function(e){var i={printingData:{type:"text",message:""},firebase:!1,fireDB:!1,firebaseNodeUrl:"",FirebaseApiKey:"",FirebaseAuthDomain:"",FirebaseDatabaseURL:"",FirebaseServiceRef:"",socketStarted:!1,v2_local:!1,chatKey:!1,chatKeyVisitor:!1,processVisitor:!1,fireChat:!1,fireUsersOnlineKeys:{},fireUsers:{},fireUserKeys:[],fireOldMessages:{},fireMessages:{},fireSender:"visitor",fireRobot:{},visitorKey:!1,fireOperatorPrinting:{},dragChatObject:{},resizeChatObject:{},chat_created:!1,chat_old_time:!1,chat_timezone:3,unread_messages:[],unread_messages_count:0,document_title:document.title,document_favicon_href:t('link[rel="shortcut icon"]').length?t('link[rel="shortcut icon"]').attr("href"):t('link[rel="icon"]').attr("href"),new_favicon_href:"",input_scroll:!1,auth_type:"default",default_logo_visitor:WBK.settings.staticServerUrl+"/widget/img/user.png",agreementLink:"https://whitesaas.com/agreement/",logo_visitor:!1,is_first_message:!1,first_message:!1,bottom_body:62,height_input:56,allow_mime_file:".pdf,.txt,.doc,.docx,.xls,.xlsm,.rar,.zip",allow_mime_img:"image/png,image/jpg,image/jpeg,image/gif",invitation_show_data:!1,invitation_operator_id:!1,last_operator_data:!1,send_autoreply:!1,send_autoreply_first:!1,show_one_invitation:!1,show_quick_message:!1,showed_quick_messages:!1,sent_quick_messages:!1,on_event:{emodji:!1},fileUploaded:{},fileUploadedCount:0,chatCreating:!1,scallingMobile:!1,offline_message_sending:!1,scroll_left:0,scroll_top:0,containerSize:0,show_contact_form_inside_chat:0,use_telephony_mask:1,autoCall:0,autoCallText:"0",autoCallDeffered:0,autoCallDefferedDelay:0,disableMobileOpenHash:0,smilesCodes:{"1f601":"😁","1f602":"😂","1f603":"😃","1f604":"😄","1f605":"😅","1f606":"😆","1f609":"😉","1f60a":"😊","1f60b":"😋","1f60c":"😌","1f60d":"😍","1f60f":"😏","1f612":"😒","1f613":"😓","1f614":"😔","1f616":"😖","1f618":"😘","1f61a":"😚","1f61c":"😜","1f61d":"😝","1f61e":"😞","1f620":"😠","1f621":"😡","1f622":"😢","1f623":"😣","1f624":"😤","1f625":"😥","1f628":"😨","1f629":"😩","1f62a":"😪","1f62b":"😫","1f62d":"😭","1f630":"😰","1f91d":"🤝","1f60e":"😎","1f44c":"👌","1f446":"👆","1f44d":"👍","1f44e":"👎","1f4aa":"💪","1f607":"😇","1f525":"🔥",2705:"✅"},chat_distribution_department_enabled:!1,chat_distribution_department_picked:null,chat_department_picked:!1,need_send_pick_department:!1,preform_request_data:{request:{},context:null},messages_for_send_by_timer:[],last_message_id:null,visitor_auto_invite:!1};t.extend(!0,n,i),t.extend(!0,n,e)},log:function(e){wsUtil.log("CHAT : "+e,"background: #00a4b4; color: #ffffff")},safe_tags:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},autoSendMessage:function(e){var a="";!(a=e?t(e).data("message"):t('[href="#showchat"]').data("message"))||n.chat_created||n.chatCreating||i.send({text:a,type:"text"},{scroll:!0})},hasVisitorData:function(){return!!(parseInt(n.chat_introduced)||WBK.settings.visitorName||WBK.settings.visitorPhone||WBK.settings.visitorEmail)},sendPickDepartmentMessage:function(){i.addMessageRobot({subType:"pick_department"}),i.changeStateInput(!0,n.lang_text.block_input_for_pick_department)},setDepartment:function(e,t){n.chat_distribution_department_picked=e,i.showHelloMessageOperatorsFromDepartments(),i.typingPositionUpdate(),i.changeStateInput(!1,""),s.window.find(".ws-chat-message-robot-pick-department").hide(),i.addMessageRobot({subType:"text",text:n.lang_text.picked_department_text+" "+t}),n.first_message&&(i.sendFire(n.first_message),n.first_message=!1,wsUtil.deleteCookie("WidgetChat_first_message_"+WBK.settings.chatWidgetId)),i.sendSystem({subType:"text",text:n.lang_text.picked_department_text+" "+t}),Object.keys(n.preform_request_data.request).length&&i.sendPreformRequest(n.preform_request_data.request,n.preform_request_data.context)},changeStateInput:function(e,t){s.window.find(".ws-textarea").attr("contenteditable",!e).html(t),e?(s.window.find(".ws-textarea-group").addClass("ws-textarea-group-hide"),s.window.find(".ws-textarea-element").hide(),s.window.find(".ws-textarea-group .ws-textarea-placeholder").hide()):(s.window.find(".ws-textarea-group").removeClass("ws-textarea-group-hide"),s.window.find(".ws-textarea-element").show(),t||s.window.find(".ws-textarea-group .ws-textarea-placeholder").show())},makeOpacityColor:function(e,t){if("rgba"===e.substr(0,4)){var i=parseInt(e.substr(e.length-2,e.length-1))/t;return e.substr(0,e.length-2)+i+")"}return e},recalculateWidthButton:function(){if(-1!==["vertical_left","vertical_right"].indexOf(n.button_location)){var e=s.btn_el.width();e%2==1&&e++,s.btn_el.width(e)}},updateVisitorAutoInvite:function(){n.visitor_auto_invite||i.updateVisitor({autoInvite:!0})}})},773:()=>{var e,t,i,n,a,s;wsGenerator=(e=jWS,{settings:{},templates:{},widget:{},init:function(o){t=this,i=this.settings,n=this.templates,a=this.widget,s=WBK.checkDebug(),e.fn._frameCheck()&&"undefined"==typeof WBK&&(WBK=document.WBK),t.loader(o)},loader:function(e){var n=e.Data.generator;"tablet"===WBK.settings.device&&parseInt(n.hide_tablet)?s&&t.log("Виджет скрыт на планшетах"):"mobile"===WBK.settings.device&&parseInt(n.hide_generator_mobile)?s&&t.log("Виджет скрыт на телефонах"):(t.setDefaultSettings(),WBK.settings.generatorId=e.Settings.generatorId,i.langText=n.lang_text,null!=n.text_general&&(i.langText.text_general=wsUtil.decorateText(n.text_general)),null!=n.text_sub&&(i.langText.text_sub=wsUtil.decorateText(n.text_sub)),null!=n.text_success&&(i.langText.text_success=wsUtil.decorateText(n.text_success),i.successTextWithTags=n.text_success),null!=n.text_counter_title&&(i.langText.text_counter_title=wsUtil.decorateText(n.text_counter_title)),null!=n.btn_success_text&&(i.langText.btn_success_text=n.btn_success_text),null!=n.btn_cancel_text&&(i.langText.btn_cancel_text=n.btn_cancel_text),null!=n.email_agreement_text&&(i.langText.email_agreement_text=n.email_agreement_text),n.show_close_button&&(i.show_close_button=n.show_close_button),n.text_general_color_background&&(i.textGeneralColorBackground=n.text_general_color_background),n.right_block_color&&(i.colorBackgroundRight=n.right_block_color),n.text_general_color_text&&(i.textGeneralColorText=n.text_general_color_text),n.btn_success_color&&(i.btnSuccessColor=n.btn_success_color),n.btn_cancel_color&&(i.btnCancelColor=n.btn_cancel_color),n.counter_time&&(i.counterTime=n.counter_time),n.date_end&&(i.dateEnd=n.date_end),n.date_end_time&&(i.dateEndTime=n.date_end_time),n.date_end_weekday&&(i.dateEndWeekday=parseInt(n.date_end_weekday)),n.date_hours&&(i.dateHours=n.date_hours),n.each_day_to_time&&(i.each_day_to_time=n.each_day_to_time),n.date_hours_type&&(i.dateHoursType=n.date_hours_type),n.get_email&&(i.getEmail=n.get_email),n.get_name&&(i.getName=n.get_name),n.get_phone&&(i.getPhone=n.get_phone),n.img_background&&(i.imgBackground=parseInt(n.img_background)),n.img_background_service&&(i.imgBackgroundService=parseInt(n.img_background_service)),n.logo_file_extension&&(i.logo_file_extension=n.logo_file_extension),n.logo_file_extension_mobile&&(i.logo_file_extension_mobile=n.logo_file_extension_mobile),n.paused_seconds&&(i.pausedSeconds=n.paused_seconds),n.repeat_show_time&&(i.repeatShowTime=n.repeat_show_time),n.repeat_show_type&&(i.repeatShowType=n.repeat_show_type),n.show_enter&&(i.showEnter=n.show_enter),n.paused_sec_target&&(i.paused_sec_target=n.paused_sec_target),n.show_scroll_value&&(i.showScrollValue=parseInt(n.show_scroll_value)),n.show_behavioral_value&&(i.showBehavioralValue=parseInt(n.show_behavioral_value)),n.send_action&&(i.sendAction=n.send_action),n.page_open_type&&(i.pageOpenType=n.page_open_type),n.send_action_url&&(i.sendActionUrl=n.send_action_url),"none"!=n.send_action&&"new_page"==n.page_open_type&&n.send_action_url&&(wsUtil.parseURL(n.send_action_url).scheme||(n.send_action_url="http://"+n.send_action_url),i.actionUrlLinkHrefText='href="'+n.send_action_url+'" target = "_blank"'),n.show_exit&&(i.showExit=n.show_exit),n.timer_enable&&(i.timerEnable=parseInt(n.timer_enable)),n.auto_call&&(i.autoCall=parseInt(n.auto_call)),n.auto_call_text&&(i.autoCallText=n.auto_call_text),n.auto_call_deffered&&(i.autoCallDeffered=parseInt(n.auto_call_deffered)),n.auto_call_deffered_delay&&(i.autoCallDefferedDelay=parseInt(n.auto_call_deffered_delay)),n.ispayed&&(i.isPayed=n.ispayed),n.hasMoneyForLead&&(i.hasMoneyForLead=n.hasMoneyForLead),n.isPayedGenerator&&(i.isPayedGenerator=n.isPayedGenerator),n.close_click_bgr&&(i.closeClickBgr=parseInt(n.close_click_bgr)),n.counter_bgr_color&&(i.counterBgrColor=n.counter_bgr_color),n.counter_number_color&&(i.counterNumberColor=n.counter_number_color),n.container_shadow&&(i.containerShadow=n.container_shadow),e.Settings.serviceDomain&&(i.partnerLink="http://"+WBK.settings.servicedomain+"?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=generator&utm_term="),n.partnerLink&&(i.partnerLink=n.partnerLink),n.format_general_text&&(i.textGeneralFormat=n.format_general_text),n.position_gorizontal_general_text&&(i.textGeneralPositionGorizontal=n.position_gorizontal_general_text),n.position_vertical_general_text&&(i.textGeneralPositionVertical=n.position_vertical_general_text),n.font_family_general_text&&(i.textGeneralFontFamily=n.font_family_general_text),n.font_size_general_text&&(i.textGeneralFontSize=parseInt(n.font_size_general_text)),n.email_service&&(i.emailService=n.email_service),n.email_agreement&&(i.emailAgreement=parseInt(n.email_agreement)),n.agreementLink&&(i.agreementLink=n.agreementLink),n.no_show_timeout&&(i.noShowTimeout=parseInt(n.no_show_timeout)),n.hide_background_site&&(i.hideBackgroundSite=parseInt(n.hide_background_site)),n.site_bgr_color&&(i.siteBgrColor=n.site_bgr_color),n.video_repeat&&(i.repeat_video=parseInt(n.video_repeat)),n.video_voice&&(i.voice_video=parseInt(n.video_voice)),n.video_code&&(i.code_video=t.getGeneratorVideoIframeSrc(n.video_code)),n.video_position&&(i.video_position=n.video_position),n.text_line_height&&(i.textLineHeight=n.text_line_height),null!=n.position_gorizontal_general_text_mobile&&(i.textGeneralPositionGorizontalMobile=n.position_gorizontal_general_text_mobile),null!=n.position_vertical_general_text_mobile&&(i.textGeneralPositionVerticalMobile=n.position_vertical_general_text_mobile),null!=n.format_general_text_mobile&&(i.formatTextMobile=n.format_general_text_mobile),null!=n.text_general_color_background_mobile&&(i.textGeneralColorBackgroundMobile=n.text_general_color_background_mobile),null!=n.text_general_color_text_mobile&&(i.textGeneralColorTextMobile=n.text_general_color_text_mobile),null!=n.text_sub_color_text_mobile&&(i.textSubColorTextMobile=n.text_sub_color_text_mobile),null!=n.generator_next_block_content_bg&&(i.generatorNextBlockContentBg=n.generator_next_block_content_bg),null!=n.generator_cross_content_color&&(i.generatorCrossContentColor=n.generator_cross_content_color),null!=n.timer_enable_mobile&&(i.timerEnableMobile=parseInt(n.timer_enable_mobile)),null!=n.counter_bgr_color_mobile&&(i.counterBgrColorMobile=n.counter_bgr_color_mobile),null!=n.counter_number_color_mobile&&(i.counterNumberColorMobile=n.counter_number_color_mobile),null!=n.counter_time_mobile&&(i.counterTimeMobile=n.counter_time_mobile),null!=n.date_hours_mobile&&(i.dateHoursMobile=n.date_hours_mobile),null!=n.date_hours_type_mobile&&(i.dateHoursTypeMobile=n.date_hours_type_mobile),null!=n.date_end_weekday_mobile&&(i.dateEndWeekdayMobile=n.date_end_weekday_mobile),null!=n.each_day_to_time_mobile&&(i.eachDayToTimeMobile=n.each_day_to_time_mobile),null!=n.each_day_to_time_mobile&&(i.eachDayToTimeMobile=n.each_day_to_time_mobile),null!=n.no_show_timeout_mobile&&(i.noShowTimeoutMobile=parseInt(n.no_show_timeout_mobile)),null!=n.btn_success_color_mobile&&(i.btnSuccessColorMobile=n.btn_success_color_mobile),null!=n.email_agreement_mobile&&(i.emailAgreementMobile=n.email_agreement_mobile),null!=n.email_agreement_text_mobile&&(i.langText.emailAgreementTextMobile=n.email_agreement_text_mobile),null!=n.text_general_mobile&&(i.langText.textGeneralMobile=wsUtil.decorateText(n.text_general_mobile)),null!=n.text_sub_mobile&&(i.langText.textSubMobile=wsUtil.decorateText(n.text_sub_mobile)),null!=n.text_success_mobile&&(i.langText.textSuccessMobile=wsUtil.decorateText(n.text_success_mobile),i.text_success_mobile=n.text_success_mobile),null!=n.text_counter_title_mobile&&(i.langText.textCounterTitleMobile=wsUtil.decorateText(n.text_counter_title_mobile)),null!=n.img_background_mobile&&(i.imgBackgroundMobile=parseInt(n.img_background_mobile)),null!=n.img_background_service_mobile&&(i.imgBackgroundServiceMobile=n.img_background_service_mobile),null!=n.btn_success_text_mobile&&(i.langText.btnSuccessTextMobile=n.btn_success_text_mobile),null!=n.date_end_mobile&&(i.dateEndMobile=n.date_end_mobile),null!=n.date_end_time_mobile&&(i.dateEndTimeMobile=n.date_end_time_mobile),n.get_mobile_email&&(i.getMobileEmail=n.get_mobile_email),n.get_mobile_phone&&(i.getMobilePhone=n.get_mobile_phone),n.get_mobile_name&&(i.getMobileName=n.get_mobile_name),n.use_telephone_mask&&(i.useTelephoneMask=+n.use_telephone_mask),n.use_telephone_mask_mobile&&(i.useTelephoneMaskMobile=+n.use_telephone_mask_mobile),n.font_family_general_text_mobile&&(i.textGeneralFontFamilyMobile=n.font_family_general_text_mobile),n.font_size_general_text_mobile&&(i.textGeneralFontSizeMobile=parseInt(n.font_size_general_text_mobile)),n.text_line_height_mobile&&(i.textLineHeightMobile=n.text_line_height_mobile),i.calculateHeight=!0,WBK.loadFont(),t.setTemplate(),t.start())},start:function(){var t=this;if(a.window=e(n.window).hide().appendTo("body"),a.windowbgr=e(n.windowBgr).hide().click((function(e){return i.closeClickBgr&&t.closeWidget(),e.preventDefault(),!1})).appendTo("body"),2==i.hideBackgroundSite&&a.windowbgr.addClass("cbk-window-bgr-transparent"),e(".white-saas-generator-copyright-url, .white-saas-mobile-generator-copyright-url").attr("href",i.partnerLink),WBK.settings.visitorPhone&&e(".white-saas-generator-userphone, .white-saas-mobile-generator-userphone").val(WBK.settings.visitorPhone),WBK.settings.visitorEmail&&e(".white-saas-generator-useremail, .white-saas-generator-useremail").val(WBK.settings.visitorEmail),WBK.settings.visitorName&&e(".white-saas-generator-username").val(WBK.settings.visitorName),WBK.settings.hideCopyright?e(".white-saas-generator-copyright-url, .white-saas-mobile-generator-copyright").remove():e("body").on("click",".white-saas-generator-copyright-url, .white-saas-mobile-generator-copyright-url",(function(t){WBK.sendAdvertLinkStat(e(this).data("widget"),e(this).attr("href"),e(this).text(),WBK.settings.generatorId)})),i.langText.text_general||a.window.find(".white-saas-generator-text-general-span").hide(),i.langText.textGeneralMobile||a.window.find(".white-saas-mobile-generator-image-container").hide(),a.window.find(".white-saas-generator-text-general-span").html(i.langText.text_general),a.window.find(".white-saas-mobile-generator-text-general-span").html(i.langText.textGeneralMobile),parseInt(i.timerEnable)||a.window.find(".white-saas-generator-text-sub").css("max-height","185px"),a.window.find(".white-saas-generator-text-sub").html(i.langText.text_sub),i.emailAgreement||a.window.find(".white-saas-generator-label-agreement").hide(),a.window.find(".white-saas-generator-agreement-link").attr("href",i.agreementLink),i.imgBackgroundService){var s=new Date;a.window.find(".white-saas-generator-image").attr("src",WBK.settings.staticServerUrl+"/uploaded/callback_generators/"+WBK.settings.serviceid+"/logo.png?"+s.getTime())}if(i.isPayed){if(i.code_video&&(a.window.find(".white-saas-generator-container").addClass("generator-video"),t.playerLoad()),a.window.find(".white-saas-generator-btn-success").text(i.langText.btn_success_text),a.window.find(".white-saas-generator-btn-cancel").text(i.langText.btn_cancel_text),i.siteBgrColor&&a.windowbgr.css("background-color",i.siteBgrColor),i.imgBackground&&(s=new Date,a.window.find(".white-saas-generator-image").attr("src",WBK.settings.staticServerUrl+"/uploaded/generators/"+WBK.settings.generatorId+"/logo.png"+i.logo_file_extension+"?"+s.getTime())),i.imgBackgroundMobile&&(s=new Date,a.window.find(".white-saas-mobile-generator-image").attr("src",WBK.settings.staticServerUrl+"/uploaded/generators/"+WBK.settings.generatorId+"/logo_mobile.png"+i.logo_file_extension_mobile+"?"+s.getTime())),i.textGeneralColorBackground&&a.window.find(".white-saas-generator-text-general-span").css("background-color",i.textGeneralColorBackground),i.colorBackgroundRight&&a.window.find(".white-saas-generator-right-block").css("background-color",i.colorBackgroundRight),i.textGeneralColorText&&a.window.find(".white-saas-generator-text-general-span").css("color",i.textGeneralColorText),i.btnSuccessColor&&(a.window.find(".white-saas-generator-btn-success").css("background-color",i.btnSuccessColor),a.window.find(".white-saas-generator-btn-yes").css("background-color",i.btnSuccessColor)),i.btnCancelColor&&a.window.find(".white-saas-generator-btn-cancel").css("background-color",i.btnCancelColor),i.counterBgrColor&&a.window.find(".white-saas-generator-counter-block, .white-saas-generator-counter-dz-block").css("background-color",i.counterBgrColor),i.counterNumberColor&&a.window.find(".white-saas-generator-counter-number").css("color",i.counterNumberColor),i.containerShadow)switch(i.containerShadow){case"none":a.window.css("box-shadow","none");break;case"easy":a.window.css("box-shadow","0 21px 32px 0 rgba(0, 0, 0, 0.15)");break;case"heavy":a.window.css("box-shadow","0 21px 32px 0 rgba(0, 0, 0, 0.45)")}i.textGeneralFormat&&a.window.find(".white-saas-generator-text-general").css("text-align",i.textGeneralFormat),i.textGeneralPositionGorizontal&&a.window.find(".white-saas-generator-text-general").css("left",i.textGeneralPositionGorizontal+"px"),i.textGeneralPositionVertical&&a.window.find(".white-saas-generator-text-general").css("top",i.textGeneralPositionVertical+"px"),i.textGeneralFontFamily&&WBK.addStyles(".white-saas-generator-text-general-span {font-family: "+i.textGeneralFontFamily+"!important;}"),i.textGeneralFontSize&&a.window.find(".white-saas-generator-text-general-span").css("font-size",i.textGeneralFontSize+"px"),i.textLineHeight&&a.window.find(".white-saas-generator-text-general-span").css("line-height",i.textLineHeight),0==i.timerEnable&&a.window.find(".white-saas-generator-counter").hide(),"hide"==i.getName&&a.window.find(".white-saas-generator-username").hide(),"hide"==i.getPhone&&a.window.find(".white-saas-generator-userphone").hide(),"hide"==i.getEmail&&a.window.find(".white-saas-generator-useremail").hide(),"hide"==i.getMobilePhone&&a.window.find(".white-saas-mobile-generator-userphone").hide(),"hide"==i.getMobileName&&a.window.find(".white-saas-mobile-generator-username").hide(),"hide"==i.getMobileEmail&&a.window.find(".white-saas-mobile-generator-useremail").hide(),0==i.show_close_button&&a.window.find(".white-saas-generator-close-button").hide(),i.textGeneralFontFamilyMobile&&a.window.find(".white-saas-mobile-generator-text-general-span").css("font-family",i.textGeneralFontFamilyMobile),i.textGeneralFontSizeMobile&&a.window.find(".white-saas-mobile-generator-text-general-span").css("font-size",i.textGeneralFontSizeMobile),i.textLineHeightMobile&&a.window.find(".white-saas-mobile-generator-text-general-span").css("line-height",i.textLineHeightMobile),i.formatTextMobile&&a.window.find(".white-saas-mobile-generator-text-general").css("text-align",i.formatTextMobile),i.textGeneralPositionGorizontalMobile&&a.window.find(".white-saas-mobile-generator-text-general").css("left",i.textGeneralPositionGorizontalMobile+"%"),i.textGeneralPositionVerticalMobile&&a.window.find(".white-saas-mobile-generator-text-general").css("top",i.textGeneralPositionVerticalMobile+"%"),i.textGeneralColorBackgroundMobile&&a.window.find(".white-saas-mobile-generator-text-general-span").css("background",i.textGeneralColorBackgroundMobile),i.textGeneralColorTextMobile&&a.window.find(".white-saas-mobile-generator-text-general-span").css("color",i.textGeneralColorTextMobile),i.generatorNextBlockContentBg&&a.window.find(".white-saas-mobile-generator-next-block, .white-saas-mobile-generator-bg-image, .white-saas-mobile-generator-success-block").css("background",i.generatorNextBlockContentBg),i.counterBgrColorMobile&&(a.window.find(".white-saas-mobile-generator-block-hours, .white-saas-mobile-generator-block-min, .white-saas-mobile-generator-block-seconds").css("background",i.counterBgrColorMobile),a.window.find(".white-saas-mobile-generator-block-colon span").css("color",i.counterBgrColorMobile)),i.counterBgrColorMobile&&a.window.find(".white-saas-mobile-generator-counter-dig-text").css("color",i.counterNumberColorMobile),i.textSubColorTextMobile&&a.window.find(".white-saas-mobile-generator-text-sub, .white-saas-mobile-generator-counter-text, .white-saas-mobile-generator-email-agreement-text, .white-saas-mobile-generator-text-success").css("color",i.textSubColorTextMobile),i.langText.emailAgreementTextMobile&&parseInt(i.emailAgreementMobile)||a.window.find(".white-saas-mobile-generator-label-agreement").hide(),0==i.timerEnableMobile&&a.window.find(".white-saas-mobile-generator-counter-clock").hide(),i.btnSuccessColorMobile&&a.window.find(".white-saas-mobile-generator-btn-success").css("background",i.btnSuccessColorMobile),i.generatorCrossContentColor&&a.window.find(".white-saas-mobile-generator-close-button").css("color",i.generatorCrossContentColor)}else i.getPhone="yes",a.window.find(".white-saas-generator-username").hide(),i.getName="hide",a.window.find(".white-saas-generator-useremail").hide(),i.getEmail="hide";if(a.window.find(".white-saas-generator-btn-cancel, .white-saas-generator-close-button, .white-saas-mobile-generator-close-button").click((function(e){return e.preventDefault(),t.closeWidget(),!1})),WBK.settings.phoneMasks){var o={inputmask:{definitions:{"#":{validator:"[0-9]",cardinality:1}},clearIncomplete:!1,showMaskOnHover:!1,autoUnmask:!0},match:/[0-9]/,replace:"#",list:e.masksSort(WBK.settings.phoneMasks,["#"],/[0-9]|#/,"mask"),listKey:"mask",onMaskChange:function(){e(this).attr("placeholder",e(this).inputmask("getemptymask"))}};i.useTelephoneMask&&e(".white-saas-generator-userphone").inputmasks(o),i.useTelephoneMaskMobile&&e(".white-saas-mobile-generator-userphone").inputmasks(o),o.inputmask.definitions.clearIncomplete=!0,e(".cbk-phone-checker").inputmasks(o)}i.useTelephoneMask||(e(".white-saas-generator-userphone").attr("placeholder",i.langText.text_placeholder_userphone),WBK.initOnlyDigitsEvent(".white-saas-generator-userphone")),i.useTelephoneMaskMobile||(e(".white-saas-mobile-generator-userphone").attr("placeholder",i.langText.text_placeholder_userphone),WBK.initOnlyDigitsEvent(".white-saas-mobile-generator-userphone")),a.window.find(".white-saas-generator-btn-success, .white-saas-mobile-generator-btn-success").on("click",(function(e){"new_page"==i.pageOpenType&&i.sendActionUrl||e.preventDefault(),t.sendLead(e)})),a.window.find(".white-saas-generator-btn-yes").on("click",(function(e){e.preventDefault(),t.hideWidget()}));var r=1;"paused"==i.showEnter&&i.pausedSeconds!=r&&(r=i.pausedSeconds),i.timerEnable&&"mobile"!==WBK.settings.device&&wsUtil.setTimeout("WidgetGeneratorInitTimer",(function(){t.initCountDown()}),1e3*r),i.timerEnableMobile&&"mobile"===WBK.settings.device&&wsUtil.setTimeout("WidgetGeneratorInitTimer",(function(){t.initCountDownMobile()}),1e3*r),t.initTimer(),"#showgenerator"===window.top.location.hash&&(i.noShowTimeout?(i.noShow=1,t.hideWidget()):t.showWidget("url")),e.fn._frameCheck()&&"undefined"==typeof WBK||e("body").on("click",'a[href="#showgenerator"], a[href="'+window.top.location.origin+'#showgenerator"], a[href="'+window.top.location.origin+'/#showgenerator"]',(function(e){return t.showWidget("url"),e.preventDefault(),!1})),parseInt(i.showExit)&&e("body").mouseleave((function(n){if(n.pageX,n.pageY-e(document).scrollTop()<=10&&!(i.noShow||WBK.settings.windowOpened||WBK.settings.chatWindowOpened||WBK.settings.windowLoanerOpened||WBK.settings.windowQuizOpened||WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||wsUtil.getCookie("WhiteGenerator_closed_"+WBK.settings.generatorId)||wsUtil.getCookie("WhiteGenerator_success_closed_"+WBK.settings.generatorId)||WBK.settings.called)&&parseInt(wsUtil.getCookie("WhiteCallback_timePage"))>8){WBK.settings.windowInvaderOpened&&(wsInvader.widget.window.find(".cbk-support-new-message-copyright").hide(),wsInvader.widget.window.hide());var a=new Date;a.setMinutes(a.getMinutes()+144e3),wsUtil.setCookie("WhiteGenerator_show_"+WBK.settings.generatorId,"onexit",a),t.showWidget("exit")}})),"scroll"==i.showEnter&&e(window).on("scroll.white-saas-generator",(function(){var n=e(window).scrollTop()/(e(document).height()-e(window).height())*100,a="auto";!(i.showScrollValue<=n)||i.noShow||WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||WBK.settings.windowOpened||WBK.settings.windowInvaderOpened||WBK.settings.chatWindowOpened||WBK.settings.chatInvitationOpened||WBK.settings.windowLoanerOpened||WBK.settings.windowQuizOpened||wsUtil.getCookie("WhiteGenerator_closed_"+WBK.settings.generatorId)||wsUtil.getCookie("WhiteGenerator_success_closed_"+WBK.settings.generatorId)||WBK.settings.called||("mobile"===WBK.settings.device&&(a="mobile"),t.showWidget(a))}))},initTimer:function(){if("disabled"!=i.showEnter&&"scroll"!=i.showEnter){var e=1,n="auto";if("mobile"===WBK.settings.device&&(n="mobile"),"paused"==i.showEnter&&(e=i.pausedSeconds,"site"===i.paused_sec_target)){var a=wsUtil.getCookie("WhiteCallback_timeAll");a&&(+a<+e?e-=a:e=0)}if("behavioral"==i.showEnter){var s=3,o=27;i.showBehavioralValue&&(s+=i.showBehavioralValue,o+=i.showBehavioralValue),e=wsUtil.getRandomArbitrary(s,o)}wsUtil.setInterval("WidgetGeneratorTimer",(function(){i.noShow||WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||WBK.settings.windowOpened||WBK.settings.windowInvaderOpened||WBK.settings.chatWindowOpened||WBK.settings.windowLoanerOpened||WBK.settings.windowQuizOpened||(wsUtil.deleteInterval("WidgetGeneratorTimer"),wsUtil.getCookie("WhiteGenerator_closed_"+WBK.settings.generatorId)||wsUtil.getCookie("WhiteGenerator_success_closed_"+WBK.settings.generatorId)||WBK.settings.called||t.showWidget(n))}),1e3*e)}},playerLoad:function(){var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t),window.onYouTubeIframeAPIReady=function(){window.generatorPlayer=new YT.Player("white-saas-generator-player",{events:{onReady:onPlayerReady}})},window.onPlayerReady=function(){0==i.voice_video&&window.generatorPlayer.mute()}},initCountDown:function(){var n=new Date;if(n=t.getDate(n),a=!(!(a=wsUtil.getCookie("WhiteGenerator_"+WBK.settings.generatorId+"_counter"))||"false"==a)&&JSON.parse(a),"fixed"==i.counterTime)if(a&&a.counterTime==i.counterTime&&a.dateHours==i.dateHours&&a.dateHoursType==i.dateHoursType&&wsUtil.getCookie("WhiteGenerator_"+WBK.settings.generatorId+"_countEnd"))n=new Date(wsUtil.getCookie("WhiteGenerator_"+WBK.settings.generatorId+"_countEnd"));else{wsUtil.setCookie("WhiteGenerator_"+WBK.settings.generatorId+"_countEnd",n,n);var a={dateHours:i.dateHours,dateHoursType:i.dateHoursType,counterTime:"fixed"};wsUtil.setCookie("WhiteGenerator_"+WBK.settings.generatorId+"_counter",JSON.stringify(a),n)}else{a&&(a.counterTime=i.counterTime);var s=new Date;s.setMinutes(s.getMinutes()+144e3),wsUtil.setCookie("WhiteGenerator_"+WBK.settings.generatorId+"_counter",JSON.stringify(a),s)}i.endTime=n,Math.floor((i.endTime-new Date)/1e3)<0&&i.noShowTimeout&&(i.noShow=1,t.hideWidget()),wsUtil.setInterval("WidgetGeneratorCountDown",(function(){var n,a,s,o,r;(n=Math.floor((i.endTime-new Date)/1e3))<0?(i.noShowTimeout&&(i.noShow=1,t.hideWidget()),t.stopCountDown(),a="00",s="00",o="00",r="00"):((a=Math.floor(n/86400))>99&&(a=99),n-=86400*a,n-=3600*(s=Math.floor(n/3600)),r=n-=60*(o=Math.floor(n/60)));var l=i.counterTypeInTimer;i.counterTypeInTimer=a>0?1:0,l!=i.counterTypeInTimer&&(1==i.counterTypeInTimer?(e(".white-saas-generator-counter-number-hours").next().text(i.langText.text_counter_days),e(".white-saas-generator-counter-number-minutes").next().text(i.langText.text_counter_hours),e(".white-saas-generator-counter-number-seconds").next().text(i.langText.text_counter_minutes)):(e(".white-saas-generator-counter-number-hours").next().text(i.langText.text_counter_hours),e(".white-saas-generator-counter-number-minutes").next().text(i.langText.text_counter_minutes),e(".white-saas-generator-counter-number-seconds").next().text(i.langText.text_counter_seconds))),1==i.counterTypeInTimer&&(r=o,o=s,s=a),t.updateGeneratorDigits(s,".white-saas-generator-counter-number-hours"),t.updateGeneratorDigits(o,".white-saas-generator-counter-number-minutes"),t.updateGeneratorDigits(r,".white-saas-generator-counter-number-seconds")}),1e3)},initCountDownMobile:function(){var e=new Date;if(e=t.getDateMobile(e),n=!(!(n=wsUtil.getCookie("WhiteGenerator_"+WBK.settings.generatorId+"_counterMobile"))||"false"==n)&&JSON.parse(n),"fixed"==i.counterTimeMobile)if(n&&n.counterTimeMobile==i.counterTimeMobile&&n.dateHoursMobile==i.dateHoursMobile&&n.dateHoursTypeMobile==i.dateHoursTypeMobile&&wsUtil.getCookie("WhiteGenerator_"+WBK.settings.generatorId+"_countEndMobile"))e=new Date(wsUtil.getCookie("WhiteGenerator_"+WBK.settings.generatorId+"_countEndMobile"));else{wsUtil.setCookie("WhiteGenerator_"+WBK.settings.generatorId+"_countEndMobile",e,e);var n={dateHoursMobile:i.dateHoursMobile,dateHoursTypeMobile:i.dateHoursTypeMobile,counterTimeMobile:"fixed"};wsUtil.setCookie("WhiteGenerator_"+WBK.settings.generatorId+"_counterMobile",JSON.stringify(n),e)}else{n&&(n.counterTimeMobile=i.counterTimeMobile);var a=new Date;a.setMinutes(a.getMinutes()+144e3),wsUtil.setCookie("WhiteGenerator_"+WBK.settings.generatorId+"_counterMobile",JSON.stringify(n),a)}i.endTimeMobile=e,Math.floor((i.endTimeMobile-new Date)/1e3)<0&&i.noShowTimeoutMobile&&(i.noShow=1,t.hideWidget()),wsUtil.setInterval("WidgetGeneratorCountDownMobile",(function(){var e,n,a,s,o;(e=Math.floor((i.endTimeMobile-new Date)/1e3))<0?(i.noShowTimeoutMobile&&(i.noShow=1,t.hideWidget()),t.stopCountDownMobile(),n="00",a="00",s="00",o="00"):((n=Math.floor(e/86400))>99&&(n=99),e-=86400*n,e-=3600*(a=Math.floor(e/3600)),o=e-=60*(s=Math.floor(e/60))),i.counterTypeInTimer,i.counterTypeInTimerMobile=n>0?1:0,1==i.counterTypeInTimerMobile&&(o=s,s=a,a=n),t.updateGeneratorDigits(a,".white-saas-mobile-generator-block-hours .white-saas-mobile-generator-counter-dig-text"),t.updateGeneratorDigits(s,".white-saas-mobile-generator-block-min .white-saas-mobile-generator-counter-dig-text"),t.updateGeneratorDigits(o,".white-saas-mobile-generator-block-seconds .white-saas-mobile-generator-counter-dig-text")}),1e3)},stopCountDown:function(){wsUtil.deleteInterval("WidgetGeneratorCountDown")},stopCountDownMobile:function(){wsUtil.deleteInterval("WidgetGeneratorCountDownMobile")},updateGeneratorDigits:function(e,t){var i=Math.floor(e/10)%10+""+e%10;a.window.find(t).text(i)},getDate:function(e){switch(i.counterTime){case"fixed":"hours"==i.dateHoursType?e.setHours(e.getHours()+parseInt(i.dateHours)):"minutes"==i.dateHoursType&&e.setMinutes(e.getMinutes()+parseInt(i.dateHours));break;case"todate":var t=i.dateEnd.split("."),n=i.dateEndTime.split(":");e=new Date(parseInt(t[2]),parseInt(t[1])-1,parseInt(t[0]),n[0],n[1]);break;case"toweekday":var a,s=(new Date).getDay(),o=parseInt(i.dateEndWeekday);a=s<o?o-s:s===o?7:7-(s-o),e=(e=new Date(new Date(e).setHours(0,0,0,0))).setDate(e.getDate()+a);break;case"eachdaytotime":var r=new Date((new Date).setHours(parseInt(i.each_day_to_time.split(":")[0]),0,0));e>r?(e.setDate(e.getDate()+1),e.setHours(r.getHours(),0,0)):e=r}return e},getDateMobile:function(e){switch(i.counterTimeMobile){case"fixed":"hours"==i.dateHoursTypeMobile?e.setHours(e.getHours()+parseInt(i.dateHoursMobile)):"minutes"==i.dateHoursTypeMobile&&e.setMinutes(e.getMinutes()+parseInt(i.dateHoursMobile));break;case"todate":var t=i.dateEndMobile.split("."),n=i.dateEndTimeMobile.split(":");e=new Date(parseInt(t[2]),parseInt(t[1])-1,parseInt(t[0]),n[0],n[1]);break;case"toweekday":var a,s=(new Date).getDay(),o=parseInt(i.dateEndWeekdayMobile);a=s<o?o-s:s==o?7:7-(s-o),e=(e=new Date(new Date(e).setHours(0,0,0,0))).setDate(e.getDate()+a);break;case"eachdaytotime":var r=new Date((new Date).setHours(parseInt(i.eachDayToTimeMobile.split(":")[0]),0,0));e>r?(e.setDate(e.getDate()+1),e.setHours(r.getHours(),0,0)):e=r}return e},lengthSuccessText:function(e){a.window.find(".white-saas-generator-success").show();var t,n=a.window.find(".white-saas-generator-success-text"),s=n.closest(".white-saas-generator-right-block").height(),o=.83*s,r=a.window.find(".white-saas-generator-buttons").height();n.height()>s?(n.parent().css("margin-top","5%"),n.find(".wsg-body-content").css({"overflow-y":"scroll",position:"absolute"}),n.height(o),n.nanoScroller({contentClass:"wsg-body-content",paneClass:"wsg-body-pane",sliderClass:"wsg-body-slider"})):(n.html(i.langText.text_success),t=100-100*n.height()/(s-r-25),n.parent().css("margin-top",Math.floor(t)+"%"))},sendLead:function(n){if(!i.sendingLead){var s,o,r,l,c,d,h;if(i.sendingLead=!0,"mobile"===WBK.settings.device){s=e(".white-saas-mobile-generator-username").val(),o=e(".white-saas-mobile-generator-useremail").val(),r=l=e(".white-saas-mobile-generator-userphone").val(),""==s||WBK.settings.visitorName||(WBK.setVisitorInfoIfNot({name:s}),i.langText.textSuccessMobile=wsUtil.decorateText(i.text_success_mobile),a.window.find(".white-saas-mobile-generator-text-success").html(i.langText.textSuccessMobile)),e(".white-saas-mobile-generator-userphone-error, .white-saas-mobile-generator-useremail-error, .white-saas-mobile-generator-userall-error").addClass("white-saas-mobile-generator-error-hidden"),i.useTelephoneMaskMobile&&(l=WBK.checkPhone(r),c=e(".white-saas-mobile-generator-userphone").attr("placeholder")),d=e(".white-saas-generator-email-agreement").is(":checked")?1:0,h=1;var u="";if("yes"==i.getMobileName&&""==s&&(e(".white-saas-mobile-generator-username").addClass("white-saas-mobile-generator-error"),u?u+=", .white-saas-mobile-generator-username-error":u=".white-saas-mobile-generator-username-error"),"yes"==i.getMobilePhone&&(""==r||""!=r&&r.length<5||""!=r&&i.useTelephoneMaskMobile&&""==l||""!=r&&i.useTelephoneMaskMobile&&""!=l&&l.length<5)&&(u?u+=", .white-saas-mobile-generator-userphone-error":u=".white-saas-mobile-generator-userphone-error"),"yes"!=i.getMobileEmail||""!=o&&wsUtil.validateEmail(o)||(e(".white-saas-mobile-generator-useremail").addClass("white-saas-mobile-generator-error"),u?u+=", .white-saas-mobile-generator-useremail-error":u=".white-saas-mobile-generator-useremail-error"),"yes"!=i.getMobileEmail&&"yes"!=i.getMobilePhone&&(""==r&&""==o?u=".white-saas-mobile-generator-userall-error":((""!=r&&r.length<5||""!=r&&""==l||""!=r&&""!=l&&l.length<5)&&(u?u+=", .white-saas-mobile-generator-userphone-error":u=".white-saas-mobile-generator-userphone-error"),""==o||wsUtil.validateEmail(o)||(u?u+=", .white-saas-mobile-generator-useremail-error":u=".white-saas-mobile-generator-useremail-error"))),u)return a.window.find(u).removeClass("white-saas-mobile-generator-error-hidden"),i.sendingLead=!1,void n.preventDefault()}else if(s=e(".white-saas-generator-username").val().trim(),o=e(".white-saas-generator-useremail").val(),l=e(".white-saas-generator-userphone").val(),""==s||WBK.settings.visitorName||(WBK.setVisitorInfoIfNot({name:s}),i.langText.text_success=wsUtil.decorateText(i.successTextWithTags)),i.useTelephoneMask&&(l=WBK.checkPhone(l),c=e(".white-saas-generator-userphone").attr("placeholder")),d=e(".white-saas-mobile-generator-email-agreement").is(":checked")?1:0,h=0,e(".white-saas-generator-userphone-error, .white-saas-generator-username-error, .white-saas-generator-useremail-error").addClass("white-saas-generator-error-hidden"),u="","yes"==i.getName&&""==s&&(u=".white-saas-generator-username-error"),"hide"!==i.getName&&0!=s.length&&s.length<2&&(u=".white-saas-generator-username-error"),"yes"==i.getPhone&&(""==l||l.length<3)&&(u?u+=", .white-saas-generator-userphone-error":u=".white-saas-generator-userphone-error"),"yes"!=i.getEmail||""!=o&&wsUtil.validateEmail(o)||(u?u+=", .white-saas-generator-useremail-error":u=".white-saas-generator-useremail-error"),"yes"!=i.getName&&"yes"!=i.getEmail&&"yes"!=i.getPhone&&""==s&&""==l&&""==o&&(u=".white-saas-generator-userall-error"),u)return a.window.find(u).removeClass("white-saas-generator-error-hidden"),i.sendingLead=!1,void n.preventDefault();WBK.setVisitorInfoIfNot({phone:l,email:o});var g=(new Date).getTime(),p=wsUtil.generateHash(g,WBK.settings.visitorId),w={code:WBK.settings.whiteSaasCode,name:s,email:o,phone:l,visitId:WBK.settings.visitId,generatorId:WBK.settings.generatorId,generatorStatId:WBK.settings.generatorStatId,phoneMask:c,emailAgreement:d,agreementLink:"https://whitesaas.com/agreement/",url:"string"==typeof document.URL?document.URL:"",visitorId:WBK.settings.visitorId,invader_id:WBK.settings.invaderId,invaderStatId:WBK.settings.invaderGeneratorStatId,instinct_id:WBK.settings.instinctId,instinctStatId:WBK.settings.instinctGeneratorStatId,roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId(),leadvertexId:wsUtil.getLeadvertexId(),fromMobile:h,googleClientId:wsUtil.getGoogleClientId(),externalParams:wsUtil.getExternalParams(),hash:p,hashTime:g};"function"==typeof window.ws_OnGeneratorSendLead&&window.ws_OnGeneratorSendLead(w);var f=WBK.settings.serverUrl+"/api?action=genLeadAdd";jWS.post(f,w,(function(n){if(1==n.Success){var s=new Date;if(s.setMinutes(s.getMinutes()+144e3),wsUtil.setCookie("WhiteGenerator_success_closed_"+WBK.settings.generatorId,!0,s),void 0!==n.Data.leadId&&(WBK.settings.genLeadId=n.Data.leadId,(l=WBK.checkPhone(l,!0))&&i.autoCall&&WBK.settings.callbackEnabled&&i.isPayed&&i.hasMoneyForLead&&i.isPayedGenerator)){wsKiller.settings.callingWidget=!0;var o=new Date;o.setMinutes(o.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","ongen",o),WBK.settings.phoneMask=i.useTelephoneMask?e(".white-saas-generator-userphone").attr("placeholder"):WBK.numberMask(l).mask,wsKiller.newCall(l,!1,i.autoCallDeffered,i.autoCallDefferedDelay)}t.sendGoal("lead"),"go_url"==i.sendAction&&i.sendActionUrl&&"new_page"!==i.pageOpenType?(wsUtil.parseURL(i.sendActionUrl).scheme||(i.sendActionUrl="http://"+i.sendActionUrl),window.location.href=i.sendActionUrl,t.hideWidget()):"mobile"===WBK.settings.device?(a.window.find(".white-saas-mobile-generator-next-block").hide(),a.window.find(".white-saas-mobile-generator-success-block").show()):(a.window.find(".white-saas-generator-right-block").children().hide(),t.lengthSuccessText(i.langText.text_success)),i.sendingLead=!1}}),"json")}},hideWidget:function(){WBK.settings.windowGeneratorOpened=!1,a.windowbgr.hide(),a.window.hide(),a.window.each((function(){this.style.setProperty("display","none","important")})),"mobile"===WBK.settings.device&&(a.window.data("noViewport")?(a.window.data("noViewport",0),e("meta[name=viewport]:last").attr("content","")):e("meta[name=viewport]:last").attr("content",a.window.data("oldViewport")),e("body").removeClass("cbk-body-mobile"),e(window).scrollTop(i.scrollTop),e(window).scrollLeft(i.scrollLeft),wsUtil.fixJivo(!1)),i.code_video&&e(".white-saas-generator-video-iframe").remove(),WBK.settings.callbackEnabled&&1!=wsKiller.settings.hideBtn&&wsKiller.settings.btnShow&&wsKiller.widget.btn.show(500),WBK.settings.chatBtnOpened&&wsChat.widget.btn.show(),WBK.settings.loanerId&&"mobile"!=WBK.settings.device&&wsLoaner.showWidget(),WBK.settings.quizId&&!WBK.settings.quizIntegrated&&!1===WBK.settings.thisIsQuizLanding&&wsQuizzes[WBK.settings.quizId].showWidget(),WBK.settings.multiButtonId&&wsMultiButton.showWidget(),WBK.settings.invaderGeneratorStatId=!1},calculateMobileImageHeight:function(){if(!("pc"===WBK.settings.device||"tablet"===WBK.settings.device&&window.innerWidth>900)&&(a.window.find(".white-saas-mobile-generator-image").css("height","auto"),e(".white-saas-mobile-generator").height()>=window.innerHeight)){var t=0;"hide"!==i.getMobilePhone&&(t+=1),"hide"!==i.getMobileEmail&&(t+=1),"hide"!==i.getMobileName&&(t+=1),t>1&&(a.window.find(".white-saas-mobile-generator-image").css("height",a.window.find(".white-saas-mobile-generator-image").height()-33*(t-1)),e(".white-saas-mobile-generator-image").addClass("white-saas-mobile-generator-image-cover"))}},showWidget:function(n){var s=window.innerHeight/2-a.window.height()/2;if(s<0&&(s=0),s=(s<0?0:s)+a.window.scrollTop(),WBK.settings.callbackEnabled&&setTimeout((function(){wsKiller.widget.btn.hide()}),200),WBK.settings.chatBtnOpened&&wsChat.widget.btn.hide(),WBK.settings.chatInvitationOpened&&wsChat.hideInvitation(),WBK.settings.loanerId&&"mobile"!=WBK.settings.device&&wsLoaner.hideWidget(),WBK.settings.quizId&&!WBK.settings.quizIntegrated&&!1===WBK.settings.thisIsQuizLanding&&wsQuizzes[WBK.settings.quizId].hideWidget(),WBK.settings.videoWidgetId&&WBK.settings.videoWidgetOpened&&wsVideoWidget.closeWidget(),"mobile"===WBK.settings.device||"tablet"===WBK.settings.device&&window.innerWidth<900){i.scrollLeft=e(window).scrollLeft(),i.scrollTop=e(window).scrollTop(),e("meta[name=viewport]:last").length?(a.window.data("oldViewport",e("meta[name=viewport]:last").attr("content")),e("meta[name=viewport]:last").remove()):a.window.data("noViewport",1),e("head").append(e("<meta>").attr("name","viewport").attr("content","width=device-width, user-scalable=0, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0")),e("body").addClass("cbk-body-mobile").css("width",e(window).width()+"px"),i.calculateHeight&&(t.calculateMobileImageHeight(),i.calculateHeight=!1);var o=0;-1===navigator.userAgent.search(/\iPhone\b.*\bSafari\b/g)||90!=window.orientation&&-90!=window.orientation||navigator.userAgent.match("CriOS")||(o=38),(s=window.innerHeight/2-a.window.height()/2)<0&&(s=0),s=(s<0?0:s)+a.window.scrollTop()+o,a.window.css("top",s+"px");var r=a.window.width(),l=(window.innerWidth-r)/2;l<0&&(l=0),a.window.css("left",l+"px"),WBK.settings.windowOpened||WBK.settings.windowLoanerOpened||WBK.settings.windowQuizOpened||WBK.settings.videoWidgetOpened||(a.windowbgr.show(),a.window.show(),a.window.each((function(){this.style.setProperty("display","block","important")}))),wsUtil.fixJivo(!0),e(window).on("resize",(function(){t.calculateMobileImageHeight(),(s=window.innerHeight/2-a.window.height()/2)<0&&(s=0),s=(s<0?0:s)+a.window.scrollTop(),a.window.css("top",s+"px"),r=a.window.width(),(l=(window.innerWidth-r)/2)<0&&(l=0),a.window.css("left",l+"px")})),e(window).on("orientationchange",(function(){setTimeout((function(){var e=0;-1===navigator.userAgent.search(/\iPhone\b.*\bSafari\b/g)||90!=window.orientation&&-90!=window.orientation||navigator.userAgent.match("CriOS")||(e=38),(s=window.innerHeight/2-a.window.height()/2)<0&&(s=0),s=(s<0?0:s)+a.window.scrollTop()+e,a.window.css("top",s+"px"),r=a.window.width(),(l=(window.innerWidth-r)/2)<0&&(l=0),a.window.css("left",l+"px")}),600)})),setTimeout((function(){e(window).resize()}),600),i.timerEnableMobile&&"paused"==i.showEnter&&(wsUtil.deleteTimeout("WidgetGeneratorInitTimer"),t.initCountDownMobile()),i.useTelephoneMaskMobile&&WBK.setPhoneInputFocusForm(e(".white-saas-mobile-generator-userphone"))}else a.window.css("top",s+"px"),WBK.settings.windowOpened||WBK.settings.windowLoanerOpened||WBK.settings.windowQuizOpened||WBK.settings.videoWidgetOpened||(a.windowbgr.show(),e("#btn_agreement_caption").html(i.langText.btn_success_text),a.window.show(),a.window.each((function(){this.style.setProperty("display","block","important")})),i.isPayed&&i.code_video&&(e(".white-saas-generator-video-iframe").length?e(".white-saas-generator-video-iframe").attr("src",i.code_video):(e(".white-saas-generator-video").append('<iframe onload="window.onFrameLoad()" class="white-saas-generator-video-iframe" frameborder="0" allow="autoplay; loop; fullscreen; accelerometer; gyroscope; picture-in-picture; encrypted-media" allowfullscreen="1" width="100%" height="100%" src='+i.code_video+"></iframe>"),0==i.voice_video&&(window.generatorPlayer.a=e(".white-saas-generator-video-iframe")[0],window.onFrameLoad=function(){0==i.voice_video&&window.generatorPlayer.mute()}))),i.useTelephoneMask&&WBK.setPhoneInputFocusForm(e(".white-saas-generator-userphone"))),i.timerEnable&&"paused"==i.showEnter&&(wsUtil.deleteTimeout("WidgetGeneratorInitTimer"),t.initCountDown());WBK.settings.windowGeneratorOpened=!0,0===i.noShow&&(t.sendEvents("show",n),t.sendGoal("newshow")),wsUtil.fixBootstrap()},closeWidget:function(){var e=new Date;"minutes"==i.repeatShowType?e.setMinutes(e.getMinutes()+parseInt(i.repeatShowTime)):"days"==i.repeatShowType&&e.setDate(e.getDate()+parseInt(i.repeatShowTime)),wsUtil.setCookie("WhiteGenerator_closed_"+WBK.settings.generatorId,!0,e),t.hideWidget(),t.sendEvents("close"),t.sendGoal("close")},sendEvents:function(t,i){var n=WBK.settings.serverUrl+"/api?action=genEvent&callback=?";e.getJSON(n,{event:t,openType:i,invaderId:"invader"==i&&WBK.settings.invaderId,instinctId:"instinct"==i&&WBK.settings.instinctId,generatorStatId:WBK.settings.generatorStatId,generatorId:WBK.settings.generatorId,code:WBK.settings.whiteSaasCode,visitId:WBK.settings.visitId,visitorId:WBK.settings.visitorId},(function(e){void 0!==e.Data.genStatId&&(WBK.settings.generatorStatId="show"===t&&e.Data.genStatId)}))},sendGoal:function(e){var t,i,n=!1,a=!1;switch(e){case"lead":t="GEN_LEAD",i="NewLead",n="generator",a="NewLead",wsUtil.sendUniversalGoal();break;case"newshow":t="GEN_SHOW",i="GenNewShow";break;case"close":t="GEN_CANCEL",i="CancelLead"}wsUtil.sendGoal(t,i,"Generator",n,a)},setDefaultSettings:function(){e.extend(!0,i,{firstApperance:3,reapperance:60,textGeneralColorBackground:!1,colorBackgroundRight:!1,textGeneralColorText:!1,btnSuccessColor:!1,btnCancelColor:!1,counterTime:!1,counterTypeInTimer:0,dateEnd:!1,dateEndTime:!1,dateEndWeekday:!1,dateHours:!1,getEmail:!1,getName:!1,getPhone:!1,imgBackground:0,imgBackgrouundService:0,logo_file_extension:"",logo_file_extension_mobile:"",pausedSeconds:!1,repeatShowTime:!1,repeatShowType:!1,showEnter:!1,showScrollValue:0,showBehavioralValue:0,sendAction:!1,pageOpenType:"current",actionUrlLinkHrefText:'href="javascript:void(0)"',sendActionUrl:!1,showExit:!1,timerEnable:!1,autoCall:0,autoCallText:"0",autoCallDeffered:0,autoCallDefferedDelay:0,isPayed:!1,hasMoneyForLead:!1,isPayedGenerator:!1,closeClickBgr:0,counterBgrColor:!1,counterNumberColor:!1,leadId:!1,partnerLink:!1,textGeneralFormat:!1,textGeneralPositionGorizontal:!1,textGeneralPositionVertical:!1,textGeneralFontFamily:!1,textGeneralFontSize:!1,emailService:"off",emailAgreement:0,langText:{},noShowTimeout:0,noShow:0,containerShadow:!1,sendingLead:!1,hideTablet:!1,hideBackgroundSite:1,siteBgrColor:"rgba(255,255,255,0.7)",close_button:0,voice_video:0,repeat_video:1,code_video:"",video_position:"0"})},setTemplate:function(){n="mobile"===WBK.settings.device||"tablet"===WBK.settings.device&&window.innerWidth<900?{windowBgr:'<div class="cbk-window-bgr"></div>',window:'<div class="white-saas-mobile-generator"><div class="white-saas-mobile-generator-bg-image"><div class="white-saas-mobile-generator-image-container"></div><img class="white-saas-mobile-generator-image" src="//saas-support.com/widget/img/background.jpg"><div class="white-saas-mobile-generator-text-general"><span class="white-saas-mobile-generator-text-general-span">'+i.langText.textGeneralMobile+'</span></div><a href="javascript:void(0)" class="white-saas-mobile-generator-close-button" style="">×</a></div><div class="white-saas-mobile-generator-next-block"><div class="white-saas-mobile-generator-next-block-content"><a href="javascript:void(0)" class="white-saas-mobile-generator-close-button white-saas-mobile-generator-only-landscape" style="">×</a><div class="white-saas-mobile-generator-text-sub">'+i.langText.textSubMobile+'</div><div class="white-saas-mobile-generator-counter-clock "><div class="white-saas-mobile-generator-counter-text">'+i.langText.textCounterTitleMobile+'</div><div class="white-saas-mobile-generator-counter-dig"><div class="white-saas-mobile-generator-counter-block"><div class="white-saas-mobile-generator-block-hours" style="background: rgba(170,122,122,1)"><span class="white-saas-mobile-generator-counter-dig-text" style="color: rgba(255,0,0,1)">06</span></div><div class="white-saas-mobile-generator-block-colon"><span style="color: rgba(255,0,0,1);">:</span></div><div class="white-saas-mobile-generator-block-min" style="background: rgba(170,122,122,1)"><span class="white-saas-mobile-generator-counter-dig-text" style="color: rgba(255,0,0,1)">51</span></div><div class="white-saas-mobile-generator-block-colon" "=""><span style="color: rgba(255,0,0,1);">:</span></div><div class="white-saas-mobile-generator-block-seconds" style="background: rgba(170,122,122,1)"><span class="white-saas-mobile-generator-counter-dig-text" style="color: rgba(255,0,0,1)">44</span></div></div></div></div></div><div class="white-saas-mobile-generator-group"><input type="text" class="white-saas-mobile-generator-username" maxlength="32" placeholder="'+i.langText.text_placeholder_username+'"><input type="tel" class="white-saas-mobile-generator-userphone" placeholder="'+i.langText.text_placeholder_userphone+'" maxlength="32"><input type="text" class="cbk-phone-checker white-saas-generator-input-hidden"/><input type="text" class="white-saas-mobile-generator-useremail" maxlength="32" placeholder="email"><div class="white-saas-mobile-generator-group white-saas-mobile-generator-group-with-error"><small class="white-saas-mobile-generator-username-error white-saas-mobile-generator-error-hidden">'+i.langText.error_name+'</small></div><div class="white-saas-mobile-generator-group white-saas-mobile-generator-group-with-error"><small class="white-saas-mobile-generator-userphone-error white-saas-mobile-generator-error-hidden">'+i.langText.error_phone+'</small></div><div class="white-saas-mobile-generator-group white-saas-mobile-generator-group-with-error"><small class="white-saas-mobile-generator-useremail-error white-saas-mobile-generator-error-hidden">'+i.langText.error_email+'</small></div><div class="white-saas-mobile-generator-group white-saas-mobile-generator-group-with-error"><small class="white-saas-mobile-generator-userall-error white-saas-mobile-generator-error-hidden">'+i.langText.error_all+'</small></div></div><div class="white-saas-mobile-generator-group"><a '+i.actionUrlLinkHrefText+' class="white-saas-mobile-generator-btn-success">'+i.langText.btnSuccessTextMobile+'</a></div><div class="white-saas-mobile-generator-group"><label class="white-saas-mobile-generator-label-agreement"><input type="checkbox" class="white-saas-mobile-generator-email-agreement" checked=""><span class="white-saas-mobile-generator-email-agreement-text">'+i.langText.email_agreement_text+'</span></label></div><div class="white-saas-mobile-generator-group"><div class="white-saas-mobile-generator-copyright"><a href="#" class="white-saas-mobile-generator-copyright-url" target="_blank">'+i.langText.text_link+'</a></div></div></div><div class="white-saas-mobile-generator-success-block"><div class="white-saas-mobile-generator-next-block-content"><div class="white-saas-mobile-generator-text-success">'+i.langText.textSuccessMobile+"</div></div></div></div>"}:{windowBgr:'<div class="cbk-window-bgr"></div>',window:'<div class="white-saas-generator"><div class="white-saas-generator-container"><div class="white-saas-generator-video '+(1==i.video_position?"left-position":"")+'">'+(i.code_video?'<iframe id ="white-saas-generator-player" class="white-saas-generator-video-iframe" frameborder="0" allow="autoplay; fullscreen; accelerometer; gyroscope; picture-in-picture; encrypted-media" allowfullscreen="1" width="100%" height="100%" src="'+i.code_video+'"></iframe>':"")+'</div><div class="white-saas-generator-left-block"'+(i.code_video?'style="pointer-events: none;"':"")+'><img class="white-saas-generator-image" src="'+WBK.settings.staticServerUrl+'/widget/img/background.png"><div class="white-saas-generator-text-general"><span class="white-saas-generator-text-general-span">'+i.langText.text_general+'</span></div></div><div class="white-saas-generator-right-block"><a href="javascript:void(0)" class="white-saas-generator-close-button">×</a><div class="white-saas-generator-success"><div class="white-saas-generator-success-text nano"><div class="wsg-body-content">'+i.langText.text_success+'</div></div><div class="white-saas-generator-buttons"><a href="#" class="white-saas-generator-btn-yes">'+i.langText.text_btn_yes+'</a></div></div><div class="white-saas-generator-text-sub">'+i.langText.text_sub+'</div><div class="white-saas-generator-counter"><div class="white-saas-generator-counter-title">'+i.langText.text_counter_title+'</div><div class="white-saas-generator-counter-clock"><div class="white-saas-generator-counter-dig"><div class="white-saas-generator-counter-block"></div><div class="white-saas-generator-counter-number white-saas-generator-counter-number-hours">00</div><div class="white-saas-generator-counter-name">'+i.langText.text_counter_hours+'</div></div><div class="white-saas-generator-counter-dz"><div class="white-saas-generator-counter-dz-block"></div><div class="white-saas-generator-counter-dz-block"></div></div><div class="white-saas-generator-counter-dig"><div class="white-saas-generator-counter-block"></div><div class="white-saas-generator-counter-number white-saas-generator-counter-number-minutes">00</div><div class="white-saas-generator-counter-name">'+i.langText.text_counter_minutes+'</div></div><div class="white-saas-generator-counter-dz"><div class="white-saas-generator-counter-dz-block"></div><div class="white-saas-generator-counter-dz-block"></div></div><div class="white-saas-generator-counter-dig"><div class="white-saas-generator-counter-block"></div><div class="white-saas-generator-counter-number white-saas-generator-counter-number-seconds">00</div><div class="white-saas-generator-counter-name">'+i.langText.text_counter_seconds+'</div></div></div></div><div class="white-saas-generator-group"><input type="text" class="white-saas-generator-group-input white-saas-generator-username" placeholder="'+i.langText.text_placeholder_username+'"><small class="white-saas-generator-username-error white-saas-generator-error-hidden">'+i.langText.error_name+'</small></div><div class="white-saas-generator-group"><input type="text" class="white-saas-generator-group-input white-saas-generator-userphone" placeholder="'+i.langText.text_placeholder_userphone+'"><input type="text" class="cbk-phone-checker white-saas-generator-input-hidden"/><small class="white-saas-generator-userphone-error white-saas-generator-error-hidden">'+i.langText.error_phone+'</small></div><div class="white-saas-generator-group"><input type="email" class="white-saas-generator-group-input white-saas-generator-useremail" placeholder="name@example.com"><small class="white-saas-generator-useremail-error white-saas-generator-error-hidden">'+i.langText.error_email+'</small></div><div class="white-saas-generator-group"><small class="white-saas-generator-userall-error white-saas-generator-error-hidden">'+i.langText.error_all+'</small></div><div class="white-saas-generator-group"><div class="white-saas-generator-label-agreement"><span style="margin-top: -15px;font-size: 9px;position: relative;display: block;">'+i.langText.email_agreement_text_agreement+'</span></div></div><div class="white-saas-generator-buttons"><a '+i.actionUrlLinkHrefText+'  class="white-saas-generator-btn-success ym-disable-clickmap">'+i.langText.btn_success_text+"</a>"+(i.langText.btn_cancel_text?'<a href="javascript:void(0)" class="white-saas-generator-btn-cancel">'+i.langText.btn_cancel_text+"</a>":"")+'</div><div class="white-saas-generator-copyright"><a href="#" class="white-saas-generator-copyright-url" target="_blank" data-widget="generator">'+i.langText.text_link+"</a></div></div></div></div>"}},log:function(e){wsUtil.log("GENERATOR : "+e)},getGeneratorVideoIframeSrc:function(e){var t=e;if(!t.match("^http")){var n="&loop=0";1==i.repeat_video&&(n="&loop=1&playlist="+e),t="https://www.youtube.com/embed/"+e+"?autoplay=1&autohide=1&controls=0&disablekb=1&modestbranding=1&rel=0&showinfo=0&cc_load_policy=1&iv_load_policy=3&enablejsapi=1&widgetid=1"+n}return t}})},781:()=>{wsKiller=function($){var _this,s,t,w,_debug;return{settings:{},templates:{},widget:{},masksPhoneData:{inited:{"#cbkPhoneInput":!1,"#cbkPhoneDeferredInput":!1},newMask:!1,pasted:{"#cbkPhoneInput":!1,"#cbkPhoneDeferredInput":!1}},init:function(e){_this=this,s=this.settings,t=this.templates,w=this.widget,s.workingDays={},$.fn._frameCheck()&&"undefined"==typeof WBK&&(WBK=document.WBK),1===WBK.settings.phoneBasesCountries.length&&7===WBK.settings.phoneBase&&(_this.masksPhoneData.newMask=!0),_debug=WBK.checkDebug(),_this.loader(e)},loader:function(e){var t=e.Data.callback;_this.setDefaultText(),t.killerLangText&&(s.text=t.killerLangText),_this.setDefaultSettings(),_this.setTemplate(),document.body.style.setProperty("--envybox-btn-background-color","rgba(244,67,54,0.8)"),WBK.settings.callbackEnabled=!0,WBK.settings.killerId=e.Settings.killerId,WBK.settings.checkCaptcha=!1,t.killerHasMoney&&(s.killerHasMoney=1),t.killerIsPayed&&(s.killerIsPayed=!0),t.killerUseDepartment&&t.killerDepartments&&(s.useDepartment=parseInt(t.killerUseDepartment),s.departments=t.killerDepartments),t.killerTimezone&&""!==t.killerTimezone&&(s.killerTimezone=t.killerTimezone,"UTC"===s.killerTimezone?s.killerTimezone=0:(s.killerTimezone=parseInt(s.killerTimezone.charAt(3)+s.killerTimezone.charAt(4)+s.killerTimezone.charAt(5)),parseInt(t.killerTimezone.charAt(7))&&(s.killerTimezone=s.killerTimezone+.5))),t.killerWorkdays&&(s.killerWorkdays=t.killerWorkdays);var i,n=new Date;if(s.timeDelta=parseInt(n.getTime()/1e3)-WBK.settings.utcTime,n.setTime(1e3*WBK.settings.utcTime+60*n.getTimezoneOffset()*1e3+60*s.killerTimezone*60*1e3),s.currentDay=n.getDay()-1,s.currentDay<0&&(s.currentDay=6),s.prevDay=s.currentDay-1,s.prevDay<0&&(s.prevDay=6),t.killerFormCall=parseInt(t.killerFormCall),t.killerFormCall&&(s.killerFormCall=t.killerFormCall),parseInt(t.killerFormCallHide)&&(s.killerFormCallHide=parseInt(t.killerFormCallHide)),t.killerCallOff=parseInt(t.killerCallOff),t.killerCallOff&&(s.killerCallOff=t.killerCallOff),t.killerText&&(s.text.killerText=t.killerText,s.text.cbkShareTitle[0][0][0]=_this.formatText(s.text.killerText[0].call_deferred[0]),s.text.cbkShareTitle[0][0][1]=_this.formatText(s.text.killerText[0].call_deferred[1]),s.text.cbkShareTitle[0][1][0]=_this.formatText(s.text.killerText[0].call_deferred[0]),s.text.cbkShareTitle[0][1][1]=_this.formatText(s.text.killerText[0].call_deferred[1]),s.text.cbkShareTitle[1][1][0]=_this.formatText(s.text.killerText[1].success_call[0]),s.text.cbkShareTitle[1][1][1]=_this.formatText(s.text.killerText[1].success_call[1]),s.text.cbkDepartmentTitle[0][0]=_this.formatText(s.text.killerText[0].department[0]),s.text.cbkDepartmentTitle[0][1]=_this.formatText(s.text.killerText[0].department[1]),s.text.cbkDepartmentTitle[1][0]=_this.formatText(s.text.killerText[1].department[0]),s.text.cbkDepartmentTitle[1][1]=_this.formatText(s.text.killerText[1].department[1]),s.text.cbkCallTitleFail[1][0]=_this.formatText(s.text.killerText[1].cbk_call_title_fail[0]),s.text.cbkCallTitleFail[1][1]=_this.formatText(s.text.killerText[1].cbk_call_title_fail[1])),e.Settings.serviceName&&(s.text.cbkCopyright="Хочу "+WBK.settings.servicename+" на свой сайт"),e.Settings.serviceDomain&&(s.cbkLink="http://"+WBK.settings.servicedomain+"?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=killer&utm_term="),t.partnerLink&&(s.cbkLink=t.partnerLink),t.agreementLink&&(s.agreementLink=t.agreementLink),t.killerIsPaused&&(s.killerIsPaused=t.killerIsPaused),t.killerPausedStart&&(s.killerPausedStart=t.killerPausedStart),t.killerPausedEnd&&(s.killerPausedEnd=t.killerPausedEnd),t.killerPausedDay&&(s.killerPausedDay=t.killerPausedDay),parseInt(t.killerOrderedCall)&&(s.killerOrderedCall=parseInt(t.killerOrderedCall)),t.killerSettings){if(t.killerSettings.windowPosition&&(s.windowPosition=parseInt(t.killerSettings.windowPosition)),t.killerSettings.auto_call_deffered&&(s.auto_call_deffered=parseInt(t.killerSettings.auto_call_deffered),s.auto_call_deffered_delay_value=parseInt(t.killerSettings.auto_call_deffered_delay_value)),t.killerSettings.agreementPersonalData&&(s.agreementPersonalData=t.killerSettings.agreementPersonalData),t.killerSettings.killerTransparentBgr&&(s.killerTransparentBgr=!0),s.contactNameInput=t.killerSettings.contact_name,s.contactEmailInput=t.killerSettings.contact_email,t.killerLogo&&(s.killerLogo=t.killerLogo),t.killerBtnLogo&&(s.killerBtnLogo=t.killerBtnLogo),t.killerSettings.logoStyle&&(s.killerLogoStyle=t.killerSettings.logoStyle),t.killerSettings.positionCustomLogoTop&&(s.customLogoPositionTop=t.killerSettings.positionCustomLogoTop),t.killerSettings.customLogoWidth&&t.killerSettings.customLogoHeight&&(s.customLogoWidth=t.killerSettings.customLogoWidth,s.customLogoHeight=t.killerSettings.customLogoHeight),t.killerUpdatedAt&&(s.killerUpdatedAt=t.killerUpdatedAt),t.killerSettings.btnType&&(s.btnType=t.killerSettings.btnType),t.killerSettings.btnSize&&(s.btnSize=t.killerSettings.btnSize),t.killerSettings.mobileBtnSize&&(s.mobileBtnSize=t.killerSettings.mobileBtnSize),t.killerSettings.animation&&(s.animation=t.killerSettings.animation),t.killerSettings.waveColor&&(s.waveColor=t.killerSettings.waveColor,WBK.addStyles(".callbackkiller.cbk-phone.cbk-phone-pulse .cbk-phone-circle{background-color: "+s.waveColor+"!important;}.callbackkiller.cbk-phone.cbk-phone-wild .cbk-phone-circle{background-color: "+s.waveColor+"!important;}.callbackkiller.cbk-phone.cbk-phone-waves .cbk-phone-circle{background-color: "+s.waveColor+"!important;}.callbackkiller.cbk-phone.cbk-phone-waves .cbk-phone-second_circle, .callbackkiller.cbk-phone.cbk-phone-waves .cbk-phone-third_circle{border: 1px solid "+s.waveColor+"!important;}")),t.killerSettings.btnPosition&&"btn"===s.btnType&&(s.btnPosition=t.killerSettings.btnPosition),t.killerSettings.btnExtendedPosition&&"extended_btn"===s.btnType&&(s.btnExtendedPosition=t.killerSettings.btnExtendedPosition),t.killerSettings.btnExtendedCorner&&"extended_btn"===s.btnType&&(s.btnExtendedCorner=t.killerSettings.btnExtendedCorner),t.killerSettings.hideBtn&&"pc"==WBK.settings.device&&(s.hideBtn=parseInt(t.killerSettings.hideBtn)),2==t.killerSettings.hideBtn&&"mobile"==WBK.settings.device&&(s.hideBtn=parseInt(t.killerSettings.hideBtn)),t.killerSettings.timerType&&(s.timerType=t.killerSettings.timerType),t.killerSettings.hideDefered&&(s.hideDefered=parseInt(t.killerSettings.hideDefered)),t.killerSettings.btnText&&(s.btnText=t.killerSettings.btnText),t.killerSettings.btnFontSize&&(s.btnFontSize=t.killerSettings.btnFontSize),t.killerSettings.btnTextAdd&&"pc"==WBK.settings.device&&(s.btnTextAdd=t.killerSettings.btnTextAdd),t.killerSettings.windowNoCopyright&&(WBK.settings.hideCopyright=!0),t.killerSettings.btnNoAnimateOnScroll&&(s.btnNoPulse=!0),t.killerSettings.btnStaticOnScroll&&(s.btnStaticOnScroll=!0),parseInt(t.killerSettings.btnHideMobileZoom)&&(s.btnHideMobileZoom=!0),t.killerSettings.btnHideOnMobile&&"mobile"===WBK.settings.device&&(s.hideBtn=1),t.killerSettings.btnHideOnTablet&&"tablet"===WBK.settings.device&&(s.hideBtn=1),t.killerSettings.btnRotateTimeout&&(s.timeouts.rotatePhoneIcons=t.killerSettings.btnRotateTimeout),t.killerSettings.btnShowTimeout&&(s.timeouts.btnShowTimeout=t.killerSettings.btnShowTimeout),t.killerSettings.paused_sec_target&&(s.timeouts.paused_sec_target=t.killerSettings.paused_sec_target),t.killerSettings.btnShowScroll&&(s.btnShowScroll=t.killerSettings.btnShowScroll),t.killerSettings.windowBtnTextOnline&&(s.windowBtnTextOnline=t.killerSettings.windowBtnTextOnline),t.killerSettings.windowBtnTextOffline&&(s.windowBtnTextOffline=t.killerSettings.windowBtnTextOffline),null!=t.killerSettings.killerManagerRatingCheck&&(s.managerRatingCheck=parseInt(t.killerSettings.killerManagerRatingCheck)),null!=t.killerSettings.killerCloseClickBgr&&(s.killerCloseClickBgr=parseInt(t.killerSettings.killerCloseClickBgr)),t.killerSettings.windowMinApperanceOnExitTimeout&&(s.showOnExitApperanceTimeout=t.killerSettings.windowMinApperanceOnExitTimeout),t.killerSettings.windowDisplayMode&&(1===t.killerSettings.windowDisplayMode&&(s.showWindowReapperanceTimeout=0,s.showOnExitReapperanceTimeout=40),2===t.killerSettings.windowDisplayMode&&(s.showWindowReapperanceTimeout=7,s.showOnExitReapperanceTimeout=10080),3===t.killerSettings.windowDisplayMode&&(s.noShowWindow=!0)),t.killerSettings.killerCallTimeout&&(s.callTimeout=parseInt(t.killerSettings.killerCallTimeout)),t.killerSettings.windowMinApperanceTimeout&&t.killerSettings.windowMaxApperanceTimeout&&t.killerSettings.windowMinApperanceTimeout<t.killerSettings.windowMaxApperanceTimeout?s.showWindowApperanceTimeout=wsUtil.getRandomArbitrary(t.killerSettings.windowMinApperanceTimeout,t.killerSettings.windowMaxApperanceTimeout):t.killerSettings.windowMinApperanceTimeout?s.showWindowApperanceTimeout=wsUtil.getRandomArbitrary(t.killerSettings.windowMinApperanceTimeout,t.killerSettings.windowMinApperanceTimeout+7):t.killerSettings.windowMaxApperanceTimeout&&(s.showWindowApperanceTimeout=wsUtil.getRandomArbitrary(0,t.killerSettings.windowMaxApperanceTimeout)),t.killerSettings.windowNoShowOnExit&&(s.noShowOnExit=!0),t.killerSettings.windowShowOnExitAlways&&(s.showOnExitAlways=!0),(t.killerSettings.btnColor||t.killerSettings.btnMobileColor&&"pc"!=WBK.settings.device)&&("pc"!=WBK.settings.device&&t.killerSettings.btnMobileColor?s.btnColor=t.killerSettings.btnMobileColor:t.killerSettings.btnColor&&(s.btnColor=t.killerSettings.btnColor),WBK.addStyles(".ws-killer .ws-killer-btn{background-color: "+s.btnColor+"!important;} .ws-killer .ws-killer-btn .ws-icon-phone{color: "+s.btnColor+"!important;} .cbk-btn, .cbk-btn:hover {background-color: "+s.btnColor+"!important;} .cbk-phone .cbk-phone-bgr {background-color: "+s.btnColor+"!important;}")),(t.killerSettings.btnTextColor||t.killerSettings.btnMobileTextColor&&"pc"!=WBK.settings.device)&&("pc"!=WBK.settings.device&&t.killerSettings.btnMobileTextColor?s.btnTextColor=t.killerSettings.btnMobileTextColor:t.killerSettings.btnTextColor&&(s.btnTextColor=t.killerSettings.btnTextColor),WBK.addStyles(".ws-killer .ws-btn-title {color: "+s.btnTextColor+"!important} .cbk-btn .cbk-title, .cbk-btn:hover .cbk-title {color: "+s.btnTextColor+"!important;} .cbk-phone .cbk-phone-phone .ws-icon-phone, .cbk-phone .cbk-phone-text, .cbk-phone .cbk-phone-text span, .cbk-phone .cbk-phone-phone.cbk-phone-with-text, .cbk-phone .cbk-phone-phone.cbk-phone-with-text span{color: "+s.btnTextColor+"!important;}")),t.killerSettings.windowBackgroundColor&&WBK.addStyles(".cbk-window.cbk-background {background-color: "+t.killerSettings.windowBackgroundColor+"!important;}.cbk-window.callbackkiller-mobile.cbk-background {background-color: "+t.killerSettings.windowBackgroundColor+"!important;}"),t.killerSettings.windowTextColor&&WBK.addStyles(".cbk-window * {color: "+t.killerSettings.windowTextColor+"!important}.cbk-window a, .cbk-window a:hover, .cbk-window a.cbk-button-no.cbk-button-no-dark {color: "+t.killerSettings.windowTextColor+"!important;}.cbk-window a.cbk-button-no.cbk-button-no-dark, .cbk-window a.cbk-button-no.cbk-button-no-dark:hover {color: "+t.killerSettings.windowTextColor+"!important;border-bottom: 1px dashed "+t.killerSettings.windowTextColor+"!important}"),t.killerSettings.windowLinkColor&&WBK.addStyles(".cbk-link-btn a, .cbk-link-btn a:hover, .cbk-link-btn a:active, .cbk-window a.cbk-button-no, .cbk-window a.cbk-button-no:hover{color: "+t.killerSettings.windowLinkColor+"!important; border-bottom: 1px dashed "+t.killerSettings.windowLinkColor+"!important;}"),t.killerSettings.windowInputBackgroundColor&&WBK.addStyles(".cbk-window .cbk-form .cbk-input, .cbk-window .cbk-form .cbk-input:focus, .cbk-window .cbk-form .cbk-input:hover, .cbk-window .cbk-form .cbk-select, .cbk-window .cbk-form .cbk-select option {background: "+t.killerSettings.windowInputBackgroundColor+"!important;}"),t.killerSettings.windowInputTextColor&&WBK.addStyles(".cbk-window .cbk-form .cbk-input, .cbk-window .cbk-form .cbk-input:focus, .cbk-window .cbk-form .cbk-input:hover, .cbk-window .cbk-form .cbk-select, .cbk-window .cbk-form .cbk-select option {color: "+t.killerSettings.windowInputTextColor+"!important;}"),t.killerSettings.hasOwnProperty("usePhoneMask")||(t.killerSettings.usePhoneMask=!0),!t.killerSettings.usePhoneMask&&t.killerSettings.windowInputBackgroundColor){var a=t.killerSettings.windowInputBackgroundColor;a=a.match(/rgba\(([\.\d]+[,\s]*?){4}/g)?a.replace(/,\s*?[\.\d]+?\)/,")"):a,WBK.addStyles(".callbackkiller.cbk-window .cbk-form .ws-dcpi_dropdown .ws-dcpi_country-list{background-color: "+a+"!important;}"),WBK.addStyles(".callbackkiller.cbk-window .cbk-form .ws-dcpi_dropdown{background-color: "+t.killerSettings.windowInputBackgroundColor+"!important;}")}if(!t.killerSettings.usePhoneMask&&t.killerSettings.windowInputTextColor){var o=t.killerSettings.windowInputTextColor;o=o.match(/rgba\(([\.\d]+[,\s]*?){4}/g)?o.replace(/,\s*?[\.\d]+?\)/,")"):o,WBK.addStyles(".callbackkiller.cbk-window .cbk-form .ws-dcpi_dropdown .ws-dcpi_country .ws-dcpi_country-name, .callbackkiller.cbk-window .cbk-form .ws-dcpi_dropdown .ws-dcpi_country-list .ws-dcpi_country .ws-dcpi_country-code, .callbackkiller.cbk-window .cbk-form .ws-dcpi_dropdown .ws-dcpi_dropdown-toggle-selected_code{color: "+o+"!important;}")}t.killerSettings.windowBtnBackgroundColor&&(document.body.style.setProperty("--envybox-btn-background-color",t.killerSettings.windowBtnBackgroundColor.replace(",1)",",.8)")),WBK.addStyles(".cbk-window .cbk-button {background: "+t.killerSettings.windowBtnBackgroundColor.replace(",1)",",.8)")+"!important;}.cbk-window .cbk-button:hover, .cbk-window .cbk-button:active {background: "+t.killerSettings.windowBtnBackgroundColor+"!important;}")),t.killerSettings.windowBtnTextColor&&WBK.addStyles(".cbk-window .cbk-form .cbk-button, .cbk-window .cbk-form .cbk-button:hover, .cbk-window .cbk-form .cbk-button {color: "+t.killerSettings.windowBtnTextColor+"!important;}"),t.killerSettings.logoShadow&&(s.logoShadow=t.killerSettings.logoShadow,"hide"==s.logoShadow&&WBK.addStyles(".cbk-window-logo {box-shadow:none!important;}")),(t.killerSettings.btnPositionBottom||0===t.killerSettings.btnPositionBottom)&&(s.phonePositionBottom=t.killerSettings.btnPositionBottom),(t.killerSettings.btnPositionRight||0===t.killerSettings.btnPositionRight)&&(s.phonePositionRight=t.killerSettings.btnPositionRight),void 0!==t.killerSettings.btnMobilePositionHorizontal&&(s.btnMobilePositionHorizontal=t.killerSettings.btnMobilePositionHorizontal),t.killerSettings.btnMobilePositionHorizontalType&&(s.btnMobilePositionHorizontalType=t.killerSettings.btnMobilePositionHorizontalType),void 0!==t.killerSettings.btnMobilePositionVertical&&(s.btnMobilePositionVertical=t.killerSettings.btnMobilePositionVertical),t.killerSettings.shiftDayBeginning&&(s.shiftDayBeginning=parseInt(t.killerSettings.shiftDayBeginning)),t.killerSettings.btnMobilePositionVerticalType&&(s.btnMobilePositionVerticalType=t.killerSettings.btnMobilePositionVerticalType),t.killerOffNoWork&&(s.killerOffNoWork=t.killerOffNoWork),t.killerSettings.siteBgrColor&&(s.siteBgrColor=t.killerSettings.siteBgrColor),t.killerSettings.killerSendAction&&(s.killerSendAction=t.killerSettings.killerSendAction),t.killerSettings.killerPageOpenType&&(s.killerPageOpenType=t.killerSettings.killerPageOpenType),t.killerSettings.killerSendActionUrl&&(s.killerSendActionUrl=t.killerSettings.killerSendActionUrl),t.killerSettings.killerSendActionJavascript&&(s.killerSendActionJavascript=t.killerSettings.killerSendActionJavascript),s.usePhoneMask=!!t.killerSettings.usePhoneMask}(_this.checkWorkTime(),!s.killerWorking&&s.killerOffNoWork&&(s.hideBtn=1,s.noShowOnExit=!0,s.noShowWindow=!0),s.killerOrderedCall&&(s.hideBtn=1),wsUtil.getCookie("WhiteCallback_callId")&&(s.callId=wsUtil.getCookie("WhiteCallback_callId"),WBK.initSocket()),_this.initWidget(),_this.initKiller(),"#callbackkiller"===window.top.location.hash||"#callbackwidget"===window.top.location.hash)&&((i=new Date).setMinutes(i.getMinutes()+144e3),wsUtil.setCookie("CallbackKiller_shownOn","onbtn",i),_this.showWindow("btn"));"#callbackkillermodal"!==window.top.location.hash&&"#callbackwidgetmodal"!==window.top.location.hash||((i=new Date).setMinutes(i.getMinutes()+144e3),wsUtil.setCookie("CallbackKiller_shownOn","onbtn",i),_this.showWindow("modal"))},checkToInitInputMask:function(e,t){!_this.masksPhoneData.inited["#"+e.id]&&e.value&&(_this.initInputMask(e),_this.masksPhoneData.inited["#"+this.id]=!0)},formatNumberForRussia:function(e){return e?(11===(e=e.replace(/[^0-9]/g,"")).length&&"8"===e[0]?e=e.replace("8","7"):10===e.length&&"9"===e[0]&&(e=e.replace("9","79")),e):null},initInputMask:function(e,t){if((s.usePhoneMask||".cbk-phone-checker"===e)&&WBK.settings.phoneMasks){var i={inputmask:{definitions:{"#":{validator:"[0-9]",cardinality:1}},clearIncomplete:!1,showMaskOnHover:!1,autoUnmask:!0},match:/[0-9]/,replace:"#",list:$.masksSort(WBK.settings.phoneMasks,["#"],/[0-9]|#/,"mask"),listKey:"mask",onMaskChange:function(){$(this).attr("placeholder",$(this).inputmask("getemptymask")),i.ignoreSetValueOnPaste=!0,!_this.masksPhoneData.newMask||$(this).val()||$(this).hasClass("cbk-phone-checker")||_this.removeMask(this)}};void 0!==t&&(i.inputmask.definitions.clearIncomplete=!0),_this.masksPhoneData.newMask&&(i.ignoreSetValueOnPaste=!0),$(e).inputmasks(i);var n=$(e).attr("id");n&&(_this.masksPhoneData.inited["#"+n]=!0)}},showWindow:function(e,t){if(s.agreementPersonalData&&(!t&&s.killerWorking?w.window.find(".cbk-personal-agreement span").html(s.windowBtnTextOnline):w.window.find(".cbk-personal-agreement span").html(s.windowBtnTextOffline),$(".cbk-personal-agreement").show()),"auto"===e&&(WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||WBK.settings.chatWindowOpened||WBK.settings.chatInvitationOpened||WBK.settings.windowLoanerOpened||WBK.settings.multiButtonVariantsOpened||WBK.settings.windowQuizOpened))wsUtil.getCookie("WhiteCallback_noShowWindow")||s.noShowWindow||wsUtil.setTimeout("showWindowOnTimer",(function(){if(!wsUtil.getCookie("WhiteCallback_noShowWindow")&&!wsUtil.getCookie("WhiteCallback_noShowOnExit")&&(_this.checkWorkTime(),!WBK.settings.windowOpened)){var e=new Date;e.setMinutes(e.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onshow",e),_this.showWindow("auto")}}),1e3*s.showWindowApperanceTimeout);else{if("pc"!=WBK.settings.device&&23663!==WBK.settings.siteId&&(s.scrollLeft=$(window).scrollLeft(),s.scrollTop=$(window).scrollTop(),$("meta[name=viewport]:last").length?(w.window.data("oldViewport",$("meta[name=viewport]:last").attr("content")),$("meta[name=viewport]:last").remove()):w.window.data("noViewport",1),$("head").append($("<meta>").attr("name","viewport").attr("content","width=device-width, user-scalable=0, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0")),$("body").addClass("cbk-body-mobile").css("width",$(window).width()+"px")),WBK.settings.windowInvaderOpened&&(wsInvader.widget.window.find(".cbk-support-new-message-copyright").hide(),wsInvader.widget.window.hide()),WBK.settings.chatEnabled&&("auto"==e?WBK.settings.chatBtnOpened&&!WBK.settings.chatInvitationOpened&&(wsChat.widget.btn.hide(),wsChat.widget.invitation.hide()):WBK.settings.chatWindowOpened&&wsChat.widget.window.hide(),WBK.settings.chatBtnOpened&&"auto"!=e&&(wsChat.widget.btn.hide(),wsChat.widget.invitation.hide())),WBK.settings.quizId&&!WBK.settings.quizIntegrated&&!1===WBK.settings.thisIsQuizLanding&&wsQuizzes[WBK.settings.quizId].hideWidget(),WBK.settings.videoWidgetId&&WBK.settings.videoWidgetOpened&&wsVideoWidget.closeWidget(),WBK.settings.loanerId&&"mobile"!=WBK.settings.device&&wsLoaner.hideWidget(),WBK.settings.multiButtonId&&wsMultiButton.hideWidget(),WBK.settings.windowOpened=!0,w.btn.hasClass("cbk-phone")&&"pc"==WBK.settings.device&&(_this.stopRotatePhoneIcons(),w.btn.removeClass("cbk-pulse")),w.btn.is(":visible"))if("exit"===e)w.btn.hide();else{var i="cbk-fadeOutRightBtn";"pc"!=WBK.settings.device?i="cbk-fadeOutDown":1===s.windowPosition&&(i="cbk-fadeOutLeft"),WBK.animateFastOnce(w.btn,i,(function(){WBK.settings.windowOpened&&w.btn.hide()}))}if("exit"===e){w.window.addClass("cbk-window-onexit"),w.window.removeClass("cbk-window-modal");var n=w.window.width();(a=s.showOnExitXPosition-n/2)<0&&(a=0),a+n>window.innerWidth&&(a=window.innerWidth-n-10),w.window.css("left",a+"px"),w.window.css("top","0")}else if(2!==s.windowPosition&&"modal"!==e||"pc"!=WBK.settings.device)w.window.removeClass("cbk-window-onexit"),2!==s.windowPosition&&w.window.removeClass("cbk-window-modal"),w.window.css("left",""),w.window.css("top","");else{w.window.addClass("cbk-window-modal"),w.window.removeClass("cbk-window-onexit");var a;n=w.window.width();(a=(window.innerWidth-n)/2)<0&&(a=0);var o=w.window.height(),r=(window.innerHeight-o)/2;r<0&&(r=0),w.window.css("left",a+"px"),w.window.css("top",r+"px")}if(_this.initCallTimer(),w.windowbgr.show(),w.window.find(".cbk-form-title").show(),w.window.find("#cbkNameInput").attr("style","display: "+("none"==s.contactNameInput?"none":"inline-block")+"!important"),w.window.find("#cbkEmailInput").attr("style","display: "+("none"==s.contactEmailInput?"none":"inline-block")+"!important"),w.window.find("#cbkPhoneInput").attr("style","display: inline-block!important"),w.window.show(),"modal"===e)l="cbk-fadeInUp",WBK.animateFastOnce(w.window,l);else if("exit"!==e){var l="cbk-fadeInRight";"pc"!=WBK.settings.device?w.window.show():1===s.windowPosition||2===s.windowPosition?(l="cbk-fadeInLeft",WBK.animateFastOnce(w.window,l)):3===s.windowPosition?(l="cbk-fadeInUp",w.window.addClass("cbk-window-bottom"),WBK.animateFastOnce(w.window,l)):1!==s.windowPosition&&"sm"===e?(wsInvader&&"right"!=wsInvader.settings.position&&(l="cbk-fadeInLeft",w.window.addClass("cbk-window-left")),WBK.animateFastOnce(w.window,l)):1!==s.windowPosition&&"instinct"===e?(wsInstinct&&"right"!=wsInstinct.settings.position_x&&(l="cbk-fadeInLeft",w.window.addClass("cbk-window-left")),WBK.animateFastOnce(w.window,l)):1!==s.windowPosition&&"multi_button"===e?("right"!=wsMultiButton.settings.position_x&&(l="cbk-fadeInLeft",w.window.addClass("cbk-window-left")),WBK.animateFastOnce(w.window,l)):1!==s.windowPosition&&"video_widget"===e&&("right"!==wsVideoWidget.settings.position_x&&(l="cbk-fadeInLeft",w.window.addClass("cbk-window-left")),WBK.animateFastOnce(w.window,l))}switch(e){case"auto":_this.sendGoal("showauto");break;case"exit":_this.sendGoal("showonexit")}if(_this.checkWorkTime(),w.window.find("div.cbk-form").hide(),$("#cbkPhoneBtn").show(),w.window.find(".cbk-timer").removeClass("call"),wsUtil.deleteInterval("callTimerAnimation"),w.window.find(".cbk-text-after-call").hide(),!t&&s.killerWorking){w.window.find("div.cbk-callform .cbk-button-no").show(),s.killerHasMoney&&!s.killerCallOff&&"hide"!=s.timerType?w.window.find(".cbk-timer").show():(!s.killerCallOff&&s.killerHasMoney||(e="nomoney"),w.window.find(".cbk-timer").hide()),"modal"===e?e="auto":"sm"!==e&&"instinct"!==e&&"multi_button"!==e&&"video_widget"!==e||(e="btn"),_this.setFormText(w.window.find("div.cbk-callform .cbk-form-title"),s.text.killerText[s.killerWorking][e][WBK.settings.hasVisitorName]),_this.personalizeForms();var c=w.window.find("div.cbk-callform");c.show(),"pc"==WBK.settings.device&&WBK.animateOnce(c,"cbk-fadeIn",(function(){WBK.animateOnce(c.find("div.cbk-form-title"),"cbk-bounce")})),_this.setPhoneInputFocus()}else{_this.setWorkDays(),s.killerHasMoney?"modal"===e?e="auto":"sm"!==e&&"instinct"!==e&&"multi_button"!==e&&"video_widget"!==e||(e="btn"):e="nomoney",_this.setFormText(w.window.find("div.cbk-cdform .cbk-form-title"),s.text.killerText[s.killerWorking][e][WBK.settings.hasVisitorName]),_this.personalizeForms();var d=w.window.find("div.cbk-cdform");d.show(),WBK.animateOnce(d,"cbk-fadeIn",(function(){"pc"==WBK.settings.device&&WBK.animateOnce(d.find("div.cbk-form-title"),"cbk-bounce")})),_this.setPhoneInputFocus()}_this.onResizeWindow(),s.callStarted=!1,s.usePhoneMask||w.window.find("#cbkPhoneInput").closest(".ws-dcpi_dropdown").css("display","flex");var h=WBK.settings.serverUrl+"/api?action=newshow&callback=?";$.getJSON(h,{shownOn:wsUtil.getCookie("WhiteCallback_shownOn"),device:WBK.settings.device,code:WBK.settings.whiteSaasCode,googleClientId:wsUtil.getGoogleClientId(),killerId:WBK.settings.killerId,visitorId:WBK.settings.visitorId,advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId(),leadvertexId:wsUtil.getLeadvertexId(),externalParams:wsUtil.getExternalParams()})}wsUtil.fixJivo(!0),wsUtil.fixBootstrap()},initNoUsePhoneMaskDialCodeDropdownInputs:function(){s.usePhoneMask||(w.wsDCPI=wsUtil.getOrInitDialCodesPhoneInput(),w.wsDCPI.renderOnInput("#cbkPhoneInput","cbkPhoneInput",null,!0),w.wsDCPI.renderOnInput("#cbkPhoneDeferredInput","cbkPhoneDeferredInput",null,!0))},checkPhoneWithUseMaskSetting:function(e,t){return e=s.usePhoneMask?WBK.checkPhone(e,!0):w.wsDCPI.getSelectedCountryByInputKey(t).code+$("#"+t).val()},hideWindow:function(){if("pc"!=WBK.settings.device&&(w.window.data("noViewport")?(w.window.data("noViewport",0),$("head meta[name=viewport]:last").attr("content","")):$("head meta[name=viewport]:last").attr("content",w.window.data("oldViewport")),$("body").removeClass("cbk-body-mobile").css("width","auto"),$(window).scrollTop(s.scrollTop),$(window).scrollLeft(s.scrollLeft),wsUtil.fixJivo(!1)),w.windowbgr.hide(),WBK.settings.windowOpened){var e="cbk-fadeOutRight";"pc"!=WBK.settings.device?(w.window.hide(),w.window.find("div.cbk-form").hide()):1===s.windowPosition||w.window.hasClass("cbk-window-left")?e="cbk-fadeOutLeft":(3===s.windowPosition||w.window.hasClass("cbk-window-bottom"))&&(e="cbk-fadeOutUp"),"pc"==WBK.settings.device&&WBK.animateFastOnce(w.window,e,(function(){w.window.hide(),w.window.find("div.cbk-form").hide(),1!==s.windowPosition&&w.window.hasClass("cbk-window-left")&&w.window.removeClass("cbk-window-left")}))}if(1!=s.hideBtn&&s.btnShow){var t="cbk-fadeInRight";"pc"!=WBK.settings.device?(t="cbk-fadeInUp",w.btn.show(500)):(w.btn.show(),("btn"!=s.btnType||"btn"==s.btnType&&"left"!=s.btnPosition)&&WBK.animateFastOnce(w.btn,t,(function(){_this.updatePhonePosition()})))}(w.btn.hasClass("cbk-phone")&&"pc"==WBK.settings.device&&_this.startRotatePhoneIcons(),WBK.settings.windowOpened=!1,s.showWindowReapperanceTimeout)?((i=new Date).setDate(i.getDate()+parseInt(s.showWindowReapperanceTimeout)),wsUtil.setCookie("WhiteCallback_noShowWindow",1,i)):wsUtil.setCookie("WhiteCallback_noShowWindow",1);var i=new Date;s.showOnExitAlways?i.setSeconds(i.getSeconds()+3):i.setMinutes(i.getMinutes()+parseInt(s.showOnExitReapperanceTimeout)),wsUtil.setCookie("WhiteCallback_noShowOnExit",1,i),WBK.settings.invaderCallbackStatId=!1,WBK.settings.chatEnabled&&(WBK.settings.chatBtnOpened&&wsChat.widget.btn.show(),WBK.settings.chatWindowOpened&&wsChat.widget.window.show()),WBK.settings.quizId&&!WBK.settings.quizIntegrated&&!1===WBK.settings.thisIsQuizLanding&&wsQuizzes[WBK.settings.quizId].showWidget(),WBK.settings.windowInvaderOpened&&!wsUtil.getCookie("WhiteInvader_closed_"+WBK.settings.invaderId)&&wsInvader.showWidget(),WBK.settings.loanerId&&"mobile"!=WBK.settings.device&&wsLoaner.showWidget(),WBK.settings.multiButtonId&&wsMultiButton.showWidget()},startShakeBtn:function(){wsUtil.setInterval("shakeBtn",(function(){"extended_btn"==s.btnType?WBK.animateOnce(w.extended_btn,"cbk-shake"):WBK.animateOnce(w.btn,"cbk-shake")}),1e3*s.timeouts.shakeBtn)},stopShakeBtn:function(){wsUtil.deleteInterval("shakeBtn")},startRotatePhoneIcons:function(){if(s.btnText){var e=1e3;w.btn.hasClass("cbk-phone-wild")&&(e=3e3),w.btn.hasClass("cbk-phone")&&_this.initBtnText(),w.btn.find(".cbk-phone-content div.cbk-rotate-icon").length||w.btn.find(".cbk-phone-content div:first").addClass("cbk-rotate-icon"),wsUtil.setInterval("rotatePhoneIcons",(function(){if(w.btn.hasClass("cbk-pulse"))w.btn.find(".cbk-phone-content div").removeClass("cbk-rotate-icon");else{var e=!1;w.btn.find(".cbk-phone-content div.cbk-rotate-icon").is(":last-child")&&(e=!0),e?(w.btn.find(".cbk-phone-content div").removeClass("cbk-rotate-icon"),w.btn.find(".cbk-phone-content div:first").addClass("cbk-rotate-icon")):w.btn.find(".cbk-phone-content div.cbk-rotate-icon").removeClass("cbk-rotate-icon").next().addClass("cbk-rotate-icon")}w.btn.hasClass("cbk-phone")&&_this.initBtnText()}),s.timeouts.rotatePhoneIcons*e)}else w.btn.find(".cbk-phone-text").remove()},stopRotatePhoneIcons:function(){s.btnText?(w.btn.removeClass("cbk-phone-text-none"),wsUtil.deleteInterval("rotatePhoneIcons"),w.btn.find(".cbk-rotate-icon").removeClass("cbk-rotate-icon"),_this.initBtnText()):w.btn.addClass("cbk-phone-text-none")},getBackground:function(e){var t=e.css("background-color"),i=parseFloat(t.split(",")[3],10);return(isNaN(i)||i>.8)&&"transparent"!==t?t:!e.is("body")&&_this.getBackground(e.parent())},getLuma:function(e){var t=e.substring(4,e.length-1).split(",");return.2126*t[0]+.7152*t[1]+.0722*t[2]},showError:function(e,t){e.is("input")||e.is("div")?(e.addClass("cbk-error"),"pc"==WBK.settings.device&&e.addClass("cbk-error").focus()):e.is("select")||(e=e.parent());var i=$('<div class="cbk-error-text">'+t+"</div>"),n=e;s.usePhoneMask||"cbkPhoneInput"!==e[0].id&&"cbkPhoneDeferredInput"!==e[0].id||!$(e[0]).closest(".ws-dcpi_dropdown").length||(n=$(e[0]).closest(".ws-dcpi_dropdown").closest(".cbk-form-field")),n.after(i),setTimeout((function(){i.fadeOut(500,(function(){$(this).remove(),e.removeClass("cbk-error")}))}),2e3),$("#cbkPhoneBtn").show()},hideErorrs:function(){w.window.find(".cbk-error-text").remove(),w.window.find(".cbk-error").removeClass("cbk-error")},initBtn:function(){"btn"==s.btnType&&s.btnText&&($(".cbk-btn .cbk-title").html(s.btnText),$(".cbk-btn .cbk-title").css("font-size",s.btnFontSize)),"extended_btn"==s.btnType&&"pc"==WBK.settings.device&&(s.btnText?w.extended_btn.find(".ws-btn-title").html(s.btnText):w.extended_btn.addClass("ws-killer-text-none")),_this.initBtnText(),w.btn.hasClass("cbk-phone")?("pc"==WBK.settings.device&&(_this.startRotatePhoneIcons(),w.btn.on("mouseenter.callbackkiller",(function(e){_this.isTouchDevice()||(wsUtil.deleteTimeout("cbkPhonePulse"),w.btn.removeClass("cbk-pulse"),_this.stopRotatePhoneIcons())})).on("mouseleave.callbackkiller",(function(e){_this.isTouchDevice()||(w.btn.find(".cbk-phone-phone").addClass("cbk-rotate-icon"),_this.startRotatePhoneIcons())})).on("dragstart",(function(e){e.preventDefault()})).on("mousedown.callbackkiller",(function(e){1===e.which&&(s.dragObject.elem=_this.widget.btn,s.dragObject.downX=e.pageX,s.dragObject.downY=e.pageY)})).on("mouseup.callbackkiller",(function(e){if(s.dragObject.dragStarted){s.dragObject.dragStarted=!1;var t=new Date;t.setSeconds(t.getSeconds()+1),wsUtil.setCookie("WhiteCallback_noClickOnPhone",1,t)}s.dragObject={}}))),$(document).on("mouseup.callbackkiller",(function(e){if(s.dragObject.dragStarted){s.dragObject.dragStarted=!1;var t=new Date;t.setSeconds(t.getSeconds()+1),wsUtil.setCookie("WhiteCallback_noClickOnPhone",1,t)}s.dragObject={}})),$(document).on("mousemove.callbackkiller",(function(e){if(s.dragObject.elem){var t=e.pageX-s.dragObject.downX,i=e.pageY-s.dragObject.downY;if(Math.abs(t)<3&&Math.abs(i)<3)return;s.dragObject.dragStarted||(s.dragObject.oldPosition={left:s.dragObject.elem.position().left||"",top:s.dragObject.elem.position().top||""},s.dragObject.shiftX=s.dragObject.downX-s.dragObject.elem.position().left,s.dragObject.shiftY=s.dragObject.downY-s.dragObject.elem.position().top,s.dragObject.dragStarted=!0),s.dragObject.elem.css({left:e.pageX-s.dragObject.shiftX+"px",top:e.pageY-s.dragObject.shiftY+"px",right:"auto",bottom:"auto"})}}))):s.btnNoPulse||_this.startShakeBtn()},initBtnText:function(){if($(".cbk-phone .cbk-phone-text").length){if(s.btnText){var e=new Array,t="",i=0,n=0;for(e=s.btnText.split(" "),n=0;n<e.length;n++)e[n].length>t.length&&(t=e[n]);"sm"===s.btnSize||"xs"===s.btnSize?t.length>10?i=70:t.length>8?i=80:t.length>6&&(i=90):t.length>10?i=80:t.length>8&&(i=85),i?$(".cbk-phone .cbk-phone-text").html($("<span>").addClass("cbk-font-size-"+i).html(s.btnText)):$(".cbk-phone .cbk-phone-text").html(s.btnText)}if($(".cbk-phone").is(":visible")?$(".cbk-phone .cbk-phone-text").css("marginTop",($(".cbk-phone").outerHeight()-$(".cbk-phone .cbk-phone-text").outerHeight())/2):($(".cbk-phone").show(),$(".cbk-phone .cbk-phone-text").css("marginTop",($(".cbk-phone").outerHeight()-$(".cbk-phone .cbk-phone-text").outerHeight())/2),$(".cbk-phone").hide()),s.btnTextAdd){e=new Array,t="",i=0,n=0;for(e=s.btnTextAdd.split(" "),n=0;n<e.length;n++)e[n].length>t.length&&(t=e[n]);"sm"===s.btnSize||"xs"===s.btnSize?t.length>10?i=70:t.length>8?i=80:t.length>6&&(i=90):t.length>10?i=80:t.length>8&&(i=90),i?$(".cbk-phone .cbk-phone-phone").addClass("cbk-phone-with-text").html($("<span>").addClass("cbk-font-size-"+i).html(s.btnTextAdd)):$(".cbk-phone .cbk-phone-phone").addClass("cbk-phone-with-text").html(s.btnTextAdd),$(".cbk-phone").is(":visible")?$(".cbk-phone .cbk-phone-phone").css("marginTop",($(".cbk-phone").outerHeight()-$(".cbk-phone .cbk-phone-phone").outerHeight())/2):($(".cbk-phone").show(),$(".cbk-phone .cbk-phone-phone").css("marginTop",($(".cbk-phone").outerHeight()-$(".cbk-phone .cbk-phone-phone").outerHeight())/2),$(".cbk-phone").hide())}}},initPhonePosition:function(){if("pc"!=WBK.settings.device)_this.updateBtnPositionMobile();else if("phone"==s.btnType){if(s.btnStaticOnScroll){$(window).width();w.btn.stop().css({left:s.phonePositionRight>=50?100-s.phonePositionRight+"%":"auto",right:s.phonePositionRight<50?s.phonePositionRight+"%":"auto",bottom:s.phonePositionBottom<=50?s.phonePositionBottom+"%":"auto",top:s.phonePositionBottom>50?100-s.phonePositionBottom+"%":"auto"})}else{var e=$(window).scrollTop(),t=window.innerHeight,i=s.phonePositionBottom,n=s.phonePositionRight,a=t-t*i/100+e;i<50&&(a-=w.btn.outerHeight()),w.btn.stop().css({bottom:"auto",top:a+"px",left:n>=50?100-n+"%":"auto",right:n<50?n+"%":"auto"})}w.btn.stop().css({transform:"scale(1)"})}else if("btn"==s.btnType){var o={};"left"===s.btnPosition||"right"===s.btnPosition?(o.top=s.phonePositionBottom>50?100-s.phonePositionBottom+"%":"auto",o.bottom=s.phonePositionBottom<=50?s.phonePositionBottom+"%":"auto",s.phonePositionBottom>50?o.marginTop=-w.btn.outerHeight():o.marginBottom=w.btn.outerWidth()):(o.left=s.phonePositionRight>=50?100-s.phonePositionRight+"%":"auto",o.right=s.phonePositionRight<50?s.phonePositionRight+"%":"auto"),w.btn.stop().css(o)}else if("extended_btn"==s.btnType){o={bottom:s.phonePositionBottom<=50?s.phonePositionBottom+"%":"auto",top:s.phonePositionBottom>50?100-s.phonePositionBottom+"%":"auto",right:s.phonePositionRight<50?s.phonePositionRight+"%":"auto",left:s.phonePositionRight>=50?100-s.phonePositionRight+"%":"auto"};switch(w.btn.show(),s.btnExtendedPosition){case"horizontal":100==s.phonePositionBottom?w.extended_btn.addClass("ws-killer-btn-attach-top"):0==s.phonePositionBottom&&w.extended_btn.addClass("ws-killer-btn-attach-bottom");break;case"vertical_left":w.extended_btn_container.addClass("ws-killer-btn-left"),w.extended_btn.addClass("ws-killer-btn-attach-top"),s.phonePositionBottom>50?o.marginTop=w.extended_btn.outerWidth():o.marginBottom=-w.extended_btn.outerHeight();break;case"vertical_right":w.extended_btn_container.addClass("ws-killer-btn-right"),w.extended_btn.addClass("ws-killer-btn-attach-bottom"),w.extended_btn.show(),s.phonePositionBottom>50?o.marginTop=-w.extended_btn.outerHeight():o.marginBottom=w.extended_btn.outerWidth()}w.btn.hide(),w.extended_btn_container.stop().css(o)}},updatePhonePosition:function(){if("mobile"===WBK.settings.device&&1!=s.hideBtn&&s.btnShow)_this.updateBtnPositionMobile();else if("tablet"===WBK.settings.device&&1!=s.hideBtn&&s.btnShow)_this.updateBtnPositionMobile();else if("phone"==s.btnType)if(s.btnStaticOnScroll)s.btnNoPulse||"pc"!=WBK.settings.device||(w.btn.addClass("cbk-pulse"),wsUtil.setTimeout("cbkPhonePulse",(function(){w.btn.removeClass("cbk-pulse"),w.btn.find(".cbk-phone-phone").addClass("cbk-rotate-icon")}),1e3*s.timeouts.phonePulse));else{var e=$(window).scrollTop(),t=window.innerHeight,i=s.phonePositionBottom,n=s.phonePositionRight,a=t-t*i/100+e;i<50&&(a-=w.btn.outerHeight()),w.btn.stop().animate({left:n>50?100-n+"%":"auto",right:n<50?n+"%":"auto",top:a+"px",bottom:"auto"},350,(function(){s.btnNoPulse||"pc"!=WBK.settings.device||(w.btn.addClass("cbk-pulse"),wsUtil.setTimeout("cbkPhonePulse",(function(){w.btn.removeClass("cbk-pulse"),w.btn.find(".cbk-phone-phone").addClass("cbk-rotate-icon")}),1e3*s.timeouts.phonePulse)),"wild"===s.animation&&w.btn.addClass("cbk-phone-wild")}))}},updateBtnPositionMobile:function(){var e=wsUtil.getRatio(),t=.57*e;s.scallingMobile=1!=e;var i,n={ratio:t,positionX:s.btnMobilePositionHorizontalType,positionY:s.btnMobilePositionVerticalType,positionXValue:"right"===s.btnMobilePositionHorizontalType?100-s.btnMobilePositionHorizontal:s.btnMobilePositionHorizontal,positionYValue:"bottom"===s.btnMobilePositionVerticalType?100-s.btnMobilePositionVertical:s.btnMobilePositionVertical};s.scallingMobile?(w.btn.removeClass("envy-not-scalling"),n.el=w.btn,i=wsUtil.getMobileScalePositionWidget(n),w.btn.css(i)):(w.btn.addClass("envy-not-scalling"),i=wsUtil.getMobileNotScalePositionWidget(n),w.btn.css(i)),1!=s.hideBtn&&s.btnShow&&(w.btn.show(),w.btn.removeClass("btn-hide"))},onResizeWindow:function(){if(w.window.hasClass("cbk-window-modal")){var e=w.window.width(),t=(window.innerWidth-e)/2;t<0&&(t=0);var i=w.window.height(),n=(window.innerHeight-i)/2;n<0&&(n=0),w.window.css("left",t+"px"),w.window.css("top",n+"px")}if(s.killerLogo&&"custom"==s.killerLogoStyle&&(s.customLogoWidth&&s.customLogoHeight&&s.customLogoPositionTop&&(w.window.hasClass("cbk-window-modal")||w.window.hasClass("cbk-window-onexit")?(w.window.find(".cbk-window-logo").addClass("cbk-custom-logo"),w.window.find(".cbk-window-logo").css("width",""),w.window.find(".cbk-window-logo").css("height",""),w.window.find(".cbk-window-logo").css("top",0),w.window.find(".cbk-window-logo").css("marginLeft",0)):(w.window.find(".cbk-window-logo").addClass("cbk-custom-logo").css("width",s.customLogoWidth),w.window.find(".cbk-window-logo").addClass("cbk-custom-logo").css("height",s.customLogoHeight),w.window.hasClass("cbk-window-bottom")&&!w.window.hasClass("cbk-window-modal")&&w.window.hasClass("cbk-window-onexit")?(w.window.find(".cbk-window-logo").css("top",s.customLogoPositionTop+"px"),w.window.find(".cbk-window-logo").css("marginLeft",w.window.offsetWidth()-617-s.customLogoWidth/2)):(w.window.find(".cbk-window-logo").css("top",s.customLogoPositionTop+"px"),w.window.find(".cbk-window-logo").css("marginLeft",-s.customLogoWidth/2)))),"show"==s.logoShadow&&WBK.addStyles(".cbk-window-logo.cbk-custom-logo{box-shadow: 0 3px 12px rgba(0, 0, 0, 0.15)!important;}")),"pc"!=WBK.settings.device){w.window.find("div.cbk-window-logo").css({margin:"20px auto 0",position:"initial"}),w.window.find("div.cbk-form").css("marginTop",20);var a=w.window.find("div.cbk-forms"),o=w.window.find("div.cbk-form:visible").outerHeight(!0),r=w.window.find("div.cbk-window-logo:visible")?w.window.find("div.cbk-window-logo:visible").outerHeight(!0):0,l=0;window.innerHeight>o+r&&(l=(window.innerHeight-o-r)/2);var c=w.window.find(".cbk-copyright");a.css("marginTop",0),c.css("margin-top",0),c.css("margin-top","-"+c.outerHeight()+"px");var d=o+r+l+c.outerHeight();d<window.innerHeight?d=window.innerHeight:$(".callbackkiller-mobile .cbk-copyright").attr("style","display: none !important"),w.window.find(".cbk-background").attr("style","height:"+d+"px !important"),s.btnHideMobileZoom&&s.scallingMobile&&"pc"!=WBK.settings.device&&w.btn.hide()}else{a=w.window.find("div.cbk-forms");if(3!==s.windowPosition){s.formHeight||(s.formHeight=w.window.find("div.cbk-form:visible").height(),a.height(s.formHeight),w.window.find("div.cbk-forms").height(s.formHeight));var h=0;!s.killerLogo||w.window.hasClass("cbk-window-modal")||w.window.hasClass("cbk-window-onexit")||(h=120);l=((w.window.hasClass("cbk-window-modal")||w.window.hasClass("cbk-window-onexit")||$.fn._frameCheck()?a.parent().height():window.innerHeight)-a.height()+h)/2;a.css("marginTop",l),a.css("margin")}}_this.updatePhonePosition()},onScroll:function(){var e=this;if(3==s.hideBtn&&!s.btnShow){var t=$(window).scrollTop()/($(document).height()-$(window).height())*100;WBK.settings.windowOpened||WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||WBK.settings.windowLoanerOpened||WBK.settings.windowQuizOpened||!(s.btnShowScroll<=t)||(s.btnShow=!0,w.btn.show())}s.btnHideMobileZoom&&"pc"!=WBK.settings.device&&w.btn.addClass("btn-hide"),s.btnStaticOnScroll||"wild"!==s.animation||w.btn.removeClass("cbk-phone-wild"),wsUtil.setTimeout("scrollTimer",(function(){e.updatePhonePosition()}),250)},initCallTimer:function(){"hide"!=s.timerType?(w.window.find("div.cbk-timer").html('<span class="cbk-number">00</span><span class="cbk-d">:</span><span class="cbk-number cbk-number-sec">'+(s.callTimeout-1)+'</span><span class="cbk-d">:</span><span class="cbk-number cbk-number-msec">99</span>'),"seconds"==s.timerType&&(w.window.find("div.cbk-callform").find(".cbk-d").last().hide(),w.window.find("div.cbk-departmentform").find(".cbk-d").last().hide(),w.window.find("div.cbk-timer").find(".cbk-number-msec").hide())):w.window.find("div.cbk-timer").hide()},initWidget:function(){WBK.loadFont();var e=t.phone,i="",n="";if("pc"==WBK.settings.device){if("btn"===s.btnType&&(e=t.btn,"left"===s.btnPosition?i="cbk-btn-left":"top"===s.btnPosition?i="cbk-btn-top":"right"===s.btnPosition&&(i="cbk-btn-right")),"phone"===s.btnType&&(s.btnStaticOnScroll&&(i="cbk-phone-fixed "),"sm"===s.btnSize?i+="cbk-phone-sm":"xs"===s.btnSize&&(i+="cbk-phone-xs"),s.animation&&"pulse"===s.animation?(i+=" cbk-phone-pulse",WBK.addStyles(".callbackkiller.cbk-phone.cbk-phone-pulse{--box-shadow-color: 0 9px 16px "+s.btnColor+"!important;}")):!s.animation||"wild"!==s.animation&&"waves"!==s.animation||(i+=" cbk-phone-"+s.animation)),"extended_btn"===s.btnType)switch(e=t.extended_btn,s.btnExtendedCorner){case"smooth":default:i+="ws-killer-btn-mini-round";break;case"round":i+="ws-killer-btn-round";break;case"flat":i+=""}"vertical_left"==s.btnExtendedPosition&&(n+="ws-killer-btn-left"),"vertical_right"==s.btnExtendedPosition&&(n+="ws-killer-btn-right")}else{var a="";"bg"===s.mobileBtnSize?a+="cbk-phone-mobile-bg":"xs"===s.mobileBtnSize&&(a+="cbk-phone-mobile-xs")}w.btn=$(e).addClass(i);var o=w.btn;if("extended_btn"===s.btnType&&"pc"==WBK.settings.device&&(w.extended_btn=w.btn.find(".ws-killer-btn").addClass(i),w.extended_btn_container=w.btn.find(".ws-killer-btn-container"),w.extended_btn_container.addClass(n),o=w.extended_btn),"pc"!=WBK.settings.device&&w.btn.addClass(a),o.click((function(e){if(!wsUtil.getCookie("WhiteCallback_noClickOnPhone")){s.dragObject={};var t=new Date;t.setMinutes(t.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onbtn",t),_this.showWindow("btn"),_this.sendGoal("showonbtn")}return e.preventDefault(),!1})),w.btn.appendTo("body"),w.btn.hide(),"pc"!=WBK.settings.device&&w.btn.addClass("envy-not-scalling"),1!=s.hideBtn)if(_this.initPhonePosition(),_this.initBtn(),2==s.hideBtn){var r=s.timeouts.btnShowTimeout;if("site"===s.timeouts.paused_sec_target){var l=wsUtil.getCookie("WhiteCallback_timeAll");l&&(+l<+r?r-=l:r=0)}wsUtil.setTimeout("btnShowTimeout",(function(){s.btnShow=!0,WBK.settings.windowOpened||WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||WBK.settings.chatWindowOpened||WBK.settings.windowLoanerOpened||WBK.settings.windowQuizOpened||w.btn.show()}),1e3*r)}else 0==s.hideBtn&&(s.btnShow=!0,WBK.settings.windowOpened||WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||WBK.settings.chatWindowOpened||WBK.settings.chatInvitationOpened||WBK.settings.windowLoanerOpened||WBK.settings.windowQuizOpened||w.btn.show());w.windowbgr=$(t.windowbgr).hide().click((function(e){return s.killerCloseClickBgr&&_this.hideWindow(),e.preventDefault(),!1})).appendTo("body"),s.siteBgrColor&&w.windowbgr.css("background-color",s.siteBgrColor),s.killerTransparentBgr&&w.windowbgr.addClass("cbk-window-bgr-transparent"),w.window=$(t.window).hide().find("a.cbk-close-window").click((function(e){return _this.hideWindow(),e.preventDefault(),!1})).end().appendTo("body"),s.killerLogo&&$(t.windowlogo).html($("<img/>").attr("src",WBK.settings.staticServerUrl+s.killerLogo)).prependTo(w.window.find(".cbk-forms")),"extended_btn"==s.btnType&&s.killerBtnLogo&&"pc"==WBK.settings.device&&w.extended_btn.addClass("ws-killer-logo-yes").find(".ws-killer-logo-img").attr("src",WBK.settings.staticServerUrl+s.killerBtnLogo+"?v="+s.killerUpdatedAt),"pc"==WBK.settings.device&&(1===s.windowPosition?w.window.addClass("cbk-window-left"):2===s.windowPosition&&w.window.addClass("cbk-window-modal")),WBK.settings.hideCopyright?w.window.find("a.cbk-copyright").remove():$("body").on("click","a.cbk-copyright",(function(e){WBK.sendAdvertLinkStat($(this).data("widget"),$(this).attr("href"),$(this).text(),WBK.settings.killerId)})),s.windowBtnTextOnline&&w.window.find("#cbkPhoneBtn").html(s.windowBtnTextOnline),s.windowBtnTextOffline&&w.window.find("#cbkPhoneDeferredBtn").html(s.windowBtnTextOffline),s.hideDefered&&w.window.find(".cbk-link-btn").hide(),3==s.windowPosition&&$(".cbk-form.cbk-callform").addClass("cbk-forms-bottom"),w.window.find("div.cbk-form").hide(),$("#cbkCallDeferredTime").change((function(){_this.setPhoneInputFocus()})),$("#cbkPhoneBtn").click((function(e){e.preventDefault(),_this.hideErorrs();var t=$("#cbkPhoneInput").val(),i=$("#cbkNameInput").val().trim(),n=$("#cbkEmailInput").val();WBK.settings.phoneMask=$("#cbkPhoneInput").attr("placeholder"),WBK.settings.smartToken=w.window.find("input[name='smart-token']").val();var a=!0;if("required"===s.contactNameInput&&(a=a&&i),"none"!==s.contactNameInput&&0!==i.length&&(a=a&&i.length>=2),"required"===s.contactEmailInput&&(a=a&&n),a=a&&t)if(t=_this.checkPhoneWithUseMaskSetting(t,"cbkPhoneInput")){if(!$.fn._frameCheck()){var o=window.top.location.hash.match(/\#callbackwidget\_(.*)/),r=!(!o||!o[1])&&decodeURI(o[1]);r&&(s.use_custom_text_from_hash=r),window.top.location.hash=""}if(s.useDepartment){if(s.callToPhone=t,s.callToPhoneIsDeferred=!1,!$.fn._frameCheck()){var l=window.top.location.hash.match(/\#callbackwidget\-(.*)/),c=!(!l||!l[1])&&decodeURI(l[1]);if(c){var d=!1;if($.each(s.departments,(function(e){s.departments[e].department&&s.departments[e].department==c&&(d=!0)})),d)return WBK.settings.visitorName=i.charAt(0).toUpperCase()+i.substr(1,i.length-1),WBK.settings.visitorEmail=n,_this.callToPhone(s.callToPhone,c,"",_this.executeActionAfterRequest),void(window.top.location.hash="")}}$("#cbkDepartmentRadioButtons").empty().remove(),$("#cbkDepartment").empty().remove();var h=$('<select id="cbkDepartment" class="cbk-select"></select>'),u=$('<div id="cbkDepartmentRadioButtons"></div>'),g=!1;if($.each(s.departments,(function(e){s.departments[e].department&&""!=s.departments[e].department&&($(u).append($('<div class="ws-radio-button"><input id="radio'+e+'" name="cbkDepartmentRadio"'+(0==e?' checked="" ':"")+'type="radio" class="radio" value="'+s.departments[e].department+'"><label for="radio'+e+'" style="-webkit-line-clamp:unset">'+s.departments[e].department+"</label></div>")),$(h).append($('<option style="word-break: break-word;overflow-wrap: break-word;text-align:left">').val(s.departments[e].department).text(s.departments[e].department)))})),s.departments.length<=4)$(".cbk-departmentform .cbk-form-title").after(u),$(".cbk-departmentform").height()>$(".cbk-forms").height()&&(g=!0,$(".cbk-departmentform  #cbkDepartmentRadioButtons").remove());(s.departments.length>4||g)&&$(".cbk-departmentform .cbk-form-title").after(h),w.window.find("div.cbk-form").hide();var p=w.window.find("div.cbk-departmentform");"none"!=s.timerType&&p.find("div.cbk-timer").show(),_this.setFormText(w.window.find("div.cbk-departmentform .cbk-form-title"),s.text.killerText[s.killerWorking].department[WBK.settings.hasVisitorName]),p.show(),WBK.animateOnce(p,"cbk-fadeIn",(function(){"pc"==WBK.settings.device&&WBK.animateOnce(p.find("div.cbk-form-title"),"cbk-bounce")})),_this.onResizeWindow()}else WBK.settings.visitorName=i.charAt(0).toUpperCase()+i.substr(1,i.length-1),WBK.settings.visitorEmail=n,_this.callToPhone(t,"","",_this.executeActionAfterRequest)}else _this.showError($("#cbkPhoneInput"),s.text.cbkErrorNoPhone);else("required"===s.contactNameInput&&!i||"none"!==s.contactNameInput&&0!==i.length&&i.length<2)&&_this.showError($("#cbkNameInput"),s.text.cbkErrorNoName),"required"!==s.contactEmailInput||n||_this.showError($("#cbkEmailInput"),s.text.cbkErrorNoEmail),t||_this.showError($("#cbkPhoneInput"),s.text.cbkErrorNoPhone);return!1})),$("#cbkDepartmentBtn").click((function(e){_this.hideErorrs();var t=s.departments.length<=4?$('input[name="cbkDepartmentRadio"]:checked').val():$("#cbkDepartment").val();if(s.callToPhoneIsDeferred)_this.callToPhoneAt(s.callToPhone,$("#cbkCallDeferredTime option:selected").attr("data-date"),$("#cbkCallDeferredTime").val(),t);else{var i=$("#cbkNameInput").val();WBK.settings.visitorName=i.charAt(0).toUpperCase()+i.substr(1,i.length-1),WBK.settings.visitorEmail=$("#cbkEmailInput").val(),_this.callToPhone(s.callToPhone,t,"",_this.executeActionAfterRequest)}return e.preventDefault(),!1})),w.window.find("div.cbk-callform .cbk-button-no").click((function(e){_this.hideErorrs(),w.window.find("div.cbk-form").hide(),_this.checkWorkTime(),_this.setWorkDays(),w.window.find("div.cbk-cdform .cbk-form-title").html(s.text.cbkCallLaterTitle),_this.personalizeForms();var t=w.window.find("div.cbk-cdform");return t.show(),WBK.animateOnce(t,"cbk-fadeIn",(function(){"pc"==WBK.settings.device&&WBK.animateOnce(t.find("div.cbk-form-title"),"cbk-bounce")})),w.window.find(".cbk-cdform .cbk-personal-agreement span").html(s.windowBtnTextOffline),_this.onResizeWindow(),_this.setPhoneInputFocus(),e.preventDefault(),!1})),$("#cbkPhoneDeferredBtn").click((function(e){_this.hideErorrs();var t=$("#cbkPhoneDeferredInput").val();if(WBK.settings.phoneMask=$("#cbkPhoneDeferredInput").attr("placeholder"),WBK.settings.smartToken=w.window.find("input[name='smart-token']").val(),t){if(t=_this.checkPhoneWithUseMaskSetting(t,"cbkPhoneDeferredInput"))if(s.useDepartment){s.callToPhone=t,s.callToPhoneIsDeferred=!0,$("#cbkDepartmentRadioButtons").empty(),$("#cbkDepartment").remove();var i=$('<select id="cbkDepartment" class="cbk-select"></select>'),n=$('<div id="cbkDepartmentRadioButtons"></div>'),a=!1;if($.each(s.departments,(function(e){s.departments[e].department&&""!=s.departments[e].department&&($(n).append($('<div class="ws-radio-button"><input id="radio'+e+'" name="cbkDepartmentRadio"'+(0==e?' checked="" ':"")+'type="radio" class="radio" value="'+s.departments[e].department+'"><label for="radio'+e+'" style="-webkit-line-clamp:unset">'+s.departments[e].department+"</label></div>")),$(i).append($('<option style="word-break: break-word;overflow-wrap: break-word;text-align:left">').val(s.departments[e].department).text(s.departments[e].department)))})),s.departments.length<=4)$(".cbk-departmentform .cbk-form-title").after(n),$(".cbk-departmentform").height()>$(".cbk-forms").height()&&(a=!0,$(".cbk-departmentform  #cbkDepartmentRadioButtons").remove());(s.departments.length>4||a)&&$(".cbk-departmentform .cbk-form-title").after(i),w.window.find("div.cbk-form").hide();var o=w.window.find("div.cbk-departmentform");o.find("div.cbk-timer").hide(),_this.setFormText(w.window.find("div.cbk-departmentform .cbk-form-title"),s.text.killerText[s.killerWorking].department[WBK.settings.hasVisitorName]),o.show(),WBK.animateOnce(o,"cbk-fadeIn",(function(){"pc"==WBK.settings.device&&WBK.animateOnce(o.find("div.cbk-form-title"),"cbk-bounce")})),_this.onResizeWindow()}else _this.callToPhoneAt(t,$("#cbkCallDeferredTime option:selected").attr("data-date"),$("#cbkCallDeferredTime").val())}else _this.showError($("#cbkPhoneDeferredInput"),s.text.cbkErrorNoPhone);return e.preventDefault(),!1})),w.window.find("div.cbk-crqform .cbk-button-yes").click((function(e){return _this.callAfterForm(!0),_this.onResizeWindow(),e.preventDefault(),!1})),w.window.find("div.cbk-crqform .cbk-button-no").click((function(e){w.window.find("div.cbk-form").hide(),_this.setFormText(w.window.find("div.cbk-naform .cbk-form-title"),s.text.killerText[1].no_connect[WBK.settings.hasVisitorName]),_this.personalizeForms();var t=w.window.find("div.cbk-naform");return t.show(),WBK.animateOnce(t,"cbk-fadeIn",(function(){"pc"==WBK.settings.device&&WBK.animateOnce(t.find("div.cbk-form-title"),"cbk-bounce")})),_this.onResizeWindow(),e.preventDefault(),!1})),_this.masksPhoneData.newMask&&s.usePhoneMask?($("#cbkPhoneInput, #cbkPhoneDeferredInput").on("keydown",(function(e){var t=e.currentTarget,i=e.key;_this.masksPhoneData.pasted["#"+t.id]=!1;var n=$(t).val().length,a=(e.ctrlKey||e.metaKey)&&86===e.keyCode,s=(e.ctrlKey||e.metaKey)&&65===e.keyCode,o=(e.ctrlKey||e.metaKey)&&88===e.keyCode;if(!n&&!_this.masksPhoneData.inited["#"+t.id]){if(!parseInt(i)&&!a)return void e.preventDefault();if("7"===i||"8"===i)$(t).val("7"),e.preventDefault(),_this.initInputMask(t);else if("9"===i)$(t).val("7"),_this.initInputMask(t);else if(WBK.settings.phoneBasesCountries&&-1==WBK.settings.phoneBasesCountries.indexOf(i)&&!a)return $(t).val(""),void e.preventDefault()}var r="";(r=window.getSelection?window.getSelection().toString():document.selection.createRange().text)||(r=t.value.substring(t.selectionStart,t.selectionEnd));var l=(r=r.replace(/[^0-9]/g,""))&&r.length===n;l&&("8"===i?($(t).val("7"),wsUtil.setCaretPosition($(t),3,3),e.preventDefault()):"9"===i&&($(t).val("7"),wsUtil.setCaretPosition($(t),3,3))),1!==n&&!l||"Control"==e.key||"Meta"==e.key||!_this.masksPhoneData.inited["#"+t.id]||"Backspace"!==i&&!o||s||$("#cbkPhoneInput, #cbkPhoneDeferredInput").on("keyup",(function(e){_this.masksPhoneData.pasted["#"+t.id]||_this.removeMask(t)}))})),$("#cbkPhoneInput, #cbkPhoneDeferredInput").on("paste",(function(e){var t,i=e.currentTarget;if(window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.originalEvent.clipboardData&&e.originalEvent.clipboardData.getData&&(t=e.originalEvent.clipboardData.getData("text")),t){var n=_this.formatNumberForRussia(t);n?(_this.masksPhoneData.pasted["#"+i.id]=!0,11===this.value.length?this.value=n:this.value+=n,_this.checkToInitInputMask(this,e)):e.preventDefault()}}))):(_this.initInputMask("#cbkPhoneInput"),_this.initInputMask("#cbkPhoneDeferredInput")),_this.initInputMask(".cbk-phone-checker",!0),$("#cbkPhoneInput").bind("keydown",(function(e){13===e.keyCode&&$("#cbkPhoneBtn").click()})),$("#cbkPhoneDeferredInput").bind("keydown",(function(e){13===e.keyCode&&$("#cbkPhoneDeferredBtn").click()})),$("#cbkCallDeferredDate").change((function(){_this.setWorkTimes(),_this.setPhoneInputFocus()})),w.window.find(".cbk-ink-reaction").on("click",(function(e){var t=_this.getBackground($(this)),i=_this.getLuma(t)>183?" inverse":"",n=$('<div class="cbk-ink'+i+'"></div>'),a=$(this).offset(),s=e.pageX-a.left,o=e.pageY-a.top;n.css({top:o,left:s}).appendTo($(this)),wsUtil.setTimeout("cbkInkReactionTimout",(function(){n.remove()}),1500)})),WBK.settings.hideCopyright||"pc"!=WBK.settings.device||WBK.settings.thisIsCallbackKILLER||wsUtil.setInterval("animateCopyright",(function(){WBK.animateOnce(w.window.find("a.cbk-copyright"),"cbk-tada")}),1e3*s.timeouts.animateCopyright),$(window).on("resize.callbackkiller",(function(){_this.onResizeWindow()})),$(window).on("scroll.callbackkiller",(function(){_this.onScroll()})),wsUtil.deleteCookie("WhiteCallback_timePage"),WBK.pageIdentAdd(WBK.pageIdent),WBK.pageIdentGetMainPage()?WBK.pageIdentObserve():WBK.pageIdentSetMainPage(WBK.pageIdent),"tablet"!=WBK.settings.device&&(s.noShowOnExit||$("body").mouseleave((function(e){var t={x:e.pageX,y:e.pageY-$(document).scrollTop()};if(t.y<=10){var i=s.showOnExitApperanceTimeout;if(s.showOnExitAlways&&(i=0),!WBK.settings.windowOpened&&!WBK.settings.windowGeneratorOpened&&!WBK.settings.videoWidgetOpened&&!WBK.settings.chatWindowOpened&&!WBK.settings.chatInvitationOpened&&!WBK.settings.windowLoanerOpened&&!WBK.settings.windowQuizOpened&&(1!=parseInt(wsGenerator.settings.showExit)||wsUtil.getCookie("WhiteGenerator_show_"+WBK.settings.generatorId)||wsUtil.getCookie("WhiteGenerator_success_closed_"+WBK.settings.generatorId)||wsUtil.getCookie("WhiteGenerator_closed_"+WBK.settings.generatorId))&&!wsUtil.getCookie("WhiteCallback_noShowOnExit")&&parseInt(wsUtil.getCookie("WhiteCallback_timePage"))>parseInt(i)){s.showOnExitXPosition=t.x;var n=new Date;n.setMinutes(n.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onexit",n),_this.showWindow("exit")}i||wsUtil.deleteCookie("WhiteCallback_noShowWindow")}})),wsUtil.getCookie("WhiteCallback_noShowWindow")||s.noShowWindow||WBK.settings.chatWindowOpened||wsUtil.setTimeout("showWindowOnTimer",(function(){if(!wsUtil.getCookie("WhiteCallback_noShowWindow")&&(wsUtil.getCookie("WhiteCallback_noShowOnExit")&&!s.showWindowReapperanceTimeout||!wsUtil.getCookie("WhiteCallback_noShowOnExit"))&&(_this.checkWorkTime(),!WBK.settings.windowOpened)){var e=new Date;e.setMinutes(e.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onshow",e),_this.showWindow("auto")}}),1e3*s.showWindowApperanceTimeout),_this.checkWorkTime()),"pc"!=WBK.settings.device&&(w.btn.addClass("callbackkiller-mobile"),w.window.addClass("callbackkiller-mobile"),$(window).on("envy:resize",(function(){_this.onResizeWindow()}))),$("body").on("click.callbackwidget",'a[href="#callbackwidget"], a[href="'+window.top.location.origin+'#callbackwidget"], a[href="'+window.top.location.origin+'/#callbackwidget"], a[href="#callbackkiller"], a[href="'+window.top.location.origin+'#callbackkiller"], a[href="'+window.top.location.origin+'/#callbackkiller"]',(function(e){return"extended_btn"==s.btnType&&"pc"==WBK.settings.device?w.extended_btn.click():w.btn.click(),e.preventDefault(),!1})),$("body").on("click.callbackwidget",'a[href="#callbackwidgetmodal"], a[href="'+window.top.location.origin+'#callbackwidgetmodal"], a[href="'+window.top.location.origin+'/#callbackwidgetmodal"], a[href="#callbackwidgetmodal"], a[href="'+window.top.location.origin+'#callbackkillermodal"], a[href="'+window.top.location.origin+'/#callbackkillermodal"]',(function(e){var t=new Date;return t.setMinutes(t.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onbtn",t),_this.showWindow("modal"),e.preventDefault(),!1})),s.useDepartment&&Object.keys(s.departments).map((function(e,t){var i=s.departments[e];$("body").on("click.callbackwidget",'a[href="#callbackwidget-'+i.department+'"], a[href="'+window.top.location.origin+"#callbackwidget"+i.department+'"], a[href="'+window.top.location.origin+"/#callbackwidget"+i.department+'"]',(function(e){return $.fn._frameCheck()||(window.location.hash="#callbackwidget-"+i.department),"extended_btn"==s.btnType&&"pc"==WBK.settings.device?w.extended_btn.click():w.btn.click(),e.preventDefault(),!1}))})),$("body").on("click.callbackwidget",'a[href^="#callbackwidget_"], a[href^="'+window.top.location.origin+'#callbackwidget_"], a[href^="'+window.top.location.origin+'/#callbackwidget_"]',(function(e){return $.fn._frameCheck()||(window.location.hash=$(this).attr("href")),"extended_btn"==s.btnType&&"pc"==WBK.settings.device?w.extended_btn.click():w.btn.click(),e.preventDefault(),!1})),$("body").keyup((function(e){WBK.settings.windowOpened&&27===e.keyCode&&_this.hideWindow()})),w.window.find("span.cbk-service-name").html(WBK.settings.servicename)},removeMask:function(e){$(e).val(""),$(e).inputmask("remove"),$(e).attr("placeholder",s.text.cbkPhoneInputPlaceholderText),this.masksPhoneData.inited["#"+e.id]=!1,$("#cbkPhoneInput, #cbkPhoneDeferredInput").off("keyup")},checkWorkTime:function(){if(s.killerWorkdays){var e=new Date;e.setTime(e.getTime()-1e3*s.timeDelta+60*e.getTimezoneOffset()*1e3+60*s.killerTimezone*60*1e3);var t=s.killerWorkdays.time_start[s.currentDay].split(":"),i=s.killerWorkdays.time_end[s.currentDay].split(":"),n=s.killerWorkdays.time_start[s.prevDay].split(":"),a=s.killerWorkdays.time_end[s.prevDay].split(":");if(s.killerIsPaused&&s.killerPausedStart&&s.killerPausedEnd){var o=s.killerPausedStart.split("."),r=new Date(parseInt(o[2]),parseInt(o[1])-1,parseInt(o[0]),e.getHours(),e.getMinutes(),e.getSeconds());r.setTime(r.getTime()-1e3*s.timeDelta+60*e.getTimezoneOffset()*1e3+60*s.killerTimezone*60*1e3);var l=s.killerPausedEnd.split("."),c=new Date(parseInt(l[2]),parseInt(l[1])-1,parseInt(l[0]),e.getHours(),e.getMinutes()+1,e.getSeconds());c.setTime(c.getTime()-1e3*s.timeDelta+60*e.getTimezoneOffset()*1e3+60*s.killerTimezone*60*1e3);var d=new Date(e.getFullYear(),e.getMonth(),e.getDate()).valueOf(),h=new Date(r.getFullYear(),r.getMonth(),r.getDate()).valueOf(),u=new Date(c.getFullYear(),c.getMonth(),c.getDate()).valueOf();d>=h&&d<=u&&(s.killerIsPausedNow=!0)}if(s.killerWorkdays.workdays[s.currentDay]&&"false"!==s.killerWorkdays.workdays[s.currentDay]&&!s.killerIsPausedNow)if((f=new Date(e.getTime())).setHours(t[0]),f.setMinutes(t[1]),f.setSeconds(0),s.shiftDayBeginning&&f.setHours(f.getHours()+s.shiftDayBeginning),(m=new Date(e.getTime())).setHours(i[0]),m.setMinutes(i[1]),m.setSeconds(0),parseInt(t[0])===parseInt(i[0])&&parseInt(t[1])===parseInt(i[1]))s.killerWorking=1;else if(e>f)if(e<m){s.killerWorking=1,s.killerWorkingToday=!0;var g=new Date,p=g.getHours(),w=g.getTimezoneOffset();p>=21&&w<-180&&(s.killerWorkingToday=!1)}else s.killerWorking=0,s.killerWorkingToday=!1;else s.killerWorking=0,s.killerWorkingToday=!0;else if(s.killerWorkdays.workdays[s.prevDay]&&"false"!==s.killerWorkdays.workdays[s.prevDay]&&parseInt(a[0])<parseInt(n[0])&&!s.killerIsPausedNow){var f,m;(f=new Date(e.getTime())).setDate(f.getDate()-1),f.setHours(n[0]),f.setMinutes(n[1]),f.setSeconds(0),(m=new Date(e.getTime())).setDate(m.getDate()-1),m.setHours(a[0]),parseInt(n[0])>parseInt(a[0])&&m.setHours(m.getHours()+24),m.setMinutes(a[1]),m.setSeconds(0),parseInt(n[0])===parseInt(a[0])&&parseInt(n[1])===parseInt(a[1])?s.killerWorking=1:e>f?e<m?(s.killerWorking=1,s.killerWorkingToday=!0):(s.killerWorking=0,s.killerWorkingToday=!1):(s.killerWorking=0,s.killerWorkingToday=!0)}else s.killerWorkingToday=!1}else s.killerWorking=0,s.killerWorkingToday=!1},setWorkTimes:function(){_this.checkWorkTime();var e=new Date;s.hourDelta=-e.getTimezoneOffset()/60-s.killerTimezone;var t=$("#cbkCallDeferredDate option:selected").attr("day-id"),i=s.workingDays[t].date;$("#cbkCallDeferredTime").empty();var n=s.workingDays[t].workTime,a=[];n.forEach((function(t){var n,s,o,r,l=t.startTime,c=t.endTime;l?(n=l.hours,s=l.minutes):(n=null,s=null),c?(o=c.hours,r=c.minutes):(o=null,r=null),s=null!=s&&0!==s?s:"00";var d=null!=o?o:24,h=null!=r&&"0"!==r?r:"00";59===h&&(d+=1);for(var u=n=null!=n?n:0;u<d;u++)if(!(i.getDate()===e.getDate()&&i.getMonth()===e.getMonth()&&u<=e.getHours())){var g=(u<10?"0"+u:u)+":"+(u===n?s:"00");a.push(g),$("#cbkCallDeferredTime").append($("<option>").val(g).text(g).attr("data-date",i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()))}if(null!=c){0===h||59===h?(d-=1,h="30"):30===h&&(h="00");var p=(d<10?"0"+d:d)+":"+h;if(a.some((function(e){return e===p})))return;a.push(p),$("#cbkCallDeferredTime").append($("<option>").val(p).text(p).attr("data-date",i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()))}}))},setWorkDays:function(){$("#cbkCallDeferredDate").empty(),s.workingDays={};var e,t,i,n,a,o,r,l={0:s.text.cbkMondayText,1:s.text.cbkTuesdayText,2:s.text.cbkWednesdayText,3:s.text.cbkThursdayText,4:s.text.cbkFridayText,5:s.text.cbkSaturdayText,6:s.text.cbkSundayText},c=new Date,d=new Date,h=new Date(d.getFullYear(),d.getMonth(),d.getDate()+7),u=[],g=new Date(d.getFullYear(),d.getMonth(),d.getDate()+4);d.setTime(d.getTime()-1e3*s.timeDelta+60*d.getTimezoneOffset()*1e3+60*s.killerTimezone*60*1e3);var p=-c.getTimezoneOffset()/60-s.killerTimezone;s.killerIsPaused&&s.killerPausedStart&&s.killerPausedEnd&&(e=s.killerPausedStart.split("."),t=new Date(parseInt(e[2]),parseInt(e[1])-1,parseInt(e[0])),i=s.killerPausedEnd.split("."),n=new Date(parseInt(i[2]),parseInt(i[1])-1,parseInt(i[0])));var w=function(){return s.killerWorkdays.workdays.some((function(e){return!0===e}))}.bind(this),f=function(){return u.some((function(e){return e.date<h}))}.bind(this),m=function(){return u.some((function(e){return e.date<g}))}.bind(this),v=function(e,t){return Math.round((t-e)/864e5)}.bind(this),_=function(e,t){return v(d,e)>=6?e.getDate()+" "+WBK.settings.months[e.getMonth()]:l[t]}.bind(this),b=function(e){if(void 0===t)return!1;var i=new Date(t.getFullYear(),t.getMonth(),t.getDate()),a=new Date(n.getFullYear(),n.getMonth(),n.getDate()),s=new Date(e.getFullYear(),e.getMonth(),e.getDate());return s>=i&&s<=a}.bind(this),k=function(e,t,i,n){var a,o=s.killerWorkdays[i][t].split(":");a=n?e.getDate()+n:e.getDate();var r=new Date(e.getFullYear(),e.getMonth(),a,parseInt(o[0]),parseInt(o[1]));if("time_start"===i){s.shiftDayBeginning&&r.setHours(r.getHours()+s.shiftDayBeginning);var l=new Date(d),c=30*Math.ceil(l.getMinutes()/30);l.setMinutes(c),l.setSeconds(0),r<l&&(r.setHours(l.getHours()),r.setMinutes(l.getMinutes()))}return r}.bind(this),y=function(e,t,i){for(var n=[],l=0;l<t;l++)if((r=(r=new Date(e.getFullYear(),e.getMonth(),e.getDate()+l).getDay())-1<0?6:r-1)>6&&(r-=7),s.killerWorkdays.workdays&&s.killerWorkdays.workdays[r]){var c=new Date(e.getFullYear(),e.getMonth(),e.getDate()+l);if(a=k(e,r,"time_start",l),o=k(e,r,"time_end",l),b(c))continue;if(o<=e)continue;n.push({date:c,startTime:a,endTime:o})}i&&(n=n.splice(0,i)),u=u.concat(n)}.bind(this),x=function(e,t){var i=t.startTime,n=t.endTime,a=!!t.hasOwnProperty("lastTime")&&t.lastTime;if(s.workingDays.hasOwnProperty(e))s.workingDays[e].workTime.push({startTime:i,endTime:n,lastTime:a});else{var o=t.date,r=t.dayNumber,l=t.dayName;s.workingDays[e]={date:o,dayNumber:r,dayName:l,workTime:[{startTime:i,endTime:n,lastTime:a}]}}}.bind(this);y(d,14),(s.killerIsPausedNow||!u.length&&s.killerIsPaused||!w())&&(w()||void 0!==n&&b(new Date(d.getFullYear(),d.getMonth(),d.getDate()+1))||(n=d),n=void 0===n||w()?new Date(n.getFullYear(),n.getMonth(),n.getDate()):new Date(n.getFullYear(),n.getMonth(),n.getDate()+1),u.length&&(u=u.filter((function(e){return e.date<n}))),w()?y(n,14,1):(r=n.getDay()-1<0?6:n.getDay()-1,u.push({date:n,startTime:k(n,r,"time_start"),endTime:k(n,r,"time_end")}))),u=(u=u.map((function(e){var t;return 0===e.endTime.getHours()&&0===e.endTime.getMinutes()&&(e.endTime.setMinutes(30),e.endTime.setSeconds(0)),(e.startTime.getTime()===e.endTime.getTime()||e.startTime.getTime()>e.endTime.getTime())&&(e.startTime=new Date(e.endTime),t=30*Math.floor(e.startTime.getMinutes()/30),e.startTime.setMinutes(t),e.startTime.setSeconds(0),e.startTime.setMinutes(e.startTime.getMinutes()-30)),{date:e.date,startTime:e.startTime,endTime:e.endTime}}))).filter((function(e){return e.startTime.getTime()>d.getTime()})),u=f()?u.filter((function(e){return e.date<h})):u.filter((function(e,t){return 0===t})),m()&&(u=u.filter((function(e){return e.date<g}))),u.forEach((function(e){var t=new Date(e.startTime.getFullYear(),e.startTime.getMonth(),e.startTime.getDate(),e.startTime.getHours()+p,e.startTime.getMinutes()),i=new Date(e.endTime.getFullYear(),e.endTime.getMonth(),e.endTime.getDate(),e.endTime.getHours()+p,e.endTime.getMinutes()),n=t.getDate()+"-"+t.getMonth()+"-"+t.getFullYear(),a=i.getDate()+"-"+i.getMonth()+"-"+i.getFullYear(),s=t.getDay()-1<0?6:t.getDay()-1,o=i.getDay()-1<0?6:i.getDay()-1;if(n===a)x(n,{date:t,dayNumber:s,dayName:_(t,s),startTime:{hours:t.getHours(),minutes:t.getMinutes()},endTime:{hours:i.getHours(),minutes:i.getMinutes()}});else{var r=0===i.getHours()&&0===i.getMinutes();if(x(n,{date:t,dayNumber:s,dayName:_(t,s),startTime:{hours:t.getHours(),minutes:t.getMinutes()},endTime:r?{hours:23,minutes:59}:null}),r)return;x(a,{date:i,dayNumber:o,dayName:_(i,o),startTime:null,endTime:{hours:i.getHours(),minutes:i.getMinutes()}})}}));for(var C=Object.keys(s.workingDays),W=0;W<C.length;W++){var B=C[W],I=s.workingDays[B].date.getFullYear()+"-"+(s.workingDays[B].date.getMonth()+1)+"-"+s.workingDays[B].date.getDate();$("#cbkCallDeferredDate").append($("<option>").attr("day-id",B).val(I).text(s.workingDays[B].dayName))}C.length&&_this.setWorkTimes()},initKiller:function(){_this._initKiller(),wsUtil.setTimeout("cbkInitKilerTimout",(function(){_this._initKiller()}),3e3)},_initKiller:function(){if(WBK.settings.callbackEnabled&&s.killerFormCall){if("ru-mod.ru"===window.location.hostname&&"/emarket/cart/"===window.location.pathname)return!1;var e='form:not(".callbackwidget-not-call-form")';2===s.killerFormCall&&(e="form.callbackwidget-call-form, form.callbackkiller-call-form"),_debug&&console.log("Forms to check:"),_debug&&console.log($(document).find(e)),$(document).find(e).off("submit.cbk").on("submit.cbk",(function(){_this.checkFormOnSubmit(this)}));try{$(document).find("iframe").each((function(){var t=this;try{t.contentWindow&&t.contentDocument&&(_debug&&console.log("Forms in frame to check:"),_debug&&console.log($(t.contentWindow.document).find(e)),$(t.contentWindow.document).find(e).off("submit.cbk").on("submit.cbk",(function(){_this.checkFormOnSubmit(this)})))}catch(e){}}))}catch(e){}}$(document).find("input, select").each((function(){var e=$(this).attr("type");"button"!==e&&"submit"!==e&&"radio"!==e&&"checkbox"!==e&&($(this).off("focus.callbackkiller").on("focus.callbackkiller",(function(){s.noShowWindow=!0})),$(this).off("blur.callbackkiller").on("blur.callbackkiller",(function(){s.noShowWindow=!1})))})),$(document).find("iframe").each((function(){var e=this;try{e.contentWindow&&e.contentDocument&&$(e.contentWindow.document).find("input, select").each((function(){var e=$(this).attr("type");"button"!==e&&"submit"!==e&&"radio"!==e&&"checkbox"!==e&&($(this).off("focus.callbackkiller").on("focus.callbackkiller",(function(){s.noShowWindow=!0})),$(this).off("blur.callbackkiller").on("blur.callbackkiller",(function(){s.noShowWindow=!1})))}))}catch(e){}})),_this.startCheckNeedToCall()},checkFormOnSubmit:function(e){_debug&&console.log("Form submitted:"),_debug&&console.log($(e)),_this.checkWorkTime(),$(e).find("input").each((function(){var t=$(this).attr("type");if("button"!==t&&"submit"!==t&&"radio"!==t&&"checkbox"!==t&&"file"!==t&&"image"!==t&&"password"!==t&&"hidden"!==t){var i=$(this).val();if(WBK.settings.phoneMask="+_(___)___-__-__",i)if(i=WBK.checkPhone($(this).val())){var n=new Date;n.setMinutes(n.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onform",n);var a=$(e).find("input.callbackwidget-name").val(),o=$(e).find("input.callbackwidget-email").val(),r=$(e).find(".callbackwidget-department"),l=!1;if(s.useDepartment&&r.length)switch(r.attr("type")){case"radio":case"checkbox":l=$(e).find(".callbackwidget-department:checked").val();break;default:l=r.val()}""==a&&""==o||WBK.setVisitorData({name:a,email:o}),WBK.settings.phoneMask=$(".cbk-phone-checker:first").attr("placeholder"),wsUtil.setCookie("WhiteCallback_needcall",!0),wsUtil.setCookie("WhiteCallback_needcall_phone",i),l&&wsUtil.setCookie("WhiteCallback_needcall_department",l)}}}))},startCheckNeedToCall:function(){_this.checkNeedToCall(),wsUtil.setInterval("checkNeedToCall",(function(){_this.checkNeedToCall()}),1e3*s.timeouts.needToCall)},checkNeedToCall:function(){if(wsUtil.getCookie("WhiteCallback_needcall")){_this.checkWorkTime();var e=wsUtil.getCookie("WhiteCallback_needcall_phone"),t=wsUtil.getCookie("WhiteCallback_needcall_department");if(s.killerWorking){if(s.killerFormCallHide){if(s.showWindowReapperanceTimeout)(i=new Date).setDate(i.getDate()+parseInt(s.showWindowReapperanceTimeout)),wsUtil.setCookie("WhiteCallback_noShowWindow",1,i);else wsUtil.setCookie("WhiteCallback_noShowWindow",1);var i=new Date;s.showOnExitAlways?i.setSeconds(i.getSeconds()+3):i.setMinutes(i.getMinutes()+parseInt(s.showOnExitReapperanceTimeout)),wsUtil.setCookie("WhiteCallback_noShowOnExit",1,i)}else _this.showWindow("auto");if(s.callingFromForm=!0,_this.setWorkDays(),$("#cbkPhoneInput").val(e),this.initNoUsePhoneMaskDialCodeDropdownInputs(),s.phoneMask=$("#cbkPhoneInput").attr("placeholder"),wsUtil.deleteCookie("WhiteCallback_needcall"),wsUtil.deleteCookie("WhiteCallback_needcall_phone"),wsUtil.deleteCookie("WhiteCallback_needcall_department"),s.auto_call_deffered&&s.auto_call_deffered_delay_value)(i=new Date).setMinutes(i.getMinutes()+s.auto_call_deffered_delay_value),_this.deferredCall(e,i.getFullYear()+"-"+(i.getMonth()+1<10?"0":"")+(i.getMonth()+1)+"-"+(i.getDate()<10?"0":"")+i.getDate(),(i.getHours()<10?"0":"")+i.getHours()+":"+(i.getMinutes()<10?"0":"")+i.getMinutes(),t),"onform"==wsUtil.getCookie("WhiteCallback_shownOn")&&38835==WBK.settings.siteId?(_this.sendGoal("form"),_this.sendGoal("form")):_this.sendGoal("call");else _this.callToPhone(e,t)}else _this.setWorkDays(),_this.deferredCall(e,$("#cbkCallDeferredTime option:first").attr("data-date"),$("#cbkCallDeferredTime option:first").text(),t),wsUtil.deleteCookie("WhiteCallback_needcall"),wsUtil.deleteCookie("WhiteCallback_needcall_phone"),wsUtil.deleteCookie("WhiteCallback_needcall_department"),"onform"==wsUtil.getCookie("WhiteCallback_shownOn")&&38835==WBK.settings.siteId?_this.sendGoal("form"):_this.sendGoal("call")}},callAfterForm:function(e){if(s.managerRatingCheck&&e){_this.initRating(),w.window.find("div.cbk-form").hide();var t=w.window.find("div.cbk-ratingform");t.show(),WBK.animateOnce(t,"cbk-fadeIn",(function(){"pc"==WBK.settings.device&&WBK.animateOnce(t.find("div.cbk-form-title"),"cbk-bounce")}))}else _this.congratulationsForm()},congratulationsForm:function(){w.window.find("div.cbk-form").hide();var e=w.window.find("div.cbk-shareform"),t=s.killerHasMoney;!t&&s.killerIsPayed&&s.killerCallOff&&(t=1);var i=s.text.cbkShareTitle[s.killerWorking][t][WBK.settings.hasVisitorName];!s.killerCallOff&&"hide"==s.timerType&&s.calling&&(i=s.text.cbkCallTitleOnHideTimer),w.window.find("div.cbk-shareform .cbk-form-title").html(i),_this.personalizeForms(),w.window.find(".cbk-form-title").show(),e.show(),WBK.animateOnce(e,"cbk-fadeIn",(function(){"pc"==WBK.settings.device&&WBK.animateOnce(e.find("div.cbk-form-title"),"cbk-bounce")})),_this.onResizeWindow()},initRating:function(){var e=w.window.find("ul.cbk-call-rating");e.find("a").unbind("mouseenter.callbackkiller").unbind("mouseleave.callbackkiller").unbind("click.callbackkiller").removeClass("cbk-marked"),e.find("a").on("mouseenter.callbackkiller",(function(){for(var e=$(this).data("value"),t=1;t<=e;t++)$("#cbkRating"+t).addClass("cbk-marked")})).on("mouseleave.callbackkiller",(function(){e.find("a").removeClass("cbk-marked")})).on("click.callbackkiller",(function(e){var t=WBK.settings.serverUrl+"/api?action=rating&callback=?",i=$(this).data("value");return jWS.getJSON(t,{code:WBK.settings.whiteSaasCode,rating:i,callId:s.callId,killerId:WBK.settings.killerId,visitorId:WBK.settings.visitorId},(function(e){})),_this.callAfterForm(!1),_this.onResizeWindow(),e.preventDefault(),!1}))},personalizeForms:function(){var e=this,t=s.callTimeout+"&nbsp;"+wsUtil.doEnding(s.callTimeout,s.text.cbkSecond1,s.text.cbkSecond2,s.text.cbkSecond3);w.window.find("div.cbk-form-title").each((function(){$(this).html($(this).html().replace(/\[time\]/g,t))})),this.initNoUsePhoneMaskDialCodeDropdownInputs(),WBK.settings.visitorPhone?(s.usePhoneMask&&($("#cbkPhoneInput").val(WBK.settings.visitorPhone),$("#cbkPhoneDeferredInput").val(WBK.settings.visitorPhone)),s.usePhoneMask||($("#cbkPhoneInput").val(w.wsDCPI.parseCountry(WBK.settings.visitorPhone,"cbkPhoneInput").value),$("#cbkPhoneDeferredInput").val(w.wsDCPI.parseCountry(WBK.settings.visitorPhone,"cbkPhoneDeferredInput").value)),e.masksPhoneData.newMask&&(e.initInputMask("#cbkPhoneInput"),e.initInputMask("#cbkPhoneDeferredInput"))):e.masksPhoneData.newMask&&$("#cbkPhoneInput, #cbkPhoneDeferredInput").attr("placeholder",s.text.cbkPhoneInputPlaceholderText),WBK.settings.visitorEmail&&$("#cbkEmailInput").val(WBK.settings.visitorEmail),WBK.settings.visitorName?(w.window.find("span.cbk-visitor-name").replaceWith($("<a>").addClass("cbk-change-name").addClass("cbk-button-no").addClass("cbk-button-no-dark").attr("href","javascript:void(0)").html(WBK.settings.visitorName)),w.window.find(".cbk-visitor-name-no-link").text(WBK.settings.visitorName),$("#cbkNameInput").val(WBK.settings.visitorName),w.window.find("div.cbk-form-title").each((function(){$(this).html($(this).html().replace(/\[name\]/g,"<a href='javascript:void(0)' class='cbk-change-name cbk-button-no cbk-button-no-dark'>"+WBK.settings.visitorName+"</a>"))}))):(w.window.find(".cbk-visitor-name-to-delete").remove(),w.window.find("div.cbk-form-title").each((function(){$(this).html($(this).html().replace("[name]",""))}))),w.window.find("a.cbk-copyright").attr("href",s.cbkLink),w.window.find("a.cbk-agreement-link").attr("href",s.agreementLink),WBK.settings.thisIsCallbackKILLER&&w.window.find("a.cbk-copyright").addClass("cbk-copyright-callbackkiller").html(s.text.cbkCopyrightEnvybox)},setPhoneInputFocus:function(){var e="cbkPhoneInput",t=[77,38,39,44,48],i=[380,358,992,375,373,972,971];$("div.cbk-cdform:visible").length&&(e="cbkPhoneDeferredInput"),"pc"===WBK.settings.device&&$("#"+e).focus(),s.usePhoneMask&&($("#"+e).val()||s.calling||(""!==WBK.settings.phoneBase?(_this.masksPhoneData.newMask||$("#"+e).val(WBK.settings.phoneBase),"pc"==WBK.settings.device&&(_this.masksPhoneData.newMask||(7===WBK.settings.phoneBase&&wsUtil.setCaretPosition($("#"+e),3,3),i.includes(WBK.settings.phoneBase)&&wsUtil.setCaretPosition($("#"+e),5,5),t.includes(WBK.settings.phoneBase)&&wsUtil.setCaretPosition($("#"+e),4,4)))):"pc"!=WBK.settings.device||_this.masksPhoneData.newMask||wsUtil.setCaretPosition($("#"+e),2,2)),"pc"!=WBK.settings.device&&(!_this.masksPhoneData.newMask&&s.usePhoneMask&&$("#"+e).off("focus.caretPosition").on("focus.caretPosition",(function(){!s.calling&&$("#"+e).val().length<4&&(""!==WBK.settings.phoneBase?($("#"+e).val(WBK.settings.phoneBase),7===WBK.settings.phoneBase&&wsUtil.setCaretPosition($("#"+e),3,3),t.includes(WBK.settings.phoneBase)&&wsUtil.setCaretPosition($("#"+e),4,4),i.includes(WBK.settings.phoneBase)&&wsUtil.setCaretPosition($("#"+e),5,5)):wsUtil.setCaretPosition($("#"+e),2,2))})),(s.killerLogo||"required"==s.contactNameInput&&"required"==s.contactEmailInput||navigator.userAgent.match(/iPad|iPhone/gi))&&_this.animateToInput(e),$(window).off("orientationchange.cbkWindow").on("orientationchange.cbkWindow",(function(){setTimeout((function(){window.innerWidth>window.innerHeight&&(s.killerLogo||"required"==s.contactNameInput&&"required"==s.contactEmailInput)&&_this.animateToInput(e)}),500,e)})),!s.calling&&$("#"+e).val().length<4&&$("#"+e).focus()))},getCheckerPhoneMask:function(){var e=w.window.find(".cbk-phone-checker:first");e.length&&(WBK.settings.phoneMask=e.attr("placeholder"))},setFormText:function(e,t){e.html(_this.formatText(t))},formatText:function(e){var t=WBK.replaceTagVariant(e.title);t=WBK.replaceGetParamText(t);var i=WBK.replaceTagVariant(e.text);return i=WBK.replaceGetParamText(i),WBK.settings.geoCity&&(WBK.settings.geoCity.name||(WBK.settings.geoCity.name=WBK.settings.geoCity.ip_city),t&&(t=t.replace(/\[geocity1\]/g,WBK.settings.geoCity.name).replace(/\[geocity2\]/g,WBK.settings.geoCity.name_rod).replace(/\[geocity3\]/g,WBK.settings.geoCity.name_mes).replace(/\[geocity4\]/g,WBK.settings.geoCity.name_vin)),i&&(i=i.replace(/\[geocity1\]/g,WBK.settings.geoCity.name).replace(/\[geocity2\]/g,WBK.settings.geoCity.name_rod).replace(/\[geocity3\]/g,WBK.settings.geoCity.name_mes).replace(/\[geocity4\]/g,WBK.settings.geoCity.name_vin))),t=t.replace(/\[name\]/g,WBK.settings.visitorName),i=i.replace(/\[name\]/g,WBK.settings.visitorName),e.title&&e.text?t=t+"<br/><small>"+i+"</small>":!e.title&&e.text&&(t="<small>"+i+"</small>"),t},sendGoal:function(e){if(s.killerIsPayed){var t,i,n=!1,a="CallbackWidget",o=!1;switch(WBK.settings.thisIsCallbackKILLER&&(a="CallbackKILLER"),e){case"call":t=WBK.settings.thisIsCallbackKILLER?"CBK_CALL":"CBW_CALL",i="NewCall",n="callback",o="NewCall",wsUtil.sendUniversalGoal();break;case"showonbtn":t=WBK.settings.thisIsCallbackKILLER?"CBK_SHOW_ON_BTN":"CBW_SHOW_ON_BTN",i="ShowOnBtn";break;case"showauto":t=WBK.settings.thisIsCallbackKILLER?"CBK_SHOW_AUTO":"CBW_SHOW_AUTO",i="ShowAuto";break;case"showonexit":t=WBK.settings.thisIsCallbackKILLER?"CBK_SHOW_ON_EXIT":"CBW_SHOW_ON_EXIT",i="ShowOnExit";break;case"form":t=WBK.settings.thisIsCallbackKILLER?"CBK_CALL_ON_FORM":"CBW_CALL_ON_FORM",i="NewCallOnForm",wsUtil.sendUniversalGoal()}wsUtil.sendGoal(t,i,a,n,o)}},callToPhone:function(e,t,i,n){if(s.use_custom_text_from_hash&&(i=s.use_custom_text_from_hash,s.use_custom_text_from_hash=!1),e=this.checkPhoneWithUseMaskSetting(e,"cbkPhoneInput"),_this.getCheckerPhoneMask(),e&&!s.calling){s.calling=!0,s.callStarted=!0,$("#cbkPhoneBtn, .cbk-personal-agreement").css("display","none");var a=w.window.find(s.usePhoneMask?"#cbkPhoneInput":".ws-dcpi_dropdown:visible");a&&a.attr("style","display: none!important");var o=(new Date).getTime(),r=wsUtil.generateHash(o,WBK.settings.visitorId),l={phone:e,name:WBK.settings.visitorName?WBK.settings.visitorName.trim():"",email:WBK.settings.visitorEmail,department:t||"",customtext:i||($('meta[name="callbackkiller:customtext"]').length?$('meta[name="callbackkiller:customtext"]').attr("content"):""),phoneMask:WBK.settings.phoneMask,shownOn:wsUtil.getCookie("WhiteCallback_shownOn"),url:"string"==typeof document.URL?document.URL:"",device:WBK.settings.device,code:WBK.settings.whiteSaasCode,visitorId:WBK.settings.visitorId,visitId:WBK.settings.visitId,googleClientId:wsUtil.getGoogleClientId(),killerId:WBK.settings.killerId,generatorId:WBK.settings.generatorId,quizId:WBK.settings.quizId,invader_id:WBK.settings.invaderId,invaderStatId:WBK.settings.invaderCallbackStatId,instinct_id:WBK.settings.instinctId,instinctStatId:WBK.settings.instinctCallbackStatId,generatorLeadId:WBK.settings.genLeadId,roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId(),leadvertexId:wsUtil.getLeadvertexId(),externalParams:wsUtil.getExternalParams(),checkCaptcha:WBK.settings.checkCaptcha,smartToken:WBK.settings.smartToken,hashTime:o,hash:r};s.usePhoneMask||(l.phone_country_prefix=w.wsDCPI.getSelectedCountryByInputKey("cbkPhoneInput").key);var c=WBK.settings.serverUrl+"/api?action=call";$.post(c,l,(function(t){"function"==typeof window.ws_OnCallbackOnlineCall&&window.ws_OnCallbackOnlineCall(l),s.callingWidget=!1,WBK.settings.genLeadId=!1,WBK.settings.visitorPhone=e,WBK.settings.called=!0,_this.onCall(t,l),void 0!==n&&n(t)}),"json")}},executeActionAfterRequest:function(e){e.Success&&!e.Errors&&_this.executeActionAfterCall()},executeActionAfterCall:function executeActionAfterCall(){if(s.killerSendAction&&"none"!==s.killerSendAction)switch(s.killerSendAction){case"go_url":if(s.killerSendActionUrl){var match=wsUtil.parseURL(s.killerSendActionUrl);switch(match.scheme||(s.killerSendActionUrl="http://"+s.killerSendActionUrl),s.killerPageOpenType){case"new_page":window.open(s.killerSendActionUrl,"_blank");break;case"current":window.location.href=s.killerSendActionUrl}}break;case"go_javascript":s.killerSendActionJavascript&&eval(s.killerSendActionJavascript)}},onCapcha:function(e){WBK.settings.checkCaptcha=!0,window.smartCaptcha?window.smartCaptcha.reset():wsUtil.getScript("https://smartcaptcha.yandexcloud.net/captcha.js",(function(){var t={sitekey:e.key,hl:"ru"};if(window.smartCaptcha){var i=w.window.find("#cbk-captcha-container")[0];window.smartCaptcha.render(i,t)}})),w.window.find("#cbk-captcha-container").show()},onCall:function(e,t){if(e.Success||!e.Errors||s.callingFromForm){if(e.Success&&e.Data.noWorkTime&&!s.callingFromForm)e.Data.killerWorkdays&&(s.killerWorkdays=e.Data.killerWorkdays),e.Data.killerIsPaused&&(s.killerIsPaused=e.Data.killerIsPaused),e.Data.killerPausedStart&&(s.killerPausedStart=e.Data.killerPausedStart),e.Data.killerPausedEnd&&(s.killerPausedEnd=e.Data.killerPausedEnd),e.Data.killerPausedDay&&(s.killerPausedDay=e.Data.killerPausedDay),s.calling=!1,s.callStarted=!1,_this.showWindow("auto",!0);else if(e.Success&&e.Data.callId){if(WBK.settings.checkCaptcha=!1,w.window.find("#cbk-captcha-container").hide(),s.callingFromForm&&(s.killerFormCallHide||_this.showWindow("auto",!1),w.window.find("div.cbk-callform .cbk-form-title").html(s.text.cbkCallTitleOnFormCall),$("#cbkPhoneBtn").hide()),e.Data.callId){s.callId=e.Data.callId;var i=new Date;i.setMinutes(i.getMinutes()+15),wsUtil.setCookie("WhiteCallback_callId",s.callId,i),WBK.initSocket()}if(s.killerHasMoney)if(parseInt(e.Data.callOff))_this.congratulationsForm(),s.calling=!1,s.callStarted=!1;else{if(!w.window.find("div.cbk-callform:visible").length)w.window.find("div.cbk-form").hide(),w.window.find("div.cbk-callform").show();w.window.find("div.cbk-callform .cbk-link-btn .cbk-button-no").hide(),w.window.find(".cbk-form-title").hide(),w.window.find(".cbk-window-logo").hide(),w.window.find("#cbkNameInput").attr("style","display: none!important"),w.window.find("#cbkEmailInput").attr("style","display: none!important");var n=s.usePhoneMask?"#cbkPhoneInput":".ws-dcpi_dropdown:visible";w.window.find(n).attr("style","display: none!important"),w.window.find(".cbk-timer").addClass("call"),s.calling=!0,"hide"==s.timerType?_this.callAfterForm(!0):(w.window.find(".cbk-text-after-call").show(),wsUtil.setInterval("callTimerAnimation",(function(){var e=w.window.find("div.cbk-callform .cbk-timer .cbk-number-sec"),t=w.window.find("div.cbk-callform .cbk-timer .cbk-number-msec"),i=parseInt(e.text()),a=parseInt(t.text());if(--a<1&&(i--,a=99),i<1){wsUtil.deleteInterval("callTimerAnimation"),s.calling=!1,w.window.find(".cbk-timer").removeClass("call"),w.window.find(".cbk-window-logo").show(),w.window.find(".cbk-text-after-call").hide(),w.window.find(".cbk-form-title").show(),w.window.find(n).attr("style","display: inline-block!important"),w.window.find("div.cbk-form").hide();var o=w.window.find("div.cbk-crqform");o.show(),WBK.animateOnce(o,"cbk-fadeIn",(function(){"pc"==WBK.settings.device&&WBK.animateOnce(o.find("div.cbk-form-title"),"cbk-bounce")})),_this.onResizeWindow(),a=0,i=0}i<10&&(i="0"+i),a<10&&(a="0"+a),e.text(i),t.text(a)}),10))}else _this.congratulationsForm();"onform"!=wsUtil.getCookie("WhiteCallback_shownOn")||38835!=WBK.settings.siteId&&53201!=WBK.settings.siteId&&19381!=WBK.settings.siteId&&38333!=WBK.settings.siteId&&31073!=WBK.settings.siteId?_this.sendGoal("call"):_this.sendGoal("form")}}else s.useDepartment&&_this.showError($(s.departments.length<=4?"#cbkDepartmentRadioButtons":"#cbkDepartment"),e.Errors[0]),s.calling?($(".cbk-personal-agreement").show(),s.usePhoneMask?$("#cbkPhoneInput").show():$("#cbkPhoneInput").closest(".ws-dcpi_dropdown").css("display","flex"),_this.showError($("#cbkPhoneInput"),e.Errors[0]),e.captcha&&_this.onCapcha(e)):_this.showError($("#cbkPhoneDeferredInput"),e.Errors[0]),s.calling=!1,s.callStarted=!1},newCall:function(e,t,i,n){var a,o;if((e=this.checkPhoneWithUseMaskSetting(e,"cbkPhoneInput"))&&!s.calling)if($(".callbackwidget-name").each((function(){$(this).val()&&(a=$(this).val())})),$(".callbackwidget-email").each((function(){$(this).val()&&(o=$(this).val())})),(a||o)&&WBK.setVisitorData({name:a,email:o,phone:e}),WBK.settings.phoneMask=w.window.find(".cbk-phone-checker:first").attr("placeholder"),_this.setWorkDays(),s.killerWorking||t)if(i&&n){var r=new Date;r.setMinutes(r.getMinutes()+n),_this.deferredCall(e,r.getFullYear()+"-"+(r.getMonth()+1<10?"0":"")+(r.getMonth()+1)+"-"+(r.getDate()<10?"0":"")+r.getDate(),(r.getHours()<10?"0":"")+r.getHours()+":"+(r.getMinutes()<10?"0":"")+r.getMinutes()),_this.sendGoal("call")}else _this.callToPhone(e);else _this.deferredCall(e,$("#cbkCallDeferredTime option:first").attr("data-date"),$("#cbkCallDeferredTime option:first").text()),_this.sendGoal("call")},callToPhoneAt:function(e,t,i,n,a){(e=this.checkPhoneWithUseMaskSetting(e,"cbkPhoneDeferredInput"))&&(s.callStarted=!0,_this.deferredCall(e,t,i,n,a,(function(e){if(!e.Success&&e.Errors)_this.showError($("#cbkPhoneDeferredInput"),e.Errors[0]),e.captcha&&_this.onCapcha(e),s.calling=!1;else if(e.Success){if(WBK.settings.checkCaptcha=!1,w.window.find("#cbk-captcha-container").hide(),e.Data.callId){s.callId=e.Data.callId;var t=new Date;t.setMinutes(t.getMinutes()+15),wsUtil.setCookie("WhiteCallback_callId",s.callId,t)}_this.congratulationsForm(),_this.onResizeWindow(),_this.executeActionAfterCall(),"onform"==wsUtil.getCookie("WhiteCallback_shownOn")&&38835==WBK.settings.siteId?_this.sendGoal("form"):_this.sendGoal("call")}})))},deferredCall:function(e,t,i,n,a,o){if(e=this.checkPhoneWithUseMaskSetting(e,"cbkPhoneDeferredInput"),this.getCheckerPhoneMask(),e){var r=(new Date).getTime(),l=wsUtil.generateHash(r,WBK.settings.visitorId),c={phone:e,department:n||"",customtext:a||($('meta[name="callbackkiller:customtext"]').length?$('meta[name="callbackkiller:customtext"]').attr("content"):""),phoneMask:WBK.settings.phoneMask,shownOn:wsUtil.getCookie("WhiteCallback_shownOn"),url:"string"==typeof document.URL?document.URL:"",device:WBK.settings.device,code:WBK.settings.whiteSaasCode,visitorId:WBK.settings.visitorId,visitId:WBK.settings.visitId,googleClientId:wsUtil.getGoogleClientId(),killerWorking:s.killerWorking,hourDelta:s.hourDelta,date:t,time:i,killerId:WBK.settings.killerId,generatorId:WBK.settings.generatorId,quizId:WBK.settings.quizId,generatorLeadId:WBK.settings.genLeadId,invader_id:WBK.settings.invaderId,invaderStatId:WBK.settings.invaderCallbackStatId,instinct_id:WBK.settings.instinctId,instinctStatId:WBK.settings.instinctCallbackStatId,roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId(),leadvertexId:wsUtil.getLeadvertexId(),externalParams:wsUtil.getExternalParams(),checkCaptcha:WBK.settings.checkCaptcha,smartToken:WBK.settings.smartToken,hashTime:r,hash:l};s.usePhoneMask||(c.phone_country_prefix=w.wsDCPI.getSelectedCountryByInputKey("cbkPhoneDeferredInput").key);var d=WBK.settings.serverUrl+"/api?action=calldeferred";jWS.post(d,c,(function(e){"function"==typeof window.ws_OnCallbackDeferredCall&&window.ws_OnCallbackDeferredCall(c),void 0!==o&&o(e),WBK.settings.genLeadId=!1,WBK.settings.called=!0}),"json")}},onCallStatus:function(e){if(parseInt(e.site_id)===WBK.settings.siteId&&parseInt(e.call_id)===parseInt(s.callId))if(1===parseInt(e.call_status)&&"hide"!=s.timerType){if(WBK.settings.windowOpened||(!s.callingFromForm||s.callingFromForm&&!s.killerFormCallHide)&&_this.showWindow("auto"),w.window.find("div.cbk-callform").is(":visible")&&(w.window.find("div.cbk-callform .cbk-form-title").html(s.text.cbkCallTitleCalling),w.window.find(".cbk-text-after-call").hide(),w.window.find(".cbk-form-title").show(),_this.personalizeForms(),"pc"==WBK.settings.device)){var t=w.window.find("div.cbk-callform");WBK.animateOnce(t.find("div.cbk-form-title"),"cbk-bounce")}}else if(2===parseInt(e.call_status))w.window.find(".cbk-form-title").show(),WBK.settings.windowOpened||(!s.callingFromForm||s.callingFromForm&&!s.killerFormCallHide)&&_this.showWindow("auto"),wsUtil.deleteInterval("callTimerAnimation"),s.calling=!1,_this.callAfterForm(!0),_this.onResizeWindow();else if(4===parseInt(e.call_status)){w.window.find(".cbk-text-after-call").hide(),w.window.find(".cbk-form-title").show(),WBK.settings.windowOpened||(!s.callingFromForm||s.callingFromForm&&!s.killerFormCallHide)&&_this.showWindow("auto"),wsUtil.deleteInterval("callTimerAnimation"),w.window.find(".cbk-timer").hide(),s.calling=!1,w.window.find("div.cbk-form").hide();t=w.window.find("div.cbk-callform");WBK.settings.hasVisitorName?t.find("div.cbk-form-title").html(s.text.cbkCallTitleFail[1][1]):t.find("div.cbk-form-title").html(s.text.cbkCallTitleFail[1][0]),_this.personalizeForms(),t.show(),"pc"==WBK.settings.device&&WBK.animateOnce(t.find("div.cbk-form-title"),"cbk-bounce")}},setDefaultText:function(){s.text={cbkBtnTitle:"Закажите звонок",cbkCopyright:"Хочу <span class='cbk-service-name'></span> на свой сайт",cbkCopyrightEnvybox:"<span class='ws-copyright-text'>Сделано в </span><img class='ws-copyright-img' src='"+WBK.settings.staticServerUrl+"/img/logo/envybox_widget.png'>",cbkCallTitleCalling:"<span class='cbk-visitor-name'>Мы</span><span class='cbk-visitor-name-to-delete'>, мы</span> уже звоним Вам, возьмите трубку!",cbkCallTitleNoTariff:"Здравствуйте<span class='cbk-visitor-name-to-delete'>, </span><span class='cbk-visitor-name'></span>!<br/>Оставьте номер, и мы Вам перезвоним!",cbkCallTitleNoTariffOnExit:"<span class='cbk-visitor-name'>Не</span><span class='cbk-visitor-name-to-delete'>, не</span> нашли что искали? Оставьте номер, и мы Вам перезвоним!",cbkCallTitleOnFormCall:"Спасибо!<br/><small>Мы сейчас с Вами свяжемся!</small>",cbkCallTitleOnHideTimer:"Спасибо за заказ звонка,<br/><small> мы свяжемся с Вами в ближайшее время!</small>",cbkDepartmentTitle:{0:{0:"Выберите с кем хотите связаться:",1:"[name], выберите с кем хотите связаться:"},1:{0:"Выберите с кем хотите связаться:",1:"[name], выберите с кем хотите связаться:"}},cbkCallTitleFail:{1:{0:"Мы не можем до вас дозвониться, давайте проверим ваш номер!",1:"Мы не можем до вас дозвониться [name], давайте проверим ваш номер!"}},cbkPhoneInputPlaceholderText:"Введите телефон",cbkDepartmentBtnTitle:"Жду звонка!",cbkPhoneBtnTitle:"Позвоните мне!",cbkPhoneDeferredBtnTitle:"Жду звонка!",cbkSelectTimeIn:"в",cbkCallLaterBtnTitle:"Выбрать удобное время звонка",cbkCallResultQuestionTitle:"<span class='cbk-visitor-name'>Скажите</span>,<br/><small>Вам удалось начать разговор с менеджером?</small>",cbkAfterCall:"Ждите звонка",cbkYes:"Да",cbkNo:"Нет",cbkRatingTitle:"Оцените<br/><small>на сколько Вам понравилось общение с менеджером</small>",cbkSendCallToEmailTitle:"<span class='cbk-visitor-name'>Спасибо</span>,<br/><small>учтем оценку. Еще могу выслать Вам на email запись этого разговора через <span class='cbk-service-name'>"+WBK.settings.servicename+"</span>.</small>",cbkSendCallToEmailTitle2:"<span class='cbk-visitor-name'>Еще могу</span><span class='cbk-visitor-name-to-delete'>,</span><br/><small><span class='cbk-visitor-name-to-delete'>еще могу </span>выслать Вам на email запись этого разговора через <span class='cbk-service-name'>"+WBK.settings.servicename+"</span>.</small>",cbkEmailPlaceholder:"Введите email",cbkSendEmail:"Получить аудиозапись!",cbkNoThanks:"Нет, спасибо",cbkGetNameTitle:"Учтем оценку.<br/><small>Хотите в следующий раз мы будем обращаться к Вам по имени?</small>",cbkGetNameTitle2:"Хорошо,<br/><small>хотите в следующий раз мы будем обращаться к Вам по имени?</small>",cbkGetNameTitle3:"<span class='cbk-visitor-name-no-link'></span>,<br/><small>если вы не <span class='cbk-visitor-name-no-link'></span>, а представились шутливым именем, тогда укажите настоящее имя :)</small>",cbkGetNamePlaceholder:"Введите имя",cbkAgreementPersonalData:"Нажимая на кнопку \"<span>Позвоните мне</span>\", я даю свое согласие на обработку персональных данных и принимаю <a href='' class='cbk-agreement-link' target='_blank'>условия соглашения</a>",cbkSendName:"Будем знакомы!",cbkSkip:"Пропустить &gt;&gt;",cbkShareTitle:{0:{0:{0:"Спасибо!<br/><small>Мы Вам перезвоним в указанное время.</small>",1:"[name], спасибо!<br/><small>Мы Вам перезвоним в указанное время.</small>"},1:{0:"Спасибо!<br/><small>Мы Вам перезвоним в указанное время.</small>",1:"[name], спасибо!<br/><small>Мы Вам перезвоним в указанное время.</small>"}},1:{0:{0:"Спасибо за заявку!",1:"[name], спасибо за заявку!"},1:{0:"Спасибо за звонок!",1:"[name], спасибо за звонок!"}}},cbkYesAgree:"Да, согласен!",cbkCallLaterTitle:"Выберите<br/><small>удобное время звонка.</small>",cbkCallLaterTitle3:"Не нашли что искали?<br/><small>Хотите мы Вам позвоним и поможем?</small>",cbkErrorNoPhone:"Пожалуйста, введите свой номер!",cbkErrorNoAgree:"Вы должны принять соглашение!",cbkErrorNoName:"Пожалуйста, введите свое имя!",cbkErrorNoEmail:"Пожалуйста, введите свой email!",cbkSecond1:"секунду",cbkSecond2:"секунды",cbkSecond3:"секунд",cbkMondayText:"Понедельник",cbkTuesdayText:"Вторник",cbkWednesdayText:"Среда",cbkThursdayText:"Четверг",cbkFridayText:"Пятница",cbkSaturdayText:"Суббота",cbkSundayText:"Воскресенье",cbkCloseText:"Закрыть"}},setDefaultSettings:function(){var e={timeouts:{socketReconnect:2,needToCall:1,shakeBtn:5,rotatePhoneIcons:1.5,phonePulse:1.5,animateCopyright:5,btnShowTimeout:0,paused_sec_target:"page"},btnShowScroll:0,btnShow:!1,callTimeout:24,btnColor:!1,btnTextColor:!1,btnNoPulse:!1,btnPosition:!1,btnExtendedPosition:!1,btnExtendedCorner:!1,btnSize:!1,btnStaticOnScroll:!1,btnText:!1,btnFontSize:"22px",btnTextAdd:!1,btnType:"phone",calling:!1,callingWidget:!1,callingFromForm:!1,callId:!1,callStarted:!1,callToPhoneIsDeferred:!1,currentDay:0,departments:!1,hideBtn:0,hourDelta:0,killerId:!1,killerCallOff:!1,killerFormCall:!1,killerFormCallHide:0,killerIsPayed:!1,killerLogo:!1,killerBtnLogo:!1,killerUpdatedAt:!1,killerTimezone:3,killerTransparentBgr:!1,killerWorkdays:!1,killerWorking:0,killerWorkingToday:!0,killerHasMoney:0,killerIsPaused:!1,killerPausedStart:!1,killerPausedEnd:!1,killerPausedDay:!1,killerIsPausedNow:!1,noShowOnExit:!1,noShowWindow:!1,phonePositionRight:20,phonePositionBottom:5,prevDay:0,showWindowApperanceTimeout:27,showWindowReapperanceTimeout:1,showOnExitApperanceTimeout:8,showOnExitReapperanceTimeout:1440,managerRatingCheck:!0,killerCloseClickBgr:!0,timeDelta:0,useDepartment:"",sockjs:!1,cbkLink:"https://whitesaas.com?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=&utm_term=",agreementLink:"https://whitesaas.com/agreement/",cssUrl:"//saas-support.com/widget/cbk.css",btnMobilePositionHorizontal:40,btnMobilePositionHorizontalType:"left",btnMobilePositionVertical:95,btnMobilePositionVerticalType:"bottom",mobileViewPort:!1,timerType:"millisecond",windowPosition:0,dragObject:{},btnHideMobileZoom:!1,scallingMobile:!1,formHeight:!1,hideDefered:0,scrollLeft:0,scrollTop:0,auto_call_deffered:0,auto_call_deffered_delay_value:10,agreementPersonalData:0,shiftDayBeginning:0,showOnExitAlways:!1,mobileBtnSize:!1};$.extend(!0,s,e)},setTemplate:function(){t={btn:'<a class="callbackkiller cbk-btn" href="javascript:void(0)"><span class="cbk-title">'+s.text.cbkBtnTitle+"</span></a>",phone:'<a class="callbackkiller cbk-phone" href="javascript:void(0)"><div class="cbk-phone-bgr"></div><div class="cbk-phone-content"><div class="cbk-phone-phone cbk-rotate-icon"><i class="ws-icon-phone"></i></div><div class="cbk-phone-text">'+s.text.cbkBtnTitle+'</div></div><div class="cbk-phone-circle"></div><div class="cbk-phone-second_circle"></div><div class="cbk-phone-third_circle"></div></a>',extended_btn:'<div class="ws-killer"><div class="ws-killer-btn-container"><div class="ws-killer-btn"><div class="ws-killer-btn-ico"><div class="ws-killer-btn-logo"><i class="ws-icon-phone"></i><img src="" class="ws-killer-logo-img"></div></div><div class="ws-btn-title">'+s.text.cbkBtnTitle+"</div></div></div></div>",windowbgr:'<div class="cbk-window-bgr"></div>',windowlogo:'<div class="cbk-window-logo"></div>',window:'<div class="callbackkiller cbk-window cbk-background"><a class="cbk-close-window" href="javascript:void(0)">'+s.text.cbkCloseText+'&nbsp;</a><div class="cbk-forms"><div class ="cbk-form cbk-callform" style="display:inline-block"><div class="cbk-form-element cbk-form-text"><div class="cbk-form-title"></div></div><div class="cbk-form-element cbk-form-action" ><div class="cbk-form-field"><input type="text" id="cbkNameInput" class="cbk-input" maxlength="255" placeholder="'+s.text.cbkGetNamePlaceholder+'"/></div><div class="cbk-form-field"><input type="text" id="cbkEmailInput" class="cbk-input" maxlength="255" placeholder="'+s.text.cbkEmailPlaceholder+'"/></div><div class="cbk-form-field"><input type="tel" id="cbkPhoneInput" class="cbk-input" maxlength="22" autocomplete="off"/><input type="text" class="cbk-phone-checker cbk-input-hidden"/></div><div class="cbk-form-field"><button type="button" id="cbkPhoneBtn" class="cbk-button cbk-button-lg cbk-ink-reaction ym-disable-clickmap">'+s.text.cbkPhoneBtnTitle+'</button></div></div><div><label class="cbk-label cbk-personal-agreement" style="display:none">'+s.text.cbkAgreementPersonalData+'</label></div><div class="cbk-timer"></div><div class="cbk-text-after-call" style="display:none; text-align:center;">'+s.text.cbkAfterCall+'</div><br/><div class="cbk-link-btn"><a href="javascript:void(0)" class="cbk-button-no">'+s.text.cbkCallLaterBtnTitle+'</a></div></div><div class="cbk-form cbk-cdform" style="display:inline-block"><div class="cbk-form-element cbk-form-text"><div class="cbk-form-title"></div><div class="cbk-deferred"><select id="cbkCallDeferredDate" class="cbk-select cbk-deferred-date"></select> <div>'+s.text.cbkSelectTimeIn+'</div> <select id="cbkCallDeferredTime" class="cbk-select cbk-deferred-time"></select></div></div><div class="cbk-form-element cbk-form-action"><input type="tel" id="cbkPhoneDeferredInput" class="cbk-input" maxlength="22"/><button type="button" id="cbkPhoneDeferredBtn" class="cbk-button cbk-button-lg cbk-ink-reaction ym-disable-clickmap">'+s.text.cbkPhoneDeferredBtnTitle+'</button></div><div><label class="cbk-label cbk-personal-agreement" style="display:none">'+s.text.cbkAgreementPersonalData+'</label></div></div><div class="cbk-form cbk-departmentform" style="display:inline-block"><div class="cbk-form-element cbk-form-text"><div class="cbk-form-title">'+s.text.cbkDepartmentTitle+'</div></div><div class="cbk-form-element cbk-form-action"><button type="button" id="cbkDepartmentBtn" class="cbk-button cbk-button-lg cbk-ink-reaction ym-disable-clickmap">'+s.text.cbkDepartmentBtnTitle+'</button></div><div class="cbk-timer"></div></div><div class="cbk-form cbk-crqform" style="display:inline-block"><div class="cbk-form-title">'+s.text.cbkCallResultQuestionTitle+'</div><button type="button" class="cbk-button cbk-button-yes">'+s.text.cbkYes+'</button><button type="button" class="cbk-button cbk-button-no">'+s.text.cbkNo+'</button></div><div class="cbk-form cbk-ratingform" style="display:inline-block"><div class="cbk-form-title">'+s.text.cbkRatingTitle+'</div><ul class="cbk-call-rating"><li><a id="cbkRating1" href="javascript:void(0)" data-value="1">1</a></li><li><a id="cbkRating2" href="javascript:void(0)" data-value="2">2</a></li><li><a id="cbkRating3" href="javascript:void(0)" data-value="3">3</a></li><li><a id="cbkRating4" href="javascript:void(0)" data-value="4">4</a></li><li><a id="cbkRating5" href="javascript:void(0)" data-value="5">5</a></li></ul></div><div class="cbk-form cbk-geform" style="display:inline-block"><div class="cbk-form-element cbk-form-text"><div class="cbk-form-title">'+s.text.cbkSendCallToEmailTitle+'</div></div><div class="cbk-form-element cbk-form-action"><input type="text" id="cbkEmailInputRecord" class="cbk-input" placeholder="'+s.text.cbkEmailPlaceholder+'"/><button type="button" class="cbk-button cbk-button-yes">'+s.text.cbkSendEmail+'</button></div><div class="cbk-link-btn"><a href="javascript:void(0)" class="cbk-button-no">'+s.text.cbkNoThanks+'</a></div></div><div class="cbk-form cbk-shareform" style="display:inline-block"><div class="cbk-form-title"></div></div><div class="cbk-form cbk-naform" style="display:inline-block"><div class="cbk-form-title"></div></div></div><div id="cbk-captcha-container" class="cbk-captcha-container" style="display:none;"></div><a class="cbk-copyright" target="_blank" href="'+s.cbkLink+'" data-widget="callback"><span class="copyright-content">'+s.text.cbkCopyright+"</span></a></div></div>"}},animateToInput:function(e){var t="";"required"==s.contactNameInput&&(t+=" ,#cbkNameInput"),"required"==s.contactEmailInput&&(t+=" ,#cbkEmailInput");var i=$("#"+e+t);navigator.userAgent.match(/iPad|iPhone/gi)?(i.off("focus.ios").on("focus.ios",(function(){$("body").animate({scrollTop:0},0),$("body").animate({scrollTop:$(this).offset().top+$(this).height()-$(window).height()/4},0)})),setTimeout((function(){i.blur(),i.focus()}),500,i)):(i.off("focus.cbkInput").on("focus.cbkInput",(function(){setTimeout((function(e){$(window).height()<=$(e).offset().top+$(e).height()&&($(".cbk-window").animate({scrollTop:0},0),$(".cbk-window").animate({scrollTop:$(e).offset().top+$(e).height()-$(window).height()+20},0))}),500,i)})),i.blur(),i.focus())},log:function(e){wsUtil.log("KILLER : "+e)},isTouchDevice:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}}}(jWS)},759:()=>{"use strict";var e,t,i,n,a,s=(e=jWS,n={},a={url:"https://unicom24.ru/mfi_iframe_v7/",price_param:"sum",name_param:"name",price_id:"loaner-price",serviceName:"Envybox",partnerLink:"",lang_text:{iframe_warning:"Ваш браузер не поддерживает плавающие фреймы"},dragObject:{}},{init:function(t){e.fn._frameCheck()&&"undefined"==typeof WBK&&(window.WBK=document.WBK),WBK.checkDebug()&&(this.log=this.consoleLog),this.loader(t)},loader:function(e){var t=e.Data.loaner;this.setSettings(t),WBK.settings.loanerId=parseInt(e.Settings.loanerId),a.serviceName=e.Settings.serviceName,a.partner_link=e.Settings.partner_link,a.partner_link||(a.partner_link="http://whitesaas.com/?utm_source=widget&utm_medium=self&utm_campaign="+WBK.settings.domain+"&utm_content=loaner"),this.setTemplate(),this.initWidget()},setSettings:function(t){e.extend(!0,a,t)},setTemplate:function(){if("new"===a.work_type){var e=WBK.settings.visitorName?WBK.settings.visitorName:"",n=WBK.settings.visitorEmail?WBK.settings.visitorEmail:"",s=WBK.settings.visitorPhone&&"7"===WBK.settings.visitorPhone.substr(0,1)?WBK.settings.visitorPhone:"7",o="http://whitesaas.com/agreement/loaner/"+WBK.settings.loanerId+"/0/";"1"===a.agreement_personal_data_format&&a.agreement_personal_data_custom_link&&(o=a.agreement_personal_data_custom_link),t="<div class='ws-loaner'><div class='ws-loaner-modal-overflow'></div><div class='ws-loaner-modal-wrap'><div class='ws-loaner-modal-container ws-loaner-modal-new'><form onsubmit='return false;this.submit()' class='ws-loaner-form'><a class='loaner-close-window' href='javascript:void(0)'>Закрыть&nbsp;</a><div class='ws-loaner-header-text'>"+a.form_header_text+"</div><div class='ws-loaner-body-text'>"+a.form_body_text+"</div><div class = 'ws-loaner-input-group'><div class = 'ws-loaner-input-user-name ws-loaner-input-container'><input class='ws-loaner-input' placeholder='Ваше Имя' value='"+e+"' oninput = this.classList.remove('invalid-field')></div>","hidden"!==a.email_require&&(t+="<div class = 'ws-loaner-input-user-email ws-loaner-input-container'><input class='ws-loaner-input' placeholder='Email' value='"+n+"' oninput = this.classList.remove('invalid-field')></div>"),t+="<div class = 'ws-loaner-input-user-phone ws-loaner-input-container'><input class='ws-loaner-input' placeholder='+7(___)___-__-__' value='"+s+"' oninput = this.classList.remove('invalid-field') ></div><div class = 'ws-loaner-input-container'><input type='submit' class='ws-loaner-input ws-loaner-submit' value='"+a.form_button_text+"'></div>","1"===a.agreement_personal_data&&(t+="<div class = 'personal-agreement'><input type='checkbox' id ='loaner-personal-agreement' checked onchange = this.classList.remove('invalid-field')><label for='loaner-personal-agreement'><span>Согласен на обработку персональных данных и принимаю <a href='"+o+"' class='cbk-agreement-link' target='_blank'>условия соглашения</a></span></label></div>"),t+="<a class='ws-loaner-copyright' target='_blank' href='"+a.partner_link+"' data-widget='loaner'><span class='copyright-content'>Работает на <span class='service-name'>"+(WBK.settings.thisIsCallbackKILLER?"<img class='ws-copyright-img' src=\""+WBK.settings.staticServerUrl+'/img/logo/envybox_widget.png">':a.serviceName)+"</span></span></a></div></form><div class = 'final_form'><a class='loaner-close-window' href='javascript:void(0)'>Закрыть&nbsp;</a><div class='ws-loaner-post-header-text'>Спасибо!</div><div class='ws-loaner-post-body-text'>С Вами свяжется менеджер для согласования заявки</div><a class='ws-loaner-copyright' target='_blank' href='"+a.partner_link+"' data-widget='loaner'><span class='copyright-content'>Работает на <span class='service-name'>"+(WBK.settings.thisIsCallbackKILLER?"<img class='ws-copyright-img' src=\""+WBK.settings.staticServerUrl+'/img/logo/envybox_widget.png">':a.serviceName)+"</span></span></a></div></div></div></div>"}else t="<div class='ws-loaner'><div class='ws-loaner-modal-overflow'></div><div class='ws-loaner-modal-wrap'><div class='ws-loaner-modal-container'><iframe class='ws-loaner-modal'>"+a.lang_text.iframe_warning+"</iframe><a class='ws-loaner-modal-close' href=''></a></div></div></div>";i='<div class="ws-loan-container" style="display: none;"><div class="ws-loaner-btn-el-container ws-loaner-not-scalling"><div class="ws-loaner-btn-container ws-loaner-btn-mini-hover"><div class="ws-btn-ico"><div class="ws-loaner-logo"><i class="ws-icon-loaner" style="color: '+a.color_background+'"></i><img src="'+a.loaner_widget_logo+'" class="ws-loaner-logo-img"></div></div><div class="ws-btn-title"></div></div></div>'},initWidget:function(){var s=this;if("new"===a.work_type){var o=this.getPageValues();if(!o.name||!o.price)return!1}WBK.loadFont(),n.usable=!0;var r,l=e("#"+a.price_id).text(),c=e(t),d=e(i),h={};h[a.price_param]=l,h[a.name_param]=name,h.key="bgpcqofvjphjndzbayoifdsayrinbbnd",h.sub_id=encodeURIComponent(JSON.stringify({visit:WBK.settings.visitId,visitor:WBK.settings.visitorId,loaner:WBK.settings.loanerId})),r=function(t,i){var n="?";return t.search(/\?/)>=0&&(n="&"),t+n+e.param(i)}(a.url,h),n.$modalOverflow=c.find(".ws-loaner-modal-overflow"),n.$modalWrap=c.find(".ws-loaner-modal-wrap"),n.$modalFrame=c.find(".ws-loaner-modal"),n.$modalOverflow.hide(),n.$modalWrap.hide(),n.$modalFrame.attr("src",r),n.$widget=e("body").append(d).find(".ws-loan-container"),n.$window=e("body").append(c).find(".ws-loaner"),e(".ws-loaner-submit").on("click",this.submit),n.$widget.find(".ws-loaner-btn-container").addClass("loan-corner-"+a.corner_type),WBK.addStyles(".ws-loan-container .ws-loaner-btn-container{background: "+a.color_background+"!important;}.ws-loan-container .ws-loaner-btn-container .ws-btn-title{color: "+a.color_text+"!important;}");var u="";["form_color_text","form_color_background","form_button_color","form_button_text_color"].forEach((function(e){a[e]&&(u+="--"+e+":"+a[e]+";")})),u&&WBK.addStyles(".ws-loaner{"+u+"}"),n.$widget.find(".ws-btn-title").html(a.widget_text);var g,p={};if("hide"!==a.position){switch(n.$widget.show(),a.position){case"horizontal":switch(a.position_x){case"left":p.left=a.position_x_value+"%",p.right="auto";break;case"right":p.right=a.position_x_value+"%",p.left="auto"}switch(a.position_y){case"bottom":p.bottom=a.position_y_value+"%",p.top="auto",0==a.position_y_value&&n.$widget.find(".ws-loaner-btn-container").addClass("ws-loaner-btn-attach");break;case"top":p.top=a.position_y_value+"%",p.bottom="auto",0==a.position_y_value&&n.$widget.find(".ws-loaner-btn-container").addClass("ws-loaner-btn-attach-top")}break;case"vertical_left":n.$widget.find(".ws-loaner-btn-container").addClass("ws-loaner-btn-rotate").addClass("ws-loaner-btn-attach-top"),p.left=-(n.$widget.find(".ws-loaner-btn-container").outerWidth()-n.$widget.find(".ws-loaner-btn-container").outerHeight())/2+"px",p.right="auto";break;case"vertical_right":n.$widget.find(".ws-loaner-btn-container").addClass("ws-loaner-btn-rotate").addClass("ws-loaner-btn-attach"),p.right=-(n.$widget.find(".ws-loaner-btn-container").outerWidth()-n.$widget.find(".ws-loaner-btn-container").outerHeight())/2+"px",p.left="auto"}if("vertical_left"==a.position||"vertical_right"==a.position)switch(a.position_y){case"bottom":p.bottom=(n.$widget.find(".ws-loaner-btn-container").outerWidth()-n.$widget.find(".ws-loaner-btn-container").outerHeight())/2+e(window).height()/100*a.position_y_value+"px",p.top="auto";break;case"top":p.top=(n.$widget.find(".ws-loaner-btn-container").outerWidth()-n.$widget.find(".ws-loaner-btn-container").outerHeight())/2+e(window).height()/100*a.position_y_value+"px",p.bottom="auto"}if(n.$widget.find(".ws-loaner-btn-el-container").css(p),a.img_src){var w=new Date;a.loaner_widget_logo=WBK.settings.staticServerUrl+"/uploaded/loaners/"+a.img_src+"?"+w.getTime(),n.$widget.find(".ws-loaner-btn-container").addClass("ws-loaner-btn-logo-yes"),n.$widget.find(".ws-loaner-logo-img").attr("src",a.loaner_widget_logo)}}if(e(n.$window).on("click",".ws-loaner-modal-close, .loaner-close-window",function(e){e.preventDefault(),s.hideWindow(),s.reTemplate()}.bind(s)),e(n.$widget).on("click",function(e){wsUtil.getCookie("WhiteCallback_noClickOnLoanerButton")||(a.dragObject={},e.preventDefault(),s.sendGoal("click"),s.showWindow())}.bind(s)),window.loaner=this,!e.fn._frameCheck()||"undefined"!=typeof WBK)try{g=window.top.location.hash}catch(e){}if("#showloaner"==g&&(s.sendGoal("click"),s.showWindow()),!e.fn._frameCheck()||"undefined"!=typeof WBK)try{e("body").on("click",'a[href="#showloaner"], a[href="'+window.top.location.origin+'#showloaner"], a[href="'+window.top.location.origin+'/#showloaner"]',(function(e){return s.sendGoal("click"),s.showWindow(),e.preventDefault(),!1})),e("body").on("click",".ws-show-loaner-action",(function(e){return s.sendGoal("click"),s.showWindow(),e.preventDefault(),!1}))}catch(e){}if("pc"==WBK.settings.device&&"horizontal"==a.position&&0!=a.position_y_value&&100!=a.position_y_value&&(n.$widget.find(".ws-loaner-btn-el-container").on("mousedown.ws-loaner-btn-el-container",(function(e){1===e.which&&(a.dragObject.elem=n.$widget.find(".ws-loaner-btn-el-container"),a.dragObject.downX=e.pageX,a.dragObject.downY=e.pageY)})).on("dragstart",(function(e){e.preventDefault()})).on("mouseup",(function(e){if(a.dragObject.dragStarted){a.dragObject.dragStarted=!1;var t=new Date;t.setSeconds(t.getSeconds()+1),wsUtil.setCookie("WhiteCallback_noClickOnLoanerButton",1,t)}a.dragObject={}})),e(document).on("mouseup.ws-loaner-btn-el-container",(function(e){if(a.dragObject.dragStarted){a.dragObject.dragStarted=!1;var t=new Date;t.setSeconds(t.getSeconds()+1),wsUtil.setCookie("WhiteCallback_noClickOnLoanerButton",1,t)}a.dragObject={}})),e(document).on("mousemove.ws-loaner-btn-el-container",(function(e){if(a.dragObject.elem){var t=e.pageX-a.dragObject.downX,i=e.pageY-a.dragObject.downY;if(Math.abs(t)<3&&Math.abs(i)<3)return;a.dragObject.dragStarted||(a.dragObject.oldPosition={left:a.dragObject.elem.position().left||"",top:a.dragObject.elem.position().top||""},a.dragObject.shiftX=a.dragObject.downX-a.dragObject.elem.position().left,a.dragObject.shiftY=a.dragObject.downY-a.dragObject.elem.position().top,a.dragObject.dragStarted=!0),a.dragObject.elem.css({left:e.pageX-a.dragObject.shiftX+"px",top:e.pageY-a.dragObject.shiftY+"px",right:"auto",bottom:"auto"})}}))),WBK.settings.phoneMasks){var f=[];WBK.settings.phoneMasks.forEach((function(e){"+7"===e.mask.substr(0,2)&&f.push(e)})),this.masks=f;var m={inputmask:{definitions:{"#":{validator:"[0-9]",cardinality:1}},clearIncomplete:!1,showMaskOnHover:!1,autoUnmask:!0},match:/[0-9]/,replace:"#",list:e.masksSort(f,["#"],/[0-9]|#/,"mask"),listKey:"mask",onMaskChange:function(){e(this).attr("placeholder",e(this).inputmask("getemptymask"))}};e(".ws-loaner-input-user-phone input").inputmasks(m)}s.sendEvents("show","loaner","")},showWidget:function(){if(!n.usable)return!1;"hide"!==a.position&&n.$widget.show()},hideWidget:function(){if(!n.usable)return!1;n.$widget.hide()},showWindow:function(){if(!n.usable)return!1;WBK.settings.windowLoanerOpened=!0,n.$modalOverflow.show(),n.$modalWrap.show(),this.hideWidget(),this.sendEvents("click","loaner",""),WBK.settings.windowInvaderOpened&&(wsInvader.widget.window.find(".cbk-support-new-message-copyright").hide(),wsInvader.widget.window.hide()),WBK.settings.callbackEnabled&&wsKiller.widget.btn.hide(),WBK.settings.chatBtnOpened&&wsChat.widget.btn.hide(),WBK.settings.quizId&&!WBK.settings.quizIntegrated&&!1===WBK.settings.thisIsQuizLanding&&wsQuizzes[WBK.settings.quizId].hideWidget(),WBK.settings.videoWidgetId&&WBK.settings.videoWidgetOpened&&wsVideoWidget.closeWidget(),WBK.settings.chatInvitationOpened&&wsChat.hideInvitation(),WBK.settings.multiButtonId&&!WBK.settings.multiButtonHidden&&wsMultiButton.hideWidget(),e(".ws-loaner-input-user-name input").focus()},hideWindow:function(){if(!n.usable)return!1;WBK.settings.windowLoanerOpened=!1,this.sendGoal("cancel"),n.$modalOverflow.hide(),n.$modalWrap.hide(),this.showWidget(),WBK.settings.chatEnabled&&(WBK.settings.chatBtnOpened&&wsChat.widget.btn.show(),WBK.settings.chatWindowOpened&&wsChat.widget.window.show()),WBK.settings.windowInvaderOpened&&wsInvader.showWidget(),WBK.settings.callbackEnabled&&1!=wsKiller.settings.hideBtn&&wsKiller.settings.btnShow&&wsKiller.widget.btn.show(),WBK.settings.multiButtonId&&wsMultiButton.showWidget(),WBK.settings.quizId&&!WBK.settings.quizIntegrated&&!1===WBK.settings.thisIsQuizLanding&&wsQuizzes[WBK.settings.quizId].showWidget()},consoleLog:function(e,t){void 0===t?console.log(e):console.log(e,t)},log:function(){},sendGoal:function(e){var t,i;switch(e){case"click":t="LOAN_CLICK",i="ClickLoaner";break;case"close":t="LOAN_CANCEL",i="CancelLoaner"}wsUtil.sendGoal(t,i,"Loaner",!1,!1)},submit:function(){var t=e(".ws-loaner-input-user-name input"),i=t.val(),n=e(".ws-loaner-input-user-email input"),o=n.val(),r=e(".ws-loaner-input-user-phone input"),l=r.val(),c=e("#loaner-personal-agreement"),d=c.prop("checked");return i?o&&/^.*@.+\..+$/.test("email")?(n.addClass("invalid-field"),!1):o||"required"!==a.email_require?l&&11===l.length?parseInt(a.agreement_personal_data)&&!d?(c.addClass("invalid-field"),!1):(s.sendLead(i,o,l),s.reTemplate("final"),!1):(r.addClass("invalid-field"),!1):(n.addClass("invalid-field"),!1):(t.addClass("invalid-field"),!1)},sendLead:function(t,i,n){var a=WBK.settings.serverUrl+"/api?action=loanerAddLead&callback=?",s=this.getPageValues();e.getJSON(a,{widgetType:this.widgetType,widgetId:this.widgetId,loanerId:WBK.settings.loanerId,loanerStatId:WBK.settings.loanerStatId,code:WBK.settings.whiteSaasCode,visitId:WBK.settings.visitId,visitorId:WBK.settings.visitorId,leadInfo:{name:t,email:i,phone:n,product:s.name,price:s.price}})},getPageValues:function(){var t={name:a.product_value,price:a.price_value};if(a.product_values_substitution){var i=e("#"+a.product_id);i.val()?t.name=i.val():i.text()&&(t.name=i.text())}if(a.price_values_substitution){var n=e("#"+a.price_id);n.val()?t.price=n.val():n.text()&&(t.price=n.text())}var s=new RegExp("\\s+|`","gi");return t.price=parseFloat(t.price.trim().replace(s,"")),t},reTemplate:function(t){var i=e(".ws-loaner-modal-container.ws-loaner-modal-new");"final"===t?i.addClass("final"):i.removeClass("final")},sendEvents:function(t,i,n){var a=WBK.settings.serverUrl+"/api?action=loanerEvent&callback=?";e.getJSON(a,{event:t,widgetType:i,widgetId:parseInt(n)?parseInt(n):0,loanerId:WBK.settings.loanerId,loanerStatId:WBK.settings.loanerStatId,code:WBK.settings.whiteSaasCode,visitId:WBK.settings.visitId,visitorId:WBK.settings.visitorId},(function(e){e&&e.Data&&void 0!==e.Data.id&&"click"===t&&"loaner"===i&&(WBK.settings.loanerStatId=e.Data.id)}))}})},322:()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}var t;window.wsUtil=(t=jWS,{specialChars:function(e){return t("<div></div>").html(e).text()},giveGetParams:function(){aGetStr=location.search||"",aGetStr=aGetStr.replace("?","");var e={},i=aGetStr.split("&");return 0===i.length||t.each(i,(function(t,i){i&&(n=i.split("="),2===n.length&&(e[n[0]]=n[1]))})),e},setCookie:function(e,t,i,n,a,s){if(!e||!t)return!1;n||(n="/");var o=e+"="+encodeURIComponent(t);return i&&(o+="; expires="+i.toGMTString()),n&&(o+="; path="+n),a&&(o+="; domain="+a),s&&(o+="; secure"),document.cookie=o,!0},getCookie:function(e){return new RegExp("(?:; )?"+e+"=([^;]*);?").test(document.cookie)?decodeURIComponent(RegExp.$1):null},deleteCookie:function(e,t,i){return t||(t="/"),this.setCookie(e,"0",new Date(0),t,i),!0},isLocalStorageNameSupported:function(){var e="test_localstorage";try{return window.localStorage.setItem(e,1),window.localStorage.removeItem(e),!0}catch(e){return this.log("localStorage недоступен"),!1}},setStorage:function(e,t){if(this.isLocalStorageNameSupported())localStorage.setItem(e,t);else{var i=new Date;i.setFullYear(i.getFullYear()+2),this.setCookie(e,t,i)}},getStorage:function(e){return this.isLocalStorageNameSupported()?localStorage.getItem(e):this.getCookie(e)},deleteStorage:function(e){this.isLocalStorageNameSupported()?localStorage.removeItem(e):this.deleteCookie(e)},checkStorageTime:function(e){if(0!=e.length){var i=(new Date).getTime();t.each(e,(function(e,t){var n=wsUtil.getStorage(t)?wsUtil.getStorage(t):0;0!=n&&n<i&&wsUtil.deleteStorage(t)}))}},doEnding:function(e,t,i,n){return(e=""+e).charAt(e.length-2)&&1==e.charAt(e.length-2)?n:1==e.charAt(e.length-1)?t:e.charAt(e.length-1)>1&&e.charAt(e.length-1)<5?i:n},array2json:function(t){var i=[],n="[object Array]"===Object.prototype.toString.apply(t);for(var a in t){var s=t[a];if("object"==e(s))n?i.push(this.array2json(s)):i[a]=this.array2json(s);else{var o="";n||(o='"'+a+'":'),o+="number"==typeof s?s:!1===s?"false":!0===s?"true":'"'+s+'"',i.push(o)}}var r=i.join(",");return n?"["+r+"]":"{"+r+"}"},getRandomArbitrary:function(e,t){return Math.round(Math.random()*(t-e)+e)},initTimeouts:function(){this.hasOwnProperty("_timeouts")&&this._timeouts.length>0&&this.deleteAllTimeouts(),this._timeouts=[]},setTimeout:function(e){function t(t,i,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,i){this._timeouts.hasOwnProperty(e)&&this.deleteTimeout(e),this._timeouts[e]=setTimeout(t,i)})),getTimeout:function(e){return this._timeouts[e]},deleteTimeout:function(e){void 0!==this._timeouts[e]&&(clearTimeout(this._timeouts[e]),delete this._timeouts[e])},deleteAllTimeouts:function(){for(var e in this._timeouts)this._timeouts.hasOwnProperty(e)&&this.deleteTimeout(e)},initIntervals:function(){this.hasOwnProperty("_intervals")&&this._intervals.length>0&&this.deleteAllIntervals(),this._intervals=[]},setInterval:function(e){function t(t,i,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,i){this._intervals.hasOwnProperty(e)&&this.deleteInterval(e),this._intervals[e]=setInterval(t,i)})),getInterval:function(e){return this._intervals[e]},deleteInterval:function(e){void 0!==this._intervals[e]&&(clearInterval(this._intervals[e]),delete this._intervals[e])},deleteAllIntervals:function(){for(var e in this._intervals)this._intervals.hasOwnProperty(e)&&this.deleteInterval(e)},setCaretPosition:function(e,t,i){var n=e.jws&&e.length>0?e[0]:e;if("number"==typeof t)i="number"==typeof i?i:t,n.setSelectionRange?-1===navigator.userAgent.search(/Edge/)&&n.setSelectionRange(t,i):n.createTextRange&&((a=n.createTextRange()).collapse(!0),a.moveEnd("character",i),a.moveStart("character",t),a.select()),n.focus();else if(n.setSelectionRange)t=n.selectionStart,i=n.selectionEnd;else if(document.selection&&document.selection.createRange){var a;i=(t=0-(a=document.selection.createRange()).duplicate().moveStart("character",-1e5))+a.text.length}},setFocusContentEditable:function(e){var t,i;document.createRange?((t=document.createRange()).selectNodeContents(e),t.collapse(!1),(i=window.getSelection()).removeAllRanges(),i.addRange(t)):document.selection&&((t=document.body.createTextRange()).moveToElementText(e),t.collapse(!1),t.select())},getRoistatPromo:function(){var e=this.getCookie("roistat_visit");return e||t(".roistat-promo").length&&(e=parseInt(t(".roistat-promo").text())),e},getAdvertiseId:function(){return this.getCookie("adv_uid")},getCalltrackingId:function(){return this.getCookie("cbk_calltracking.ru_id")},getLeadvertexId:function(){return this.getCookie("fromID")},getLPGeneratorId:function(){return this.getCookie("cbk_lpgenerator_id")},sendYaMetrika:function(e){for(var t in window)try{"string"==typeof t&&t.match(/yaCounter\w+|YaCounter/)&&void 0!==window[t]&&window[t].reachGoal&&window[t].reachGoal(e)}catch(e){}},sendMailCounter:function(e){if("undefined"!=typeof _tmr)try{var i=t("html").html().match(/mail.ru\/counter\?id=(\d+)/i);"undefined"!=typeof _tmr&&i[1]&&_tmr.push({id:i[1],type:"reachGoal",goal:e})}catch(e){}},sendGoal:function(e,i,n,a,s){if(t.fn._frameCheck()&&"undefined"==typeof WBK&&(WBK=document.WBK),wsUtil.sendYaMetrika(e),wsUtil.sendMailCounter(i),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent",n,i,(WBK.settings.visitorName?WBK.settings.visitorName:"")+" "+(WBK.settings.visitorPhone?WBK.settings.visitorPhone:"")]),"undefined"!=typeof ga&&"function"==typeof ga&&ga("send","event",n,i,(WBK.settings.visitorName?WBK.settings.visitorName:"")+" "+(WBK.settings.visitorPhone?WBK.settings.visitorPhone:"")),"undefined"!=typeof dataLayer&&(dataLayer.push({event:"GAEvent",eventCategory:n,eventAction:i}),dataLayer.push({event:i})),"undefined"!=typeof gtag&&gtag("event",i,{event_category:n,event_label:i}),a)try{"undefined"!=typeof yaglametrika&&"undefined"!=typeof yaglaservice&&yaglametrika.id&&yaglaservice("wbkNewLead","type="+a)}catch(e){this.log("Ошибка сервиса yagla")}s&&WBK.settings.sendFacebookLead&&"undefined"!=typeof fbq&&fbq("track","Lead",{content_name:i,content_category:n})},sendUniversalGoal:function(){if("no"==wsUtil.getCookie("WhiteSaas_uniqueLead")){wsUtil.sendGoal("UNIQUE_LEAD","UniqueLead","UniqueLead",!0);var e=new Date;e.setMinutes(e.getMinutes()+60),wsUtil.setCookie("WhiteSaas_uniqueLead","yes",e)}},log:function(e,t){t=t||"background: #222; color: #bada55",console.log("%c "+e+" ",t)},validateEmail:function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},getGoogleClientId:function(){var e="";if("undefined"!=typeof ga&&"function"==typeof ga&&void 0!==ga.getAll&&"function"==typeof ga.getAll&&ga.getAll().length&&(e=ga.getAll()[0].get("clientId")),!e){var t={};document.cookie.split(";").forEach((function(e){var i=e.split("="),n=i[0].trim(),a=i[1];t[n]=a})),t.hasOwnProperty("_ga")&&(e=t._ga.substring(6))}return e},humanizeNumber:function(e,t){if(void 0===t&&(t="&nbsp;"),0==e)return 0;if(!e)return"";var i=e.toString(),n="",a=0;","!=i.charAt(i.length-2)&&"."!=i.charAt(i.length-2)||(a=2),","!=i.charAt(i.length-3)&&"."!=i.charAt(i.length-3)||(a=3),","!=i.charAt(i.length-4)&&"."!=i.charAt(i.length-4)||(a=4);for(var s=0,o=i.length-a;s<o;s++)n=n+((o-s)%3==0&&0!=s?t:"")+i.charAt(s);for(s=i.length-a,o=i.length;s<o;s++)n+=i.charAt(s);return n},parseURL:function(e){var t=["url","scheme","slash","host","port","path","query","hash"],i=/^(?:([A-Za-z]+):(\/{0,3}))?([0-9.\-A-Za-z]+\.[0-9A-Za-z]+)?(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec(e),n={};if(!i)return n;for(var a=0,s=t.length;a<s;a+=1)n[t[a]]=i[a]||"";return n},timezoneFormat:function(e){var t=0;return"UTC"===e?t=0:(t=parseInt(e.charAt(3)+e.charAt(4)+e.charAt(5)),parseInt(e.charAt(7))&&(t+=.5)),t},getTimeByServerTimezone:function(e){var t=new Date;return t.setTime(1e3*WBK.settings.utcTime+60*t.getTimezoneOffset()*1e3+60*e*60*1e3),t},fixBootstrap:function(){window.$&&window.$.fn&&"function"==typeof window.$.fn.modal&&window.$(document).off("focusin.modal")},fixFastClick:function(){void 0!==window.FastClick&&t(".ws-textarea, .ws-btn-file, .ws-btn-smile, .ws-textarea-send-btn").addClass("needsclick")},fixJivo:function(e){"pc"!=WBK.settings.device&&(e?t("body").append('<style id="cbk-j-fix">div#jivo-iframe-container{z-index:50000 !important;}</style>'):t("#cbk-j-fix").remove())},getDeviceWidth:function(){var e=window.orientation&&0!=window.orientation?window.screen.height:window.screen.width;return navigator.userAgent.indexOf("Android")>=0&&(e=window.screen.width),e},getVisualWidth:function(){return this.checkVisualViewport()?window.visualViewport.width:window.innerWidth},getVisualHeight:function(){return this.checkVisualViewport()?window.visualViewport.height:window.innerHeight},getRatio:function(){return this.getVisualWidth()/this.getDeviceWidth()},checkVisualViewport:function(){return window.hasOwnProperty("visualViewport")&&window.visualViewport},getScrollLeft:function(){return this.checkVisualViewport()?window.visualViewport.offsetLeft:t(window).scrollLeft()},getScrollTop:function(){return this.checkVisualViewport()?window.visualViewport.pageTop:t(window).scrollTop()},getMobileNotScalePositionWidget:function(e){var t={zoom:e.ratio,"-moz-transform":"scale("+e.ratio+")"};return"right"===e.positionX?(t.right=e.positionXValue+"%",t.left="auto"):(t.left=e.positionXValue+"%",t.right="auto"),"bottom"===e.positionY?(t.bottom=e.positionYValue+"%",t.top="auto"):(t.top=e.positionYValue+"%",t.bottom="auto"),t},getMobileScalePositionWidget:function(e){var t,i=e.el.outerWidth(),n=e.el.outerHeight(),a=wsUtil.getScrollLeft(),s=wsUtil.getScrollTop(),o=wsUtil.getVisualWidth(),r=wsUtil.getVisualHeight();return t="right"===e.positionX?a+o*((100-e.positionXValue)/100)-e.ratio*i:a+o*(e.positionXValue/100),{top:("bottom"===e.positionY?s+r*((100-e.positionYValue)/100)-e.ratio*n:s+r*(e.positionYValue/100))/e.ratio+"px",bottom:"auto",left:t/e.ratio+"px",right:"auto",zoom:e.ratio}},isIE:function(){return!!(window.navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.match(/Trident.*rv\:11\./))},getScript:function(e,i,n){t.ajax({type:"GET",url:e,success:i,dataType:"script",cache:n,scriptCharset:"utf-8"})},getExternalParams:function(){return{yandexClientId:this.getYandexClientId()}},getYandexClientId:function(){return this.getCookie("_ym_uid")||null},getOpenedWidgets:function(){var e=[];return WBK.settings.windowOpened&&e.push("killer"),WBK.settings.chatWindowOpened&&e.push("chat"),WBK.settings.windowLoanerOpened&&e.push("loaner"),WBK.settings.windowQuizOpened&&e.push("quiz"),WBK.settings.windowGeneratorOpened&&e.push("generator"),WBK.settings.videoWidgetOpened&&e.push("video_widget"),e},decorateText:function(e){e=WBK.replaceTagVariant(e),e=WBK.replaceGetParamText(e),WBK.settings.geoCity.name||(WBK.settings.geoCity.name=WBK.settings.geoCity.ip_city);var t="";return WBK.settings.visitorName&&(t=WBK.settings.visitorName),e=(e=(e=(e=(e=e.replace(/\[geocity1\]/g,WBK.settings.geoCity.name)).replace(/\[geocity2\]/g,WBK.settings.geoCity.name_rod)).replace(/\[geocity3\]/g,WBK.settings.geoCity.name_mes)).replace(/\[geocity4\]/g,WBK.settings.geoCity.name_vin)).replace(/\[name\]/g,t),e=(e=t?e.replace(/\[name\|(.+?)\]/gi,t):e.replace(/\[name\|(.+?)\]/gi,"$1")).replace(/\[(.+?)\|(.+?)\]/gi,"<a href='$1' target='_blank'>$2</a>")},htmlEscape:function(e){return e=e.replace(/\t/g,"    ").replace(/  /g,"&nbsp; ").replace(/  /g," &nbsp;").replace(/\r\n|\n|\r/g,"<br />")},isAppleOS:function(){return!!/Mac|iPad|iPhone|iPod/.test(navigator.userAgent)},getOrInitDialCodesPhoneInput:function(){return this.wsDCPI||(this.wsDCPI=new WsDialCodesPhoneInput(t).initCommon({defaultCountry:WBK.settings.geoCity.ip_flag,setFlagsImageCss:!1,initCommonCallback:function(){WBK.addStyles(".ws-dcpi_flag{background-image:url("+WBK.settings.staticServerUrl+"/img/flags.png);}")}})),this.wsDCPI},generateHash:function(e,t){return window.generateWsHash(e,t)}})},862:()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}!function(t){t.ajaxSetup({async:!0}),t.fn.WBK=function(t,n){if(n&&"object"===e(t)){if("object"!==e(t)&&t){if("string"==typeof t)return}else if(t.hasOwnProperty("whiteSaasCode")){var a=new i(t);return jWS.fn._frameCheck()?"object"===e(document.WBK)?void console.log("Only one instance of WhiteSaas can be run"):(document.WBK=a,a.boot(n),document.WBK):"object"===e(window.top.WBK)?void console.log("Only one instance of WhiteSaas can be run"):(window.top.WBK=a,a.boot(n),window.top.WBK)}return this}console.log("WBK data required")},t.fn._frameCheck=function(){try{return window!=window.top||document!=top.document||window.location!=top.location}catch(e){return!0}};var i=function(e){var i=this;if(i.setDefaultSettings(),i.pageIdent=i.pageIdentGen(),t.extend(i.settings,e),!this.settings.whiteSaasCode)return!1;jWS.fn._frameCheck()?(document.WhiteSaas=this,document.WhiteCallback=this,document.CallbackKiller=this):(window.top.WhiteSaas=this,window.top.WhiteCallback=this,window.top.CallbackKiller=this)};i.prototype.boot=function(e){this.onLoad(e)},i.prototype.sendCrmLead=function(e,i,n){var a=this;e||console.log("Не указан crmId"),i||console.log("Нет данных для отправки"),i.google_client_id=wsUtil.getGoogleClientId(),i.yandex_client_id=wsUtil.getYandexClientId();var s=a.settings.serverUrl+"/api?action=createLead&callback=?";t.getJSON(s,{code:a.settings.whiteSaasCode,visitId:a.settings.visitId||wsUtil.getCookie("WhiteCallback_visit"),visitorId:a.settings.visitorId||wsUtil.getCookie("WhiteCallback_visitorId"),crmId:e,data:i},(function(t){1==t.Success&&console.log("Лид отправлен в crm (id : "+e+")"),n&&"function"==typeof n&&n(t)}))},i.prototype.setCustomParams=function(i){if(i)if("object"==e(i)&&i.length){var n=this,a=n.settings.serverUrl+"/api?action=setCustomParams&callback=?";t.getJSON(a,{code:n.settings.whiteSaasCode,visitId:n.settings.visitId,visitorId:n.settings.visitorId,url:window.location.href,data:i},(function(e){1==e.Success&&console.log("Параметры обновлены")}))}else console.log("Некорректный формат, должен быть передан массив или данные отсутствуют");else console.log("Не указаны данные для отправки")},i.prototype.clearServiceCookie=function(e){for(var t=e.split("; "),i=[],n=0;n<t.length;n++)if("string"==typeof t[n])if(0===t[n].search(/WhiteCallback_openedpage/)||0===t[n].search(/sw_openedpage/));else{var a=t[n];i.push(a.substring(0,64))}return i.join("; ")},i.prototype.onLoad=function(i){var n=this;if(i.Settings){if(!i.Settings.visitorId)return!1;if(n.settings.visitorId=i.Settings.visitorId,wsUtil.getCookie("WhiteCallback_visitorId")||((a=new Date).setMinutes(a.getMinutes()+30),wsUtil.setCookie("WhiteCallback_visitorId",n.settings.visitorId,a)),i.Settings.visitId){var a;if(n.settings.visitId=i.Settings.visitId,wsUtil.setCookie("WhiteCallback_visit",i.Settings.visitId),!wsUtil.getCookie("WhiteSaas_uniqueLead"))(a=new Date).setMinutes(a.getMinutes()+60),wsUtil.setCookie("WhiteSaas_uniqueLead","no",a);n.updateVisit()}}if(i.Success&&i.Data&&i.Settings){n.settings.device=i.Settings.device,i.Settings.visitorName&&""!==i.Settings.visitorName&&(n.settings.visitorName=i.Settings.visitorName,n.settings.hasVisitorName=1),i.Settings.visitorPhone&&""!==i.Settings.visitorPhone&&(n.settings.visitorPhone=i.Settings.visitorPhone),i.Settings.visitorEmail&&""!==i.Settings.visitorEmail&&(n.settings.visitorEmail=i.Settings.visitorEmail),i.Settings.staticServerUrl&&""!==i.Settings.staticServerUrl&&(n.settings.staticServerUrl=i.Settings.staticServerUrl),i.Settings.thisIsCallbackKILLER&&(n.settings.thisIsCallbackKILLER=!0),i.Settings.serviceName&&(n.settings.servicename=i.Settings.serviceName),i.Settings.serviceDomain&&(n.settings.servicedomain=i.Settings.serviceDomain),i.Settings.serviceId&&(n.settings.serviceid=i.Settings.serviceId),i.Settings.accountId&&(n.settings.accountid=i.Settings.accountId),i.Settings.siteId&&(n.settings.siteId=parseInt(i.Settings.siteId)),(i.Settings.phoneBase||""===i.Settings.phoneBase)&&(""===i.Settings.phoneBase?n.settings.phoneBase="":n.settings.phoneBase=parseInt(i.Settings.phoneBase)),i.Settings.phoneMasks&&(n.settings.phoneMasks=i.Settings.phoneMasks),i.Settings.phoneBasesCountries&&(n.settings.phoneBasesCountries=i.Settings.phoneBasesCountries),i.Settings.windowNoCopyright&&(n.settings.hideCopyright=!0),i.Settings.geoCity&&(n.settings.geoCity=i.Settings.geoCity,n.settings.geoCity.name||(n.settings.geoCity.name=n.settings.geoCity.ip_city),n.settings.geoCity.name_rod=n.settings.geoCity.name_rod||n.settings.geoCity.name,n.settings.geoCity.name_mes=n.settings.geoCity.name_mes||n.settings.geoCity.name,n.settings.geoCity.name_vin=n.settings.geoCity.name_vin||n.settings.geoCity.name);var s=new Date;i.Settings.utcTime?n.settings.utcTime=i.Settings.utcTime:n.settings.utcTime=parseInt(s.getTime()/1e3),i.Settings.siteCode&&(n.settings.whiteSaasCode=i.Settings.siteCode),i.Settings.notSendFacebookLead&&(n.settings.sendFacebookLead=!1),i.Settings.paths&&"object"===e(i.Settings.paths)&&(n.settings.paths=i.Settings.paths),"function"==typeof window.ws_OnCodeLoad&&window.ws_OnCodeLoad(),wsUtil.initTimeouts(),wsUtil.initIntervals(),n.initStyles(),n.updatePageShowCount(),wsUtil.deleteCookie("CallbackKiller_timePage"),n.pageIdentCheck(),n.pageIdentAdd(n.pageIdent),n.pageIdentGetMainPage()?n.pageIdentObserve():n.pageIdentSetMainPage(n.pageIdent),n.checkIE(),n.checkResize(),n.loadWidgets(i),t(window).on("beforeunload.whiteSaas",n.clearOpenedPages)}},i.prototype.clearOpenedPages=function(){var e=wsUtil.getCookie("WhiteCallback_mainPage");wsUtil.deleteCookie("WhiteCallback_mainPage");var t=[],i=(wsUtil.getCookie("WhiteCallback_openedPages")||"").split(".");if(0===i.length||i.length>20)wsUtil.deleteCookie("WhiteCallback_openedPages");else{for(var n in i)i.hasOwnProperty(n)&&i[n]!==e&&t.push(i[n]);var a=new Date;a.setFullYear(a.getFullYear()+1),wsUtil.setCookie("WhiteCallback_openedPages",t.join("."),a)}},i.prototype.checkResize=function(){var e=this;e.settings.windowRatio=wsUtil.getRatio(),wsUtil.setInterval("envyResize",(function(){var t=wsUtil.getRatio();e.settings.windowRatio!==t&&(e.settings.windowRatio=t,wsUtil.setTimeout("resizeEvent",(function(){WBK.settings.chatWindowOpened||WBK.settings.windowOpened||WBK.settings.windowQuizOpened||WBK.settings.windowGeneratorOpened||WBK.settings.videoWidgetOpened||jWS(window).trigger("envy:resize")}),250))}),200)},i.prototype.checkIE=function(){wsUtil.isIE()&&jWS("body").addClass("envybox-ie")},i.prototype.prepareSettings=function(e,i){var n=[];e.Data.multi_button&&e.Settings.multiButtonId&&("pc"==e.Settings.device||"pc"!=e.Settings.device&&!e.Data.multi_button.hide_mobile)&&(n=this.checkWidgetsToHide(e),t.each(n,(function(i,n){switch(n.action){case"killer":n.action_value==e.Settings.killerId&&(e.Data.callback.killerSettings.hideBtn=1,e.Data.callback.killerSettings.btnHideOnMobile=1,e.Data.callback.killerSettings.btnHideOnTablet=1);break;case"chat":n.action_value==e.Settings.chatWidgetId&&(t.fn._frameCheck()&&"undefined"==typeof WBK&&(WBK=document.WBK),WBK.addStyles(".ws-chat .ws-chat-btn-container{display:none!important;}"));break;case"loaner":n.action_value==e.Settings.loanerId&&(e.Data.loaner.position="hide");break;case"quiz":n.action_value==e.Settings.quizId&&(e.Data.quizzes[e.Settings.quizId].show_button_on_site=0)}}))),i&&i(e)},i.prototype.checkWidgetsToHide=function(e){var t,i=[],n={killer:e.Settings.killerId,chat:e.Settings.chatWidgetId,loaner:e.Settings.loanerId,quiz:e.Settings.quizId};return null!==(t=e.Data)&&void 0!==t&&null!==(t=t.multi_button)&&void 0!==t&&t.variants&&e.Data.multi_button.variants.forEach((function(e){n[e.action]===e.action_value&&i.push(e)})),i},i.prototype.loadWidgets=function(e){var t=this;t.prepareSettings(e,(function(e){try{e.Data.callback&&e.Settings.killerId&&(wsKiller.init(e),"function"==typeof window.ws_OnKillerLoad&&window.ws_OnKillerLoad())}catch(e){wsUtil.log("KILLER : "+e.stack)}try{e.Data.chat&&e.Settings.chatWidgetId&&(e.Data.chat.v2&&(wsChat=wsChatNew),wsChat.init(e),"function"==typeof window.ws_OnChatLoad&&window.ws_OnChatLoad())}catch(e){wsUtil.log("CHAT : "+e.stack)}try{e.Data.generator&&e.Settings.generatorId&&(wsGenerator.init(e),"function"==typeof window.ws_OnGeneratorLoad&&window.ws_OnGeneratorLoad())}catch(e){wsUtil.log("GENERATOR : "+e.stack)}try{if(e.Data.quiz&&e.Settings.quizId&&e.Data.quiz.showQuiz){var i=WBK.settings.staticServerUrl+WBK.settings.paths.quiz;WBK.settings.quizId||(WBK.settings.quizId=parseInt(e.Settings.quizId)),window.wsQuizzes={},wsUtil.getScript(i,(function(){var t;for(var i in e.Data.quizzes)t=i,window.wsQuizzes[t]=new wsQuiz(jWS),window.wsQuizzes[t].init(e.Data.quizzes[t],t);"function"==typeof window.ws_OnQuizLoad&&window.ws_OnQuizLoad()}),!0)}}catch(e){wsUtil.log("QUIZ : "+e.stack)}try{if(e.Data.instinct&&e.Settings.instinctId){var n=WBK.settings.staticServerUrl+WBK.settings.paths.instinct;wsUtil.getScript(n,(function(){wsInstinct.init(e),"function"==typeof window.ws_OnInstinctLoad&&window.ws_OnInstinctLoad()}),!0)}}catch(e){wsUtil.log("INSTINCT : "+e.stack)}if("mobile"!==t.settings.device){try{if(e.Data.invader&&e.Settings.invaderId){n=WBK.settings.staticServerUrl+WBK.settings.paths.invader;wsUtil.getScript(n,(function(){wsInvader.init(e),"function"==typeof window.ws_OnInvaderLoad&&window.ws_OnInvaderLoad()}),!0)}}catch(e){wsUtil.log("INVADER : "+e.stack)}try{e.Data.loaner&&e.Settings.loanerId&&(wsLoaner.init(e),"function"==typeof window.ws_OnLoanerLoad&&window.ws_OnLoanerLoad())}catch(e){wsUtil.log("LOANER : "+e.stack)}}try{if(e.Data.multi_button&&e.Settings.multiButtonId){var a=WBK.settings.staticServerUrl+WBK.settings.paths.multi_button;wsUtil.getScript(a,(function(){wsMultiButton.init(e),"function"==typeof window.ws_OnMultiButtonLoad&&window.ws_OnMultiButtonLoad()}),!0)}}catch(e){wsUtil.log("MULTI_BUTTON : "+e.stack)}try{e.Data.calltracking&&e.Settings.calltrackingId&&wsCallTracking.run(e)}catch(e){wsUtil.log("CALLTRACKING : "+e.stack)}try{if(e.Data.form_customizer&&e.Settings.formCustomizerId){n=WBK.settings.staticServerUrl+WBK.settings.paths.form_customizer;wsUtil.getScript(n,(function(){wsFormCustomizer.init(e),"function"==typeof window.ws_OnFormCustomizerLoad&&window.ws_OnFormCustomizerLoad()}),!0)}}catch(e){wsUtil.log("FORM_CUSTOMIZER : "+e.stack)}try{if(e.Data.video_widget&&e.Settings.videoWidgetId){n=WBK.settings.staticServerUrl+WBK.settings.paths.video_widget;wsUtil.getScript(n,(function(){wsVideoWidget.init(e.Data.video_widget,e.Settings.videoWidgetId),"function"==typeof window.ws_OnVideoWidgetLoad&&window.ws_OnVideoWidgetLoad()}),!0)}}catch(e){wsUtil.log("VIDEO_WIDGET : "+e.stack)}}))},i.prototype.setVisitorData=function(e){if(!e.name&&!e.email&&!e.phone)return!1;var t=WBK.settings.serverUrl+"/api?action=setVisitorData&callback=?";jWS.getJSON(t,{code:WBK.settings.whiteSaasCode,name:e.name?e.name:WBK.settings.visitorName,email:e.email?e.email:WBK.settings.visitorEmail,phone:e.phone?e.phone:WBK.settings.visitorPhone,visitorId:WBK.settings.visitorId},(function(t){WBK.settings.visitorName=e.name?e.name:WBK.settings.visitorName,WBK.settings.visitorEmail=e.email?e.email:WBK.settings.visitorEmail,WBK.settings.visitorPhone=e.phone?e.phone:WBK.settings.visitorPhone}))},i.prototype.getVisitCount=function(){return parseInt(wsUtil.getStorage("ws_visit_count"))?parseInt(wsUtil.getStorage("ws_visit_count")):0},i.prototype.updateVisit=function(){var e=this;wsUtil.getStorage("ws_visit_id")!=e.settings.visitId&&(wsUtil.setStorage("ws_visit_id",e.settings.visitId),e.updateVisitCount())},i.prototype.updateVisitCount=function(){var e=this.getVisitCount(),t=e?e+1:1;wsUtil.setStorage("ws_visit_count",t)},i.prototype.getPageShowCount=function(){return parseInt(wsUtil.getStorage("ws_page_show_count"))?parseInt(wsUtil.getStorage("ws_page_show_count")):0},i.prototype.updatePageShowCount=function(){var e=this.getPageShowCount(),t=e?e+1:1;wsUtil.setStorage("ws_page_show_count",t)},i.prototype.initStyles=function(){t("body").append("<style id='whitesaas_style'></style>")},i.prototype.addStyles=function(e){t("#whitesaas_style").append(e)},i.prototype.showInvader=function(){window.wsInvader&&wsInvader.showWidget()},i.prototype.showWidgetGenerator=function(e){window.wsGenerator&&wsGenerator.showWidget(e)},i.prototype.showWidgetChat=function(){window.wsChat&&wsChat.showWidget()},i.prototype.showWindow=function(e,t){window.wsKiller&&wsKiller.showWindow(e,t)},i.prototype.newCall=function(e,t){window.wsKiller&&wsKiller.newCall(e,t)},i.prototype.showInvitationByName=function(e){window.wsChat&&wsChat.showInvitationByName(e)},i.prototype.checkFormOnSubmit=function(e){window.wsKiller&&wsKiller.checkFormOnSubmit(e)},i.prototype.callToPhone=function(e,t,i){window.wsKiller&&wsKiller.callToPhone(e,t,i)},i.prototype.setCookie=function(e,t,i,n,a,s){window.wsUtil&&wsUtil.setCookie(e,t,i,n,a,s)},i.prototype.getCookie=function(e){window.wsUtil&&wsUtil.getCookie(e)},i.prototype.setPhoneInputFocusForm=function(e){var t=this;e.focus(),e.val()||(""!==t.settings.phoneBase?(e.val(t.settings.phoneBase),[7,38,47,48,39].includes(t.settings.phoneBase)&&wsUtil.setCaretPosition(e,3,3),[380,358,992,375,373,972,971].includes(t.settings.phoneBase)&&wsUtil.setCaretPosition(e,5,5),77===t.settings.phoneBase&&wsUtil.setCaretPosition(e,4,4)):"mobile"!==t.settings.device&&wsUtil.setCaretPosition(e,2,2))},i.prototype._initSocket=function(e){var t=this;if(!t.settings.socket){var i=t.settings.socketioUrl+"?type=visitor&site_id="+t.settings.siteId+"&id="+t.settings.visitorId,n=new io.connect(i),a={disconnect:function(e){t.settings.socket=!1},sync:function(e){switch(e.event){case"onVisitorMessage":wsChat.onVisitorMessage(e);break;case"onVisitorMessageRead":wsChat.onVisitorMessageRead()}},connected:function(i){t.settings.socket=n,t.settings.socketConnected?WBK.settings.chatEnabled&&!parseInt(wsChat.settings.v2)&&wsChat.socketConnected(i,e):void 0!==e&&e(i),t.settings.socketConnected=1},onOperatorStatus:function(e){wsChat.onOperatorStatus(e)},onConnectToChat:function(e){wsChat.onConnectToChat(e)},onDisconnectFromChat:function(e){wsChat.onDisconnectFromChat(e)},onCloseChat:function(e){wsChat.onCloseChat(e)},onOperatorPrinting:function(e){wsChat.onOperatorPrinting(e)},onOperatorMessage:function(e){wsChat.onOperatorMessage(e)},onOperatorUpdateMessage:function(e){wsChat.onOperatorUpdateMessage(e)},onMessageReceived:function(e){},onMessageRead:function(e){wsChat.onMessageRead(e)},onUpdateRegistrationId:function(e){wsChat.onUpdateRegistrationId(e)},onCallStatus:function(e){wsKiller.onCallStatus(e)},onCalltracking:function(e){wsCallTracking.onSocket(e)}};Object.keys(a).forEach((function(e){n.on(e,(function(i){a[e].call(t,i)}))}))}},i.prototype.initSocket=function(e){var i=this;i.settings.socketScript?i._initSocket(e):(i.settings.socketScript=!0,t.getScript(i.settings.serverUrl+"/widget/socket.io.js").done((function(t,n){i._initSocket(e)})).fail((function(e,t,n){i.settings.socketScript=!1})))},i.prototype.updateTimeAll=function(){var e=new Date;e.setDate(e.getDate()+1),wsUtil.setCookie("WhiteCallback_timeAll",parseInt(wsUtil.getCookie("WhiteCallback_timeAll"))+1||1,e),wsUtil.setCookie("WhiteCallback_timePage",parseInt(wsUtil.getCookie("WhiteCallback_timePage"))+1||1,e)},i.prototype.pageIdentCheck=function(){var e=wsUtil.getCookie("WhiteCallback_openedPages"),t="",i=[];e&&e.split(".").forEach((function(e){wsUtil.getCookie("WhiteCallback_openedpage_"+e)&&-1===i.indexOf(e)&&i.push(e)})),i&&(t=i.join("."));var n=new Date;n.setFullYear(n.getFullYear()+1),wsUtil.setCookie("WhiteCallback_openedPages",t,n)},i.prototype.pageIdentAdd=function(e){var t=this,i=new Date;i.setFullYear(i.getFullYear()+1);var n=wsUtil.getCookie("WhiteCallback_openedPages");n?-1===n.indexOf(e)&&(n+="."+e):n=e,wsUtil.setCookie("WhiteCallback_openedPages",n,i),wsUtil.setInterval("incrementPageTime",(function(){t.incrementPageTime.apply(t,[e])}),1e3)},i.prototype.incrementPageTime=function(e){var t=new Date,i=parseInt((new Date).getTime()/1e3);t.setMinutes(t.getMinutes()+1),void 0===window.whitesaas_no_cookie_page&&"e7367ab9d00ca6b7bf516553717689df"!==WBK.settings.whiteSaasCode&&"fadc320b2259aa102e8fab9155a354e6"!==WBK.settings.whiteSaasCode&&"1f01938b0c94b11ededc95f49294cdf6"!==WBK.settings.whiteSaasCode&&wsUtil.setCookie("WhiteCallback_openedpage_"+e,i,t)},i.prototype.pageIdentRemove=function(e){var t=[],i=(wsUtil.getCookie("WhiteCallback_openedPages")||"").split(".");if(wsUtil.deleteCookie("WhiteCallback_openedpage_"+e),0==i.length)return wsUtil.deleteCookie("WhiteCallback_openedPages");for(var n in i)i.hasOwnProperty(n)&&i[n]!==e&&t.push(i[n]);if(t.length>0){var a=new Date;a.setFullYear(a.getFullYear()+1),wsUtil.setCookie("WhiteCallback_openedPages",t.join("."),a),this.pageIdentSetUpdateMainPage(t[0])}else wsUtil.deleteCookie("WhiteCallback_openedPages"),wsUtil.deleteCookie("WhiteCallback_mainPage"),wsUtil.deleteCookie("WhiteCallback_updateMainPage")},i.prototype.pageIdentSetMainPage=function(e){var t=this,i=new Date;i.setFullYear(i.getFullYear()+1),wsUtil.setCookie("WhiteCallback_mainPage",e,i),wsUtil.setInterval("updateTimeAll",(function(){t.updateTimeAll.call(t)}),1e3)},i.prototype.pageIdentObserve=function(){var e=this;wsUtil.setInterval("pageIdentObserve",(function(){wsUtil.getCookie("WhiteCallback_updateMainPage")===e.pageIdent&&(e.pageIdentSetMainPage.apply(e,[e.pageIdent]),wsUtil.deleteInterval("pageIdentObserve"),wsUtil.deleteCookie("WhiteCallback_updateMainPage"));var t=parseInt((new Date).getTime()/1e3),i=wsUtil.getCookie("WhiteCallback_mainPage"),n=wsUtil.getCookie("WhiteCallback_openedpage_"+i);((n=parseInt(n))+3<t||isNaN(n))&&e.pageIdentRemove.apply(e,[i])}),1e3)},i.prototype.pageIdentSetUpdateMainPage=function(e){if(e.length>0){var t=new Date;t.setFullYear(t.getFullYear()+1),wsUtil.setCookie("WhiteCallback_updateMainPage",e,t)}else wsUtil.deleteCookie("WhiteCallback_updateMainPage")},i.prototype.pageIdentGetMainPage=function(){return wsUtil.getCookie("WhiteCallback_mainPage")},i.prototype.pageIdentGen=function(){for(var e="",t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i=0;i<5;i++)e+=t.charAt(Math.floor(52*Math.random()));return e},i.prototype.animateOnce=function(e,i,n){e.addClass("cbk-animated").addClass(i),setTimeout((function(){e.removeClass("cbk-animated").removeClass(i),n&&t.isFunction(n)&&n()}),1e3)},i.prototype.animateFastOnce=function(e,i,n){e.addClass("cbk-animated").addClass("cbk-animated-fast").addClass(i),setTimeout((function(){e.removeClass("cbk-animated").removeClass("cbk-animated-fast").removeClass(i),n&&t.isFunction(n)&&n()}),250)},i.prototype.animateElTime=function(e,i,n,a){e.addClass("cbk-animated").addClass("cbk-animated-fast").addClass(i),setTimeout((function(){e.removeClass("cbk-animated").removeClass("cbk-animated-fast").removeClass(i),n&&t.isFunction(n)&&n()}),a)},i.prototype.sendAdvertLinkStat=function(e,t,i,n){var a=this,s=a.settings.serverUrl+"/api?action=advertlinkstat&callback=?";jWS.getJSON(s,{code:a.settings.whiteSaasCode,widget:e,widgetId:n,adverturl:t,adverttext:i,visitId:a.settings.visitId,visitorId:a.settings.visitorId},(function(e){}))},i.prototype.Sound=function(e){if(!e)return!1;var t=!1,i=document.createElement("audio");if(t=!!i.canPlayType,""!=i.canPlayType("audio/mpeg")&&"no"!=i.canPlayType("audio/mpeg")?ext=".mp3":"no"!=i.canPlayType('audio/ogg; codecs="vorbis"')&&""!=i.canPlayType('audio/ogg; codecs="vorbis"')?ext=".ogg":t=!1,t){var n=this.settings.staticServerUrl+"/widget/audio/"+e+ext;i.src=n,i.load();var a=i.play();void 0!==a&&a.then((function(e){})).catch((function(e){}))}},i.prototype.checkPhone=function(e,i){var n=!1;return e&&(12===(e=(e=e.toString()).replace(/\D/g,"")).length&&"3"===e.charAt(0)&&"8"===e.charAt(1)?(0!==e.indexOf("380",0)&&(e=!1),(n=t(".cbk-phone-checker:first").val(e).blur().val())&&""!==n||(n=!1)):11===e.length&&"3"===e.charAt(0)&&"8"===e.charAt(1)&&"0"===e.charAt(2)?n=!1:10===e.length&&"0"===e.charAt(0)?(10===e.length&&(e="38"+e),(n=t(".cbk-phone-checker:first").val(e).blur().val())&&""!==n||(n=!1)):e.length>=12&&"8"===e.charAt(0)&&"6"===e.charAt(1)||11===e.length&&"3"===e.charAt(0)&&"8"===e.charAt(1)&&"6"===e.charAt(2)||12===e.length&&"4"===e.charAt(0)&&"4"===e.charAt(1)?(n=t(".cbk-phone-checker:first").val(e).blur().val())&&""!==n||(n=!1):10!==e.length&&11!==e.length||"6"!==e.charAt(0)||"6"!==e.charAt(1)?"3"===e.charAt(0)&&"5"===e.charAt(1)&&"8"===e.charAt(2)||12===e.length&&"3"===e.charAt(0)&&"7"===e.charAt(1)&&"5"===e.charAt(2)?(n=t(".cbk-phone-checker:first").val(e).blur().val())&&""!==n||(n=!1):10!==e.length&&14!==e.length||"4"!==e.charAt(0)||"7"!==e.charAt(1)?12===e.length&&"9"===e.charAt(0)&&"9"===e.charAt(1)&&"2"===e.charAt(2)||12===e.length&&"9"===e.charAt(0)&&"9"===e.charAt(1)&&"6"===e.charAt(2)||12===e.length&&"9"===e.charAt(0)&&"9"===e.charAt(1)&&"8"===e.charAt(2)||"3"===e.charAt(0)&&"5"===e.charAt(1)&&"9"===e.charAt(2)||11===e.length&&"3"===e.charAt(0)&&"7"===e.charAt(1)&&"3"===e.charAt(2)||"1"===e.charAt(0)&&11===e.length||"6"===e.charAt(0)&&"2"===e.charAt(1)&&e.length>=10||"3"===e.charAt(0)&&"9"===e.charAt(1)&&e.length>=11||"4"===e.charAt(0)&&"2"===e.charAt(1)&&"0"===e.charAt(2)&&12===e.length||"9"===e.charAt(0)&&"0"===e.charAt(1)&&12===e.length||"4"===e.charAt(0)&&"0"===e.charAt(1)&&11===e.length||"9"===e.charAt(0)&&"7"===e.charAt(1)&&"2"===e.charAt(2)&&e.length>=11||"9"===e.charAt(0)&&"7"===e.charAt(1)&&"1"===e.charAt(2)&&e.length>=11?(n=t(".cbk-phone-checker:first").val(e).blur().val())&&""!==n||(n=!1):10===e.length&&"0"!==e.charAt(0)&&"380"!==e.substring(0,3)&&"7"!==e.charAt(0)||11===e.length&&"380"!==e.substring(0,3)?(10===e.length&&(e="7"+e),11===e.length&&"8"===e.charAt(0)&&(e=e.substring(0,0)+"7"+e.substring(1)),(n=t(".cbk-phone-checker:first").val(e).blur().val())&&""!==n||(n=!1)):!(e.length>=11&&"0"!==e.charAt(0))||"8"!==e.charAt(0)&&"7"!==e.charAt(0)||"3"!==e.charAt(1)&&"4"!==e.charAt(1)&&"8"!==e.charAt(1)&&"9"!==e.charAt(1)&&"7"!==e.charAt(1)||("8"!==e.charAt(0)||i||(e="7"+e.substring(1)),e=!i&&e.substring(0,11),(n=t(".cbk-phone-checker:first").val(e).blur().val())&&""!==n||(n=!1)):(n=t(".cbk-phone-checker:first").val(e).blur().val())&&""!==n||(n=!1):(n=t(".cbk-phone-checker:first").val(e).blur().val())&&""!==n||(n=!1)),n},i.prototype.setVisitorInfoIfNot=function(e){e.name&&!WBK.settings.visitorName&&(WBK.settings.visitorName=e.name),e.phone&&!WBK.settings.visitorPhone&&(WBK.settings.visitorPhone=e.phone),e.email&&!WBK.settings.visitorEmail&&(WBK.settings.visitorEmail=e.email)},i.prototype.checkWidgetOpened=function(e){var t=this,i=!0;switch(e){case"instinct":(t.settings.windowGeneratorOpened||t.settings.windowOpened||t.settings.chatWindowOpened||t.settings.windowQuizOpened||t.settings.videoWidgetOpened)&&(i=!1);break;case"video_widget":(t.settings.windowGeneratorOpened||t.settings.windowOpened||t.settings.chatWindowOpened||t.settings.windowQuizOpened)&&(i=!1)}return i},i.prototype.checkDebug=function(){var e=!1;return 1==wsUtil.getStorage("ws_debug")&&(e=!0),e},i.prototype.formatText=function(e){return e?(e=this.replaceTagVariant(e),e=this.replaceGetParamText(e),e=this.replaceTimeVariant(e)):""},i.prototype.replaceGetParamText=function(e){if(!e)return"";for(var t=/\[get:([-\w]+)\]/;_res=t.exec(e);){var i=this.urlParam(_res[1]);e=e.replace(_res[0],i?decodeURIComponent(i).replace(/\+/g," "):"")}return e},i.prototype.replaceTagVariant=function(e){if(!e)return"";for(var i=/\[\#([-\w]+)\]/;_result=i.exec(e);){var n=new RegExp("\\[\\#"+_result[1]+"\\]","gi");e=e.replace(n,t("#"+_result[1]).text())}return e},i.prototype.replaceTimeVariant=function(e){if(!e)return"";for(var t=/\[time(\+|\-)?(\d+)?(\|)?(\d+)?\]/;_res=t.exec(e);){var i=!0,n=new Date;void 0!==_res[1]&&(i="-"!=_res[1]),void 0!==_res[2]&&n.setMinutes(i?n.getMinutes()+parseInt(_res[2]):n.getMinutes()-parseInt(_res[2])),e=e.replace(_res[0],(n.getHours()<10?"0":"")+n.getHours()+":"+(n.getMinutes()<10?"0":"")+n.getMinutes())}return e},i.prototype.urlParam=function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null==t?null:t[1]||0},i.prototype.loadFont=function(){if(!this.fontLoaded){this.fontLoaded=!0;WBK.addStyles("@font-face{font-family: 'whitesaas';src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/whitesaas.eot?"+"11');src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/whitesaas.eot?"+"11#iefix') format('embedded-opentype'),url('"+WBK.settings.staticServerUrl+"/widget/fonts/whitesaas.woff2?"+"11') format('woff2'),url('"+WBK.settings.staticServerUrl+"/widget/fonts/whitesaas.woff?"+"11') format('woff'),url('"+WBK.settings.staticServerUrl+"/widget/fonts/whitesaas.ttf?"+"11') format('truetype'),url('"+WBK.settings.staticServerUrl+"/widget/fonts/whitesaas.svg?"+"11#font3435') format('svg');font-weight: normal;font-style: normal;}"),WBK.addStyles("@font-face{font-family: 'CBKRobotoLight';src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/roboto/RobotoLight.eot');src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/roboto/RobotoLight.eot?#iefix') format('embedded-opentype'), url('"+WBK.settings.staticServerUrl+"/widget/fonts/roboto/RobotoLight.woff') format('woff'), url('"+WBK.settings.staticServerUrl+"/widget/fonts/roboto/RobotoLight.ttf') format('truetype');font-style: normal;font-weight: normal;}"),WBK.addStyles("@font-face{font-family: 'CBKRobotoRegular';src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/roboto/RobotoRegular.eot');src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/roboto/RobotoRegular.eot?#iefix') format('embedded-opentype'), url('"+WBK.settings.staticServerUrl+"/widget/fonts/roboto/RobotoRegular.woff') format('woff'), url('"+WBK.settings.staticServerUrl+"/widget/fonts/roboto/RobotoRegular.ttf') format('truetype');font-style: normal;font-weight: normal;}"),WBK.addStyles("@font-face{font-family: 'CBKRobotoThin';src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/roboto/RobotoThin.eot');src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/roboto/RobotoThin.eot?#iefix')format('embedded-opentype'), url('"+WBK.settings.staticServerUrl+"/widget/fonts/roboto/RobotoThin.woff') format('woff'), url('"+WBK.settings.staticServerUrl+"/widget/fonts/roboto/RobotoThin.ttf') format('truetype');font-style: normal;font-weight: normal;}"),WBK.addStyles("@font-face{font-family: 'CBKOpenSans';src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/open-sans/OpenSans-Regular.eot');src: local('Open Sans Regular'), local('OpenSans-Regular'), url('"+WBK.settings.staticServerUrl+"/widget/fonts/open-sans/OpenSans-Regular.eot?#iefix') format('embedded-opentype'), url('"+WBK.settings.staticServerUrl+"/widget/fonts/open-sans/OpenSans-Regular.woff2') format('woff2'), url('"+WBK.settings.staticServerUrl+"/widget/fonts/open-sans/OpenSans-Regular.woff') format('woff'), url('"+WBK.settings.staticServerUrl+"/widget/fonts/open-sans/OpenSans-Regular.ttf') format('truetype'), url('"+WBK.settings.staticServerUrl+"/widget/fonts/open-sans/OpenSans-Regular.svg#OpenSans') format('svg');font-style: normal;font-weight: 400;}"),WBK.addStyles("@font-face{font-family: 'Museo';src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/museo/MuseoSansCyrl_500.otf?') format('opentype');}@font-face{font-family: 'Museo'; font-style: normal; font-weight: 900;src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/museo/MuseoSansCyrl_900.otf?') format('opentype');}@font-face{font-family: 'Times New Roman'; font-style: normal; font-weight: normal;src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/times-new-roman/TimesNewRoman.ttf?') format('opentype');font-style: normal; font-weight: 500;}")}},i.prototype.setDefaultSettings=function(){this.settings={thisIsCallbackKILLER:!1,servicename:"WhiteSaaS",servicedomain:"whitesaas.com",serviceid:0,accountid:0,partnerLink:"https://whitesaas.com?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=&utm_term=",whiteSaasCode:0,utcTime:!1,visitorId:!1,visitId:!1,siteId:0,visitorName:!1,visitorPhone:!1,visitorEmail:!1,hasVisitorName:0,phoneBase:7,phoneMasks:!1,phoneBasesCountries:!1,device:"pc",phoneMask:"+_(___)___-__-__",language:"ru",months:{0:"января",1:"февраля",2:"марта",3:"апреля",4:"мая",5:"июня",6:"июля",7:"августа",8:"сентября",9:"октября",10:"ноября",11:"декабря"},domain:document.domain,serverUrl:"https://whitesaas.com",staticServerUrl:"https://content.saas-support.com",socketioUrl:"https://chat.callbackkiller.com/cbk",socketConnected:0,windowOpened:!1,windowGeneratorOpened:!1,windowInvaderOpened:!1,windowLoanerOpened:!1,callbackEnabled:!1,generatorEnabled:!1,chatEnabled:!1,chatBtnOpened:!1,chatWindowOpened:!1,chatInvitationOpened:!1,multiButtonVariantsOpened:!1,chatInvitationShown:!1,hideCopyright:!1,invaderStatId:!1,invaderCallbackStatId:!1,invaderGeneratorStatId:!1,instinctStatId:!1,instinctCallbackStatId:!1,instinctGeneratorStatId:!1,generatorStatId:!1,genLeadId:!1,multiButtonEnabled:!1,multiButtonOpened:!1,called:!1,fontLoaded:!1,sendFacebookLead:!0,geoCity:!1,quizIframeEventsLoaded:!1,quizStatId:!1,quizIntegrated:!1,windowRatio:1,videoWidgetIframeEventsLoaded:!1,videoWidgetOpened:!1}},i.prototype.numberMask=function(e){var t={number:e=String(e),mask:""};return e?(t.number=e.replace(/[^\d]/g,""),0==t.number.length||t.number.length<5?t:5==t.number.length?(t.mask="_-__-__",t):6==t.number.length?(t.mask="__-__-__",t):7==t.number.length?(t.mask="___-__-__",t):8==t.number.length?(t.mask="___-__-___",t):9==t.number.length?(t.mask="___-___-___",t):10==t.number.length?(0==t.number[0]?(t.number="38"+t.number,t.mask="+__(___)___-__-__"):"372"===t.number.substring(0,3)?t.mask="+___-___-__-__":-1!=[3,4,8,9,7].indexOf(parseInt(t.number[0]))?(t.number="7"+t.number,t.mask="+_(___)___-__-__"):t.mask="(___)___-__-__",t):11==t.number.length?(8==t.number[0]&&(t.number=t.number.replace(t.number.charAt(0),7)),t.mask="+_(___)___-__-__",t):12==t.number.length?(375==t.number.substr(0,3)?t.mask="+___(__)___-__-__":t.mask="+__(___)___-__-__",t):t.number.length>12?(t.mask="(___)___-__-__",t):t):t},i.prototype.initOnlyDigitsEvent=function(e){t(e).off("input").on("input",(function(e){this.value=this.value.replace(/[^\d]/g,"")}))},i.prototype.formatToPhone=function(e){var t=e.replace(/[^+\d]/g,"");if(!t)return t;var i=t.substring(0,1),n=!1;"+"===i&&(n=!0,t=t.replace(/[+]/g,""));var a=t.length;i=t.substring(0,1);var s=0,o=!1;[7,8].includes(+i)&&(s++,o=!0);var r,l=t.substring(s,s+3),c=t.substring(s+3,s+6),d=s+6;a>6&&(r=t.substring(d,s+8),d+=2);var h=t.substring(d,s+a);return a>(o?11:10)||8==+i&&n?e=t:a>6?e=o?8==+i?i+" ("+l+") "+c+(r?"-"+r:"")+(h?"-"+h:""):7==+i?i+" "+l+" "+c+(r?"-"+r:"")+(h?"-"+h:""):i+l+" "+c+(h?"-"+h:""):l+" "+c+" "+r+(h?"-"+h:""):a>3?e=o?8==+i?i+" ("+l+") "+c:i+" "+l+" "+c:l+" "+c:a>=0&&(e=o?i+l:l),e=e.trim(),n&&(e="+"+e),e},i.prototype.initPhoneFormat=function(e){var i=function(e){var t=e.keyCode;return!0===e.shiftKey||35===t||36===t||8===t||9===t||13===t||46===t||107===t||t>36&&t<41||(!0===e.ctrlKey||!0===e.metaKey)&&(65===t||67===t||86===t||88===t||90===t)},n=function(e){var n=8===e.keyCode||46===e.keyCode;if(!i(e)||8===e.keyCode||46===e.keyCode){var a=e.target,s=e.target.value.replace(/\D/g,"");if(n&&a.value.length){var o=t(e.target).data("input-length"),r=a.value.substring(a.value.length-1,a.value.length);if(["(",")"].includes(r)&&o===s.length){var l=s.substring(s.length-1,s.length);a.value=s.replace(l,""),a.value=a.value.trim()}}}};t(e).off("keydown").on("keydown",(function(e){(function(e){var t=e.keyCode;return t>=48&&t<=57||t>=96&&t<=105})(e)||i(e)||e.preventDefault(),n(e),t(e.target).data("input-length",e.target.value.replace(/\D/g,"").length)})),t(e).off("keyup").on("keyup",n),t(e).off("input").on("input",(function(e){this.value=this.value.replace(/[^+\d]/g,""),function(e){if(!i(e)||8===e.keyCode||46===e.keyCode){var t=e.target;t.value=WBK.formatToPhone(t.value)}}(e)}))}}(jWS)},627:()=>{}},__webpack_module_cache__={},deferred;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.loaded=!0,i.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(e,t,i,n)=>{if(!t){var a=1/0;for(l=0;l<deferred.length;l++){for(var[t,i,n]=deferred[l],s=!0,o=0;o<t.length;o++)(!1&n||a>=n)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[o])))?t.splice(o--,1):(s=!1,n<a&&(a=n));if(s){deferred.splice(l--,1);var r=i();void 0!==r&&(e=r)}}return e}n=n||0;for(var l=deferred.length;l>0&&deferred[l-1][2]>n;l--)deferred[l]=deferred[l-1];deferred[l]=[t,i,n]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={215:0,819:0};__webpack_require__.O.j=t=>0===e[t];var t=(t,i)=>{var n,a,[s,o,r]=i,l=0;if(s.some((t=>0!==e[t]))){for(n in o)__webpack_require__.o(o,n)&&(__webpack_require__.m[n]=o[n]);if(r)var c=r(__webpack_require__)}for(t&&t(i);l<s.length;l++)a=s[l],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return __webpack_require__.O(c)},i=self.webpackChunkWhitesaas=self.webpackChunkWhitesaas||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),__webpack_require__.O(void 0,[819],(()=>__webpack_require__(910)));var __webpack_exports__=__webpack_require__.O(void 0,[819],(()=>__webpack_require__(627)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();